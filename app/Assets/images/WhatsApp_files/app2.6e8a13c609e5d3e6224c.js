/*! Copyright (c) 2015 WhatsApp Inc.  All Rights Reserved. */
webpackJsonp([0],{6979:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return function(t){return"number"==typeof t.status&&t.status>=500?t:void e(t)}}var r=a(56),i=o(r),l=a(0),s=o(l),u=a(29),c=o(u),d=a(1),f=a(14),p=a(33),h=a(25),m=a(271),g=a(32),v=a(73),b=a(7154),y=a(108),E={BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16},isRequestingDeviceUploadLogsMutex:0,wrap:n,wrap02:n,binWrap:function(e,t){return function(a){if("object"==typeof a&&"number"==typeof a.status){if(401===a.status)throw new f.E401;if(a.status>=500)return a;t(a)}else e(a)}},actionNode:function(e,t){return["action",{type:e},t]},queryNode:function(e,t){return["query",e,t]},dropIfConditionMet:function(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t},actionGetMeta:function(e){var t={};if("action"!==this.N.tag(e))return t;var a=this.N.attr("add",e),o=this.N.attr("missing",e),n=this.N.attr("checksum",e);switch(a){case"unread":t.unreadId=this.N.attr("index",e),t.unreadFromMe="true"===this.N.attr("owner",e),t.unreadParticipant=this.N.attr("participant",e);case"after":case"before":case"last":t.pendingMsgsDone="true"===this.N.attr("last",e),t.resume="true"===this.N.attr("resume",e);case"relay":case"update":t.add=a}switch(o){case"remove":t.missing=o}return n&&(t.checksum=n),t},groupActionsByType:function(e){var t={};if(!_.isArray(e))return t;var a,o,n=e.length;for(o=0;n>o;o++)switch(a=e[o],this.N.tag(a)){case"broadcast":switch(this.N.attr("type",a)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(a);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(a)}break;case"message":case"groups_v2":case"notification":case"call_log":case"security":t.msg||(t.msg=[]),t.msg.push(a);break;case"read":case"log":case"identity":t.cmd||(t.cmd=[]),t.cmd.push(a);break;case"received":t.ack||(t.ack=[]),t.ack.push(a);break;case"user":t.contact||(t.contact=[]),t.contact.push(a);break;case"contacts":t.contacts||(t.contacts=[]),t.contacts.push(a);break;case"chat":switch(this.N.attr("type",a)){case"mute":t.mute||(t.mute=[]),t.mute.push(a);break;default:t.chat||(t.chat=[]),t.chat.push(a)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(a);break;case"status":t.status||(t.status=[]),t.status.push(a);break;case"location":t.location||(t.location=[]),t.location.push(a);break;default:d.errorVerbose("Wap:groupActionsByType unknown action: "+this.N.toString(a),a)()}return t},safeParseInt:function(e,t){var a=parseInt(this.N.attr(t,e),10);return _.isNaN(a)?void 0:a},parseChat:function(e){if("chat"===this.N.tag(e)){var t=this.N.attr("jid",e),a=parseInt(this.N.attr("t",e),10)||void 0,o=this.N.attr("type",e),n=parseInt(this.N.attr("mute",e),10)||void 0,r=parseInt(this.N.attr("before",e),10)||void 0,i="true"===this.N.attr("archive",e),l="true"===this.N.attr("read_only",e),s=parseInt(this.N.attr("modify_tag",e),10)||void 0,u=this.N.attr("name",e)||void 0,c=this.safeParseInt(e,"count"),d="true"===this.N.attr("message",e);"ahead"===o&&(o="clear");var f,p=this.N.children(e);if(_.isArray(p)){f=[];var h,m,g=p.length;for(h=0;g>h;h++)if(m=p[h],"item"===this.N.tag(m)){var v=this.N.attr("index",m);v&&f.push([v,"true"===this.N.attr("owner",m)])}}var b={id:t,t:a,type:o,keys:f,before:r,archive:i,isReadOnly:l,unreadCount:c,muteExpiration:n,modifyTag:s,name:u,pendingMsgs:d};this.pruneUndefinedProps(b);var y=[o&&"delete"!==o&&"clear"!==o&&"archive"!==o&&"unarchive"!==o&&"mute"!==o&&"modify_tag"!==o,!o&&!t,i&&o&&"clear"!==o,"clear"!==o&&r&&r>0,"clear"!==o&&f&&f.length>0];return this.dropIfConditionMet(y,b)}},parseContact:function(e){if("user"===this.N.tag(e)){var t=this.N.attr("jid",e),a=this.N.attr("name",e),o=this.N.attr("short",e)||void 0,n=this.N.attr("type",e)||"in",r="true"===this.N.attr("plaintext_disabled",e),i={id:t,name:a,type:n,shortName:o,plaintextDisabled:r},l=[!t,"in"!==n&&"out"!==n&&!!n];return this.dropIfConditionMet(l,i)}},parseCmd:function(e){if("read"===this.N.tag(e)){var t=this.N.attr("jid",e),a={type:"read",jid:t},o=[!t];return this.dropIfConditionMet(o,a)}},parseAck:function(e){if("received"===this.N.tag(e)){var t,a=this.N.attr("type",e),o=this.N.attr("id",e),n=this.N.attr("to",e);switch(a){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var r={cmd:"ack",id:o,ack:t,from:Store.Conn.me,to:n},i=[!o,!n,"message"!==a&&"read"!==a&&"played"!==a&&"error"!==a&&"pending"!==a];return this.dropIfConditionMet(i,r)}},parseBCUpdate:function(e){if("broadcast"===this.N.tag(e)&&"modify"===this.N.attr("type",e)){var t=this.N.attr("jid",e),a=this.N.children(e),o=[];if(_.isArray(a)){var n,r,i,l=a.length;for(n=0;l>n;n++)r=a[n],i=this.N.attr("jid",r),"recipient"===this.N.tag(r)&&i&&2===i.split("@").length&&"c.us"===i.split("@")[1]&&o.push({id:i})}var s={id:t,participants:o},u=[!t,"broadcast"!==t.split("@")[1],0===o.length];return this.dropIfConditionMet(u,s)}},parseBattery:function(e){if("battery"===this.N.tag(e)){var t=Math.min(parseInt(this.N.attr("value",e),10)||-1,100),a=this.N.attr("live",e),o={battery:0>t?void 0:t,plugged:a?"true"===a:void 0},n=[0>t&&!a];return this.dropIfConditionMet(n,o)}},msgGetTarget:function(e){return e.from===Store.Conn.me?e.to:e.from},parseMsg:function(e,t){switch(this.N.tag(e)){case"message":return this.parseMsgMessage(e,t);case"groups_v2":return this.parseMsgGp2(e);case"broadcast":return this.parseMsgBroadcast(e);case"notification":return this.parseMsgNotification(e);case"call_log":return this.parseMsgCallLog(e);case"security":return this.parseMsgSecurity(e);default:return}},parseMsgMessage:function(e,t){if("message"===this.N.tag(e)){var a;this.N.attr("from",e)!==Store.Conn.me||this.N.attr("to",e)?this.N.attr("to",e)!==Store.Conn.me||this.N.attr("from",e)||(a="out"):a="in";var o,n=this.N.attr("id",e),r=parseInt(this.N.attr("t",e),10)||0,i=this.N.attr("to",e)||Store.Conn.me,l=this.N.attr("from",e)||Store.Conn.me,s="broadcast"===l.split("@")[1],u=this.N.attr("participant",e),c=s?u:l,f=s?void 0:u,p=s?!1:this.N.child("broadcast",e)&&l===Store.Conn.me,h="invis"===this.N.attr("web",e),m=this.N.attr("notify",e)||"",g=parseInt(this.N.attr("status",e))||0,v=[],b=this.N.child("broadcast",e);if("broadcast"!==i){try{var E=new y({from:c,to:i,id:n,participant:u,selfDir:a})}catch(S){return void d.error("drop: cannot create MsgKey: "+S.stack)()}switch(t){case"fresh":o=1;break;default:o=g>=-1&&4>=g?g:1}if(_.isArray(b)){var C,M=b.length;for(C=0;M>C;C++){var k=b[C],w=this.N.attr("jid",k);"to"===this.N.tag(k)&&w&&v.push(w)}}var N,T=[],P=this.N.attr("type",e);switch(P){case"ciphertext":case"text":var I=this.N.dataStr(this.N.child("body",e))||"";N={id:E,body:"text"===P?I:void 0,type:"text"===P?"chat":"ciphertext",t:r,notifyName:m,from:c,to:i,self:a,author:f,invis:h,ack:o,broadcast:p,recipients:v},T=[!n,!r,!c,!i];break;case"media":var R,A,x,O,D,L=this.N.child("media",e),U=this.N.attr("type",L),F=this.N.attr("media_key",L),j=this.N.attr("mimetype",L);if("retry"===this.N.attr("reason",L))return;switch(U){case"image":case"video":var B=this.N.attr("caption",L);R=this.thumbFromMediaXml(L),A=this.N.attr("url",L),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",L),O=parseInt(this.N.attr("size",L),10)||0,D=this.N.attr("seconds",L),N={id:E,body:R,type:U,t:r,notifyName:m,from:c,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,duration:D,broadcast:p,recipients:v,filehash:x,size:O,caption:B,mediaKey:F,mimetype:j},T=[!n,!r,!c,!i];break;case"location":var G=this.N.attr("latitude",L),V=this.N.attr("longitude",L),Y=this.N.attr("name",L);R=this.thumbFromMediaXml(L),A=this.N.attr("url",L),N={id:E,body:R,type:U,t:r,notifyName:m,from:c,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,loc:Y,lat:G,lng:V,broadcast:p,recipients:v},T=[!n,!r,!c,!i,!G||!V];break;case"audio":var W="live"===this.N.attr("origin",L)?"ptt":U;A=this.N.attr("url",L),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",L),O=parseInt(this.N.attr("size",L),10)||0,D=this.N.attr("seconds",L),N={id:E,type:W,t:r,notifyName:m,from:c,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,duration:D,broadcast:p,recipients:v,filehash:x,size:O,mediaKey:F,mimetype:j},T=[!n,!r,!c,!i];break;case"vcard":var H=this.N.child("vcard",L),q=this.N.dataStr(H),z=this.N.attr("name",H);N={id:E,body:q,type:U,subtype:z,t:r,notifyName:m,from:c,to:i,self:a,author:f,invis:h,ack:o,broadcast:p,recipients:v},T=[!n,!r,!c,!i,!q,!z];break;default:d.error("wap:parseMsgMessage: unknown media type: "+this.N.toString(e),e)()}break;default:d.error("wap:parseMsgMessage: unknown message type: "+this.N.toString(e),e)()}return this.dropIfConditionMet(T,N)}}},thumbFromMediaXml:function(e){return"raw"===this.N.attr("encoding",e)?this.N.children(e)instanceof ArrayBuffer?h.encode(this.N.children(e)):"":this.N.dataStr(e)},parseMsgGp2:function(e){if("groups_v2"===this.N.tag(e)){var t,a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("id",e),n=this.N.attr("jid",e),r="invis"===this.N.attr("web",e),i=this.N.attr("type",e),l=this.N.attr("author",e),s=this.N.children(e),u=[];switch(i){case"create":t=this.N.attr("subject",e);break;case"subject":t=this.N.attr("subject",e);break;case"picture":t=this.N.attr("picture",e)}if(_.isArray(s)){var c,f=s.length;for(c=0;f>c;c++){var p=s[c],h=this.N.attr("jid",p);"participant"===this.N.tag(p)&&h&&u.push(h)}}var m=_.isString(l)?l.indexOf("s.whatsapp.net"):-1;m>-1&&(l=l.slice(0,m)+"c.us");try{var g=new y({from:n,to:n,id:o})}catch(v){return void d.error("drop: cannot create MsgKey: "+v.stack)()}var b={t:a,id:g,to:n,from:n,author:l,body:t?t.toString():void 0,type:"gp2",subtype:i,invis:r,recipients:u},E=[!o,!a,"subject"!==i&&"add"!==i&&"invite"!==i&&"remove"!==i&&"leave"!==i&&"picture"!==i&&"modify"!==i&&"create"!==i&&"delete"!==i&&"promote"!==i&&"demote"!==i,"subject"===i&&!t,("add"===i||"invite"===i||"remove"===i||"leave"===i||"promote"===i||"demote"===i||"modify"===i)&&0===u.length,!n,"string"==typeof n&&"g.us"!==n.split("@")[1]];return this.dropIfConditionMet(E,b)}},parseMsgBroadcast:function(e){if("broadcast"===this.N.tag(e)){var t,a=this.N.attr("type",e),o=this.N.attr("id",e),n=parseInt(this.N.attr("t",e),10)||0,r=this.N.attr("jid",e);switch(a){case"create":t=parseInt(this.N.attr("count",e),10)||0;break;case"add":case"remove":t=this.N.attr("participant",e)}try{var i=new y({from:r,to:r,id:o})}catch(l){return void d.error("drop: cannot create MsgKey: "+l.stack)()}var s={id:i,t:n,type:"broadcast_notification",subtype:a,from:r,to:r,body:t?t.toString():void 0},u=[!o,!n,!r,"string"==typeof r&&"broadcast"!==r.split("@")[1],"create"!==a&&"add"!==a&&"remove"!==a,("add"===a||"remove"===a)&&2!==t.split("@").length];return this.dropIfConditionMet(u,s)}},parseMsgNotification:function(e){if("notification"===this.N.tag(e)){var t=this.N.attr("id",e),a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("jid",e),n="invis"===this.N.attr("web",e),r=this.N.dataStr(e),i="true"===this.N.attr("owner",e);try{var l=new y({fromMe:i,remote:o,id:t})}catch(s){return void d.error("drop: cannot create MsgKey: "+s.stack)()}var u={id:l,type:"notification",t:a,invis:n,from:i?Store.Conn.me:o,to:i?o:Store.Conn.me,body:r},c=[!t,!a,!o,2!==o.split("@").length];return this.dropIfConditionMet(c,u)}},"delete":_.noop,error2412:_.noop,setSubProtocol:function(e){1===e?(this.BinaryProtocol=new b("01"),this.N=this.BinaryProtocol.Node):(this.BinaryProtocol=new b("03"),this.N=this.BinaryProtocol.Node)},handleResponse:function(e,t,a){if(0===e.indexOf("preempt"))switch(this.N.attr("type",t)){case"chat":d.logColor("green","bin-recv: "+e+",response,chat",t)();var o=this.N.children(t)||[];if(_.isArray(o)){for(var n=o.length,r=[],i=0;n>i;i++){var l=this.parseChat(o[i]);l&&r.push(l)}Store.Chat.handle([{cmd:"preempt",response:r}],a)}break;case"contacts":d.logColor("green","bin-recv: "+e+",response,contact",t)();var s=this.N.children(t);if(_.isArray(s)){for(var u=s.length,c=[],f=0;u>f;f++){var p=this.parseContact(s[f]);p&&c.push(p)}Store.Contact.handle([{cmd:"preempt",checksum:this.N.attr("checksum",t),response:c}],a)}break;default:d.error("Wap:handle unknown response type: "+this.N.toString(t,!0),t)()}else d.error("Wap:handle non-preemptive response: "+this.N.toString(t,!0),t)()},handleActionMsg:function(e,t,a,o){var n=a.length;switch(t.add){case"relay":case"update":var r=this.parseMsg(a[0],"relay");if(1!==n&&d.error("Wap:handle action msg relay length not 1",o)(),r){d.logColor("green","bin-recv: "+[e,"action","msg",t.add,r.type,r.from,r.to,r.id,r.author].join(","),o,r)();var i=this.msgGetTarget(r);Store.Msg.handle([{meta:t,chat:i,msg:r}])}else d.error("Wap:handle action msg relay dropped",a[0])();break;case"last":for(var l=[],s=0;n>s;s++){var u=this.parseMsg(a[s],"last");u?l.push(u):d.error("Wap:handle action msg last dropped",a[s])()}if(l.length>0){d.logColor("green","bin-recv: "+[e,"action","msg","last",a.length].join(","),o,[l])();for(var c={recent:!0,meta:t},f=0;f<l.length;f++)c[this.msgGetTarget(l[f])]=l[f];Store.Msg.handle([c])}else d.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":case"unread":if(n>0){for(var p=[],h=0;n>h;h++){var m=this.parseMsg(a[h],t.add);m?p.push(m):d.error("Wap:handle action msg before/after dropped",a[h])()}if(p.length>0){var g=this.msgGetTarget(p[0]);d.logColor("green","bin-recv: "+[e,"action","msg",t.add,g,p.length].join(","),o,[p])(),Store.Msg.handle([{meta:t,chat:g,msgs:p}])}else d.error("Wap:handle action msg "+t.add+" dropped to 0")()}else d.error("Wap:handle action msg before/after 0 msgs")();break;default:d.error("Wap:handle action msg no meta.add",o)()}},handleAction:function(e,t,a){var o=this.actionGetMeta(t),n=this.groupActionsByType(this.N.children(t)),r=(0,c["default"])(n);if(!_.isArray(r))return void d.error("Wap:handle:action keys not array: "+typeof r)(r);var i=r.length;if(0===i&&"last"===o.add)return void Store.Msg.handle([{recent:!0,meta:o}]);for(var l=0;i>l;l++){var s=r[l],u=n[s],f=u.length;switch(s){case"msg":this.handleActionMsg(e,o,u,t);break;case"cmd":for(var p=0;f>p;p++){var h=this.parseCmd(u[p]);if(h){var m=_.values(h).join(",");d.logColor("green","bin-recv: "+[e,"action","cmd",m].join(","),t)(),Store.Cmd.handle([h],a)}else d.error("Wap:handle action cmd invalid",t)()}break;case"bcUpdate":for(var g=[],v=0;f>v;v++){var b=this.parseBCUpdate(u[v]);b?g.push(b):d.error("Wap:handle action bc update invalid",u[v])()}d.logColor("green","bin-recv: "+[e,"action","bcUpdate",g.length].join(","),t)(),g.length>0&&Store.GroupMetadata.handle(g,a);break;case"ack":for(var y=0;f>y;y++){var E=this.parseAck(u[y]);E?(d.logColor("green","bin-recv: "+[e,"action","ack",E.to,E.id,E.ack].join(","),t)(),Store.Msg.handle([E],a)):d.error("Wap:handle action ack invalid",t)()}break;case"contact":for(var S=[],C=0;f>C;C++){var M=this.parseContact(u[C]);M?S.push(M):d.error("Wap:handle action contact dropped",u[C])()}if(d.logColor("green","bin-recv: "+[e,"action","contact",S.length,o.missing].join(","),t)(),S.length>0){var k=[S];(o.missing||o.checksum)&&k.push(o),Store.Contact.handle(k,a)}break;case"contacts":var w=this.parseContacts(u[0]);d.logColor("green","bin-recv: "+[e,"action","contacts"].join(","),t)(),w?Store.Contact.handle([w],a):d.error("Wap:handle:action:contacts dropped",u[0])();break;case"chat":for(var N=[],T=0;f>T;T++){var P=this.parseChat(u[T]);P?N.push(P):d.error("Wap:handle action chat dropped",u[T])()}d.logColor("green","bin-recv: "+[e,"action","chat",N.length].join(","),t)(),N.length>0&&Store.Chat.handle([N],a);break;case"battery":var I=this.parseBattery(u[0]);I?(d.logColor("green","bin-recv: "+[e,"action","battery",I.battery,I.plugged].join(","),t)(),Store.Conn.handle([I],a)):d.error("Wap:handle action battery dropped",u[0])();break;case"mute":for(var R=[],A=0;f>A;A++){var x=this.parseChat(u[A]);x?R.push(x):d.error("Wap:handle action mute dropped",u[A])()}d.logColor("green","bin-recv: "+[e,"action","mute",R.length].join(","),t)(),R.length>0&&Store.Mute.handle(R,a);break;case"status":for(var O=[],D=0;f>D;D++){var L=this.parseStatus(u[D]);L?O.push(L):d.error("Wap:handle:status dropped",u[D])(),d.logColor("green","bin-recv:"+[e,"action","status",O.length].join(),t)(),O.length>0&&Store.StatusV3.handle([O])}break;case"location":for(var U=[],F=0;f>F;F++){var j=this.parseLocation(u[F]);j?U.push(j):d.error("Wap:handle:location dropped",u[F])(),d.logColor("green","bin-recv:"+[e,"action,location",U.length].join(),t)(),U.length>0&&Store.Location.handle(U)}break;default:d.error("Wap:handle action unknown "+s,t)()}}},handle:function(e,t,a){var o=this;return this.BinaryProtocol.read(e).then(function(e){switch(o.N.tag(e)){case"response":o.handleResponse(a,e,t);break;case"action":o.handleAction(a,e,t);break;case"read":var n=o.parseCmd(e);if(n){var r=_.values(n).join();d.logColor("green","bin-recv:"+[a,"action",r].join(),e)(),Store.Cmd.handle([n],t)}else d.error("Wap:handle read invalid",e)();break;default:d.errorVerbose("TODO "+o.N.toString(e,!0),e)()}return!0})},requestDeviceUploadLogs:function(){var e,t=this;return new s["default"](function(a,o){if(t.isRequestingDeviceUploadLogsMutex)return void a();e=++t.isRequestingDeviceUploadLogsMutex;var n=t.actionNode("debug",[["log",void 0,void 0]]),r=a;r.drop=!0,t.binSend("send",n,o,{onSend:r,onDrop:o},{debugString:"debug,log",metric:t.M.DEBUG_LOG,ackRequest:!0})})["finally"](function(){e===t.isRequestingDeviceUploadLogsMutex&&(t.isRequestingDeviceUploadLogsMutex=0)})},resyncMessages:function(e){var t=this;return new m(function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(d.logColor("green","bin-recv: response,resume",e)(),"response"===t.N.tag(e)&&"resume"===t.N.attr("type",e)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a({checksum:t.N.attr("checksum",e),data:o})})["catch"](o)},r=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),g.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),i=t.queryNode({type:"resume"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:o},{debugString:"query,resume",metric:t.M.QUERY_RESUME,ackRequest:!1})})},resyncReceipts:function(e){var t=this;return new s["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(d.logColor("green","bin-recv: response,receipt",e)(),"response"===t.N.tag(e)&&"receipt"===t.N.attr("type",e)&&_.isArray(n)){var r,i,l,s=n.length;for(r=0;s>r;r++){i=n[r],l=t.N.children(i);var u=t.N.attr("jid",i),c=t.N.attr("t",i);if("receipt"===t.N.tag(i)&&u&&c&&_.isArray(l)){var f,p=[],h=l.length;for(f=0;h>f;f++){var m=l[f];if("item"===t.N.tag(m)){var g=t.N.attr("index",m),v=parseInt(t.N.attr("status",m),10)||0;g&&0!==v&&4>=v&&p.push([g,!0,void 0,v])}}p.length>0&&o.push({id:u,t:parseInt(c,10),acks:p})}}}a(o)})["catch"](o)},r=e.map(function(e){return["last",{jid:e.remote,index:e.id,t:e.t.toString()},void 0]}),i=t.queryNode({type:"receipt"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:o},{debugString:"query,receipt",metric:t.M.QUERY_RECEIPT,ackRequest:!1})})},addParticipant:function(e,t){var a=this;return new s["default"](function(o,n){var r=p.tag(),i=a.wrap(o);i.tag=r;var l=["participant",{jid:t},void 0],s=["group",{id:r,jid:e,type:"add",author:Store.Conn.me},[l]],u=a.actionNode("set",[s]);a.binSend("send",u,n,{onSend:i,onDrop:n},{debugString:"action,group,add_participant",metric:a.M.GROUP,ackRequest:!1})})},changeSubject:function(e,t){var a=this;return new s["default"](function(o,n){var r=p.tag(),i=a.wrap(o);i.tag=r;var l=["group",{id:r,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],s=a.actionNode("set",[l]);a.binSend("send",s,n,{onSend:i,onDrop:n},{debugString:"action,group,subject",metric:a.M.GROUP,ackRequest:!1})})},createGroup:function(e,t){var a=this;return new s["default"](function(o,n){var r=p.tag(),i=a.wrap(o);i.tag=r;var l=t.map(function(e){return["participant",{jid:e},void 0]});d.log("create group tag",r)();var s=["group",{id:r,type:"create",author:Store.Conn.me,subject:e},l],u=a.actionNode("set",[s]);a.binSend("send",u,n,{onSend:i,onDrop:n},{debugString:"action,group,create",metric:a.M.GROUP,ackRequest:!1})})},leaveGroup:function(e){var t=this;return new s["default"](function(a,o){var n=p.tag(),r=t.wrap(a);r.tag=n;var i=["group",{id:n,jid:e,type:"leave",author:Store.Conn.me},void 0],l=t.actionNode("set",[i]);t.binSend("send",l,o,{onSend:r,onDrop:o},{debugString:"action,group,delete",metric:t.M.GROUP,ackRequest:!1})})},removeParticipant:function(e,t){var a=this;return new s["default"](function(o,n){var r=p.tag(),i=a.wrap(o);i.tag=r;var l=["participant",{jid:t},void 0],s=["group",{id:r,jid:e,type:"remove",author:Store.Conn.me},[l]],u=a.actionNode("set",[s]);a.binSend("send",u,n,{onSend:i,onDrop:n},{debugString:"action,group,rem_participant",metric:a.M.GROUP,ackRequest:!1})})},requestMediaReupload:function(e){var t=this;return new s["default"](function(a,o){var n=e.id,r=function(e){t.BinaryProtocol.read(e).then(function(e){var o;if("response"===t.N.tag(e)&&"media"===t.N.attr("type",e)){var n=parseInt(t.N.attr("code",e))||400,r=t.N.attr("url",e);n>=500&&502!==n?(d.error("wap:requestMediaReupload:error "+n)(),o={status:n}):200===n&&r?o={status:200,url:r,mediaKey:t.N.attr("media_key",e)}:200!==n||r?(d.error("wap:requestMediaReupload:error "+n)(),o={status:n}):o={status:400}}else d.error("wap:requestMediaReupload:malformed")(),o={status:400};a(o)})["catch"](o)},i=n,l=t.queryNode({type:"media",index:i.id,jid:i.remote,owner:i.fromMe.toString()},void 0);t.binSend("sendEphemeral",l,o,{onSend:t.binWrap(r,a),onDrop:o},{debugString:"query,media",metric:t.M.QUERY_MEDIA,ackRequest:!1})})},sendConversationSeen:function(e,t,a){var o=this;return new s["default"](function(n,r){var l=n,s=o.actionNode("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,count:a&&t?a.toString():void 0},void 0]]);o.binSend("sendEphemeral",s,r,{onSend:l,onDrop:r},{debugString:"action,chat,read, "+(0,i["default"])(t)+", "+a,metric:o.M.READ,ackRequest:!0})})},sendConversationDelete:function(e){var t=this;return new s["default"](function(a,o){var n=a,r=t.actionNode("set",[["chat",{type:"delete",jid:e},void 0]]);t.binSend("send",r,o,{onSend:n,onDrop:o},{debugString:"action,chat,delete",metric:t.M.CHAT,ackRequest:!0})})},sendConversationArchive:function(e,t){var a=this;return new s["default"](function(o,n){var r=o,i=t?"archive":"unarchive",l=a.actionNode("set",[["chat",{type:i,jid:e},void 0]]);a.binSend("send",l,n,{onSend:r,onDrop:n},{debugString:"action,chat, "+i,metric:a.M.CHAT,ackRequest:!0})})},sendConversationMute:function(e,t){var a=this;return new s["default"](function(o,n){var r=o,i=t?t.toString():void 0,l=a.actionNode("set",[["chat",{type:"mute",mute:i,jid:e},void 0]]);a.binSend("send",l,n,{onSend:r,onDrop:n},{debugString:"action,chat, "+e+", "+(i?"mute, "+i:"unmute"),metric:a.M.CHAT,ackRequest:!0})})},sendMessagePlayed:function(e){var t=this;return new s["default"](function(a,o){var n=a,r=e.remote,i=e.id,l=t.actionNode("set",[["received",{type:"played",index:i,from:r},void 0]]);t.binSend("send",l,o,{onSend:n,onDrop:o},{debugString:"action,played, "+r+"_"+i,metric:t.M.RECEIVED,ackRequest:!0})})},profilePicFindThumbFromPhone:function(e,t){var a=this;return new s["default"](function(o,n){var r=function(r){a.BinaryProtocol.read(r).then(function(r){"response"===a.N.tag(r)&&"preview"===a.N.attr("type",r)||n("Not a response or preview");var i=a.N.children(r),l=i&&i[0];if(l||n("Missing preview node"),"missing"===a.N.attr("type",l))o({id:e,tag:void 0,raw:void 0});else{var s,u=a.N.attr("id",l);if(t&&u===t.tag&&t.raw)s=t.raw;else{var c=a.N.children(l);s=c?h.encode(c):void 0}o({id:e,tag:u,raw:s})}})["catch"](n)},i={type:"preview",jid:e};t&&t.tag&&(i.id=t.tag);var l=a.queryNode(i,[]);a.binSend("sendEphemeral",l,n,{onSend:a.binWrap(r,o),onDrop:n},{debugString:"query,thumb, "+e,ackRequest:!1})})},groupMetadataFindFromPhone:function(e,t){var a=this;return new s["default"](function(t,o){var n=function(n){a.BinaryProtocol.read(n).then(function(o){if("response"!==a.N.tag(o)||"group"!==a.N.attr("type",o))return void t({status:"error",info:"bad format: response incorrect"});var n=a.N.children(o),r=n&&n[0];if(!r)return void t({status:"error",info:"bad format: no group node"});if("missing"===a.N.attr("type"))return void t({status:"missing"});var i=_.map(a.N.children(r),function(e){return{id:a.N.attr("jid",e),isAdmin:"admin"===a.N.attr("type",e)}});t({status:"ok",data:{id:e,owner:a.N.attr("creator",r),creation:parseInt(a.N.attr("create",r),10)||void 0,participants:i}})})["catch"](o)},r=a.queryNode({type:"group",jid:e},[]);a.binSend("sendEphemeral",r,o,{onSend:a.binWrap(n,t),onDrop:o},{debugString:"query,group, "+e,ackRequest:!1})})},queryReceivedActions:function(){return s["default"].resolve([])},sendPresenceUpdate:function(e){var t=this;return["available","unavailable"].indexOf(e)>-1?new s["default"](function(a,o){var n=a,r=t.actionNode("set",[["presence",{type:e},void 0]]),i="available"===e?"sendEphemeral":"sendEphemeralIgnore";t.binSend(i,r,o,{onSend:n,onDrop:o},{debugString:"action,presence, "+e,metric:t.M.PRESENCE,available:"available"===e,ackRequest:"available"===e})}):void 0},sendChatstateUpdate:function(e,t){var a=this;return["composing","paused","recording"].indexOf(e)>-1?new s["default"](function(o,n){var r=o,i=a.actionNode("set",[["presence",{type:e,to:t},void 0]]);a.binSend("sendEphemeralIgnore",i,n,{onSend:r,onDrop:n},{debugString:"action,chatstate, "+e,metric:a.M.PRESENCE,skipOffline:!0,ackRequest:!1})}):void 0},sendSetPicture:function(e,t,a){var o=this;return new s["default"](function(n,r){var i=v.parseDataURL(t).data,l=v.parseDataURL(a).data,s=h.decode(i),u=h.decode(l),c=p.tag(),d=o.wrap(n);d.tag=c;var f=["picture",{id:c,jid:e,type:"set"},[["image",void 0,u],["preview",void 0,s]]],m=o.actionNode("set",[f]);o.binSend("send",m,r,{onSend:d,onDrop:r},{debugString:"action,set_pic, "+e,metric:o.M.PIC,ackRequest:!1})})},deletePicture:function(e){var t=this;return new s["default"](function(a,o){var n=p.tag(),r=t.wrap(a);r.tag=n;var i=["picture",{id:n,jid:e,type:"delete"},void 0],l=t.actionNode("set",[i]);t.binSend("send",l,o,{onSend:r,onDrop:o},{debugString:"action,delete_pic, "+e,metric:t.M.PIC,ackRequest:!1})})},sendSetStatus:function(e){var t=this;return new s["default"](function(a,o){var n=p.tag(),r=t.wrap(a);r.tag=n;var i=t.actionNode("set",[["status",void 0,e]]);t.binSend("send",i,o,{onSend:r,onDrop:o},{debugString:"action,status,set",metric:t.M.STATUS,ackRequest:!1})})},chatFindQuery:function(e){var t=this;return new s["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"chat"===t.N.attr("type",e))if("true"===t.N.attr("duplicate",e))o="preempted";else if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a(o)})["catch"](o)},r=t.queryNode({type:"chat",kind:e?"retry":void 0},void 0);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:o},{debugString:"query,chat, "+e,metric:t.M.QUERY_CHAT,ackRequest:!1})})},contactFindQuery:function(e){var t=this;return new s["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"contacts"===t.N.attr("type",e))if("true"===t.N.attr("duplicate",e))o="preempted";else if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseContact(n[r]);l&&o.push(l)}}a({checksum:t.N.attr("checksum",e),data:o})})["catch"](o)},r=t.queryNode({type:"contacts",kind:e?"retry":void 0},void 0);t.binSend("send",r,o,{onSend:t.binWrap(n,a),onDrop:o},{debugString:"query,contacts, "+e,metric:t.M.QUERY_CONTACTS,ackRequest:!1})})},msgCreateRecord:function(e,t){var a=this;return new s["default"](function(o,n){var r,i,l=e.id.id;if("chat"===e.type)i=s["default"].resolve(["message",{type:"text",to:e.to,id:e.id.id,t:e.t.toString()},[["body",void 0,e.body]]]);else if("location"===e.type)r=e.body?h.decode(e.body):void 0,i=s["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.clientUrl?e.loc:void 0,url:e.loc&&e.clientUrl?e.clientUrl:void 0,encoding:e.body?"raw":void 0},r]]]);else if("vcard"===e.type){var u=["vcard",{name:e.subtype},e.body];i=s["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"vcard"},[u]]]])}else{var c=e.mediaKey;r=e.body?h.decode(e.body):void 0,i=(t&&!c?a.sendMedia(e.avparams):s["default"].resolve(_.merge({status:200},e.avparams))).then(function(t){if(200===t.status)return s["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||t.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type||!e.caption?void 0:e.caption,page_count:"number"!=typeof e.pageCount||isNaN(e.pageCount)?void 0:e.pageCount.toString(),media_key:c,filename:t.filename},r]]]);var a="wap:msgCreateRecord:sendMedia error "+t.status;return d.error(a)(),s["default"].reject(a)})["catch"](function(){return d.error("wap:msgCreateRecord:sendMedia dropped")(),s["default"].reject("wap:msgCreateRecord:sendMedia dropped")})}i.then(function(t){var r=a.actionNode("relay",[t]),i=a.wrap(o);i.tag=l,i.meta={type:"message",key:e.id},a.binSend("send",r,n,{onSend:i,onDrop:n},{debugString:"action,message, "+e.type,metric:a.M.MESSAGE,ackRequest:!1})})["catch"](function(){d.error("wap:msgCreateRecord mPromise error")(),n("wap:msgCreateRecord mPromise error")})})},msgFindQuery:function(e,t){var a=this;return"before"!==e?s["default"].reject("wap:msgFindQuery:unsupported:"+e):new s["default"](function(e,o){var n=function(t){a.BinaryProtocol.read(t).then(function(t){var o=[],n=a.N.children(t);if("response"===a.N.tag(t)&&"message"===a.N.attr("type",t)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=a.parseMsg(n[r],"response");l&&o.push(l)}}e(o)})["catch"](o)},r=a.queryNode({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString()},void 0);a.binSend("sendEphemeral",r,o,{onSend:a.binWrap(n,e),onDrop:o},{debugString:"query,message, "+t.remote+"_"+t.id+"_"+t.fromMe+"_"+t.count,metric:a.M.QUERY_MESSAGES,ackRequest:!1})})},presenceSubscribe:function(e){var t=this;return new s["default"](function(a,o){var n=a,r=t.actionNode("set",[["presence",{type:"subscribe",to:e},void 0]]);t.binSend("sendEphemeral",r,o,{onSend:n,onDrop:o},{debugString:"action,presence,subscribe, "+e,metric:t.M.PRESENCE_SUBSCRIBE,ackRequest:!0})})},sendMedia:function(e){var t=this;return new s["default"](function(a,o){var n=_.clone(e),r=function(e){a(_.merge(n,e))};p.send({data:["query","sendMedia",n.url],onSend:t.wrap02(r),onDrop:o})})},clearBPQueue:function(){this.BinaryProtocol.dropAllBecauseLogout()},binSend:function(e,t,a,o,n){return this.BinaryProtocol.write(t).then(function(a){n.debugObj||(n.debugObj=t),o.data=a,o.binaryOpts=n,p[e](o)})["catch"](a)},pruneUndefinedProps:function(e){
for(var t in e){var a=e[t];"undefined"==typeof a&&delete e[t]}}};e.exports=E},6980:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(56),r=o(n),i=a(0),l=o(i),s=a(1),u=a(14),c=a(33),d=a(25),f=a(271),p=a(32),h=a(73),m=a(7154),g=a(108),v=a(54),b=a(6979),y={BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20},epochCount:0,epoch:0,isRequestingDeviceUploadLogsMutex:0,epochSend:function(e){return 0===this.epochCount&&this.epoch++,e||this.epochCount++,s.log("wap:epochCount: "+this.epochCount+" epoch: "+this.epoch)(),this.epoch.toString()},epochRecv:function(){this.epochCount>0?this.epochCount--:s.error("wap:epochRecv: NEGATIVE")(),s.log("wap:epochCount: "+this.epochCount+" epoch: "+this.epoch)()},wrap:function(e){var t=this;return function(a){return a&&"number"==typeof a.status&&a.status>=500?a:(t.epochRecv(),void e(a))}},binWrap:function(e,t){var a=this;return function(o){if("object"==typeof o&&"number"==typeof o.status){if(401===o.status)throw a.epochRecv(),new u.E401;if(o.status>=500)return o;a.epochRecv(),t(o)}else a.epochRecv(),e(o)}},actionNode:function(e,t,a){return["action",{type:e,epoch:this.epochSend(a)},t]},queryNode:function(e,t){return e.epoch=this.epochSend(),["query",e,t]},parseMsgMessage:function(e,t){if("message"===this.N.tag(e)){var a;this.N.attr("from",e)!==Store.Conn.me||this.N.attr("to",e)?this.N.attr("to",e)!==Store.Conn.me||this.N.attr("from",e)||(a="out"):a="in";var o,n=this.N.attr("id",e),r=parseInt(this.N.attr("t",e),10)||0,i=this.N.attr("to",e)||Store.Conn.me,l=this.N.attr("from",e)||Store.Conn.me,u="broadcast"===l.split("@")[1],c=this.N.attr("participant",e),d=u?c:l,f=u?void 0:c,p=u?!1:this.N.child("broadcast",e)&&l===Store.Conn.me,h="invis"===this.N.attr("web",e),m=this.N.attr("notify",e)||"",v=parseInt(this.N.attr("status",e))||0,b=[],y=this.N.child("broadcast",e);if("broadcast"!==i){try{var E=new g({from:d,to:i,id:n,participant:c,selfDir:a})}catch(S){return void s.error("drop: cannot create MsgKey: "+S.stack)()}switch(t){case"fresh":o=1;break;default:o=v>=-1&&4>=v?v:1}if(_.isArray(y)){var C,M=y.length;for(C=0;M>C;C++){var k=y[C],w=this.N.attr("jid",k);"to"===this.N.tag(k)&&w&&b.push(w)}}var N,T=[],P=this.N.attr("type",e);switch(P){case"ciphertext":case"text":var I=this.N.dataStr(this.N.child("body",e))||"";N={id:E,body:"text"===P?I:void 0,type:"text"===P?"chat":"ciphertext",t:r,notifyName:m,from:d,to:i,self:a,author:f,invis:h,ack:o,broadcast:p,recipients:b},T=[!n,!r,!d,!i];break;case"media":var R,A,x,O,D,L=this.N.child("media",e),U=this.N.attr("type",L),F=this.N.attr("media_key",L),j=this.N.attr("mimetype",L);if("retry"===this.N.attr("reason",L))return;switch(U){case"image":case"video":var B=this.N.attr("caption",L);R=this.thumbFromMediaXml(L),A=this.N.attr("url",L),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",L),O=parseInt(this.N.attr("size",L),10)||0,D=this.N.attr("seconds",L),N={id:E,body:R,type:U,t:r,notifyName:m,from:d,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,duration:D,broadcast:p,recipients:b,filehash:x,size:O,caption:B,mediaKey:F,mimetype:j},T=[!n,!r,!d,!i];break;case"location":var G=this.N.attr("latitude",L),V=this.N.attr("longitude",L),Y=this.N.attr("name",L);R=this.thumbFromMediaXml(L),A=this.N.attr("url",L),N={id:E,body:R,type:U,t:r,notifyName:m,from:d,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,loc:Y,lat:G,lng:V,broadcast:p,recipients:b},T=[!n,!r,!d,!i,!G||!V];break;case"audio":var W="live"===this.N.attr("origin",L)?"ptt":U;A=this.N.attr("url",L),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",L),O=parseInt(this.N.attr("size",L),10)||0,D=this.N.attr("seconds",L),N={id:E,type:W,t:r,notifyName:m,from:d,to:i,self:a,author:f,invis:h,ack:o,clientUrl:A,duration:D,broadcast:p,recipients:b,filehash:x,size:O,mediaKey:F,mimetype:j},T=[!n,!r,!d,!i];break;case"vcard":var H=this.N.child("vcard",L),q=this.N.dataStr(H),z=this.N.attr("name",H);N={id:E,body:q,type:U,subtype:z,t:r,notifyName:m,from:d,to:i,self:a,author:f,invis:h,ack:o,broadcast:p,recipients:b},T=[!n,!r,!d,!i,!q,!z];break;default:s.error("wap:parseMsgMessage unknown media type: "+this.N.toString(e),e)()}break;default:s.error("wap:parseMsgMessage unknown message type: "+this.N.toString(e),e)()}return this.dropIfConditionMet(T,N)}}},parseMsgGp2:function(e){if("groups_v2"===this.N.tag(e)){var t,a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("id",e),n=this.N.attr("jid",e),r="invis"===this.N.attr("web",e),i=this.N.attr("type",e),l=this.N.attr("author",e),u=this.N.children(e),c=[];switch(i){case"create":t=this.N.attr("subject",e);break;case"subject":t=this.N.attr("subject",e);break;case"picture":t=this.N.attr("picture",e)}if(_.isArray(u)){var d,f=u.length;for(d=0;f>d;d++){var p=u[d],h=this.N.attr("jid",p);"participant"===this.N.tag(p)&&h&&c.push(h)}}try{var m=new g({from:n,to:n,id:o})}catch(v){return void s.error("drop: cannot create MsgKey: "+v.stack)()}var b={t:a,id:m,to:n,from:n,author:l,body:t?t.toString():void 0,type:"gp2",subtype:i,invis:r,recipients:c},y=[!o,!a,"subject"!==i&&"add"!==i&&"invite"!==i&&"remove"!==i&&"leave"!==i&&"picture"!==i&&"modify"!==i&&"create"!==i&&"delete"!==i&&"promote"!==i&&"demote"!==i,"subject"===i&&!t,("add"===i||"invite"===i||"remove"===i||"leave"===i||"promote"===i||"demote"===i||"modify"===i)&&0===c.length,!n,"string"==typeof n&&"g.us"!==n.split("@")[1]];return this.dropIfConditionMet(y,b)}},setGroupParticipant:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=c.tag(),l=o.wrap(n),s=["participant",{jid:a},void 0],u=["group",{id:i,jid:t,type:e,author:Store.Conn.me},[s]],d=o.actionNode("set",[u]);o.binSend("send",d,r,{tag:i,clientCacheable:!0,onSend:l,onDrop:o.wrap(r)},{debugString:"action,group,participant,"+[e,t,a].join(","),metric:o.M.GROUP,ackRequest:!1,expires:v().unix()})})},"delete":function(){this.epochCount=0,this.epoch=0},error2412:function(){this.epochRecv()},setSubProtocol:function(e){4===e?(this.BinaryProtocol=new m("04"),this.N=this.BinaryProtocol.Node):(s.error("Wap:setSubProtocol unknown "+e)(),this.BinaryProtocol=new m("04"),this.N=this.BinaryProtocol.Node)},requestDeviceUploadLogs:function(){var e,t=this;return new l["default"](function(a,o){if(t.isRequestingDeviceUploadLogsMutex)return void a();e=++t.isRequestingDeviceUploadLogsMutex;var n=t.actionNode("debug",[["log",void 0,void 0]]),r=t.wrap(a);r.drop=!0,t.binSend("send",n,o,{onSend:r,onDrop:o},{debugString:"debug,log",metric:t.M.DEBUG_LOG,ackRequest:!0})})["finally"](function(){e===t.isRequestingDeviceUploadLogsMutex&&(t.isRequestingDeviceUploadLogsMutex=0)})},resyncMessages:function(e){var t=this;return new f(function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,resume",e)(),"response"===t.N.tag(e)&&"resume"===t.N.attr("type",e)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a({checksum:t.N.attr("checksum",e),data:o})})["catch"](o)},r=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),p.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),i=t.queryNode({type:"resume"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,resume",metric:t.M.QUERY_RESUME,ackRequest:!1})})},resyncReceipts:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,receipt",e)(),"response"===t.N.tag(e)&&"receipt"===t.N.attr("type",e)&&_.isArray(n)){var r,i,l,u=n.length;for(r=0;u>r;r++){i=n[r],l=t.N.children(i);var c=t.N.attr("jid",i),d=t.N.attr("t",i);if("receipt"===t.N.tag(i)&&c&&d&&_.isArray(l)){var f,p=[],h=l.length;for(f=0;h>f;f++){var m=l[f];if("item"===t.N.tag(m)){var g=t.N.attr("index",m),v=parseInt(t.N.attr("status",m),10)||0;g&&0!==v&&4>=v&&p.push([g,!0,void 0,v])}}p.length>0&&o.push({id:c,t:parseInt(d,10),acks:p})}}}a(o)})["catch"](o)},r=e.map(function(e){return["last",{jid:e.remote,index:e.id,t:e.t.toString()},void 0]}),i=t.queryNode({type:"receipt"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,receipt",metric:t.M.QUERY_RECEIPT,ackRequest:!1})})},queryReceivedActions:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,actions",e)(),"response"===t.N.tag(e)&&"action"===t.N.attr("type",e))if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=n[r],u=t.N.attr("id",l),c=parseInt(t.N.attr("code",l),10)||0;"item"===t.N.tag(l)&&u&&0!==c&&o.push({id:u,code:c})}}else"true"===t.N.attr("replaced",e)&&(o="replaced");a(o)})["catch"](o)},r=e.map(function(e){return["item",{id:e},void 0]}),i=t.queryNode({type:"action"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,actions",metric:t.M.QUERY_ACTIONS,ackRequest:!1})})},changeSubject:function(e,t){var a=this;return new l["default"](function(o,n){var r=c.tag(),i=a.wrap(o);i.tag=r;var l=["group",{id:r,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],s=a.actionNode("set",[l]);a.binSend("send",s,n,{clientCacheable:!0,onSend:i,onDrop:a.wrap(n)},{debugString:"action,group,subject",metric:a.M.GROUP,ackRequest:!1,expires:v().unix()})})},createGroup:function(e,t){var a=this;return new l["default"](function(o,n){var r=c.tag(),i=a.wrap(o);i.tag=r;var l=t.map(function(e){return["participant",{jid:e},void 0]});s.log("create group tag",r)();var u=["group",{id:r,type:"create",author:Store.Conn.me,subject:e},l],d=a.actionNode("set",[u]);a.binSend("send",d,n,{clientCacheable:!0,onSend:i,onDrop:a.wrap(n)},{debugString:"action,group,create",metric:a.M.GROUP,ackRequest:!1,expires:v().unix()})})},leaveGroup:function(e){var t=this;return new l["default"](function(a,o){var n=c.tag(),r=t.wrap(a);r.tag=n;var i=["group",{id:n,jid:e,type:"leave",author:Store.Conn.me},void 0],l=t.actionNode("set",[i]);t.binSend("send",l,o,{clientCacheable:!0,onSend:r,onDrop:t.wrap(o)},{debugString:"action,group,delete",metric:t.M.GROUP,ackRequest:!1,expires:v().unix()})})},addParticipant:function(e,t){return this.setGroupParticipant("add",e,t)},removeParticipant:function(e,t){return this.setGroupParticipant("remove",e,t)},promoteParticipant:function(e,t){return this.setGroupParticipant("promote",e,t)},requestMediaReupload:function(e){var t=this;return new l["default"](function(a,o){var n=e.id,r=function(e){t.BinaryProtocol.read(e).then(function(e){var o;if("response"===t.N.tag(e)&&"media"===t.N.attr("type",e)){var n=parseInt(t.N.attr("code",e))||400,r=t.N.attr("url",e);n>=500&&502!==n?(s.error("wap:requestMediaReupload:error "+n)(),o={status:n}):200===n&&r?o={status:200,url:r,mediaKey:t.N.attr("media_key",e)}:200!==n||r?(s.error("wap:requestMediaReupload:error "+n)(),o={status:n}):o={status:400}}else s.error("wap:requestMediaReupload:malformed")(),o={status:400};a(o)})["catch"](o)},i=n,l=t.queryNode({type:"media",index:i.id,jid:i.remote,owner:i.fromMe.toString()},void 0);t.binSend("sendEphemeral",l,o,{onSend:t.binWrap(r,a),onDrop:t.wrap(o)},{debugString:"query,media",metric:t.M.QUERY_MEDIA,ackRequest:!1})})},sendConversationSeen:function(e,t,a){var o=this;return new l["default"](function(n,i){var l=o.actionNode("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,count:a&&t?a.toString():void 0},void 0]]);o.binSend("send",l,i,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(i)},{debugString:"action,chat,read,"+(0,r["default"])(t)+","+a,metric:o.M.READ,ackRequest:!0})})},sendConversationDelete:function(e,t){var a=this;return new l["default"](function(o,n){var r=a.actionNode("set",[["chat",{type:"delete",jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0},void 0]]);a.binSend("send",r,n,{clientCacheable:!0,onSend:a.wrap(o),onDrop:a.wrap(n)},{debugString:"action,chat,delete",metric:a.M.CHAT,ackRequest:!0})})},sendConversationArchive:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=t?"archive":"unarchive",l=o.actionNode("set",[["chat",{type:i,jid:e,index:a?a.id:void 0,owner:a?a.fromMe.toString():void 0},void 0]]);o.binSend("send",l,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:"action,chat,"+i,metric:o.M.CHAT,ackRequest:!0})})},sendConversationMute:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=t?t.toString():void 0,l=a?a.toString():void 0,s=o.actionNode("set",[["chat",{type:"mute",mute:i,previous:l,jid:e},void 0]]);o.binSend("send",s,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:"action,chat,"+e+", "+(i?"mute,"+i:"unmute"),metric:o.M.CHAT,ackRequest:!0})})},sendMessagePlayed:function(e){var t=this;return new l["default"](function(a,o){var n=t.wrap(a),r=e.remote,i=e.id,l=t.actionNode("set",[["received",{type:"played",index:i,from:r},void 0]]);t.binSend("send",l,o,{onSend:n,onDrop:t.wrap(o)},{debugString:"action,played,"+r+"_"+i,metric:t.M.RECEIVED,ackRequest:!0})})},profilePicFindThumbFromPhone:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=function(a){o.BinaryProtocol.read(a).then(function(a){"response"===o.N.tag(a)&&"preview"===o.N.attr("type",a)||r("Not response or preview");var i=o.N.children(a),l=i&&i[0];if(l||r("Missing preview node"),"missing"===o.N.attr("type",l))n({id:e,tag:void 0,raw:void 0});else{var s,u=o.N.attr("id",l);if(t&&u===t.tag&&t.raw)s=t.raw;else{var c=o.N.children(l);s=c?d.encode(c):void 0}n({id:e,tag:u,raw:s})}})["catch"](r)},l={type:"preview",jid:e};t&&t.tag&&t.raw&&(l.id=t.tag),a&&(l.kind="status");var s=o.queryNode(l,[]);o.binSend("sendEphemeral",s,r,{onSend:o.binWrap(i,n),onDrop:o.wrap(r)},{debugString:"query,thumb,"+e,metric:o.M.QUERY_PREVIEW,ackRequest:!1})})},groupMetadataFindFromPhone:function(e){var t=this;return new l["default"](function(a,o){var n=function(n){t.BinaryProtocol.read(n).then(function(o){if("response"!==t.N.tag(o)||"group"!==t.N.attr("type",o))return void a({status:"error",info:"bad format: response incorrect"});var n=t.N.children(o),r=n&&n[0];if(!r)return void a({status:"error",info:"bad format: no group node"});if("missing"===t.N.attr("type"))return void a({status:"missing"});var i,l=[],s=t.N.children(r);_.isArray(s)&&s.forEach(function(e){switch(t.N.tag(e)){case"participant":l.push({id:t.N.attr("jid",e),isAdmin:"admin"===t.N.attr("type",e)});break;case"description":i=t.N.dataStr(e)}}),a({status:"ok",data:{id:e,owner:t.N.attr("creator",r),creation:parseInt(t.N.attr("create",r),10)||void 0,participants:l,desc:i}})})["catch"](o)},r=t.queryNode({type:"group",jid:e},[]);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,group,"+e,metric:t.M.QUERY_GROUP,ackRequest:!1})})},sendPresenceUpdate:function(e){var t=this;return["available","unavailable"].indexOf(e)>-1?new l["default"](function(a,o){var n="available"===e,r=t.actionNode("set",[["presence",{type:e},void 0]],!n),i=n?"sendEphemeral":"sendEphemeralIgnore";t.binSend(i,r,o,{onSend:n?t.wrap(a):a,onDrop:n?t.wrap(o):a,epochIneligible:!n},{debugString:"action,presence,"+e,metric:t.M.PRESENCE,available:"available"===e,ackRequest:n})}):void 0},sendChatstateUpdate:function(e,t){var a=this;return["composing","paused","recording"].indexOf(e)>-1?new l["default"](function(o,n){var r=o,i=a.actionNode("set",[["presence",{type:e,to:t},void 0]],!0);a.binSend("sendEphemeralIgnore",i,n,{onSend:r,onDrop:n,epochIneligible:!0},{debugString:"action,chatstate,"+e,metric:a.M.PRESENCE,skipOffline:!0,ackRequest:!1})}):void 0},sendSetPicture:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=h.parseDataURL(t).data,l=h.parseDataURL(a).data,s=d.decode(i),u=d.decode(l),f=c.tag(),p=o.wrap(n);p.tag=f;var m=["picture",{id:f,jid:e,type:"set"},[["image",void 0,u],["preview",void 0,s]]],g=o.actionNode("set",[m]);o.binSend("send",g,r,{clientCacheable:!0,onSend:p,onDrop:o.wrap(r)},{debugString:"action,set_pic,"+e,metric:o.M.PIC,ackRequest:!1,expires:v().unix()})})},deletePicture:function(e){var t=this;return new l["default"](function(a,o){var n=c.tag(),r=t.wrap(a);r.tag=n;var i=["picture",{id:n,jid:e,type:"delete"},void 0],l=t.actionNode("set",[i]);t.binSend("send",l,o,{clientCacheable:!0,onSend:r,onDrop:t.wrap(o)},{debugString:"action,delete_pic,"+e,metric:t.M.PIC,ackRequest:!1,expires:v().unix()})})},sendSetStatus:function(e){var t=this;return new l["default"](function(a,o){var n=t.wrap(a),r=t.actionNode("set",[["status",void 0,e]]);t.binSend("send",r,o,{clientCacheable:!0,onSend:n,onDrop:t.wrap(o)},{debugString:"action,status,set",metric:t.M.STATUS,ackRequest:!1,expires:v().unix()})})},sendSetBlock:function(e,t){var a=this;return new l["default"](function(o,n){var r=t.map(function(t){return["user",{jid:t.jid,reason:e&&t.spam?"spam":void 0},void 0]}),i=["block",{type:e?"add":"remove"},r],l=a.actionNode("set",[i]);a.binSend("send",l,n,{clientCacheable:!0,onSend:a.wrap(o),onDrop:a.wrap(n)},{debugString:"action,block,"+e+","+_.map(t,"jid").join(","),metric:a.M.BLOCK,ackRequest:!1,expires:v().unix()})})},chatFindQuery:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"chat"===t.N.attr("type",e))if("true"===t.N.attr("duplicate",e))o="preempted";else if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a(o)})["catch"](o)},r=t.queryNode({type:"chat",kind:e?"retry":void 0},void 0);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,chat,"+e,metric:t.M.QUERY_CHAT,ackRequest:!1})})},contactFindQuery:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"contacts"===t.N.attr("type",e))if("true"===t.N.attr("duplicate",e))o="preempted";else if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseContact(n[r]);l&&o.push(l)}}a({checksum:t.N.attr("checksum",e),data:o})})["catch"](o)},r=t.queryNode({type:"contacts",kind:e?"retry":void 0},void 0);t.binSend("send",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,contacts, "+e,metric:t.M.QUERY_CONTACTS,ackRequest:!1})})},msgCreateRecord:function(e,t){var a=this;return new l["default"](function(o,n){var r,i,u=e.id.id;if("chat"===e.type)i=l["default"].resolve(["message",{type:"text",to:e.to,id:e.id.id,t:e.t.toString()},[["body",void 0,e.body]]]);else if("location"===e.type)r=e.body?d.decode(e.body):void 0,i=l["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.clientUrl?e.loc:void 0,url:e.loc&&e.clientUrl?e.clientUrl:void 0,encoding:e.body?"raw":void 0},r]]]);else if("vcard"===e.type){var c=["vcard",{name:e.subtype},e.body];i=l["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"vcard"},[c]]]])}else{var f=e.mediaKey;r=e.body?d.decode(e.body):void 0,i=(t&&!f?a.sendMedia(e.avparams):l["default"].resolve(_.merge({status:200},e.avparams))).then(function(t){if(200===t.status)return l["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:"ptt"===t.type?"audio":t.type,mimetype:e.mimetype||t.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type||!e.caption?void 0:e.caption,page_count:"number"!=typeof e.pageCount||isNaN(e.pageCount)?void 0:e.pageCount.toString(),media_key:f,filename:t.filename},r]]]);var a="wap:msgCreateRecord:sendMedia error "+t.status;return s.error(a)(),l["default"].reject(a)})["catch"](function(){return s.error("wap:msgCreateRecord:sendMedia dropped")(),l["default"].reject("wap:msgCreateRecord:sendMedia dropped")})}i.then(function(t){var r=a.actionNode("relay",[t]),i=a.wrap(o);i.tag=u,i.meta={type:"message",key:e.id},a.binSend("send",r,n,{onSend:i,onDrop:a.wrap(n)},{debugString:"action,message, "+e.type,metric:a.M.MESSAGE,ackRequest:!1})})["catch"](function(){s.error("wap:msgCreateRecord mPromise error")(),n("wap:msgCreateRecord mPromise error")})})},msgFindQuery:function(e,t){var a=this;return"before"!==e?l["default"].reject("wap:msgFindQuery:unsupported:"+e):new l["default"](function(e,o){var n=function(t){a.BinaryProtocol.read(t).then(function(t){var o=[],n=a.N.children(t);if("response"===a.N.tag(t)&&"message"===a.N.attr("type",t)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=a.parseMsg(n[r],"response");l&&o.push(l)}}e(o)})["catch"](o)},r=a.queryNode({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString()},void 0);a.binSend("sendEphemeral",r,o,{onSend:a.binWrap(n,e),onDrop:a.wrap(o)},{debugString:"query,message,"+t.remote+"_"+t.id+"_"+t.fromMe+"_"+t.count,metric:a.M.QUERY_MESSAGES,ackRequest:!1})})},presenceSubscribe:function(e){var t=this;return new l["default"](function(a,o){var n=t.wrap(a),r=t.actionNode("set",[["presence",{type:"subscribe",to:e},void 0]]);t.binSend("sendEphemeral",r,o,{onSend:n,onDrop:t.wrap(o)},{debugString:"action,presence,subscribe,"+e,metric:t.M.PRESENCE_SUBSCRIBE,ackRequest:!0})})},binSend:function(e,t,a,o,n){var r=this,i=o.epochIneligible?a:function(e){r.epochRecv(),a(e)};return delete o.epochIneligible,this.BinaryProtocol.write(t).then(function(a){n.debugObj||(n.debugObj=t),o.data=a,o.binaryOpts=n,c[e](o)})["catch"](i)}};e.exports=_.defaults(y,b)},6981:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(56),r=o(n),i=a(0),l=o(i),s=a(1),u=a(271),c=a(32),d=a(7154),f=a(108),p=a(6980),h={BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22},epochCount:0,epoch:0,isRequestingDeviceUploadLogsMutex:0,parseChat:function(e){if("chat"===this.N.tag(e)){var t=this.N.attr("jid",e),a=parseInt(this.N.attr("t",e),10)||void 0,o=this.N.attr("type",e),n=parseInt(this.N.attr("mute",e),10)||void 0,r=parseInt(this.N.attr("before",e),10)||void 0,i="true"===this.N.attr("archive",e),l="true"===this.N.attr("read_only",e),s=parseInt(this.N.attr("modify_tag",e),10)||void 0,u=this.N.attr("name",e)||void 0,c=this.safeParseInt(e,"count"),d="true"===this.N.attr("message",e);"ahead"===o&&(o="clear");var f,p=this.N.children(e);if(_.isArray(p)){f=[];var h,m,g=p.length;for(h=0;g>h;h++)if(m=p[h],"item"===this.N.tag(m)){var v=this.N.attr("index",m);v&&f.push([v,"true"===this.N.attr("owner",m),this.N.attr("participant",m)])}}var b={id:t,t:a,type:o,keys:f,before:r,archive:i,isReadOnly:l,unreadCount:c,muteExpiration:n,modifyTag:s,name:u,pendingMsgs:d};this.pruneUndefinedProps(b);var y=[o&&"delete"!==o&&"clear"!==o&&"archive"!==o&&"unarchive"!==o&&"mute"!==o&&"modify_tag"!==o,!o&&!t,i&&o&&"clear"!==o,"clear"!==o&&r&&r>0,"clear"!==o&&f&&f.length>0];return this.dropIfConditionMet(y,b)}},parseCmd:function(e){if("read"===this.N.tag(e)){var t=this.N.attr("jid",e),a="false"===this.N.attr("type",e),o={type:a?"unread":"read",jid:t},n=[!t];return this.dropIfConditionMet(n,o)}},parseMsgMessage:function(e,t){if("message"===this.N.tag(e)){var a;this.N.attr("from",e)!==Store.Conn.me||this.N.attr("to",e)?this.N.attr("to",e)!==Store.Conn.me||this.N.attr("from",e)||(a="out"):a="in";var o,n=this.N.attr("id",e),r=parseInt(this.N.attr("t",e),10)||0,i=this.N.attr("to",e)||Store.Conn.me,l=this.N.attr("from",e)||Store.Conn.me,u="broadcast"===l.split("@")[1],c=this.N.attr("participant",e),d=u?c:l,p=u?void 0:c,h=u?!1:this.N.child("broadcast",e)&&l===Store.Conn.me,m="invis"===this.N.attr("web",e),g=this.N.attr("notify",e)||"",v=parseInt(this.N.attr("status",e))||0,b=[],y=this.N.child("broadcast",e);if("broadcast"!==i){try{var E=new f({from:d,to:i,id:n,participant:c,selfDir:a})}catch(S){return void s.error("drop: cannot create MsgKey: "+S.stack)()}switch(t){case"fresh":o=1;break;default:o=v>=-1&&4>=v?v:1}if(_.isArray(y)){var C,M=y.length;for(C=0;M>C;C++){var k=y[C],w=this.N.attr("jid",k);"to"===this.N.tag(k)&&w&&b.push(w)}}var N,T=[],P=this.N.attr("type",e);switch(P){case"ciphertext":case"text":var I=this.N.dataStr(this.N.child("body",e))||"";N={id:E,body:"text"===P?I:void 0,type:"text"===P?"chat":"ciphertext",t:r,notifyName:g,from:d,to:i,self:a,author:p,participant:c,invis:m,ack:o,broadcast:h,recipients:b},T=[!n,!r,!d,!i];break;case"media":var R,A,x,O,D,L,U=this.N.child("media",e),F=this.N.attr("type",U),j=this.N.attr("media_key",U),B=this.N.attr("mimetype",U);if("retry"===this.N.attr("reason",U))return;switch(F){case"image":case"video":case"document":var G=parseInt(this.N.attr("page_count",U),10)||0,V=this.N.attr("filename",U);L=this.N.attr("caption",U),R=this.thumbFromMediaXml(U),A=this.N.attr("url",U),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",U),O=parseInt(this.N.attr("size",U),10)||0,D=this.N.attr("seconds",U),N={id:E,body:R,type:F,t:r,notifyName:g,from:d,to:i,self:a,author:p,participant:c,invis:m,ack:o,clientUrl:A,duration:D,broadcast:h,recipients:b,filehash:x,size:O,caption:L,mediaKey:j,pageCount:G,mimetype:B,filename:V},T=[!n,!r,!d,!i];break;case"location":var Y=this.N.attr("latitude",U),W=this.N.attr("longitude",U),H=this.N.attr("name",U);R=this.thumbFromMediaXml(U),A=this.N.attr("url",U),N={id:E,body:R,type:F,t:r,notifyName:g,from:d,to:i,self:a,author:p,participant:c,invis:m,ack:o,clientUrl:A,loc:H,lat:Y,lng:W,broadcast:h,recipients:b},T=[!n,!r,!d,!i,!Y||!W];break;case"audio":var q="live"===this.N.attr("origin",U)?"ptt":F;A=this.N.attr("url",U),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,x=this.N.attr("filehash",U),O=parseInt(this.N.attr("size",U),10)||0,D=this.N.attr("seconds",U),N={id:E,type:q,t:r,notifyName:g,from:d,to:i,self:a,author:p,participant:c,invis:m,ack:o,clientUrl:A,duration:D,broadcast:h,recipients:b,filehash:x,size:O,mediaKey:j,mimetype:B},T=[!n,!r,!d,!i];break;case"vcard":var z=this.N.child("vcard",U),K=this.N.dataStr(z),Q=this.N.attr("name",z);N={id:E,body:K,type:F,subtype:Q,t:r,notifyName:g,from:d,to:i,self:a,author:p,participant:c,invis:m,ack:o,broadcast:h,recipients:b},T=[!n,!r,!d,!i,!K,!Q];break;default:s.error("wap:parseMsgMessage unknown media type: "+this.N.toString(e),e)()}break;default:s.error("wap:parseMsgMessage unknown message type: "+this.N.toString(e),e)()}return this.dropIfConditionMet(T,N)}}},parseMsgGp2:function(e){if("groups_v2"===this.N.tag(e)){var t,a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("id",e),n=this.N.attr("jid",e),r="invis"===this.N.attr("web",e),i="true"===this.N.attr("owner",e),l=this.N.attr("type",e),u=this.N.attr("author",e),c=this.N.children(e),d=this.N.attr("participant",e),p=[];switch(l){case"create":t=this.N.attr("subject",e);break;case"subject":t=this.N.attr("subject",e);break;case"picture":t=this.N.attr("picture",e)}if(_.isArray(c)){var h,m=c.length;for(h=0;m>h;h++){var g=c[h],v=this.N.attr("jid",g);"participant"===this.N.tag(g)&&v&&p.push(v)}}try{var b=new f({fromMe:i,remote:n,id:o,participant:d})}catch(y){return void s.error("drop: cannot create MsgKey: "+y.stack)()}var E={t:a,id:b,from:i?Store.Conn.me:n,to:i?n:Store.Conn.me,author:u,participant:d,body:t?t.toString():void 0,type:"gp2",subtype:l,invis:r,recipients:p},S=[!o,!a,"subject"!==l&&"add"!==l&&"invite"!==l&&"remove"!==l&&"leave"!==l&&"picture"!==l&&"modify"!==l&&"create"!==l&&"delete"!==l&&"promote"!==l&&"demote"!==l&&"revoke_invite"!==l,"subject"===l&&!t,("add"===l||"invite"===l||"remove"===l||"leave"===l||"promote"===l||"demote"===l||"modify"===l)&&0===p.length,!n,"string"==typeof n&&"g.us"!==n.split("@")[1]];return this.dropIfConditionMet(S,E)}},parseMsgBroadcast:function(e){if("broadcast"===this.N.tag(e)){var t,a,o=this.N.attr("type",e),n=this.N.attr("id",e),r=parseInt(this.N.attr("t",e),10)||0,i=this.N.attr("jid",e),l="true"===this.N.attr("owner",e),u=this.N.attr("participant",e);switch(o){case"create":t=parseInt(this.N.attr("count",e),10)||0;break;case"add":case"remove":a=this.N.child("participant",e),a&&(t=this.N.attr("jid",a))}try{var c=new f({fromMe:l,remote:i,id:n,participant:u})}catch(d){return void s.error("drop: cannot create MsgKey: "+d.stack)()}var p={id:c,t:r,participant:u,type:"broadcast_notification",subtype:o,from:l?Store.Conn.me:i,to:l?i:Store.Conn.me,body:t?t.toString():void 0},h=[!n,!r,!i,"string"==typeof i&&"broadcast"!==i.split("@")[1],"create"!==o&&"add"!==o&&"remove"!==o,("add"===o||"remove"===o)&&2!==t.split("@").length];return this.dropIfConditionMet(h,p)}},parseMsgNotification:function(e){if("notification"===this.N.tag(e)){var t=this.N.attr("id",e),a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("jid",e),n=this.N.attr("participant",e),r="invis"===this.N.attr("web",e),i=this.N.dataStr(e),l="true"===this.N.attr("owner",e);try{var u=new f({fromMe:l,remote:o,id:t,participant:n})}catch(c){return void s.error("drop: cannot create MsgKey: "+c.stack)()}var d={id:u,type:"notification",t:a,invis:r,from:l?Store.Conn.me:o,to:l?o:Store.Conn.me,participant:n,body:i},p=[!t,!a,!o,2!==o.split("@").length];return this.dropIfConditionMet(p,d)}},sendConversationOpWithKey:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=o.actionNode("set",[["chat",{type:e,jid:t,index:a?a.id:void 0,owner:a?a.fromMe.toString():void 0,participant:a?a.participant:void 0},void 0]]);o.binSend("send",i,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:"action,chat,"+[e,t,(a||"no_msg_key").toString()].join(),metric:o.M.CHAT,ackRequest:!0})})},setSubProtocol:function(e){5===e?(this.BinaryProtocol=new d("05"),this.N=this.BinaryProtocol.Node):6===e?(this.BinaryProtocol=new d("06"),this.N=this.BinaryProtocol.Node):(s.error("Wap:setSubProtocol unknown "+e)(),this.BinaryProtocol=new d("05"),this.N=this.BinaryProtocol.Node)},resyncMessages:function(e){var t=this;return new u(function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,resume",e)(),"response"===t.N.tag(e)&&"resume"===t.N.attr("type",e)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a({checksum:t.N.attr("checksum",e),data:o})})["catch"](o)},r=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,participant:e.participant,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),c.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),i=t.queryNode({type:"resume"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,resume",metric:t.M.QUERY_RESUME,
ackRequest:!1})})},resyncReceipts:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,receipt",e)(),"response"===t.N.tag(e)&&"receipt"===t.N.attr("type",e)&&_.isArray(n)){var r,i,l,u=n.length;for(r=0;u>r;r++){i=n[r],l=t.N.children(i);var c=t.N.attr("jid",i),d=t.N.attr("t",i);if("receipt"===t.N.tag(i)&&c&&d&&_.isArray(l)){var f,p=[],h=l.length;for(f=0;h>f;f++){var m=l[f];if("item"===t.N.tag(m)){var g=t.N.attr("index",m),v="true"===t.N.attr("owner",m),b=parseInt(t.N.attr("status",m),10)||0,y=t.N.attr("participant",m);g&&0!==b&&4>=b&&p.push([g,v,y,b])}}p.length>0&&o.push({id:c,t:parseInt(d,10),acks:p})}}}a(o)})["catch"](o)},r=e.map(function(e){return["last",{jid:e.remote,index:e.id,owner:e.fromMe.toString(),participant:e.participant,t:e.t.toString()},void 0]}),i=t.queryNode({type:"receipt"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,receipt",metric:t.M.QUERY_RECEIPT,ackRequest:!1})})},recentEmojiQuery:function(e){var t=this;return new l["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(s.logColor("green","bin-recv: response,emoji",e)(),"response"===t.N.tag(e)&&"emoji"===t.N.attr("type",e)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=n[r],u=t.N.attr("code",l),c=parseFloat(t.N.attr("value",l))||0;"item"===t.N.tag(l)&&u&&c&&!isNaN(c)&&o.push({"char":u,weight:c})}}a(o)})["catch"](o)},r=_.isArray(e)?e.map(function(e){return["item",{code:e["char"],value:e.weight.toString()},void 0]}):void 0,i=t.queryNode({type:"emoji"},r);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,emoji",metric:t.M.QUERY_EMOJI,ackRequest:!1})})},queryMsgInfo:function(e){var t=this,a=function(e){var a,o,n=[];if(_.isArray(e)){a=e.length;for(var r=0;a>r;r++)o=e[r],"item"===t.N.tag(o)&&t.N.attr("jid",o)&&t.N.attr("t",o)&&n.push({id:t.N.attr("jid",o),t:parseInt(t.N.attr("t",o),10)||0})}return n};return new l["default"](function(o,n){var r=function(e){t.BinaryProtocol.read(e).then(function(e){var n={played:[],playedRemaining:0,read:[],readRemaining:0,delivery:[],deliveryRemaining:0};if(s.logColor("green","bin-recv: response,msg,info",e)(),"response"===t.N.tag(e)&&"message_info"===t.N.attr("type",e)){var r=t.N.child("played",e),i=t.N.child("read",e),l=t.N.child("delivery",e),u=t.N.children(r),c=t.N.children(i),d=t.N.children(l),f=parseInt(t.N.attr("count",e),10)||0;n.played=a(u),n.read=a(c),n.delivery=a(d);var p=f-n.played.length,h=f-n.played.length-n.read.length,m=f-n.played.length-n.read.length-n.delivery.length;n.playedRemaining=0>p?0:p,n.readRemaining=0>h?0:h,n.deliveryRemaining=0>m?0:m}o(n)})["catch"](n)},i=t.queryNode({type:"message_info",index:e.id,jid:e.remote},void 0);t.binSend("sendEphemeral",i,n,{onSend:t.binWrap(r,o),onDrop:t.wrap(n)},{debugString:["query,msg,info",e.id,e.remote,e.fromMe].join(),metric:t.M.QUERY_MESSAGE_INFO,ackRequest:!1})})},requestMediaReupload:function(e){var t=this;return new l["default"](function(a,o){var n=e.id,r=function(e){t.BinaryProtocol.read(e).then(function(e){var o;if("response"===t.N.tag(e)&&"media"===t.N.attr("type",e)){var n=parseInt(t.N.attr("code",e))||400,r=t.N.attr("url",e);n>=500&&502!==n?(s.error("wap:requestMediaReupload:error "+n)(),o={status:n}):200===n&&r?o={status:200,url:r,mediaKey:t.N.attr("media_key",e)}:200!==n||r?(s.error("wap:requestMediaReupload:error "+n)(),o={status:n}):o={status:400}}else s.error("wap:requestMediaReupload:malformed")(),o={status:400};a(o)})["catch"](o)},i=n,l=t.queryNode({type:"media",index:i.id,jid:i.remote,owner:i.fromMe.toString(),participant:i.participant},void 0);t.binSend("sendEphemeral",l,o,{onSend:t.binWrap(r,a),onDrop:t.wrap(o)},{debugString:"query,media",metric:t.M.QUERY_MEDIA,ackRequest:!1})})},sendConversationSeen:function(e,t,a){var o=this;return new l["default"](function(n,i){var l=o.actionNode("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,participant:t?t.participant:void 0,count:a&&t?a.toString():void 0},void 0]]);o.binSend("send",l,i,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(i)},{debugString:"action,chat,read,"+(0,r["default"])(t)+","+a,metric:o.M.READ,ackRequest:!0})})},sendConversationUnseen:function(e,t){return this.sendConversationSeen(e,t,-2)},sendConversationClear:function(e,t){return this.sendConversationOpWithKey("clear",e,t)},sendConversationDelete:function(e,t){return this.sendConversationOpWithKey("delete",e,t)},sendConversationArchive:function(e,t,a){return this.sendConversationOpWithKey(t?"archive":"unarchive",e,a)},sendMessagePlayed:function(e){var t=this;return new l["default"](function(a,o){var n=t.wrap(a),r=t.actionNode("set",[["received",{type:"played",index:e.id,from:e.remote,participant:e.participant},void 0]]);t.binSend("send",r,o,{onSend:n,onDrop:t.wrap(o)},{debugString:"action,played,"+e.toString(),metric:t.M.RECEIVED,ackRequest:!0})})},sendMessageDelete:function(e,t,a){var o=this;return new l["default"](function(n,r){var i=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),l=o.actionNode("set",[["chat",{type:"clear",jid:e,media:a.toString()},i]]);o.binSend("send",l,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:"action,msgs,delete,"+[e,a,t.length].join(),metric:o.M.CHAT,ackRequest:!0})})},msgFindQuery:function(e,t){var a=this;return"before"!==e?l["default"].reject("wap:msgFindQuery:unsupported:"+e):new l["default"](function(e,o){var n=function(t){a.BinaryProtocol.read(t).then(function(t){var o=[],n=a.N.children(t);if("response"===a.N.tag(t)&&"message"===a.N.attr("type",t)&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=a.parseMsg(n[r],"response");l&&o.push(l)}}e(o)})["catch"](o)},r=a.queryNode({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},void 0);a.binSend("sendEphemeral",r,o,{onSend:a.binWrap(n,e),onDrop:a.wrap(o)},{debugString:"query,message,"+[t.toString(),t.count].join(),metric:a.M.QUERY_MESSAGES,ackRequest:!1})})}};e.exports=_.defaults(h,p)},6982:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(1),l=a(33),s=a(25),u=a(7154),c=a(108),d=a(54),f=a(6981),p={BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23},epochCount:0,epoch:0,isRequestingDeviceUploadLogsMutex:0,parseChat:function(e){if("chat"===this.N.tag(e)){var t=this.N.attr("jid",e),a=parseInt(this.N.attr("t",e),10)||void 0,o=this.N.attr("type",e),n=parseInt(this.N.attr("mute",e),10)||void 0,r=parseInt(this.N.attr("before",e),10)||void 0,i="true"===this.N.attr("archive",e),l="true"===this.N.attr("read_only",e),s=parseInt(this.N.attr("modify_tag",e),10)||void 0,u=this.N.attr("name",e)||void 0,c=this.safeParseInt(e,"count"),d="true"===this.N.attr("message",e),f="true"===this.N.attr("star",e);"ahead"===o&&(o="clear");var p,h=this.N.children(e);if(_.isArray(h)){p=[];var m,g,v=h.length;for(m=0;v>m;m++)if(g=h[m],"item"===this.N.tag(g)){var b=this.N.attr("index",g);b&&p.push([b,"true"===this.N.attr("owner",g),this.N.attr("participant",g)])}}var y={id:t,t:a,type:o,keys:p,before:r,archive:i,isReadOnly:l,unreadCount:c,muteExpiration:n,modifyTag:s,name:u,pendingMsgs:d,star:f};this.pruneUndefinedProps(y);var E=[o&&"delete"!==o&&"clear"!==o&&"archive"!==o&&"unarchive"!==o&&"mute"!==o&&"star"!==o&&"unstar"!==o&&"modify_tag"!==o,!o&&!t,i&&o&&"clear"!==o,"clear"!==o&&r&&r>0,"clear"!==o&&"star"!==o&&"unstar"!==o&&p&&p.length>0];return this.dropIfConditionMet(E,y)}},parseMsgMessage:function(e,t){if("message"===this.N.tag(e)){var a;this.N.attr("from",e)!==Store.Conn.me||this.N.attr("to",e)?this.N.attr("to",e)!==Store.Conn.me||this.N.attr("from",e)||(a="out"):a="in";var o,n=this.N.attr("id",e),r=parseInt(this.N.attr("t",e),10)||0,l=this.N.attr("to",e)||Store.Conn.me,s=this.N.attr("from",e)||Store.Conn.me,u="broadcast"===s.split("@")[1],d=this.N.attr("participant",e),f=u?d:s,p=u?void 0:d,h=u?!1:this.N.child("broadcast",e)&&s===Store.Conn.me,m="invis"===this.N.attr("web",e),g=this.N.attr("notify",e)||"",v=parseInt(this.N.attr("status",e))||0,b=[],y=this.N.child("broadcast",e),E="true"===this.N.attr("star",e);if("broadcast"!==l){try{var S=new c({from:f,to:l,id:n,participant:d,selfDir:a})}catch(C){return void i.error("drop: cannot create MsgKey: "+C.stack)()}switch(t){case"fresh":o=1;break;default:o=v>=-1&&4>=v?v:1}if(_.isArray(y)){var M,k=y.length;for(M=0;k>M;M++){var w=y[M],N=this.N.attr("jid",w);"to"===this.N.tag(w)&&N&&b.push(N)}}var T,P=[],I=this.N.attr("type",e);switch(I){case"ciphertext":case"unknown":T={id:S,type:I,t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,broadcast:h,recipients:b,star:E},P=[!n,!r,!f,!l];break;case"text":var R=this.N.dataStr(this.N.child("body",e))||"";T={id:S,body:R,type:"chat",t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,broadcast:h,recipients:b,star:E};var A=this.N.child("media",e);A&&"url"===this.N.attr("type",A)&&_.merge(T,{subtype:"url",title:this.N.attr("title",A),description:this.N.attr("description",A),canonicalUrl:this.N.attr("canonical-url",A),matchedText:this.N.attr("matched-text",A),thumbnail:this.thumbFromMediaXml(A)}),P=[!n,!r,!f,!l];break;case"media":var x,O,D,L,U,F,j=this.N.child("media",e),B=this.N.attr("type",j),G=this.N.attr("media_key",j),V=this.N.attr("mimetype",j);if("retry"===this.N.attr("reason",j))return;switch(B){case"image":case"video":case"document":var Y=parseInt(this.N.attr("page_count",j),10)||0,W=this.N.attr("filename",j);F=this.N.attr("caption",j),x=this.thumbFromMediaXml(j),O=this.N.attr("url",j),O=_.isString(O)&&O.indexOf("/u/")>0?void 0:O,D=this.N.attr("filehash",j),L=parseInt(this.N.attr("size",j),10)||0,U=this.N.attr("seconds",j),T={id:S,body:x,type:B,t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,clientUrl:O,duration:U,broadcast:h,recipients:b,filehash:D,size:L,caption:F,mediaKey:G,star:E,pageCount:Y,mimetype:V,filename:W},P=[!n,!r,!f,!l];break;case"location":var H=this.N.attr("latitude",j),q=this.N.attr("longitude",j),z=this.N.attr("name",j);x=this.thumbFromMediaXml(j),O=this.N.attr("url",j),T={id:S,body:x,type:B,t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,clientUrl:O,loc:z,lat:H,lng:q,broadcast:h,recipients:b,star:E},P=[!n,!r,!f,!l,!H||!q];break;case"audio":var K="live"===this.N.attr("origin",j)?"ptt":B;O=this.N.attr("url",j),O=_.isString(O)&&O.indexOf("/u/")>0?void 0:O,D=this.N.attr("filehash",j),L=parseInt(this.N.attr("size",j),10)||0,U=this.N.attr("seconds",j),T={id:S,type:K,t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,clientUrl:O,duration:U,broadcast:h,recipients:b,filehash:D,size:L,star:E,mediaKey:G,mimetype:V},P=[!n,!r,!f,!l];break;case"vcard":var Q=this.N.child("vcard",j),J=this.N.dataStr(Q),X=this.N.attr("name",Q);T={id:S,body:J,type:B,subtype:X,t:r,notifyName:g,from:f,to:l,self:a,author:p,participant:d,invis:m,ack:o,broadcast:h,recipients:b,star:E},P=[!n,!r,!f,!l,!J,!X];break;default:i.error("wap:parseMsgMessage unknown media type: "+this.N.toString(e),e)()}break;default:i.error("wap:parseMsgMessage unknown message type: "+this.N.toString(e),e)()}return this.dropIfConditionMet(P,T)}}},sendConversationOpWithKey:function(e,t,a,o){var n=this;return new r["default"](function(r,i){var l;switch(e){case"clear":l=(!!o).toString()}var s=n.actionNode("set",[["chat",{type:e,jid:t,index:a?a.id:void 0,owner:a?a.fromMe.toString():void 0,participant:a?a.participant:void 0,star:"undefined"!=typeof l?l:void 0},void 0]]);n.binSend("send",s,i,{clientCacheable:!0,onSend:n.wrap(r),onDrop:n.wrap(i)},{debugString:"action,chat,"+[e,a,o].join(),metric:n.M.CHAT,ackRequest:!0})})},setSubProtocol:function(e){e?(this.BinaryProtocol=new u(e),this.N=this.BinaryProtocol.Node):(i.error("Wap:setSubProtocol unknown "+e)(),l.updateImmediately("07_unknown_version"))},sendConversationClear:function(e,t,a){return this.sendConversationOpWithKey("clear",e,t,a)},sendMessageStarred:function(e,t,a){var o=this;return new r["default"](function(n,r){var i=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),l=o.actionNode("set",[["chat",{type:a?"star":"unstar",jid:e},i]]);o.binSend("send",l,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:"action,msgs,star,"+[e,a,t.length].join(),metrics:o.M.CHAT,ackRequest:!0})})},sendUnstarAll:function(){var e=this;return new r["default"](function(t,a){var o=e.actionNode("set",[["chat",{type:"unstar"},void 0]]);e.binSend("send",o,a,{clientCacheable:!0,onSend:e.wrap(t),onDrop:e.wrap(a)},{debugString:"action,unstar,all",metrics:e.M.CHAT,ackRequest:!0,expires:d().unix()})})},sendSetBlock:function(e,t){var a=this;return new r["default"](function(o,n){var r=t.map(function(e){return["user",{jid:e.jid},void 0]}),i=["block",{type:e?"add":"remove"},r],l=a.actionNode("set",[i]);a.binSend("send",l,n,{clientCacheable:!0,onSend:a.wrap(o),onDrop:a.wrap(n)},{debugString:"action,block,"+e+","+_.map(t,"jid").join(","),metric:a.M.BLOCK,ackRequest:!1,expires:d().unix()})})},sendSpamReport:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["spam",{jid:e},void 0]]);t.binSend("send",n,o,{onSend:t.wrap(a),onDrop:t.wrap(o)},{debugString:"action,spam,"+e,metric:t.M.SPAM,ackRequest:!1,expires:d().unix()})})},chatFindQuery:function(e){var t=this;return new r["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"chat"===t.N.attr("type",e))if("true"===t.N.attr("duplicate",e))o="preempted";else if(_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=t.parseChat(n[r]);l&&o.push(l)}}a(o)})["catch"](o)},r={type:"chat"};"boolean"==typeof e&&e?r.kind="retry":"string"==typeof e&&(r.jid=e);var i=t.queryNode(r,void 0);t.binSend("sendEphemeral",i,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:["query","chat",e].join(),metric:t.M.QUERY_CHAT,ackRequest:!1})})},msgCreateRecord:function(e,t){var a=this;return new r["default"](function(o,n){var l,u,c=e.id.id;if("chat"===e.type){var d=[["body",void 0,e.body]];"url"===e.subtype&&d.push(["media",{type:"url",title:e.title,description:e.description,"canonical-url":e.canonicalUrl,"matched-text":e.matchedText,encoding:"raw"},e.thumbnail?s.decode(e.thumbnail):void 0]),u=r["default"].resolve(["message",{type:"text",to:e.to,id:e.id.id,t:e.t.toString()},d])}else if("location"===e.type)l=e.body?s.decode(e.body):void 0,u=r["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.clientUrl?e.loc:void 0,url:e.loc&&e.clientUrl?e.clientUrl:void 0,encoding:e.body?"raw":void 0},l]]]);else if("vcard"===e.type){var f=["vcard",{name:e.subtype},e.body];u=r["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{type:"vcard"},[f]]]])}else{var p=e.mediaKey;l=e.body?s.decode(e.body):void 0;var h="ptt"===e.type?"audio":e.type;u=(t&&!p?a.sendMedia(e.avparams):r["default"].resolve(_.merge({status:200,type:h},e.avparams))).then(function(t){if(200===t.status)return r["default"].resolve(["message",{type:"media",to:e.to,id:e.id.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||t.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type&&"document"!==e.type||!e.caption?void 0:e.caption,page_count:"number"!=typeof e.pageCount||isNaN(e.pageCount)?void 0:e.pageCount.toString(),media_key:p,filename:t.filename},l]]]);var a="wap:msgCreateRecord:sendMedia error "+t.status;return i.error(a)(),r["default"].reject(a)})["catch"](function(){return i.error("wap:msgCreateRecord:sendMedia dropped")(),r["default"].reject("wap:msgCreateRecord:sendMedia dropped")})}u.then(function(t){var r=a.actionNode("relay",[t]),i=a.wrap(o);i.tag=c,i.meta={type:"message",key:e.id},a.binSend("send",r,n,{onSend:i,onDrop:a.wrap(n)},{debugString:["action","message",e.type,e.subtype].join(),metric:a.M.MESSAGE,ackRequest:!1})})["catch"](function(){i.error("wap:msgCreateRecord mPromise error")(),n("wap:msgCreateRecord mPromise error")})})},msgFindQuery:function(e,t){var a=this;return"before"!==e?r["default"].reject("wap:msgFindQuery:unsupported:"+e):new r["default"](function(e,o){var n=function(t){a.BinaryProtocol.read(t).then(function(t){var o=[],n=a.N.children(t);if("response"===a.N.tag(t)&&("message"===a.N.attr("type",t)||"star"===a.N.attr("type",t)||"search"===a.N.attr("type",t))&&_.isArray(n)){var r,i=n.length;for(r=0;i>r;r++){var l=a.parseMsg(n[r],"response");l&&o.push(l)}}e(o)})["catch"](o)},r=a.queryNode({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},void 0);a.binSend("sendEphemeral",r,o,{onSend:a.binWrap(n,e),onDrop:a.wrap(o)},{debugString:"query,message,"+[t.toString(),t.count].join(),metric:a.M.QUERY_MESSAGES,ackRequest:!1})})}};e.exports=_.defaults(p,f)},6983:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(1),l=a(33),s=a(271),u=a(32),c=a(7154),d=a(6982),f={version:"08",BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24},epochCount:0,epoch:0,isRequestingDeviceUploadLogsMutex:0,parseChat:function(e){if("chat"===this.N.tag(e)){var t=this.N.attr("jid",e),a=parseInt(this.N.attr("t",e),10)||void 0,o=this.N.attr("type",e),n=parseInt(this.N.attr("mute",e),10)||void 0,r=parseInt(this.N.attr("before",e),10)||void 0,i="true"===this.N.attr("archive",e),l="true"===this.N.attr("read_only",e),s=parseInt(this.N.attr("modify_tag",e),10)||void 0,u=this.N.attr("name",e)||void 0,c=this.safeParseInt(e,"count"),d="true"===this.N.attr("message",e),f="true"===this.N.attr("star",e),p="false"===this.N.attr("spam",e);"ahead"===o&&(o="clear");var h,m=this.N.children(e);if(_.isArray(m)){h=[];var g,v,b=m.length;for(g=0;b>g;g++)if(v=m[g],"item"===this.N.tag(v)){var y=this.N.attr("index",v);y&&h.push([y,"true"===this.N.attr("owner",v),this.N.attr("participant",v)])}}var E={id:t,t:a,type:o,keys:h,before:r,archive:i,isReadOnly:l,unreadCount:c,muteExpiration:n,modifyTag:s,name:u,pendingMsgs:d,star:f,notSpam:p};this.pruneUndefinedProps(E);var S=[o&&"delete"!==o&&"clear"!==o&&"archive"!==o&&"unarchive"!==o&&"mute"!==o&&"star"!==o&&"unstar"!==o&&"spam"!==o&&"modify_tag"!==o,!o&&!t,i&&o&&"clear"!==o,"clear"!==o&&r&&r>0,"clear"!==o&&"star"!==o&&"unstar"!==o&&h&&h.length>0];return this.dropIfConditionMet(S,E)}},sendConversationOpWithKey:function(e,t,a,o){var n=this;return new r["default"](function(r,i){var l,s;switch(e){case"clear":l=(!!o).toString();break;case"spam":s=(!!o).toString()}var u=n.actionNode("set",[["chat",{type:e,jid:t,index:a?a.id:void 0,owner:a?a.fromMe.toString():void 0,participant:a?a.participant:void 0,star:"undefined"!=typeof l?l:void 0,spam:"undefined"!=typeof s?s:void 0},void 0]]);n.binSend("send",u,i,{clientCacheable:!0,onSend:n.wrap(r),onDrop:n.wrap(i)},{debugString:"action,chat,"+[e,a,o].join(),metric:n.M.CHAT,ackRequest:!0})})},setSubProtocol:function(e){e?(this.BinaryProtocol=new c(e),this.N=this.BinaryProtocol.Node):(i.error("Wap:setSubProtocol unknown "+e)(),l.updateImmediately(this.version+"_unknown_version"))},resyncMessages:function(e){var t=this;return new s(function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if(i.logColor("green","bin-recv: response,resume",e)(),"response"===t.N.tag(e)&&"resume"===t.N.attr("type",e)&&_.isArray(n)){var r,l=n.length;for(r=0;l>r;r++){var s=t.parseChat(n[r]);s&&o.push(s)}}a({checksum:t.N.attr("checksum",e),statusChecksum:t.N.attr("status",e),data:o})})["catch"](o)},r=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,participant:e.participant,archive:(!!e.archive).toString(),spam:(!e.notSpam).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),u.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),e.pin&&(t.pin=e.pin.toString()),["last",t,void 0]}),l=t.queryNode({type:"resume"},r);t.binSend("sendEphemeral",l,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,resume",metric:t.M.QUERY_RESUME,ackRequest:!1})})},requestMediaReupload:function(e){var t=this;return new r["default"](function(a,o){var n=e.id,r=function(e){t.BinaryProtocol.read(e).then(function(e){var o;if(i.logColor("green","bin-recv: response,media",e)(),"response"===t.N.tag(e)&&"media"===t.N.attr("type",e)){var n=parseInt(t.N.attr("code",e))||400,r=t.N.attr("url",e);n>=500&&502!==n?(i.error("wap:requestMediaReupload:error "+n)(),o={status:n}):200===n&&r?o={status:200,url:r,mediaKey:t.N.attr("media_key",e)}:200!==n||r?(i.error("wap:requestMediaReupload:error "+n)(),o={status:n}):o={status:400}}else i.error("wap:requestMediaReupload:malformed")(),o={status:400};a(o)})["catch"](o)},l=n,s=t.queryNode({type:"media",index:l.id,jid:l.remote,owner:l.fromMe.toString(),participant:l.participant},void 0);t.binSend("sendEphemeral",s,o,{onSend:t.binWrap(r,a),onDrop:t.wrap(o)},{debugString:"query,media",metric:t.M.QUERY_MEDIA,ackRequest:!1})})},sendConversationUnseen:function(e,t){return this.sendConversationSeen(e,t,-2)},sendConversationNotSpam:function(e){return this.sendConversationOpWithKey("spam",e,void 0,!1)},msgFindQuery:function(e,t){var a=this;return new r["default"](function(o,n){var r,l=function(e){a.BinaryProtocol.read(e).then(function(e){var t=[],n=a.N.children(e);if(i.logColor("green","bin-recv: response,msg",e)(),"response"===a.N.tag(e)&&("message"===a.N.attr("type",e)||"star"===a.N.attr("type",e)||"search"===a.N.attr("type",e))&&_.isArray(n)){var r,l=n.length;for(r=0;l>r;r++){var s=a.parseMsg(n[r],"response");s&&t.push(s)}}o(t)})["catch"](n)},s="";switch(e){case"after":t.id||(e="before");case"before":r={type:"message",kind:e,jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},s=[t.toString(),t.count].join();break;case"search":r={type:"search",search:t.searchTerm},s="search";break;case"star":r={type:"star"},s="starred"}var u=a.queryNode(r,void 0);a.binSend("sendEphemeral",u,n,{onSend:a.binWrap(l,o),onDrop:a.wrap(n)},{debugString:"query,message,"+s,metric:"search"===e?a.M.QUERY_SEARCH:a.M.QUERY_MESSAGES,ackRequest:!1})})}};e.exports=_.defaults(f,d)},6984:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(1),l=a(25),s=a(108),u=a(54),c=a(6983),d={version:"09",BinaryProtocol:null,N:null,M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24,QUERY_IDENTITY:25,QUERY_URL:26,PROFILE:27,CONTACT:28},epochCount:0,epoch:0,parseChat:function(e){if("chat"===this.N.tag(e)){var t=this.N.attr("jid",e),a=parseInt(this.N.attr("t",e),10)||void 0,o=this.N.attr("type",e),n=this.N.attr("kind",e),r=parseInt(this.N.attr("mute",e),10)||void 0,i=parseInt(this.N.attr("before",e),10)||void 0,l="true"===this.N.attr("archive",e),s="true"===this.N.attr("read_only",e),u=parseInt(this.N.attr("modify_tag",e),10)||void 0,c=this.N.attr("name",e)||void 0,d=this.safeParseInt(e,"count"),f="true"===this.N.attr("message",e),p="true"===this.N.attr("star",e),h="false"===this.N.attr("spam",e),m=parseInt(this.N.attr("pin",e),10)||0;switch(n){case"text":case"image":case"video":case"gif":case"audio":case"ptt":case"document":case"location":case"vcard":case"url":break;default:n=void 0}"ahead"===o&&(o="clear");var g,v=this.N.children(e);if(_.isArray(v)){g=[];var b,y,E=v.length;for(b=0;E>b;b++)if(y=v[b],"item"===this.N.tag(y)){var S=this.N.attr("index",y);S&&g.push([S,"true"===this.N.attr("owner",y),this.N.attr("participant",y)])}else{var C=this.parseMsgMessage(y,"response");C&&g.push(C)}}var M={id:t,t:a,type:o,kind:n,keys:g,before:i,archive:l,isReadOnly:s,unreadCount:d,muteExpiration:r,modifyTag:u,name:c,pendingMsgs:f,star:p,notSpam:h,pin:m};this.pruneUndefinedProps(M);var k=[o&&"delete"!==o&&"clear"!==o&&"archive"!==o&&"unarchive"!==o&&"mute"!==o&&"star"!==o&&"unstar"!==o&&"spam"!==o&&"modify_tag"!==o&&"pin"!==o,!o&&!t,l&&o&&"clear"!==o,"clear"!==o&&i&&i>0,"clear"!==o&&"star"!==o&&"unstar"!==o&&g&&g.length>0];return this.dropIfConditionMet(k,M)}},parseMsgCallLog:function(e){if("call_log"===this.N.tag(e)){var t=parseInt(this.N.attr("t",e),10)||0,a=this.N.attr("id",e),o=this.N.attr("jid",e),n="true"===this.N.attr("owner",e),r=this.N.attr("participant",e),l=this.N.attr("type",e);switch(l){case"miss":}try{var u=new s({fromMe:n,remote:o,id:a,participant:r})}catch(c){return void i.error("drop: cannot create MsgKey: "+c.stack)()}var d={id:u,t:t,participant:r,type:"call_log",subtype:l,from:n?Store.Conn.me:o,to:n?o:Store.Conn.me},f=[!a,!t,!o,"miss"!==l];return this.dropIfConditionMet(f,d)}},parseMsgSecurity:function(e){if("security"===this.N.tag(e)){var t,a=parseInt(this.N.attr("t",e),10)||0,o=this.N.attr("id",e),n=this.N.attr("jid",e),r="true"===this.N.attr("owner",e),l=this.N.attr("participant",e),u=this.N.attr("type",e);switch(u){case"identity":var c=this.N.child("participant",e);c&&(t=this.N.attr("jid",c));break;case"encrypt":}try{var d=new s({fromMe:r,remote:n,id:o,participant:l})}catch(f){return void i.error("drop: cannot create MsgKey: "+f.stack)()}var p={id:d,t:a,participant:l,type:"e2e_notification",subtype:u,from:r?Store.Conn.me:n,to:r?n:Store.Conn.me,body:t},h=[!o,!a,!n,"identity"!==u&&"encrypt"!==u,"identity"===u&&!t];return this.dropIfConditionMet(h,p)}},parseCmd:function(e){switch(this.N.tag(e)){case"read":var t=this.N.attr("jid",e),a="false"===this.N.attr("type",e),o={type:a?"unread":"read",jid:t},n=[!t];return this.dropIfConditionMet(n,o);case"identity":var r=this.parseIdentity(e);if(r)return r.type="identity",r;return;default:return}},parseIdentity:function(e){var t=this.N.child("raw",e),a=this.N.child("text",e);return t&&a&&this.N.children(t)instanceof ArrayBuffer&&this.N.dataStr(a)?{jid:this.N.attr("jid",e),binary:this.N.children(t),string:this.N.dataStr(a)}:void 0},queryIdentity:function(e){var t=this;return new r["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=void 0;i.logColor("green","bin-recv: response,identity",e)(),"response"===t.N.tag(e)&&"identity"===t.N.attr("type",e)&&(o=t.parseIdentity(e)),a(o)})["catch"](o)},r=t.queryNode({type:"identity",jid:e},void 0);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,identity,"+e,metric:t.M.QUERY_IDENTITY,ackRequest:!1})})},queryLinkPreview:function(e){var t=this;return new r["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=void 0;if(i.logColor("green","bin-recv: response,url",e)(),"response"===t.N.tag(e)&&"url"===t.N.attr("type",e)){var n=t.N.children(e);o={title:t.N.attr("title",e),description:t.N.attr("description",e),canonicalUrl:t.N.attr("canonical-url",e),matchedText:t.N.attr("matched-text",e),thumbnail:n?l.encode(n):void 0}}a(o)})["catch"](o)},r=t.queryNode({type:"url",url:e},void 0);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,url",metric:t.M.QUERY_URL,ackRequest:!1})})},msgFindQuery:function(e,t){var a=this;return new r["default"](function(o,n){var r,l=function(t){a.BinaryProtocol.read(t).then(function(t){var n=[],r=a.N.children(t);if(i.logColor("green","bin-recv: response,msg",t)(),"response"===a.N.tag(t)&&("message"===a.N.attr("type",t)||"star"===a.N.attr("type",t)||"search"===a.N.attr("type",t)||"media_message"===a.N.attr("type",t))){if(_.isArray(r)){var l,s=r.length;for(l=0;s>l;l++){var u=a.parseMsg(r[l],"response");u&&n.push(u)}}"search"===a.N.attr("type",t)?n={eof:"true"===a.N.attr("last",t),messages:n}:"media"===e&&(n={messages:n})}o(n)})["catch"](n)},s="";switch(e){case"after":t.id||(e="before");case"before":r={type:"message",kind:e,jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},s=[t.toString(),t.count].join();break;case"search":r={type:"search",search:t.searchTerm,page:t.page.toString(),count:t.count.toString()},s=["search",t.page,t.count].join();break;case"star":r={type:"star",chat:t.chat,count:t.count.toString(),jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},s="starred";break;case"media":r={type:"media_message",count:t.count.toString(),kind:t.direction,jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},s="media"}var u=a.queryNode(r,void 0);a.binSend("sendEphemeral",u,n,{onSend:a.binWrap(l,o),onDrop:a.wrap(n)},{debugString:"query,message,"+s,metric:"search"===e?a.M.QUERY_SEARCH:a.M.QUERY_MESSAGES,ackRequest:!1})})},sendUnstarAll:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["chat",{type:"unstar",jid:e||void 0},void 0]]);t.binSend("send",n,o,{clientCacheable:!0,onSend:t.binWrap(a,a),onDrop:t.wrap(o)},{debugString:"action,unstar,all,"+e,metrics:t.M.CHAT,ackRequest:!0,expires:u().unix()})})},setPushname:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["profile",{name:e},void 0]]);t.binSend("send",n,o,{onSend:t.binWrap(a,a),onDrop:t.wrap(o)},{debugString:"action,pushname",metric:t.M.PROFILE,ackRequest:!1})})},addContact:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["contacts",{type:"add"},e]]);t.binSend("send",n,o,{clientCacheable:!0,onSend:t.binWrap(a,a),onDrop:t.wrap(o)},{debugString:"action,contact,add",metric:t.M.CONTACT,ackRequest:!0})})}};e.exports=_.defaults(d,c)},6985:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(78),r=o(n),i=a(0),l=o(i),s=a(25),u=a(1),c=a(274),d=a(7207),f=d.WebMessageInfo,p=a(501),h=p.MessageKey,m=a(494),g=m.Message,v=m.ContextInfo,b=a(108),y=a(32),E=a(6984),S={version:"10",parseMsgMessage:function(e,t){if("message"!==this.N.tag(e))return void u.error("drop: not message")(e);if("ciphertext"===this.N.attr("type",e)){var a=this.N.attr("id",e),o=this.N.attr("from",e),n=this.N.attr("participant",e),r=y.isBroadcast(o)?n:o,i=void 0;try{i=new b({from:r,to:Store.Conn.me,id:a,participant:n})}catch(l){return void u.error("drop: cannot create MsgKey: "+l.stack)()}return{type:"ciphertext",t:parseInt(this.N.attr("t",e),10)||0,
id:i,from:r,to:Store.Conn.me,participant:n,author:y.isBroadcast(o)?void 0:n,star:"true"===this.N.attr("star",e)}}var s=this.N.children(e);if(!(s instanceof ArrayBuffer))return void u.error("drop: no bytes")(e);var c=void 0;try{c=f.parse(s)}catch(l){return void u.assert(!1,"parse-error","drop: failed parsing wmi "+l)(e)}return this.parseWebMessageInfo(c,t)},parseWebMessageInfo:function(e,t){var a=e.key,o=this.decodeJid(a.remoteJid),n=a.fromMe?o:Store.Conn.me,r=a.fromMe?Store.Conn.me:o,i=this.decodeJid(a.participant),l=void 0;if(o===Store.Conn.me&&(l=a.fromMe?"out":"in"),"broadcast"===n)return void u.error("drop: broadcast")(e);var s=void 0;try{s=new b({fromMe:a.fromMe,remote:o,id:a.id,participant:i})}catch(c){return void u.error("drop: cannot create MsgKey: "+c.stack)()}return this.parseMsgProto(e.message,{id:s,from:r,to:n,self:l,participant:i,type:"unknown",t:e.messageTimestamp||0,ack:"fresh"===t?1:e.status-1,author:this.decodeJid(e.participant),invis:!!e.ignore,star:!!e.starred,broadcast:a.fromMe&&e.broadcast,notifyName:e.pushName||"",encFilehash:this.decodeBytes(e.mediaCiphertextSha256)},t)},parseMsgProto:function(e,t,a){if(!e)return u.assert(!1,"null-message","drop: not Message")(e,t),t;var o=e.conversation,n=e.imageMessage,r=e.contactMessage,i=e.locationMessage,l=e.liveLocationMessage,s=e.extendedTextMessage,c=e.documentMessage,d=e.audioMessage,f=e.videoMessage,p=e.contactsArrayMessage,h=e.protocolMessage,m=void 0;return _.isString(o)&&this.parseConversationProto(t,o),n&&(this.parseImageMessageProto(t,n),m=n.contextInfo),r&&(this.parseContactMessageProto(t,r),m=r.contextInfo),p&&(this.parseContactsArrayMessageProto(t,p),m=p.contextInfo),i&&(this.parseLocationMessageProto(t,i),m=i.contextInfo),l&&(this.parseLiveLocationMessageProto(t,l),m=l.contextInfo),s&&(this.parseExtendedTextMessageProto(t,s),m=s.contextInfo),c&&(this.parseDocumentMessageProto(t,c),m=c.contextInfo),d&&(this.parseAudioMessageProto(t,d),m=d.contextInfo),f&&(this.parseVideoMessageProto(t,f),m=f.contextInfo),h&&this.parseProtocolMessageProto(t,h,a),m&&this.parseContextInfoProto(t,m),t},parseProtocolMessageProto:function(e,t,a){if("relay"===a){var o="unknown",n=t.key,r=new b({fromMe:n.fromMe,remote:this.decodeJid(n.remoteJid),id:n.id,participant:this.decodeJid(n.participant)});_.merge(e,{type:"protocol",subtype:o,protocolMessageKey:r})}},parseConversationProto:function(e,t){e.type="chat",e.body=t},parseImageMessageProto:function(e,t){e.type="image",e.clientUrl=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.caption=t.caption,e.filehash=this.decodeBytes(t.fileSha256),e.size=t.fileLength,e.height=t.height,e.width=t.width,e.mediaKey=this.decodeBytes(t.mediaKey),e.body=this.decodeBytes(t.jpegThumbnail)||""},parseContactMessageProto:function(e,t){e.type="vcard",e.subtype=t.displayName,e.body=t.vcard},parseContactsArrayMessageProto:function(e,t){var a=t.contacts;e.type="multi_vcard",e.subtype=t.displayName,e.vcardList=_.isArray(a)?a.map(function(e){return{displayName:e.displayName,vcard:e.vcard}}):[]},parseLocationMessageProto:function(e,t){var a=t.name&&t.address?t.name+"\n"+t.address:t.name||t.address||"";e.type="location",e.lat=void 0!==t.degreesLatitude?""+t.degreesLatitude:void 0,e.lng=void 0!==t.degreesLongitude?""+t.degreesLongitude:void 0,e.loc=a,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.clientUrl=t.url},parseLiveLocationMessageProto:function(e,t){e.type="location",e.isLive=!0,e.lat=void 0!==t.degreesLatitude?""+t.degreesLatitude:void 0,e.lng=void 0!==t.degreesLongitude?""+t.degreesLongitude:void 0,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.accuracy=t.accuracyInMeters,e.speed=t.speedInMps,e.degrees=t.degreesClockwiseFromMagneticNorth,e.comment=t.caption,e.sequence=t.sequenceNumber},parseExtendedTextMessageProto:function(e,t){var a=t.matchedText||t.canonicalUrl||t.description||t.title;e.type="chat",e.subtype=a?"url":void 0,e.body=t.text||"",e.matchedText=t.matchedText,e.canonicalUrl=t.canonicalUrl,e.description=t.description,e.title=t.title,e.thumbnail=this.decodeBytes(t.jpegThumbnail)||"",e.textColor=t.textArgb,e.backgroundColor=t.backgroundArgb;var o=g.ExtendedTextMessage.FONTTYPE;switch(t.font){case o.SANS_SERIF:case o.SERIF:case o.NORICAN_REGULAR:case o.BRYNDAN_WRITE:case o.BEBASNEUE_REGULAR:case o.OSWALD_HEAVY:e.font=t.font}},parseDocumentMessageProto:function(e,t){e.type="document",e.clientUrl=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.caption=t.title,e.filehash=this.decodeBytes(t.fileSha256),e.size=t.fileLength||0,e.pageCount=t.pageCount||0,e.mediaKey=this.decodeBytes(t.mediaKey),e.filename=t.fileName,e.body=this.decodeBytes(t.jpegThumbnail)||""},parseAudioMessageProto:function(e,t){e.type=t.ptt?"ptt":"audio",e.clientUrl=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.size=t.fileLength||0,e.duration=""+(t.seconds||0),e.mediaKey=this.decodeBytes(t.mediaKey),e.streamingSidecar=t.streamingSidecar},parseVideoMessageProto:function(e,t){e.type="video",e.clientUrl=this.decodeUrl(t.url),e.directPath=t.directPath,e.mimetype=t.mimetype,e.filehash=this.decodeBytes(t.fileSha256),e.size=t.fileLength||0,e.height=t.height,e.width=t.width,e.duration=""+(t.seconds||0),e.mediaKey=this.decodeBytes(t.mediaKey),e.caption=t.caption,e.body=this.decodeBytes(t.jpegThumbnail)||"",e.isGif=t.gifPlayback,e.gifAttribution=t.gifAttribution,e.streamingSidecar=t.streamingSidecar},parseContextInfoProto:function(e,t){var a=t.quotedMessage,o=t.mentionedJid;e.quotedMsg=a&&this.parseMsgProto(a,{}),e.quotedStanzaID=t.stanzaId,e.quotedParticipant=this.decodeJid(t.participant),e.quotedRemoteJid=this.decodeJid(t.remoteJid),e.mentionedJidList=_.isArray(o)?o.map(this.decodeJid):o},msgCreateRecord:function(e,t){var a=this;return l["default"].callSynchronously(function(){if(["ptt","audio","image","video","document"].indexOf(e.type)>-1){var o="ptt"===e.type?"audio":e.type;return t&&!e.mediaKey?a.sendMedia(e.avparams):_.merge({status:200,type:o},e.avparams)}})["catch"](function(e){return u.error("wap:msgCreateRecord mPromise error ("+c.encodeErrorInfo()+"): "+e.stack)(),l["default"].reject("wap:msgCreateRecord mPromise error")}).then(function(t){if(t&&200!==t.status){var o="wap:msgCreateRecord:sendMedia error "+t.status;return u.error(o)(),l["default"].reject(o)}var n=e.id.id,i=void 0;if(e.quotedMsg){var s=e.quotedMsg.mentionedJidList,c=_.isArray(s)&&s.length>0?{mentionedJid:s.map(a.encodeJid)}:void 0;c&&(c=new v(c)),i={stanzaId:e.quotedStanzaID,remoteJid:a.encodeJid(e.quotedRemoteJid),participant:a.encodeJid(e.quotedParticipant),quotedMessage:a.createMsgProto(e.quotedMsg,{mimetype:e.quotedMsg.mimetype,duration:e.quotedMsg.duration,filehash:e.quotedMsg.filehash},c)}}if(e.mentionedJidList&&e.mentionedJidList.length>0){var d=e.mentionedJidList;i=i||{},i.mentionedJid=d.map(a.encodeJid)}e.conversionTuple&&(i=i||{},(0,r["default"])(i,e.conversionTuple),delete e.conversionTuple),i&&(i=new v(i));var p=new h({remoteJid:a.encodeJid(e.to),fromMe:!0,id:e.id.id}),m=a.createMsgProto(e,t||{},i),g=e.multicast?!0:void 0,b=e.urlText?!0:void 0,y=e.urlNumber?!0:void 0,E=e.clearMedia?!0:void 0,S=new f({key:p,message:m,messageTimestamp:e.t,multicast:g,urlText:b,urlNumber:y,clearMedia:E}),C=a.actionNode("relay",[["message",void 0,f.encode(S).readBuffer()]]);return new l["default"](function(t,o){a.binSend("send",C,o,{tag:n,onSend:a.wrap(t),onDrop:a.wrap(o),retryOn5xx:!0,resendGuard:function(){var t=Store.Msg.get(e.id);return"protocol"===e.type||t&&t.id.equals(e.id)}},{debugString:["action","message",e.type,e.subtype,n].join(),debugObj:{xml:C,pb:S},metric:a.M.MESSAGE,ackRequest:!1})})})},createMsgProto:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=new g,n=e.mimetype||t.mimetype||void 0,r=t.duration;switch(e.type){case"chat":"url"===e.subtype||e.quotedMsg||_.isArray(e.mentionedJidList)&&e.mentionedJidList.length>0||e.conversionData||e.conversionSource?o.extendedTextMessage=new g.ExtendedTextMessage({text:e.body,matchedText:e.matchedText,canonicalUrl:e.canonicalUrl,description:e.description,title:e.title,jpegThumbnail:this.encodeBytes(e.thumbnail),contextInfo:a}):o.conversation=e.body;break;case"location":var i=new g.LocationMessage({degreesLatitude:parseFloat(e.lat)||void 0,degreesLongitude:parseFloat(e.lng)||void 0,jpegThumbnail:this.encodeBytes(e.body),contextInfo:a});if(e.loc&&_.isString(e.loc)&&e.clientUrl){var l=e.loc.split("\n");i.name=l[0],i.address=l[1],i.url=e.clientUrl}o.locationMessage=i;break;case"vcard":o.contactMessage=new g.ContactMessage({displayName:e.subtype,vcard:e.body,contextInfo:a});break;case"multi_vcard":o.contactsArrayMessage=new g.ContactsArrayMessage({displayName:e.subtype,contacts:e.vcardList.map(function(e){return new g.ContactMessage(e)}),contextInfo:a});break;case"image":o.imageMessage=new g.ImageMessage({url:t.url,mimetype:n,caption:e.caption,fileSha256:this.encodeBytes(t.filehash),fileEncSha256:this.encodeBytes(t.encFilehash),height:t.height,width:t.width,fileLength:_.isNumber(e.size)?e.size:void 0,mediaKey:this.encodeBytes(t.mediaKey),jpegThumbnail:this.encodeBytes(e.body),contextInfo:a});break;case"document":var s=new g.DocumentMessage({url:t.url,mimetype:n,title:e.caption,fileSha256:this.encodeBytes(t.filehash),fileEncSha256:this.encodeBytes(t.encFilehash),fileName:t.filename,fileLength:_.isNumber(e.size)?e.size:void 0,mediaKey:this.encodeBytes(t.mediaKey),jpegThumbnail:this.encodeBytes(e.body),contextInfo:a});_.isNumber(e.pageCount)&&!isNaN(e.pageCount)&&(s.pageCount=e.pageCount),o.documentMessage=s;break;case"ptt":case"audio":r=_.isString(r)?parseInt(r,10):r,o.audioMessage=new g.AudioMessage({url:t.url,mimetype:n,fileSha256:this.encodeBytes(t.filehash),fileEncSha256:this.encodeBytes(t.encFilehash),seconds:r,ptt:"ptt"===e.type,fileLength:_.isNumber(e.size)?e.size:void 0,mediaKey:this.encodeBytes(t.mediaKey),contextInfo:a,streamingSidecar:e.streamingSidecar});break;case"video":r=_.isString(r)?parseInt(r,10):r,o.videoMessage=new g.VideoMessage({url:t.url,mimetype:n,fileSha256:this.encodeBytes(t.filehash),fileEncSha256:this.encodeBytes(t.encFilehash),height:t.height,width:t.width,seconds:r,caption:e.caption,fileLength:_.isNumber(e.size)?e.size:void 0,mediaKey:this.encodeBytes(t.mediaKey),jpegThumbnail:this.encodeBytes(e.body),gifPlayback:e.isGif,gifAttribution:e.gifAttribution,contextInfo:a,streamingSidecar:e.streamingSidecar});break;case"protocol":if("revoke"===e.subtype){var u=e.protocolMessageKey;o.protocolMessage=new g.ProtocolMessage({type:g.ProtocolMessage.TYPE.REVOKE,key:new h({remoteJid:this.encodeJid(u.remote),fromMe:u.fromMe,id:u.id,participant:u.participant})})}}return o},msgFindQuery:function(e,t){var a=this;return new l["default"](function(o,n){var r,i=function(t){a.BinaryProtocol.read(t).then(function(t){var n=[],r=a.N.children(t);if(u.logColor("green","bin-recv: response,msg",t)(),"response"===a.N.tag(t)&&("message"===a.N.attr("type",t)||"star"===a.N.attr("type",t)||"search"===a.N.attr("type",t)||"media_message"===a.N.attr("type",t))){if(_.isArray(r)){var i,l=r.length;for(i=0;l>i;i++){var s=a.parseMsg(r[i],"response");s&&n.push(s)}}"search"===a.N.attr("type",t)?n={eof:"true"===a.N.attr("last",t),messages:n}:"media"===e&&(n={messages:n})}o(n)})["catch"](n)},l="";switch(e){case"after":t.id||(e="before");case"before":r={type:"message",kind:e,jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},l=[t instanceof b?t.toString():t.remote,t.count].join();break;case"search":r={type:"search",search:t.searchTerm,page:t.page.toString(),count:t.count.toString(),jid:t.remote},l=["search",t.page,t.count,t.jid].join();break;case"star":r={type:"star",chat:t.chat,count:t.count.toString(),jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},l="starred";break;case"media":r={type:"media_message",count:t.count.toString(),kind:t.direction,jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},l="media"}var s=a.queryNode(r,void 0);a.binSend("sendEphemeral",s,n,{onSend:a.binWrap(i,o),onDrop:a.wrap(n)},{debugString:"query,message,"+l,metric:"search"===e?a.M.QUERY_SEARCH:a.M.QUERY_MESSAGES,ackRequest:!1})})},decodeJid:function(e){return e&&e.replace(/@s.whatsapp.net$/i,"@c.us")},encodeJid:function(e){return e&&e.replace(/@c.us$/,"@s.whatsapp.net")},decodeUrl:function(e){return e&&-1===e.indexOf("/u/")?e:void 0},decodeBytes:function(e){return e?s.encode(e):void 0},encodeBytes:function(e){return e?s.decode(e):void 0}};e.exports=_.defaults(S,E)},6986:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(1),l=a(108),s=a(6985),u={version:"11",M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24,QUERY_IDENTITY:25,QUERY_URL:26,PROFILE:27,CONTACT:28,QUERY_VCARD:29},msgFindQuery:function(e,t){var a=this;return new r["default"](function(o,n){var r,s=function(r){a.BinaryProtocol.read(r).then(function(n){var r=[],l=a.N.children(n);if(i.logColor("green","bin-recv: response,msg",n)(),"response"===a.N.tag(n)&&("message"===a.N.attr("type",n)||"star"===a.N.attr("type",n)||"search"===a.N.attr("type",n)||"media_message"===a.N.attr("type",n))){if(_.isArray(l)){var s,u=l.length;for(s=0;u>s;s++){var c=a.parseMsg(l[s],"response");if(c)switch(e){case"star":("gif"!==t.media||"video"===c.type&&c.isGif)&&r.push(c);break;case"media":"document"===t.media&&"document"===c.type?r.push(c):"url"===t.media&&"chat"===c.type?r.push(c):t.media||r.push(c);break;default:r.push(c)}}}"search"===a.N.attr("type",n)?r={eof:"true"===a.N.attr("last",n),messages:r}:"media"!==e||t.media||(r={docCount:parseInt(a.N.attr("document",n),10)||void 0,linkCount:parseInt(a.N.attr("url",n),10)||void 0,mediaCount:parseInt(a.N.attr("media",n),10)||void 0,messages:r})}o(r)})["catch"](n)},u="";switch(e){case"after":t.id||(e="before");case"before":r={type:"message",kind:e,jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},u=[t instanceof l?t.toString():t.remote,t.count].join();break;case"search":r={type:"search",search:t.searchTerm,page:t.page.toString(),count:t.count.toString(),jid:t.remote},u=["search",t.page,t.count,t.jid].join();break;case"star":r={type:"star",media:"gif"===t.media?t.media:void 0,chat:t.chat,count:t.count.toString(),jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},u="starred";break;case"media":r={type:"media_message",media:"document"===t.media||"url"===t.media?t.media:void 0,count:t.count.toString(),kind:t.direction,jid:t.remote,index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},u="media"}var c=a.queryNode(r,void 0);a.binSend("sendEphemeral",c,n,{onSend:a.binWrap(s,o),onDrop:a.wrap(n)},{debugString:"query,message,"+u,metric:"search"===e?a.M.QUERY_SEARCH:a.M.QUERY_MESSAGES,ackRequest:!1})})},parseMsgCallLog:function(e){if("call_log"===this.N.tag(e)){var t=parseInt(this.N.attr("t",e),10)||0,a=this.N.attr("id",e),o=this.N.attr("jid",e),n="true"===this.N.attr("owner",e),r=this.N.attr("participant",e),s=this.N.attr("type",e),u="video"===this.N.attr("kind",e);switch(s){case"miss":u&&(s="miss_video")}try{var c=new l({fromMe:n,remote:o,id:a,participant:r})}catch(d){return void i.error("drop: cannot create MsgKey: "+d.stack)()}var f={id:c,t:t,participant:r,type:"call_log",subtype:s,from:n?Store.Conn.me:o,to:n?o:Store.Conn.me},p=[!a,!t,!o,"miss"!==s&&"miss_video"!==s];return this.dropIfConditionMet(p,f)}},queryVCard:function(e){var t=this;return new r["default"](function(a,o){var n=function(e){t.BinaryProtocol.read(e).then(function(e){var o=[],n=t.N.children(e);if("response"===t.N.tag(e)&&"vcard"===t.N.attr("type",e)&&_.isArray(n))for(var r=n.length,i=0;r>i;i++){var l=t.parseMsg(n[i],"response");!l||"vcard"!==l.type&&"multi_vcard"!==l.type||o.push(l)}a(o)})["catch"](o)},r=t.queryNode({type:"vcard",jid:e},void 0);t.binSend("sendEphemeral",r,o,{onSend:t.binWrap(n,a),onDrop:t.wrap(o)},{debugString:"query,vcard,"+e,metric:t.M.QUERY_VCARD,ackRequest:!1})})},parseContact:function(e){if("user"===this.N.tag(e)){var t=this.N.attr("jid",e),a=this.N.attr("name",e),o=this.N.attr("short",e)||void 0,n=this.N.attr("type",e)||"in",r={id:t,name:a,type:n,shortName:o,plaintextDisabled:!0},i=[!t,"in"!==n&&"out"!==n&&!!n];return this.dropIfConditionMet(i,r)}},parseContacts:function(e){if("contacts"===this.N.tag(e)){var t,a,o,n,r,i=this.N.attr("type",e),l=this.N.children(e);switch(i){case"frequent":if(_.isArray(l)){a=l.length;for(var s=0;a>s;s++)switch(r=l[s],o=this.N.tag(r)){case"image":case"video":case"message":n=this.N.attr("jid",r),n&&(t||(t={type:"frequent"}),t[o]||(t[o]=[]),t[o].push(n))}}}return t}}};e.exports=_.defaults(u,s)},6987:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(56),r=o(n),i=a(0),l=o(i),s=a(1),u=a(54),c=a(108),d=a(6986),f={version:"12",M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24,QUERY_IDENTITY:25,QUERY_URL:26,PROFILE:27,CONTACT:28,QUERY_VCARD:29,QUERY_STATUS:30,QUERY_STATUS_UPDATE:31,PRIVACY_STATUS:32},statusQuery:function(){switch(arguments.length){case 2:case 3:case 4:return this.statusQueryUpdate.apply(this,arguments);case 0:default:return this.statusQueryAll()}},statusQueryAll:function(){var e=this;return new l["default"](function(t,a){var o=function(o){e.BinaryProtocol.read(o).then(function(a){var o={statuses:[]},n=e.N.children(a);if(s.logColor("green","bin-recv: response,statusv3",a)(),"response"===e.N.tag(a)&&"status"===e.N.attr("type",a)&&(o.checksum=e.N.attr("checksum",a),_.isArray(n)))for(var r=n.length,i=0;r>i;i++){var l=n[i],u=e.N.attr("jid",l),c=e.N.attr("unread",l),d=e.N.attr("count",l),f=e.N.attr("t",l);if("status"===e.N.tag(l)&&u&&d&&f){var p={id:u,unreadCount:parseInt(c,10)||0,totalCount:parseInt(d,10)||0,t:parseInt(f,10)||0,_msgs:[]},h=e.N.children(l);if(_.isArray(h))for(var m=h.length,g=0;m>g;g++)switch(e.N.tag(h[g])){default:case"message":var v=e.parseMsgMessage(h[g],"response");v&&p._msgs.push(v);break;case"picture":var b=e.N.children(h[g]);b instanceof ArrayBuffer&&(p.pic=b)}o.statuses.push(p)}}t(o)})["catch"](a)},n=e.queryNode({type:"status"},void 0);e.binSend("sendEphemeral",n,a,{onSend:e.binWrap(o,t),onDrop:e.wrap(a)},{debugString:"query,statusv3",metric:e.M.QUERY_STATUS,ackRequest:!1})})},statusQueryUpdate:function(e,t,a,o){var n=this;return new l["default"](function(r,i){var l=function(e){n.BinaryProtocol.read(e).then(function(e){var t=[],a=n.N.children(e);if(s.logColor("green","bin-recv: response,statusv3",e)(),"response"===n.N.tag(e)&&"status"===n.N.attr("type",e)&&_.isArray(a))for(var o=a.length,i=0;o>i;i++){var l=n.parseMsg(a[i],"response");l&&t.push(l)}r(t)})["catch"](i)},u="before"===o?"before":"after",d={type:"status",kind:u,chat:e,count:t.toString(),jid:a?a.remote:void 0,index:a?a.id:void 0,owner:a?a.fromMe.toString():void 0,participant:a?a.participant:void 0},f=n.queryNode(d,void 0);n.binSend("sendEphemeral",f,i,{onSend:n.binWrap(l,r),onDrop:n.wrap(i)},{debugString:["query","statusv3",u,t,a instanceof c?a.toString():e].join(),metric:n.M.QUERY_STATUS_UPDATE,ackRequest:!1})})},setStatusPrivacy:function(e,t){var a=this;return new l["default"](function(o,n){var r,i={kind:"status"};switch(e){case"blacklist":case"whitelist":i.type=e,r=_.isArray(t)?t.map(function(e){return["user",{jid:e},void 0]}):void 0;break;case"contacts":default:i.type="contacts"}var l=a.actionNode("set",[["privacy",i,r]]);a.binSend("send",l,n,{clientCacheable:!0,onSend:a.wrap(o),onDrop:a.wrap(n)},{debugString:["action,privacy,status",e].concat(t).join(),metric:a.M.PRIVACY_STATUS,ackRequest:!1,expires:u().unix()})})},sendConversationSeen:function(e,t,a,o,n){var i=this;return new l["default"](function(l,s){var u=i.actionNode("set",[["read",{kind:o?"status":void 0,chat:o?n:void 0,jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,participant:t?t.participant:void 0,count:a&&t?a.toString():void 0},void 0]]);i.binSend("send",u,s,{clientCacheable:!0,onSend:i.wrap(l),onDrop:i.wrap(s)},{debugString:"action,"+(o?"status":"chat")+",read,"+(0,r["default"])(t)+","+a,metric:i.M.READ,ackRequest:!0})})},sendStatusSeen:function(e,t){return this.sendConversationSeen(e.remote,e,void 0,!0,t)},sendStatusMute:function(e,t){var a=this;return new l["default"](function(o,n){var r=a.actionNode("set",[["status",{jid:e,mute:(!!t).toString()},void 0]]);a.binSend("send",r,n,{clientCacheable:!0,onSend:a.wrap(o),onDrop:a.wrap(n)},{debugString:"action,status,mute,"+[e,t].join(),metric:a.M.STATUS,ackRequest:!0})})},requestMediaReupload:function(e,t){var a=this;return new l["default"](function(o,n){var r=e.id,i=function(e){a.BinaryProtocol.read(e).then(function(e){var t;if(s.logColor("green","bin-recv: response,media",e)(),"response"===a.N.tag(e)&&"media"===a.N.attr("type",e)){var n=parseInt(a.N.attr("code",e))||400,r=a.N.attr("url",e);n>=500&&502!==n?(s.error("wap:requestMediaReupload:error "+n)(),t={status:n}):200===n&&r?t={status:200,url:r,mediaKey:a.N.attr("media_key",e)}:200!==n||r?(s.error("wap:requestMediaReupload:error "+n)(),t={status:n}):t={status:400}}else s.error("wap:requestMediaReupload:malformed")(),t={status:400};o(t)})["catch"](n)},l=_.isArray(t)?t.map(function(e){return["user",{jid:e},void 0]}):void 0,u=r,c=a.queryNode({type:"media",index:u.id,jid:u.remote,owner:u.fromMe.toString(),participant:u.participant},l);a.binSend("sendEphemeral",c,n,{onSend:a.binWrap(i,o),onDrop:a.wrap(n)},{debugString:"query,media",metric:a.M.QUERY_MEDIA,ackRequest:!1})})},parseCmd:function(e){switch(this.N.tag(e)){case"read":var t,a=this.N.attr("jid",e),o="false"===this.N.attr("type",e),n="status"===this.N.attr("kind",e),r=this.N.attr("checksum",e),i=this.N.attr("index",e),l="true"===this.N.attr("owner",e),s=this.N.attr("participant",e),u=this.N.attr("chat",e);try{t=new c({id:i,fromMe:l,remote:a,participant:s})}catch(d){}var f={type:o?"unread":"read",jid:a,isStatus:n,checksum:r,chat:this.decodeJid(u),key:t},p=[!a,n&&!t];return this.dropIfConditionMet(p,f);case"identity":var h=this.parseIdentity(e);if(h)return h.type="identity",h;return;default:return}},parseContact:function(e){if("user"===this.N.tag(e)){var t=this.N.attr("jid",e),a=this.N.attr("name",e),o=this.N.attr("short",e)||void 0,n=this.N.attr("type",e)||"in",r=this.N.attr("notify",e),i=this.N.attr("verify",e),l="true"===this.N.attr("status_mute",e),s=this.N.attr("index",e)||void 0,u="false"!==this.N.attr("checkmark",e),c=this.N.attr("vname",e),d=void 0,f=void 0;switch(i){case"true":case"0":case"1":case"2":d=!0,f=parseInt(i,10)||0;break;default:d=!1,u=void 0}var p={id:t,name:a||c,type:n,shortName:o,plaintextDisabled:!0,pushname:r,verified:d,verifiedLevel:f,statusMute:l,sectionHeader:s,verifiedName:c};"boolean"==typeof u&&(p.verifiedCheckmark=u);var h=[!t,"in"!==n&&"out"!==n&&!!n];return this.dropIfConditionMet(h,p)}},parseAck:function(e){if("received"===this.N.tag(e)){var t,a=this.N.attr("type",e),o=this.N.attr("index",e),n=this.N.attr("jid",e),r="true"===this.N.attr("owner",e),i=this.N.attr("participant",e);switch(a){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var l={cmd:"ack",id:o,ack:t,from:r?Store.Conn.me:n,to:r?n:Store.Conn.me,participant:i,self:r?"out":"in"},s=[!o,!n,"message"!==a&&"read"!==a&&"played"!==a&&"error"!==a&&"pending"!==a];return this.dropIfConditionMet(s,l)}}};e.exports=_.defaults(f,d)},6988:function(e,t,a){"use strict";var o=a(1),n=a(7207),r=n.WebMessageInfo,i=a(494),l=i.Message,s=a(108),u=a(6987),c={version:"13",parseMsgMessage:function(e,t){if("message"!==this.N.tag(e))return void o.error("drop: not message")(e);var a=this.N.children(e);if(!(a instanceof ArrayBuffer))return void o.error("drop: no bytes")(e);var n=void 0;try{n=r.parse(a)}catch(i){return void o.assert(!1,"parse-error","drop: failed parsing wmi "+i)(e)}return this.parseWebMessageInfo(n,t)},parseWebMessageInfo:function(e,t){var a=e.key,n=this.decodeJid(a.remoteJid),r=a.fromMe?n:Store.Conn.me,i=a.fromMe?Store.Conn.me:n,l=this.decodeJid(a.participant),u="in";if(n===Store.Conn.me&&(u=a.fromMe?"out":"in"),"broadcast"===r)return void o.error("drop: broadcast")(e);var c=void 0;try{c=new s({fromMe:a.fromMe,remote:n,id:a.id,participant:l})}catch(d){return void o.error("drop: cannot create MsgKey: "+d.stack)()}var f={id:c,from:i,to:r,self:u,participant:l,type:"unknown",t:e.messageTimestamp||0,ack:"fresh"===t?1:e.status-1,author:this.decodeJid(e.participant),invis:!!e.ignore,star:!!e.starred,broadcast:a.fromMe&&e.broadcast,notifyName:e.pushName||"",encFilehash:this.decodeBytes(e.mediaCiphertextSha256),shareDuration:e.message&&e.message.liveLocationMessage?e.duration:void 0};return e.message?this.parseMsgProto(e.message,f,t):this.parseMsgStubProto(e,f)},parseMsgStubProto:function(e,t){var a=r.STUBTYPE;switch(e.messageStubType){case a.REVOKE:return t.type="revoked",t;case a.CIPHERTEXT:return t.type="ciphertext",t;case a.FUTUREPROOF:return t.type="unknown",t.subtype="phone",t;default:return t}},parseProtocolMessageProto:function(e,t,a){if("relay"===a){var o;switch(t.type){case l.ProtocolMessage.TYPE.REVOKE:o="revoke";break;default:o="unknown"}var n=t.key,r=new s({fromMe:n.fromMe,remote:this.decodeJid(n.remoteJid),id:n.id,participant:this.decodeJid(n.participant)});e.type="protocol",e.subtype=o,e.protocolMessageKey=r}}};e.exports=_.defaults(c,u)},6989:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(6988),l={version:"14",sendConversationPin:function(e,t,a){var o=this;return new r["default"](function(n,r){var i=o.actionNode("set",[["chat",{type:"pin",pin:t?t.toString():void 0,previous:a?a.toString():void 0,jid:e},void 0]]);o.binSend("send",i,r,{clientCacheable:!0,onSend:o.wrap(n),onDrop:o.wrap(r)},{debugString:["action","chat",e,t?"pin,"+t:"unpin,"+a].join(),metric:o.M.CHAT,ackRequest:!0})})}};e.exports=_.defaults(l,i)},6991:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){window.history.pushState({},"",window.location.href)}function r(){if(!Store.Conn.connected)return!1;var e=a(7240).hasText,t=Store.Msg.some(function(e){return 0===e.ack&&e.local&&e.isSentByMe}),o=Store.Chat.some(function(e){return!!e.composeContents.text});return t||o||e()}Object.defineProperty(t,"__esModule",{value:!0});var i=a(24),l=o(i),s=a(0),u=o(s),c=a(17),d=o(c),f=a(5),p=o(f),h=a(2),m=o(h),g=a(4),_=o(g),v=a(7),b=o(v),y=a(6),E=o(y);t.hasPending=r;var S=a(3),C=o(S),M=a(10),k=o(M),w=a(7286),N=o(w),T=a(184),P=o(T),I=a(278),R=a(7328),A=o(R),x=a(12),O=o(x),D=a(94),L=o(D),U=a(8),F=o(U),j=a(7367),B=o(j),G=a(7403),V=o(G),Y=a(14),W=o(Y),H=a(177),q=o(H),z=a(7445),K=o(z),Q=a(173),J=o(Q),X=a(7492),Z=o(X),$=a(518),ee=o($),te=a(7506),ae=o(te),oe=a(71),ne=o(oe),re=a(1),ie=o(re),le=a(54),se=o(le),ue=a(7493),ce=o(ue),de=a(46),fe=o(de),pe=a(7423),he=o(pe),me=a(55),ge=o(me),_e=a(33),ve=o(_e),be=a(64),ye=o(be),Ee=a(7512),Se=o(Ee),Ce=a(7465),Me=o(Ce),ke=a(28),we=o(ke),Ne=a(261),Te=o(Ne),Pe=a(72),Ie=o(Pe),Re=a(73),Ae=o(Re),xe=a(21),Oe=o(xe),De=a(264),Le=o(De),Ue=a(7509),Fe=o(Ue),je=a(38),Be=o(je),Ge=a(32),Ve=o(Ge),Ye=a(62),We=a(129);We&&!function(){var e=a(286),t=a(285);Store.ProfilePicThumb.on("change:tag",function(a){var o=navigator.serviceWorker;o&&!a.tag&&e.request(o.controller,t.REMOVE_PP,a.id)["catch"](function(){})})}();var He=[[document,"mousemove"],[document,"scroll"],[document,"keydown"],[window,"focus"],[window,"resize"]];t["default"]=(0,ne["default"])(function(e){function t(){var e,a,o,n;(0,m["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,b["default"])(this,(e=t.__proto__||(0,p["default"])(t)).call.apply(e,[this].concat(i))),o.state={drawerActive:!1},o.idleMonitor=null,o.serverPropsQueryLoop=null,o.rightDrawerOut=!1,o.onBlurTimer=new ge["default"](function(){if(document.activeElement===document.body){var e=Ie["default"].Manager.top;e&&e.uie.requestFocus()}}),o.onBlur=function(){o.onBlurTimer.debounce(10)},o.onRightDrawerIn=function(){o.rightDrawerOut=!1,O["default"].onPanesWillChange(3),o.setState({drawerActive:!0},function(){O["default"].onPanesDidChange(3)});var e=o.calculateConversationPaneScale();null!==e&&o.animateConversationPane(e)},o.onRightDrawerOut=function(){o.rightDrawerOut=!0;var e=o.calculateConversationPaneScale();null!==e&&o.animateConversationPane(e),1!==e&&(O["default"].onPanesWillChange(2),o.setState({drawerActive:!1},O["default"].onPanesDidChange.bind(O["default"],2)))},o.onRightDrawerAnimationComplete=function(){o.state.drawerActive&&o.rightDrawerOut&&o.setState({drawerActive:!1})},o.onRotateFocus=function(e){var t=1;e&&(e.stopPropagation(),e.preventDefault(),t=e.shiftKey?-1:1,(0,Q.shouldIndicateFocus)());var a=[];if(k["default"].toArray(fe["default"].findDOMNode(o).querySelectorAll("[data-tab]")).forEach(function(e){a.push(e)}),O["default"].existsDrawerLeft(function(e){if(e){var t=fe["default"].findDOMNode(o.refs.chatlist);a=a.filter(function(e){return!t.contains(e)})}}),O["default"].existsDrawerMid(function(e){if(e){var t=fe["default"].findDOMNode(o.refs.conversation);t&&(a=a.filter(function(e){return!t.contains(e)}))}}),a.length){a=k["default"].sortBy(a,function(e){return parseInt(e.getAttribute("data-tab"),10)||0});var n=0,r=document.activeElement;r&&(n=ee["default"].ring(k["default"].findIndex(a,function(e){return e.contains(r)})+t,a));var i=a[n];(0,Q.shouldIndicateFocus)(),i.restoreFocus?i.restoreFocus(e):q["default"].focus(i,e)}},o.showTOS=function(){switch(Store.Conn.tos){case 1:case 2:O["default"].openModal(C["default"].createElement(Me["default"],null),void 0,void 0,!0);break;case 3:ve["default"].logout()}},n=a,(0,b["default"])(o,n)}return(0,E["default"])(t,e),(0,_["default"])(t,[{key:"componentWillMount",value:function(){var e=this;ye["default"].uiActive=!0,ye["default"].markAvailable();var t=this.props.listeners;t.add(window,"click",function(t){var a=t.target;if(a&&"A"===a.nodeName&&a.hasAttribute("href")){var o=(0,I.parseCmd)(a.getAttribute("href"));e.execApiCmd(o)&&t.preventDefault()}},!0)}},{key:"componentWillReceiveProps",value:function(e){e.apiCmd&&this.execApiCmd(e.apiCmd)}},{key:"componentWillUnmount",value:function(){this.onBlurTimer.cancel(),ae["default"].trigger(Z["default"].Event+":"+Z["default"].Events.LOGGED_OUT),Ae["default"].canMuckHistory()&&window.history.back(),ye["default"].uiActive=!1,this.clearIdleMonitor(),this.clearServerPropsQueryLoop()}},{key:"componentDidMount",value:function(){var e=this.props.listeners;if(ae["default"].trigger(Z["default"].Event+":"+Z["default"].Events.LOGGED_IN),this.props.apiCmd&&this.execApiCmd(this.props.apiCmd),Ae["default"].canMuckHistory()&&(window.history.pushState({},"",window.location.href),e.add(window,"popstate",n)),this.beginIdleMonitor(!0),this.beginServerPropsQueryLoop(),e.addAndRun(Store.Conn,"change:tos",this.showTOS),q["default"].focus(fe["default"].findDOMNode(this)),we["default"].isSafari){var t=Oe["default"].getNUX(F["default"].NUX.SAFARI_LIMITED_SUPPORT);(!t||t<t.maxViews)&&(setTimeout(function(){var e=l10n.t("whatsapp_safari_limited").replace("__chrome_homepage__",F["default"].BROWSER_LINK.CHROME).replace("__firefox_homepage__",F["default"].BROWSER_LINK.FIREFOX).replace("__opera_homepage__",F["default"].BROWSER_LINK.OPERA);
O["default"].openModal(C["default"].createElement(L["default"],{onOK:O["default"].closeModal.bind(O["default"]),okText:l10n.t("ok_got_it")},C["default"].createElement("div",{dangerouslySetInnerHTML:{__html:e}})))},250),Oe["default"].setNUX(F["default"].NUX.SAFARI_LIMITED_SUPPORT,{views:1,maxViews:1}))}}},{key:"execApiCmd",value:function(e){var t=(0,d["default"])(e,2),a=t[0],o=t[1];ie["default"].log("main:execApiCmd:"+a)(o),this.props.apiCmdHandled();var n=function(){switch(a){case I.Cmd.GROUP_INVITE:var e=o;return O["default"].openModal(C["default"].createElement(K["default"],{groupCode:e.code})),{v:!0};case I.Cmd.MSG_SEND:var t=o,n=t.text,r=t.phone,i=t.conversionTuple;return r?Be["default"].queryExist(Ve["default"].numberToWid(r)).then(function(e){return 200===e.status?Store.Chat.find(e.jid):u["default"].reject("Invalid number")}).then(function(e){return i&&Store.ConversionTuple.add((0,l["default"])({id:e.id,conversionData:void 0,conversionSource:void 0,timestamp:1e3*(0,Ye.globalUnixTime)()},i),{merge:!0}),e.active&&n?void O["default"].pasteChatTextInput(e,n):(n&&e.setComposeContents({text:n}),O["default"].openChatFromUnread(e).then(function(t){t&&O["default"].focusChatTextInput(e)}))})["catch"](function(e){O["default"].openModal(C["default"].createElement(L["default"],{onOK:O["default"].closeModal.bind(O["default"]),okText:l10n.t("web_ok")},l10n.t("msg_send_error")))}):O["default"].openModal(C["default"].createElement(he["default"],{msgText:n}),"modal-flow"),{v:!0};default:return{v:!1}}}();return"object"==typeof n?n.v:void 0}},{key:"beginIdleMonitor",value:function(e){var t=this,a=e?F["default"].IDLE_TIMEOUT:0;this.idleMonitor=u["default"].loop(function(){return u["default"].delay(a).addCancelControl().then(function(){ye["default"].markUnavailable(3e4);var e=void 0,o=new u["default"](function(t){e=t});return He.forEach(function(a){var o=(0,d["default"])(a,2),n=o[0],r=o[1];t.props.listeners.add(n,r,e)}),o.addCancelControl()["finally"](function(){He.forEach(function(a){var o=(0,d["default"])(a,2),n=o[0],r=o[1];t.props.listeners.remove(n,r,e)})}).then(function(){document.hasFocus()&&ye["default"].markAvailable(),a=F["default"].IDLE_TIMEOUT})})})["finally"](function(){t.idleMonitor=null})["catch"](u["default"].CancellationError,function(){}).endWithControls("cancel")}},{key:"clearIdleMonitor",value:function(){this.idleMonitor&&this.idleMonitor.control.cancel()}},{key:"beginServerPropsQueryLoop",value:function(){var e=this;this.serverPropsQueryLoop=P["default"].setTimeout(function(){Store.ServerProps.fetch()["catch"](W["default"].WapDrop,function(){}),e.beginServerPropsQueryLoop()},(0,se["default"])().add("1","days").valueOf())}},{key:"clearServerPropsQueryLoop",value:function(){P["default"].clearTimeout(this.serverPropsQueryLoop)}},{key:"calculateConversationPaneScale",value:function(){if(!(this.refs.chatlist&&this.refs.container&&this.refs.conversation))return null;var e=fe["default"].findDOMNode(this.refs.chatlist),t=fe["default"].findDOMNode(this.refs.conversation),a=fe["default"].findDOMNode(this.refs.container);return t.clientWidth/(a.clientWidth-e.clientWidth)}},{key:"animateConversationPane",value:function(e){(0,Le["default"])(fe["default"].findDOMNode(this.refs.conversation),{scaleX:[1,e]},{duration:300,easing:[.1,.82,.25,1]})}},{key:"render",value:function(){var e=this.state.drawerActive?"app three":"app two";this.props.animate||(e+=" no-animation");var t={tab:this.onRotateFocus,"shift+tab":this.onRotateFocus};return C["default"].createElement(Te["default"],{state:Te["default"].State.INACTIVE,ref:"container",displayName:"Main"},C["default"].createElement(J["default"],{handlers:t,className:e,onBlur:this.onBlur},C["default"].createElement(ce["default"],null),C["default"].createElement(N["default"],null),C["default"].createElement(Fe["default"],null),C["default"].createElement(Se["default"],null),C["default"].createElement("div",{className:"drawer-manager"},C["default"].createElement(V["default"],{direction:G.Dir.LEFT}),C["default"].createElement(V["default"],{direction:G.Dir.MID}),C["default"].createElement(V["default"],{direction:G.Dir.RIGHT,ref:"rightDrawer",onDrawerIn:this.onRightDrawerIn,onDrawerOut:this.onRightDrawerOut,onDrawerAnimationComplete:this.onRightDrawerAnimationComplete})),C["default"].createElement(A["default"],{ref:"chatlist",className:"pane pane-one"}),C["default"].createElement(B["default"],{ref:"conversation",animate:this.props.animate})))}}]),t}(C["default"].Component))},6992:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(500),r=o(n),i=a(7488),l=o(i);e.exports={AllStarredMsgs:new r["default"],Blocklist:a(7471),Call:a(7472),Chat:a(7473),ChatPreference:a(7474),Cmd:a(7475),ConversionTuple:a(7476),EmojiVariant:a(7477),GroupMetadata:a(7478),Location:a(7480),Msg:a(7481),MsgInfo:a(7482),Mute:a(7483),Presence:a(7484),ProfilePicThumb:a(7485),RecentEmoji:a(7487),ServerProps:a(7275)["default"],StarredGifMsgs:new l["default"],Status:a(7489),StatusV3:a(7490),StatusV3Privacy:a(7491)}},6993:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(1),l=a(33),s=a(7207),u=s.WebMessageInfo,c=a(6989),d={version:"15",M:{DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24,QUERY_IDENTITY:25,QUERY_URL:26,PROFILE:27,CONTACT:28,QUERY_VCARD:29,QUERY_STATUS:30,QUERY_STATUS_UPDATE:31,PRIVACY_STATUS:32,QUERY_LIVE_LOCATIONS:33,LIVE_LOCATION:34},parseMsgStubProto:function(e,t){var a=u.STUBTYPE;switch(e.messageStubType){case a.REVOKE:return t.type="revoked",t;case a.CIPHERTEXT:return t.type="ciphertext",t;case a.FUTUREPROOF:return t.subtype="phone",t;case a.NON_VERIFIED_TRANSITION:case a.UNVERIFIED_TRANSITION:case a.VERIFIED_TRANSITION:case a.VERIFIED_LOW_UNKNOWN:case a.VERIFIED_HIGH:return this.parseMsgStubTemplate(e,t);default:return t}},parseMsgStubTemplate:function(e,t){var a=u.STUBTYPE;switch(t.type="notification_template",t.templateParams=e.messageStubParameters.map(this.decodeJid),e.messageStubType){case a.NON_VERIFIED_TRANSITION:t.subtype="non_verified_transition";break;case a.UNVERIFIED_TRANSITION:t.subtype="unverified_transition";break;case a.VERIFIED_TRANSITION:t.subtype="verified_transition";break;case a.VERIFIED_LOW_UNKNOWN:t.subtype="verified_low_unknown";break;case a.VERIFIED_HIGH:t.subtype="verified_high"}return t},subscribeLiveLocation:function(e,t){var a=this;return new r["default"](function(o,n){var r=function(e){a.BinaryProtocol.read(e).then(function(e){var n=a.N.children(e),r={participants:[]};if(i.logColor("green","bin-recv: response,live_location",e)(),"response"===a.N.tag(e)&&"live_location"===a.N.attr("type",e)){var l=parseInt(a.N.attr("duration",e),10);if(r.duration=_.isNaN(l)?void 0:l,t&&_.isArray(n))for(var s=n.length,u=0;s>u;u++){var c=n[u],d=a.N.attr("jid",c),f=parseInt(a.N.attr("expiration",c),10),p=parseInt(a.N.attr("elapsed",c),10)||0,h=a.children(c);if("participant"===a.N.tag(c)&&d){var m={id:d,expiration:_.isNaN(f)?void 0:f,elapsed:p};h&&a.parseLiveLocationMessageProto(m,h),r.participants.push(m)}}}o(r)})["catch"](n)},l=a.queryNode({type:"live_location",kind:"subscribe",jid:e,participant:t?"true":void 0},void 0);a.binSend("sendEphemeral",l,n,{onSend:a.binWrap(r,o),onDrop:a.wrap(n)},{debugString:["query,live_location",e,t].join(),metric:a.M.QUERY_LIVE_LOCATIONS})})},unsubscribeLiveLocation:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["live_location",{type:"unsubscribe",jid:e},void 0]]);t.binSend("send",n,o,{clientCacheable:!0,onSend:t.wrap(a),onDrop:t.wrap(o)},{debugString:"action,live_location,unsubscribe,"+e,metric:t.M.LIVE_LOCATION})})},disableLiveLocation:function(e){var t=this;return new r["default"](function(a,o){var n=t.actionNode("set",[["live_location",{type:"disable",jid:e},void 0]]);t.binSend("send",n,o,{clientCacheable:!0,onSend:t.wrap(a),onDrop:t.wrap(o)},{debugString:"action,live_location,disable,"+e,metric:t.M.LIVE_LOCATION})})},parseLocation:function(e){if("location"===this.N.tag(e)){var t=this.N.attr("type",e),a=this.N.attr("jid",e),o=parseInt(this.N.attr("elapsed",e),10)||0,n=this.N.children(e),r={type:t,jid:a,elapsed:o};"update"===t&&n&&this.parseLiveLocationMessageProto(r,n),this.pruneUndefinedProps(r);var i=["update"!==t,!("update"!==t||a&&n)];return this.dropIfConditionMet(i,r)}},binSend:function(e,t,a,o,n){var r=this,i=o.epochIneligible?a:function(e){r.epochRecv(),a(e)};return delete o.epochIneligible,this.BinaryProtocol.write(t).then(function(a){n.debugObj||(n.debugObj=t),n.ackRequest=!1,o.data=a,o.binaryOpts=n,l[e](o)})["catch"](i)}};e.exports=_.defaults(d,c)},7118:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,a){function o(e){t.call(this,e)}for(var n={_ProxyState$ComponentName:{value:e},proxyBitMask:{value:(0,R.genBitMask)(t.prototype.mirrorMask,a)}},r=function(e){var t=a[e];n[t]={enumerable:!0,get:function(){return this._ProxyState$state.get(t)},set:function(e){this._ProxyState$state.set(t,e)}}},i=0;i<a.length;i++)r(i);return o.prototype=(0,E["default"])(t.prototype,n),o.prototype.constructor=o,o}Object.defineProperty(t,"__esModule",{value:!0});var i=a(24),l=n(i),s=a(48),u=n(s),c=a(5),d=n(c),f=a(7),p=n(f),h=a(6),m=n(h),g=a(2),_=n(g),v=a(4),b=n(v),y=a(98),E=n(y);t["default"]=function(e){var t,a,o=e.name,n=e.CONCERNS,r=e.WEAK_CONCERNS;P["default"].assert(n||r,"StateHOC wrapping class with no concerns, check "+o);var i=[];if(n)for(var s in n)i.push(new L(o,s,n[s],!0));if(r)for(var c in r)P["default"].assert(!(n&&n.hasOwnProperty(c)),'Component has marked "'+c+'" as both a normal and weak concern, check '+o),i.push(new L(o,c,r[c],!1));return a=t=function(t){function a(e){(0,_["default"])(this,a);var t=(0,p["default"])(this,(a.__proto__||(0,d["default"])(a)).call(this,e));t.hasBroken=!1,t.rr=function(e,a){t.setState((0,u["default"])({},e.name,new e.whitelistedProxyClass(a)))};for(var o=t.state={},n=0;n<i.length;n++){var r=i[n],l=r.name,s=r.getModelAndValidate(e[l]);s?o[l]=r.attachConcern(s,t.rr):t.hasBroken=!0}return t}return(0,m["default"])(a,t),(0,b["default"])(a,[{key:"componentWillReceiveProps",value:function(e){if(!this.hasBroken){for(var t=this.props,a=null,o=0;o<i.length;o++){var n=i[o],r=n.name,l=n.getModel(t[r]),s=n.getModelAndValidate(e[r]);l!==s&&(n.detachConcern(l,this.rr),s?(a||(a={}),a[r]=n.attachConcern(s,this.rr)):this.hasBroken=!0)}a&&this.setState(a)}}},{key:"componentWillUnmount",value:function(){if(!this.hasBroken)for(var e=this.props,t=0;t<i.length;t++){var a=i[t];a.detachConcern(a.getModel(e[a.name]),this.rr)}}},{key:"_getComponent",value:function(){return I._getComponent.call(this)}},{key:"render",value:function(){return this.hasBroken?null:C["default"].createElement(e,(0,l["default"])({ref:this.setComponent},this.props,this.state))}}]),a}(I.WrapperInterface),t.displayName="State("+(0,N["default"])(e)+")",a};var S=a(3),C=n(S),M=a(515),k=n(M),w=a(185),N=n(w),T=a(1),P=n(T),I=a(174),R=a(277),A=a(64),x=n(A),O=a(7486),D=o(O),L=function(){function e(t,a,o,n){(0,_["default"])(this,e),this.componentName=t,this.name=a,this.isStrong=n;var i=D[""+a[0].toUpperCase()+a.slice(1)+"Proxy"];i||P["default"].assert(!1,"state-hoc-error",'Unknown StateHOC concern type "'+a+'"'),this.proxyClass=i,this.whitelistedProxyClass=r(t,i,o)}return(0,b["default"])(e,[{key:"getModel",value:function(e){return e instanceof this.proxyClass?e._ProxyState$state:e}},{key:"getModelAndValidate",value:function(e){var t=e instanceof this.proxyClass?e._ProxyState$state:e;return t?t instanceof k["default"]?t:(P["default"].assert(!1,"state-hoc-error",this.componentName+" given invalid object for "+this.name+": "+t)(),null):(P["default"].assert(x["default"].mode!==A.MODE.MAIN,"state-hoc-error",this.componentName+" was not supplied the "+this.name+" model.")(),null)}},{key:"attachConcern",value:function(e,t){e.incObservers(!this.isStrong);var a=new this.whitelistedProxyClass(e);return e.mirror.addListener(t,a.proxyBitMask,this),a}},{key:"detachConcern",value:function(e,t){e.decObservers(),e.mirror.removeListener(t)}}]),e}()},7119:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{found:!1};if(e===t)return a.found=!0,"";if(e instanceof HTMLImageElement)return e.alt;if(e.nodeType===Node.TEXT_NODE)return e.nodeValue;for(var o=i(e),r="",l=0;l<e.childNodes.length&&(r+=n(e.childNodes[l],t,a),!a.found);)l++;return o?""+o+r+o:r}function r(e,t,a){for(var o=0;o<e.length;o++){var n=e[o];if(n.offsetLeft-a>=t)break;if(n.offsetLeft-a+n.clientWidth>=t)return o}return-1}function i(e){switch(e.tagName){case"CODE":return"```";case"STRONG":return"*";case"EM":return"_";case"DEL":return"~";default:return""}}function l(e,t){for(var a=0,o=e.childNodes,n=0;n<o.length;n++){var r=o[n];if(r===t)break;a+=r.clientWidth}return a}Object.defineProperty(t,"__esModule",{value:!0}),t.EMOJI_SIZE=void 0;var s=a(5),u=o(s),c=a(2),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(12),_=o(g),v=a(23),b=o(v),y=a(488),E=o(y),S=a(71),C=o(S),M=a(3),k=o(M),w=a(46),N=o(w),T=a(39),P=o(T),I=a(127),R=o(I),A=a(28),x=a(516),O=a(95),D=t.EMOJI_SIZE={SMALL:"SMALL",LARGE:"LARGE"},L=4096,U=function(e){function t(){var e,a,o,i;(0,d["default"])(this,t);for(var s=arguments.length,c=Array(s),f=0;s>f;f++)c[f]=arguments[f];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(c))),o.state={text:(0,O.removeFEOF)(o.props.text||""),ellipsified:null},o.registeredListener=!1,o.registerResizeListener=function(){o.registeredListener||(o.registeredListener=!0,o.props.listeners.add(window,"resize",o.recompute),o.props.listeners.add(_["default"],"resize",o.recompute))},o.unregisterResizeListener=function(){o.registeredListener&&(o.registeredListener=!1,o.props.listeners.remove(window,"resize",o.recompute),o.props.listeners.remove(_["default"],"resize",o.recompute))},o.containsEmoji=function(){return(0,O.containsEmoji)((o.state.text||"").substring(0,L))},o.recompute=o.props.debounce(function(){o.setState({ellipsified:null},o.ellipsify)},10),o.ellipsifyCheck=function(){return o.containsEmoji()&&o.ellipsify()},o.ellipsify=function(){var e=N["default"].findDOMNode(o);if(e){var t=e.querySelectorAll("img");if(t.length){var a=void 0,i=0;if(a=e.clientWidth){if(a===e.scrollWidth)return;i=0}else{var s=e.parentNode;if(s.clientWidth===s.scrollWidth)return;i=l(s,e),a=s.clientWidth-i}var u=l10n.isRTL()===o.props.dirMismatch,c=8,d=r(t,u?a-c:c,u?i:0,u),f=void 0;if(d>=0)f=t[d];else{var p=r(t,u?a:0,u?i:0,u);if(0>p)return;f=t[p]}o.setState({ellipsified:n(e,f)})}}},o.componentWillMount=function(){A.isWebkit&&o.props.ellipsify&&o.containsEmoji()&&o.registerResizeListener()},o.componentDidMount=function(){A.isWebkit&&o.props.ellipsify&&o.props.listeners.uiIdle(o.ellipsifyCheck)},o.componentWillReceiveProps=function(e){var t=e.text,a=(0,O.removeFEOF)(t);o.setState({text:a});var n=o.props.ellipsify;if(A.isWebkit&&n&&a!==o.state.text){var r=(a||"").substring(0,L);(0,O.containsEmoji)(r)?(o.recompute(),o.registerResizeListener()):(o.setState({ellipsified:null}),o.unregisterResizeListener())}},o.render=function(){if(!o.state.text)return null;var e=o.props,t=e.onClick,a=e.ellipsify,n=e.dirMismatch,r=e.inlineblock,i=e.direction,l=e.textLimit,s=o.state.ellipsified?o.state.ellipsified:o.state.text,u="inherit"===i?null:i||"auto",c=!!o.props.selectable,d=o.props.formatters||y.Configuration.EmojiOnly({selectable:c}),f=l?l:1/0;a&&s.length>L&&f>L&&(f=L);var p=(0,b["default"])("emojitext",o.props.className,{ellipsify:!!a,inlineblock:!!r,"emoji-text-clickable":!!t,"inverse-text-direction":n});return k["default"].createElement(P["default"],{className:p,dir:u,element:o.props.element,selectable:c,title:o.props.titlify?o.state.text:void 0,onClick:t},(0,E["default"])(s,d,x.JSXSerializer,void 0,f),o.state.ellipsified||s.length>f?"":null)},i=a,(0,p["default"])(o,i)}return(0,m["default"])(t,e),t}(k["default"].PureComponent);U.defaultProps={element:"span",emojiSize:D.SMALL,textLimit:1/0},t["default"]=(0,C["default"])((0,R["default"])(U))},7120:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(23),m=o(h),g=a(3),_=o(g),v=a(275),b=o(v),y=a(510),E=o(y),S=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.className,o=e.onDrop,n=e.onDragChange,r=e.theme,i=(0,m["default"])("drawer",a,{"drawer-settings":"settings"===r});return o?_["default"].createElement(E["default"],{className:i,onDragChange:n,onDrop:o,disableFromWithin:!0},t):_["default"].createElement(b["default"],{className:i},t)}}]),t}(g.PureComponent);t["default"]=S},7121:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(48),l=o(i),s=a(57),u=o(s),c=a(5),d=o(c),f=a(2),p=o(f),h=a(4),m=o(h),g=a(7),_=o(g),v=a(6),b=o(v),y=a(3),E=o(y),S=a(23),C=o(S),M=a(7601),k=o(M),w=function(e){function t(){return(0,p["default"])(this,t),(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).apply(this,arguments))}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.overflow,a=e.children,o=(0,u["default"])(e,["overflow","children"]),n=(0,C["default"])(k["default"].container,(0,l["default"])({},k["default"].noscroll,"hidden"===t));return E["default"].createElement("div",(0,r["default"])({className:n},o),a)}}]),t}(E["default"].Component);t["default"]=w},7122:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DRAWER_HEADER_TYPE=void 0;var n=a(3),r=o(n),i=a(176),l=o(i),s=a(23),u=o(s),c=a(7149),d=a(126),f=o(d),p=a(172),h=o(p),m=t.DRAWER_HEADER_TYPE={SMALL:"small",LARGE:"large",POPUP:"popup",OFFSET:"offset"},g=function(e){var t=e.title,a=e.onBack,o=e.onCancel,n=e.type,i=e.children,s=e.menu,d=n===m.SMALL?"back":"back-light",p=a?r["default"].createElement("button",{className:"btn-close-drawer","data-a8n":l["default"].key("btn-closer-drawer"),onClick:a},r["default"].createElement(h["default"],{name:d,directional:!0})):null,g=n===m.SMALL?"x":"x-light",_=o?r["default"].createElement("button",{className:"btn-close-drawer","data-a8n":l["default"].key("btn-closer-drawer"),onClick:o},r["default"].createElement(h["default"],{name:g})):null,v=(0,u["default"])("drawer-title",{"pane-header":n===m.LARGE}),b=s?r["default"].createElement("span",{className:"pane-list-controls"},r["default"].createElement(c.MenuBar,{key:"drawer-header"},r["default"].createElement(f["default"],{transitionName:"btn"},s))):null,y=(0,u["default"])({"drawer-header":n===m.LARGE,"drawer-header-small":n===m.SMALL,"drawer-header-offset":n===m.OFFSET,"drawer-header-popup":n===m.POPUP});return r["default"].createElement("header",{className:y},r["default"].createElement("div",{className:v},r["default"].createElement("div",{className:"drawer-title-action"},p,_),r["default"].createElement("span",{"data-a8n":l["default"].key("drawer-title-body"),className:"drawer-title-body"},t||i),b))};t["default"]=g},7123:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){switch(e){case A.SMALL:return 49;case A.MEDIUM:return 100;case A.LARGE:return 200;case A.NONE:return;default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7),f=o(d),p=a(6),h=o(p);t.getSize=n;var m=a(267),g=o(m),_=a(7153),v=(o(_),a(7118)),b=o(v),y=a(487),E=a(7226),S=o(E),C=a(172),M=o(C),k=a(7222),w=o(k),N=a(23),T=a(3),P=a(32),I=a(14),R=a(180),A={SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE",AUTO:"AUTO",NONE:"NONE"},x={LOW:"LOW",HIGH:"HIGH"},O=function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));a.state={loading:!0,loaded:!1},a.onLoad=function(e){a.setState({loading:!1,loaded:!0}),a.props.onLoad&&a.props.onLoad()},a.onError=function(e){e instanceof I.ServerStatusError&&a.props.profilePicThumb.onError(e.status),a.setState({loading:!1,loaded:!1})};var o=e.profilePicThumb.imgFull;return o&&R.isCached(o)&&(a.state={loading:!1,loaded:!0}),a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.profilePicThumb,a=e.loader,o=this.state,n=o.loading,r=o.loaded,i=N("avatar-image",{"is-loaded":!n}),l=void 0;a&&n&&((0,y.unproxy)(t).stale||t.imgFull)&&(l=T.createElement(w["default"],null));var s=r?this.props.defaultIcon:this.props.defaultIcon;return T.createElement("span",null,l,T.createElement(g["default"],{src:t.imgFull,hasPrivacyChecks:!0,crossOrigin:!1,className:i,onLoad:this.onLoad,onError:this.onError}),s)}}]),t}(T.PureComponent);O.CONCERNS={profilePicThumb:["imgFull"]};var D=(0,b["default"])(O),L=function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));a.state={loading:!0,loaded:!1},a.onLoad=function(e){a.setState({loading:!1,loaded:!0}),a.props.onLoad&&a.props.onLoad()},a.onError=function(e){e instanceof I.ServerStatusError&&a.props.profilePicThumb.onError(e.status),a.setState({loading:!1,loaded:!1})};var o=e.profilePicThumb.img;return o&&R.isCached(o)&&(a.state={loading:!1,loaded:!0}),a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.profilePicThumb,a=e.loader,o=this.state,n=o.loading,r=o.loaded,i=N("avatar-image",{"is-loaded":!n}),l=void 0;a&&n&&((0,y.unproxy)(t).stale||t.img)&&(l=T.createElement(w["default"],null));var s=r?this.props.defaultIcon:this.props.defaultIcon;return T.createElement("span",null,l,T.createElement(g["default"],{src:t.img,hasPrivacyChecks:!0,crossOrigin:!1,className:i,onLoad:this.onLoad,onError:this.onError}),s)}}]),t}(T.PureComponent);L.CONCERNS={profilePicThumb:["img"]};var U=(0,b["default"])(L),F=function(e){var t=e.id,a=e.size,o=e.quality,r=e.className,i=e.loader,l=e.onClick,s=e.onLoad,u=e.quoted,c=e.square,d=e.border,f=e.waitIdle;a=a||A.SMALL,o=o||x.LOW;var p={height:n(a),width:n(a)};l&&(p.cursor="pointer");var h=N("avatar",r,{"avatar-square":c,"avatar-border":d}),m="default-user";P.isUser(t)&&!P.isPSA(t)&&u?m="default-user-square":P.isGroup(t)?m="default-group":P.isBroadcast(t)?m="default-broadcast":P.isPSA(t)&&(m="default-psa");var g=T.createElement("div",{className:"avatar-default"},T.createElement(M["default"],{name:m})),_=function(){var e=null,a=Store.ProfilePicThumb.get(t);return a&&(e=o===x.HIGH?T.createElement(D,{profilePicThumb:a,defaultIcon:g,loader:i,onLoad:s}):T.createElement(U,{profilePicThumb:a,defaultIcon:g,loader:i,onLoad:s})),T.createElement("div",{className:h,style:p,onClick:l},e)};return T.createElement(S["default"],{id:t,onComplex:_,waitIdle:f},T.createElement("div",{className:h,style:p,onClick:l},g))};F.Size=A,F.Quality=x,t["default"]=F},7124:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(1),_=o(g),v=a(10),b=o(v),y=a(126),E=o(y),S=a(23),C=o(S),M=(a(174),a(72)),k=o(M),w=a(261),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={_stack:[],_transition:"default",_activeKey:0},o.popAndUpdate=function(e,t){var a=o.state._stack;a.length<2&&o.pop(t);var n=m["default"].cloneElement(a[a.length-2],e);a[a.length-2]=n,o.pop(t)},o.push=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.props.pushTransition;o.setState({_stack:o.state._stack.concat(e),_transition:t,_activeKey:++o.state._activeKey})},o.pop=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.props.popTransition,t=b["default"].dropRight(o.state._stack);t.length?o.setState({_stack:t,_transition:e,_activeKey:--o.state._activeKey}):o.end()},o.end=function(e){o.context.uim.uie.requestDismiss(e)},o.requestFocus=function(){b["default"].noop},o.getRef=function(e){o.uieElement=e},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"handleRequestDismiss",value:function(e){this.pop()}},{key:"render",value:function(){var e=this.state,t=e._stack,a=e._transition,o=e._activeKey,n=b["default"].last(t);_["default"].assert(!!n,"empty-flow",n)(),n=m["default"].createElement(N["default"],{displayName:"FlowDrawer"+o,key:o,escapable:!0,ref:this.getRef,requestFocus:this.requestFocus,requestDismiss:this.handleRequestDismiss.bind(this)},n);var r=(0,C["default"])("flow-drawer-container");return m["default"].createElement(E["default"],{transitionName:a,className:r},this.props.removeTopDrawer?n:t)}}]),t}(h.Component);T.contextTypes={uim:m["default"].PropTypes.instanceOf(k["default"])},T.defaultProps={removeTopDrawer:!0,pushTransition:"flow-transition-drawer-push",popTransition:"flow-transition-drawer-pop"},t["default"]=T},7125:function(e,t,a){"use strict";function o(e,t){this.list=e,this.index=-1,this.value=void 0,this.getter=t||function(e){return e}}var n=a(77);_.assign(o.prototype,n,{init:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=void 0,o=void 0;if(this.list=e,this.value){if(_.isEmpty(e))return void this.unset();if(a=_.indexOf(e,this.value),a>-1){if(a===this.index)return;o=!0,t=!1}else a=t&&this.index>-1?Math.min(Math.max(this.index,0),e.length-1):-1,o=a>-1;this.set(a,t,o)}},unset:function(){this.value&&this.trigger(this.getter(this.value),!1),this.value=void 0,this.index=-1},reset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=arguments[1];this.index<0||this.value&&this.trigger(this.getter(this.value),"focus",e,t)},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,o=arguments[3];if(this.list.length){var n=Math.min(Math.max(e,-1),this.list.length-1),r=this.value,i=n>-1?this.list[n]:void 0;i?(this.trigger(this.getter(i),t?"focus":"select",void 0,o),this.value=i):a&&(this.value=void 0),a&&r&&r!==i&&this.trigger(this.getter(r),!1,void 0,o),this.index=n}},getVal:function(){return this.value},setVal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=_.indexOf(this.list,e);a>-1?this.set(a,t):(this.unset(),this.value=e)},setFirst:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=arguments[1];_.isEmpty(this.list)||this.set(0,e,!0,t)},setLast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=arguments[1];_.isEmpty(this.list)||this.set(this.list.length-1,e,!0,t)},setPrev:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=arguments[1];_.isEmpty(this.list)||this.set(this.prev(),e,!0,t)},setNext:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0,t=arguments[1];_.isEmpty(this.list)||this.set(this.next(),e,!0,t)},prev:function(){return _.isEmpty(this.list)?-1:-1===this.index?-1:this.index-1},next:function(){return _.isEmpty(this.list)?-1:Math.min(this.index+1,this.list.length-1)}}),e.exports=o},7126:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){var e=a(7252);S["default"].openDrawerLeft(c["default"].createElement(e,null))}Object.defineProperty(t,"__esModule",{value:!0}),t.LoadingWithText=t.Loading=t.ImageSearchEmpty=t.SearchingImages=t.BeforeImageSearch=t.DocMsgs=t.LinkMsgs=t.MediaMsgs=t.StarredMsgs=t.AllArchived=t.ListStatus=t.BeforeSearchMessages=t.ListGroups=t.ListContacts=t.ListChats=t.SearchMessagesUnavailable=t.SearchMessages=t.SearchGroups=t.SearchContacts=t.SearchingMessages=t.Searching=t.Search=t.Archived=t.Blocked=void 0;var r=a(24),i=o(r),l=a(57),s=o(l),u=a(3),c=o(u),d=a(175),f=o(d),p=a(176),h=o(p),m=a(23),g=o(m),_=a(7119),v=o(_),b=a(172),y=o(b),E=a(12),S=o(E),C=a(7550),M=o(C),k=function(e){var t=e.icon,a=e.title,o=e.text,n=e.a8nTitle,r=e.a8nText,l=e.className,u=e.children,d=(0,s["default"])(e,["icon","title","text","a8nTitle","a8nText","className","children"]),f=a?c["default"].createElement("div",{"data-a8n":h["default"].key(n),className:M["default"].title},a):null,p=o?c["default"].createElement("div",{"data-a8n":h["default"].key(r),className:M["default"].text},c["default"].createElement(v["default"],{text:o})):null,m=(0,g["default"])(M["default"].empty,l);return c["default"].createElement("div",(0,i["default"])({className:m},d),t,f,p,u)};t.Blocked=function(){var e=c["default"].createElement("div",{className:M["default"].icon},c["default"].createElement(y["default"],{name:"empty-blocked"}));return c["default"].createElement(k,{icon:e,title:l10n.t("blocked_empty"),text:l10n.t("add_blocked_description"),a8nTitle:"blocked-empty",a8nText:"add-blocked-description"})},t.Archived=function(){var e=c["default"].createElement("div",{className:M["default"].icon},c["default"].createElement(y["default"],{name:"empty-archived"}));return c["default"].createElement(k,{icon:e,title:l10n.t("archived_empty"),a8nTitle:"archived-empty"})},t.Search=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("search_no_chats_or_contacts"),a8nText:"search-no-chats-or-contacts"})},t.Searching=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("searching_chats_contacts_messages"),a8nText:"searching-chats-contacts-messages"})},t.SearchingMessages=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("searching_messages"),a8nText:"searching-messages"})},t.SearchContacts=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("search_no_contacts"),a8nText:"search-no-contacts"})},t.SearchGroups=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("search_no_groups"),a8nText:"search-no-groups"})},t.SearchMessages=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("search_no_messages"),a8nText:"search-no-messages"})},t.SearchMessagesUnavailable=function(){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("search_results_unavailable"),a8nText:"search-results-unavailable"})},t.ListChats=function(){return c["default"].createElement(k,{text:l10n.t("no_chats"),a8nText:"no-chats"})},t.ListContacts=function(){return c["default"].createElement(k,{text:l10n.t("no_contacts"),a8nText:"no-contacts"})},t.ListGroups=function(){return c["default"].createElement(k,{text:l10n.t("no_groups"),a8nText:"no-groups"})},t.BeforeSearchMessages=function(e){return c["default"].createElement(k,{className:M["default"].emptyTop,text:l10n.t("chat_search_prompt",{chatName:e}),a8nText:"chat-search-prompt"})},t.ListStatus=function(){return c["default"].createElement(k,null)},t.AllArchived=function(){var e=Store.Chat.filter("archive").length;return c["default"].createElement(k,{title:l10n.t("all_chats_archived"),a8nTitle:"all-chats-archived"},c["default"].createElement("div",{"data-a8n":h["default"].key("see-archived"),role:"button",onClick:n,className:M["default"].action},l10n.t("see_archived",{count:e,_plural:e})));
},t.StarredMsgs=function(){return c["default"].createElement(k,{text:l10n.t("no_starred_messages"),a8nText:"no-starred-messages"})},t.MediaMsgs=function(){return c["default"].createElement(k,{text:l10n.t("no_media"),a8nText:"no-media"})},t.LinkMsgs=function(){return c["default"].createElement(k,{text:l10n.t("no_links"),a8nText:"no-links"})},t.DocMsgs=function(){return c["default"].createElement(k,{text:l10n.t("no_docs"),a8nText:"no-docs"})},t.BeforeImageSearch=function(){return c["default"].createElement(k,{text:l10n.t("image_search_prompt"),a8nText:"image-search-prompt"})},t.SearchingImages=function(){return c["default"].createElement(k,{text:l10n.t("searching_images"),a8nText:"searching-images"})},t.ImageSearchEmpty=function(){return c["default"].createElement(k,{text:l10n.t("image_search_no_results"),a8nText:"image-search-no-results"})},t.Loading=function(){return c["default"].createElement(k,null,c["default"].createElement(f["default"],{size:50,stroke:4}))},t.LoadingWithText=function(e){var t=e.text;return c["default"].createElement(k,null,c["default"].createElement("div",{className:M["default"].spinner},c["default"].createElement(f["default"],{size:50,stroke:4})),c["default"].createElement(v["default"],{element:"div",className:M["default"].text,text:t}))}},7127:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){e.preventDefault()}Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeOptions=void 0;var r=a(181),i=o(r),l=a(24),s=o(l),u=a(48),c=o(u),d=a(5),f=o(d),p=a(2),h=o(p),m=a(4),g=o(m),_=a(7),v=o(_),b=a(6),y=o(b),E=a(3),S=o(E),C=a(46),M=o(C),k=a(173),w=o(k),N=a(176),T=o(N),P=a(23),I=o(P),R=a(72),A=o(R),x=a(10),O=o(x),D=a(71),L=o(D),U=a(174),F=a(7586),j=o(F),B=a(490),G=o(B),V=t.ThemeOptions=(0,G["default"])({COMPACT:null}),Y=function(e){function t(){var e,a,o,n;(0,h["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,v["default"])(this,(e=t.__proto__||(0,f["default"])(t)).call.apply(e,[this].concat(i))),o.state={hover:!1,focus:!1},o.onWindowFocus=function(e){o.active&&o.onFilePick()},o.onMouseEnter=function(){o.setState({hover:!0})},o.onMouseLeave=function(){o.setState({hover:!1})},o.onFocus=function(){o.setState({focus:!0})},o.onBlur=function(){o.setState({focus:!1})},o.onAction=function(e){if(e.isTrusted&&!e.repeat){var t=o.props,a=t.action,n=t.mimes;if(a){var r=a(e);if(n)return void(o.active=!0);var i=o.context.uim;i&&(r===!1&&i.pop(!1,!1),i.uie.requestDismiss())}}},o.onFilePick=function(e){if(o.props.onFilePick){o.props.onFilePick(e);var t=o.context.uim;t&&t.uie.requestDismiss()}},n=a,(0,v["default"])(o,n)}return(0,y["default"])(t,e),(0,g["default"])(t,[{key:"triggerInput",value:function(){if(this.filePicker){var e=M["default"].findDOMNode(this.filePicker);e.click()}}},{key:"componentWillMount",value:function(){this.props.mimes&&this.props.listeners.add(window,"focus",this.onWindowFocus)}},{key:"render",value:function(){var e,t=this.props,a=t.children,o=t.tooltip,r=t.type,i=t.mimes,l=t.disabled,u=void 0===l?!1:l,d=t.theme,f=this.state,p=f.hover,h=f.focus,m=(p||h)&&o?o:null,g=i?S["default"].createElement("input",{accept:i,ref:(0,U.GetRef)("filePicker",this),type:"file",multiple:!0,style:{display:"none"},onClick:function(e){return e.stopPropagation()},onChange:this.props.onFilePick}):null,_=O["default"].isString(a)?S["default"].createElement("div",{className:(0,I["default"])(j["default"].ellipsify,j["default"].action,(0,c["default"])({},j["default"].compact,d===V.COMPACT)),role:"button",title:a},a):a,v={enter:this.onAction},b=(0,I["default"])(j["default"].item,j["default"].shortcut,(e={},(0,c["default"])(e,j["default"].hover,p||h),(0,c["default"])(e,j["default"].text,"text"===r),(0,c["default"])(e,j["default"].emoji,"emoji"===r),(0,c["default"])(e,j["default"].icon,"icon"===r),(0,c["default"])(e,j["default"].disabled,u),e)),y=u?{}:{handlers:v,onContextMenu:n,onMouseDown:n,onClick:this.onAction,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onFocus:this.onFocus,onBlur:this.onBlur};return S["default"].createElement(w["default"],(0,s["default"])({component:"li","data-a8n":T["default"].key(this.props.a8n),className:b,"data-animate-dropdown-item":!0},y),_,m,g)}}]),t}(S["default"].PureComponent);Y.defaultProps={type:"text"},Y.contextTypes={uim:S["default"].PropTypes.instanceOf(A["default"])};var W=function(e){function t(){return(0,h["default"])(this,t),(0,v["default"])(this,(t.__proto__||(0,f["default"])(t)).apply(this,arguments))}return(0,y["default"])(t,e),(0,g["default"])(t,[{key:"triggerInput",value:function(){(0,i["default"])(t.prototype.__proto__||(0,f["default"])(t.prototype),"getComponent",this).call(this).triggerInput()}}]),t}((0,L["default"])(Y));t["default"]=W},7128:function(e,t,a){"use strict";function o(e,t){this.list=e,this.selected=_.reduce(e,function(e,t,a){return e[a]=!1,e},{}),this.getter=t||function(e){return e}}var n=a(77);_.assign(o.prototype,n,{init:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!_.isEmpty(this.selected)){if(_.isEmpty(t))return void this.unsetAll();var a=_.reduce(t,function(t,a,o){var n=e.list.indexOf(a);t[o]=n>-1&&e.selected[n]},{});this.selected=a,this.list=t}},unsetAll:function(){var e=this;_.forEach(this.selected,function(t,a){t&&e.set(a,!1)})},reset:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;_.forEach(this.selected,function(a,o){a&&e.trigger(e.getter(e.list[o]),!0,!0,t)})},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0;if(this.list.length){var o=Math.min(Math.max(e,-1),this.list.length-1),n=o>-1?this.list[o]:void 0;n&&(this.selected[o]&&!t||!this.selected[o]&&t)&&(this.selected[o]=t,this.trigger(this.getter(n),t,a))}},setVal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,o=_.indexOf(this.list,e);-1===o&&(o=this.list.length,this.list.push(e),this.selected[o]=!1),this.set(o,t,a)},setFirst:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;_.isEmpty(this.list)||this.set(0,!0,e)},setLast:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!0;_.isEmpty(this.list)||this.set(this.list.length-1,!0,e)},getSelected:function(){var e=this;return _.reduce(this.list,function(t,a,o){return e.selected[o]&&t.push(a),t},[])},isSelected:function(e){return!!this.selected[this.list.indexOf(e)]}}),e.exports=o},7129:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return t?e+"  "+l10n.t("status_v3"):e}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=o(r),l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(3),v=o(_),b=a(7118),y=o(b),E=a(7119),S=o(E),C=a(53),M=(o(C),a(486)),k=(o(M),a(12)),w=o(k),N=a(32),T=o(N),P=a(23),I=o(P),R=a(1),A=o(R),x=a(172),O=o(x),D=a(7575),L=o(D),U=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.onClick=function(){Store.Chat.find(o.props.msg.sender).then(function(e){w["default"].openChatFromUnread(e).then(function(t){t&&w["default"].focusChatTextInput(e)})})},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.chat,o=e.contact,r=e.quoted,l=e.disableClick,s=e.displaySelf,u=a||t.chat;A["default"].assert(u,"author-with-no-chat")();var c=u?u.assignedColor(t.sender):1,d=(0,I["default"])(L["default"].author,"color-"+c,(0,i["default"])({},L["default"].followedByQuote,t.quotedMsg&&!r)),f=l?null:this.onClick,p=void 0;return s?p=v["default"].createElement(S["default"],{text:n(l10n.t("web_you"),t.isStatusV3)}):o.name?(p=[v["default"].createElement(S["default"],{text:n(o.name,t.isStatusV3),className:L["default"].name,key:"author",onClick:f})],o.isVerified&&p.push(v["default"].createElement("div",{key:"verified",className:L["default"].verifiedIcon},v["default"].createElement(O["default"],{name:"psa-verified"})))):(p=[v["default"].createElement("span",{className:L["default"].number,role:f?"button":null,key:t.id+"-number",onClick:f},n(T["default"].formattedUser(o.id),t.isStatusV3))],t.isStatusV3||p.push(v["default"].createElement(S["default"],{className:L["default"].screenName,key:t.id+"-push-name",onClick:f,direction:"auto",ellipsify:!0,text:o.notifyName}))),v["default"].createElement("div",{className:d},p)}}]),t}(v["default"].PureComponent);U.CONCERNS={msg:["sender","chat","type","isLive","isStatusV3","id","quotedMsg"],contact:["id","name","isVerified","notifyName"]},t["default"]=(0,y["default"])(U)},7130:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(7393),y=n(b),E=a(7118),S=n(E),C=a(487),M=a(53),k=n(M),w=a(62),N=o(w),T=a(12),P=n(T),I=a(47),R=n(I),A=a(172),x=n(A),O=a(23),D=n(O),L=a(7577),U=n(L),F=k["default"].TYPE,j=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.openInfoDrawer=function(){P["default"].msgInfoDrawer((0,C.unproxy)(o.props.msg))},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=void 0,a=void 0,o=(e.type===F.IMAGE||e.type===F.VIDEO)&&!e.caption||e.type===F.LOCATION&&!e.isLive&&!e.get("loc");if(e.broadcast){var n=o?"broadcast-light":"broadcast";t=v["default"].createElement("div",{className:U["default"].icon},v["default"].createElement(x["default"],{name:n}))}if(e.star&&!e.isRevoked){var r=o?"star-light":e.isSentByMe?"star":"star-in";a=v["default"].createElement("div",{className:U["default"].icon},v["default"].createElement(x["default"],{name:r}))}var l=e.isSentByMe&&e.type!==k["default"].TYPE.REVOKED?v["default"].createElement(y["default"],{msg:this.props.msg}):null,s=e.isSentByMe&&R["default"].supportsFeature(R["default"].F.MESSAGE_INFO)&&e.type!==k["default"].TYPE.REVOKED,u=(0,D["default"])(U["default"].meta,(0,i["default"])({},U["default"].metaLight,o));return v["default"].createElement("div",{className:u,onClick:s?this.openInfoDrawer:null,role:s?"button":null},a,t,v["default"].createElement("span",{className:U["default"].timestamp},e.t?N.timestampStr(e.t):null),l)}}]),t}(v["default"].PureComponent);j.CONCERNS={msg:["t","isSentByMe","isLive","isRevoked","type","broadcast","star","caption"]},t["default"]=(0,S["default"])(j)},7131:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=h["default"].findLast(e,function(e){return e.body&&e.mediaData&&(e.type===u["default"].TYPE.IMAGE||e.type===u["default"].TYPE.VIDEO)});return t&&t.mediaData.preview}Object.defineProperty(t,"__esModule",{value:!0}),t.StatusV3Proxy=void 0;var i=a(0),l=n(i),s=a(53),u=n(s),c=a(284),d=n(c),f=a(277),p=a(10),h=n(p),m=a(62),g=o(m),_=a(513),v=a(8),b=a(1),y=a(38),E=86400,S={Collection:"StatusV3",props:{id:"string",t:"number",unreadCount:"number",totalCount:"number",pic:"object",_msgs:{type:"array","default":function(){return[]}}},session:{readKeys:{type:"object","default":function(){return{}}},contact:"object",expireTimer:"object"},derived:{renderedThumbnail:{deps:["msgsChanged","pic","totalCount"],fn:function(){return this.msgs.length===this.totalCount?r(this.msgs.models):this.pic?this.pic:r(this.msgs.models)}},lastStatus:{deps:["msgsChanged","totalCount"],fn:function(){return h["default"].last(this.msgs.models)}}},initialize:function(){var e=this;_.prototype.initialize.call(this),this.addChild("contact",Store.Contact.gadd(this.id)),this.listenTo(this.msgs,"add bulk_add",function(){e.setupStatusExpiration()}),this.listenTo(this,"change:lastStatus",function(){e.lastStatus?e.t=e.lastStatus.t:e.t=void 0})},setupStatusExpiration:function(){if(!this.expireTimer&&this.msgs.length>0){var e=this.msgs.at(0),t=1,a=e.t+E-g.globalUnixTime()+t;this.expireTimer=window.setTimeout(this.expireMsg.bind(this),1e3*a)}},expireMsg:function(){for(var e=this.msgs;e.length>0&&e.at(0).t+E<g.globalUnixTime();){var t=e.at(0);this.totalCount--,e.remove(t),t["delete"](),this.unreadCount>this.totalCount&&(this.unreadCount=this.totalCount)}this.expireTimer=void 0,this.setupStatusExpiration()},"delete":function(){_.prototype["delete"].call(this),this.expireTimer&&window.clearTimeout(this.expireTimer),Store.StatusV3.remove(this.id)},onEmptyMRM:function(){var e=this;b.log("models:StatusV3:removeMsg 0 messages left, querying...")(),this.loadMore()["catch"](function(t){404===t&&e["delete"]()})},loadMore:function(e){var t=this;if(this.msgs.msgLoadState.noEarlierMsgs)return l["default"].resolve();if(this.msgs.msgLoadState.isLoadingEarlierMsgs)return this.msgs.loadEarlierPromise;var a=e||v.PAGE_SIZE;return Store.StatusV3.loadMore(this.id,a,this.msgs.last()).then(function(e){return h["default"].isArray(e)&&e.length<a&&(t.msgs.msgLoadState.noEarlierMsgs=!0),e})["catch"](function(e){return 404===e&&t["delete"](),l["default"].reject(e)})},handleReadStatus:function(e){this.readKeys[e]||(this.readKeys[e]=!0,this.unreadCount>0?this.unreadCount--:b.error("statusv3:"+this.id+":new read key but unreadCount 0")())},sendReadStatus:function(e,t){var a=this;return y.sendStatusSeen(e,t).then(function(t){200===t.status&&a.handleReadStatus(e)})},sendMute:function(e){var t=this;return y.sendStatusMute(this.id,e).then(function(a){200===a.status&&(t.contact.statusMute=e)})}},C=(0,f.genMirrorMask)(S),M=_.extend(S,{mirrorMask:C});t["default"]=M;t.StatusV3Proxy=(0,d["default"])(S,C)},7132:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,a){var o=e.clientWidth,n=e.clientHeight,r=t,i=a,l=0,s=0;return r!==o&&(i*=o/r,r=o,i>n&&(l=n/2-i/2)),n>i&&(r*=n/i,i=n,r>o&&(s=o/2-r/2)),{style:{width:r,height:i,top:l,left:s,position:"absolute"},className:(0,k["default"])(R["default"].fit)}}function r(e,t,a){var o=e.clientWidth,n=e.clientHeight,r=t,i=a,l=0,s=0,u=r/o,c=i/n;return u>c?(i*=o/r,r=o,n>i&&(l=n/2-i/2)):(r*=n/i,i=n,o>r&&(s=o/2-r/2)),{style:{width:r,height:i,top:l,left:s,position:"absolute"},className:(0,k["default"])(R["default"].fit)}}function i(e,t,a){var o=e.clientWidth,n=e.clientHeight,r=a,i=t;return r>n&&(r=n,i=t*(n/a)),i>o&&(i=o,r=a*(o/t)),{style:{width:i,height:r},className:(0,k["default"])(R["default"].fit,R["default"].fitScaledown)}}function l(e,t,a,o){var n=i(e,t,a).style,r=void 0;return r=o?{width:n.width,height:n.height,transition:A,transform:"translateX("+o.translateX+"px) translateY("+o.translateY+"px) scale("+o.factor+")"}:{width:n.width,height:n.height,transition:A},{style:r,className:(0,k["default"])(R["default"].fit,R["default"].fitScaledown,R["default"].fitZoomin)}}Object.defineProperty(t,"__esModule",{value:!0}),t.FIT_TYPE=void 0;var s=a(48),u=o(s),c=a(5),d=o(c),f=a(2),p=o(f),h=a(4),m=o(h),g=a(7),_=o(g),v=a(6),b=o(v),y=a(3),E=o(y),S=a(46),C=o(S),M=a(23),k=o(M),w=a(71),N=o(w),T=a(1),P=o(T),I=a(7561),R=o(I),A=(t.FIT_TYPE={CONTAIN:"contain",COVER:"cover",SCALE_DOWN:"scaleDown",ZOOM_IN:"zoomIn"},"transform 300ms cubic-bezier(.1,.82,.25,1)");t["default"]=(0,N["default"])(function(e){function t(e){(0,p["default"])(this,t);var a=(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.onObjectLoad=function(){var e=a.props.onObjectLoad;e&&e(a.refs.object.firstChild)},a.state={style:{visibility:"hidden"},className:(0,k["default"])(R["default"].fit)},a}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.shouldUseNativeObjectFit()||(this.initialize(this.props),this.props.listeners.add(window,"resize",function(){e.initialize(e.props)}))}},{key:"componentWillReceiveProps",value:function(e){this.shouldUseNativeObjectFit()||this.initialize(e)}},{key:"initialize",value:function(e){var t=e.size,a=e.type;if(t){var o=C["default"].findDOMNode(this),s=void 0;switch(a){case"contain":s=r(o,t.width,t.height);break;case"cover":s=n(o,t.width,t.height);break;case"scaleDown":s=i(o,t.width,t.height);break;case"zoomIn":s=l(o,t.width,t.height,e.zoomIn);break;default:return void P["default"].assert(!1,"object-fit","unrecognized type "+a)()}this.setState(s,this.onObjectLoad)}}},{key:"shouldUseNativeObjectFit",value:function(){return!1}},{key:"render",value:function(){if(this.shouldUseNativeObjectFit())return E["default"].createElement("div",{className:R["default"].nativeScaleDown},this.props.children);var e=this.props,t=this.state,a=(0,k["default"])(t.className,(0,u["default"])({},R["default"].fitRelative,"relative"===e.position));return E["default"].createElement("div",{className:a},E["default"].createElement("div",{style:t.style,ref:"object"},e.children))}}]),t}(y.Component))},7133:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.theme?s["default"][e.theme]:null,a=e.color?s["default"][e.color]:null,o=(0,c["default"])(t,a);return e.block?i["default"].createElement("div",{className:o},e.children):i["default"].createElement("span",{className:o},e.children)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7570),s=o(l),u=a(23),c=o(u)},7134:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(12),b=o(v),y=a(94),E=o(y),S=a(93),C=o(S),M=a(53),k=o(M),w=a(7118),N=o(w);t["default"]=(0,N["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=void 0,t=void 0;switch(this.props.msg.type){case k["default"].TYPE.VIDEO:this.props.msg.isGif?(e=C["default"].t("missing_gif_title"),t=C["default"].t("missing_gif_text")):(e=C["default"].t("missing_video_title"),t=C["default"].t("missing_video_text"));break;case k["default"].TYPE.AUDIO:e=C["default"].t("missing_audio_title"),t=C["default"].t("missing_audio_text");break;case k["default"].TYPE.IMAGE:e=C["default"].t("missing_photo_title"),t=C["default"].t("missing_photo_text");break;case k["default"].TYPE.DOCUMENT:e=C["default"].t("missing_document_title"),t=C["default"].t("missing_document_text")}return _["default"].createElement(E["default"],{title:e,onOK:function(){b["default"].closeModal()},okText:C["default"].t("web_ok")},t)}}]),t}(_["default"].PureComponent),n.CONCERNS={msg:["type","isGif"]},r))},7135:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.Type=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(176),b=o(v),y=a(486),E=o(y),S=a(7156),C=(o(S),a(7146)),M=o(C),k=a(7123),w=o(k),N=a(7217),T=o(N),P=a(7125),I=(o(P),a(7118)),R=o(I),A=a(487),x=a(71),O=o(x),D=a(23),L=o(D),U=a(7119),F=o(U),j=a(7139),B=o(j),G=a(177),V=o(G),Y=a(173),W=o(Y),H=a(174),q=a(7143),z=o(q),K=a(172),Q=o(K),J=a(264),X=o(J),Z=t.Type={SMALL:"SMALL",DEFAULT:"DEFAULT"},$=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onSearch=function(){o.setState({searchText:o.props.searchQuery.trimmed})},o.onActiveChange=function(e,t,a){if("focus"===e){var n=_["default"].findDOMNode(o);V["default"].focus(n,a),t&&B["default"].scrollIntoViewIfNeeded(n)}o.setState({active:!!e})},o.onDelete=function(e){e.stopPropagation(),o.props.onDelete&&o.props.onDelete(e,(0,A.unproxy)(o.props.contact))},o.onClick=function(e){o.props.onClick&&o.props.onClick(e,(0,A.unproxy)(o.props.contact))},o.onMouseDown=function(e){0===e.button&&o.onClick(e)},o.onEnter=function(e){e.preventDefault(),e.stopPropagation(),o.onClick(e)},o.onContext=function(e){return o.state.contextMenu?void o.setState({contextMenu:!1}):(o.props.onContext&&o.props.onContext(e,o.props.contact,o.onContextClose),void o.setState({contextMenu:!0}))},o.onContextClose=function(){o.setState({contextMenu:!1})},o.indicateFocus=function(e){e.stopPropagation(),e.preventDefault(),(0,Y.indicateFocus)(o.cell,["#e9eaeb","#cbdde7"],{complete:o.onBlur})},o.onBlur=function(e){var t=_["default"].findDOMNode(o.cell);t&&((0,X["default"])(t,"stop"),t.style.backgroundColor="")},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.setState({contextMenu:!1}),this.initListeners(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.initListeners(e,this.props)}},{key:"initListeners",value:function(e,t){var a=e.listeners,o=e.active,n=e.contact,r=e.searchQuery;t&&t.searchQuery&&t.searchQuery!==r&&a.remove(r,S.SEARCH_EVENT,this.onSearch),!r||t&&r===t.searchQuery||a.add(r,S.SEARCH_EVENT,this.onSearch);var i=t&&t.contact.id;n.id!==i&&(t&&t.active&&a.remove(t.active,t.contact.id,this.onActiveChange),o&&a.add(o,n.id,this.onActiveChange));var l=o&&o.value instanceof E["default"]&&n.isProxyOf(o.value);this.setState({searchText:r?r.trimmed:"",active:l})}},{key:"contextEnabled",value:function(){return!1}},{key:"render",value:function(){var e=this.props,t=e.contact,a=e.secondary,o=e.onContext,n=e.onDelete,r=e.contextEnabled,i=e.contextMenu,l=e.admin,s=e.showNotifyName,u=e.className,c=e.waitIdle,d=e.theme,f=this.state,p=f.active,h=f.searchText,g=(0,L["default"])("contact",u,{active:!!p}),_=void 0,v=void 0,y=void 0;if(!t.name&&s&&t.notifyName&&(y=m["default"].createElement("span",{className:"ellipsify screen-name"},m["default"].createElement(F["default"],{className:"screen-name-text",direction:"auto",text:t.notifyName}))),l&&(v=m["default"].createElement("div",{className:"contact-marker-admin"},l10n.t("web_group_admin"))),n){var E=this.props.type===Z.SMALL?"x-alt-small":"x-alt";_=m["default"].createElement("div",{"data-a8n":b["default"].key("chat-controls"),className:"chat-controls"},m["default"].createElement(Q["default"],{name:E,onClick:this.onDelete}))}var S=a;!S&&Store.ServerProps.statusV2&&(S=m["default"].createElement(T["default"],{status:t.status,waitIdle:c}));var C=void 0;o&&(C=this.onContext);var k=this.props.type===Z.SMALL?26:null,N={enter:this.onEnter},P=this.props.mouseDownAsClick,I=m["default"].createElement(z["default"],{contact:t,highlightText:h,titlify:!0,ellipsify:!0,you:!0});return m["default"].createElement(W["default"],{handlers:N,onFocus:this.indicateFocus,onBlur:this.onBlur},m["default"].createElement(M["default"],{id:t.id,ref:(0,H.GetRef)("cell",this),className:g,theme:d,contextEnabled:r||this.contextEnabled,contextMenu:i,pendingAction:t.pendingAction,detail:_,image:m["default"].createElement(w["default"],{id:t.id,size:k,waitIdle:c}),primary:I,primaryDetail:v,secondary:S,secondaryDetail:y,onClick:P?null:this.onClick,onMouseDown:P?this.onMouseDown:null,onContext:C}))}}]),t}(m["default"].Component);$.CONCERNS={contact:["id","status","pendingAction","notifyName","name"]};t.Component=$;t["default"]=(0,O["default"])((0,R["default"])($))},7136:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_NUM_SECTIONS=t.DEFAULT_EXTRA_ITEMS=t.DEFAULT_SCROLL_TOP=t.DEFAULT_SECTION_HEIGHT=t.DEFAULT_ITEM_HEIGHT=t.SCROLL_OFFSET_ATTR=t.SCROLL_ATTR=void 0;var n=a(181),r=o(n),i=a(521),l=o(i),s=a(182),u=o(s),c=a(5),d=o(c),f=a(2),p=o(f),h=a(4),m=o(h),g=a(7),_=o(g),v=a(6),b=o(v),y=a(3),E=o(y),S=a(46),C=o(S),M=a(23),k=o(M),w=a(10),N=o(w),T=a(7554),P=o(T),I=a(71),R=o(I),A=a(7210),x=o(A),O=a(7170),D=o(O),L=a(7340),U=o(L),F=a(496),j=o(F),B=a(7339),G=o(B),V=t.SCROLL_ATTR="data-list-scroll-container",Y=t.SCROLL_OFFSET_ATTR="data-list-scroll-offset",W=t.DEFAULT_ITEM_HEIGHT=72,H=t.DEFAULT_SECTION_HEIGHT=72,q=(t.DEFAULT_SCROLL_TOP=0,t.DEFAULT_EXTRA_ITEMS=5),z=(t.DEFAULT_NUM_SECTIONS=0,new D["default"](0,0)),K=function(e){function t(){var e,a,o,n;(0,p["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,_["default"])(this,(e=t.__proto__||(0,d["default"])(t)).call.apply(e,[this].concat(i))),o.state={firstPhysicalIndexPath:z,lastPhysicalIndexPath:z},o.scrollTop=0,o.offsetTop=0,o.bodyHeight=0,o.listHeight=0,o.pointerEvents=!0,o.metaMap={},o.prevMetaMap={},o.enablePointerEvents=N["default"].debounce(function(){return o.animationFrame?o.enablePointerEvents():(j["default"].clearBusy(o.busyId),delete o.busyId,o.props.onPointerEventsOn&&o.props.onPointerEventsOn(),C["default"].findDOMNode(o.refs.viewport).style.pointerEvents="auto",void(o.pointerEvents=!1))},150),o.onScroll=function(){o.animationFrame?o.hanging=!0:(o.hanging=!1,o.animationFrame=window.requestAnimationFrame(o._onScroll))},o._onScroll=function(){o.disablePointerEvents(),o.scrollTarget&&(o.scrollTop=o.scrollTarget.scrollTop);var e=o.getPhysicalIndexPaths(o.props),t=e.firstPhysicalIndexPath,a=e.lastPhysicalIndexPath;return t.equals(o.state.firstPhysicalIndexPath)&&a.equals(o.state.lastPhysicalIndexPath)?o._onFinishScroll():void o.setState({firstPhysicalIndexPath:t,lastPhysicalIndexPath:a},o._onFinishScroll)},o._onFinishScroll=function(){o.animationFrame=void 0,o.enablePointerEvents(),o.hanging&&o.onScroll()},n=a,(0,_["default"])(o,n)}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillReceiveProps",value:function(e){void 0!==e.scrollTop&&this.scrollTarget&&(this.scrollTarget.scrollTop=e.scrollTop),this.props.scrollTarget===e.scrollTarget&&this.initialize()}},{key:"componentDidUpdate",value:function(e,t){var a=this.state,o=a.firstPhysicalIndexPath,n=a.lastPhysicalIndexPath;o.equals(t.firstPhysicalIndexPath)&&n.equals(t.lastPhysicalIndexPath)&&this.componentDidReceiveProps(e)}},{key:"componentDidReceiveProps",value:function(e){this.props.scrollTarget!==e.scrollTarget&&(this.getTargets(this.props),this.initialize())}},{key:"componentDidMount",value:function(){var e=this;this.getTargets(this.props),this.initialize(this.props),this.props.listeners.add(window,"resize",function(){if(!e.scrollTarget)throw new Error("Invalid ScrollTarget!");e.bodyHeight=e.scrollTarget.clientHeight,e.initialize(e.props)})}},{key:"componentWillUnmount",value:function(){this.cancelScroll(),this.enablePointerEvents.cancel()}},{key:"getTargets",value:function(e){if(this.scrollTarget){var t=x["default"]?{passive:!0}:void 0;this.props.listeners.remove(this.scrollTarget,"scroll",this.onScroll,t)}for(var a=C["default"].findDOMNode(this),o=void 0,n=a,r=0;5>r;r++){if(n instanceof HTMLElement&&n.hasAttribute(V)){o=n;break}n=n&&n.parentNode}if(!o)throw new Error("Invalid ScrollTarget!");var i=x["default"]?{passive:!0}:void 0;this.props.listeners.add(o,"scroll",this.onScroll,i),this.scrollTarget=o,this.scrollTop=this.scrollTarget.scrollTop,this.bodyHeight=this.scrollTarget.clientHeight;var l=void 0;n=a;for(var s=0;r>s;s++){if(n instanceof HTMLElement&&n.hasAttribute(Y)){l=n;break}n=n&&n.parentNode}this.offsetTarget=l,this.offsetTop=l?l.offsetTop:0}},{key:"initialize",value:function(e){var t=this,a=e?e:this.props;this.cancelScroll(),this.setMetaMap(a),this.setState(this.getPhysicalIndexPaths(a),function(){t.prevMetaMap={}})}},{key:"setMetaMap",value:function(e){var t=e.heightForItem,a=e.heightForSection,o=e.sectionForSection,n=e.numberOfSections,r=e.numberOfRowsInSection,i=e.keyForRowAtIndexPath;this.prevMetaMap=this.metaMap,this.metaMap={};for(var l=0,s=0,u=n(),c=0;u>c;c++){o(c)&&(this.metaMap["section_"+c]={indexPath:c,globalOffset:l,globalIndex:s},l+=a(c),s++);for(var d=0;d<r(c);d++){var f=new D["default"](d,c),p=i(f);this.metaMap[p]={indexPath:f,globalIndex:s,globalOffset:l},l+="number"==typeof t?t:t(f),s++,c===u-1&&d===r(c)-1&&(this.listHeight=l)}}}},{key:"numberOfItems",value:function(){var e=this.props,t=e.numberOfSections,a=e.numberOfRowsInSection,o=e.keyForRowAtIndexPath,n=t()-1,r=a(n)-1,i=new D["default"](r,n);return this.metaMap[o(i)].globalIndex+1}},{key:"getIndexPathAtIndexPathWithOffset",value:function(e,t,a,o){for(var n=o.keyForRowAtIndexPath,r=D["default"].indexPathIterator(o,e),i=this.metaMap[n(e)].globalOffset,l=void 0,s=void 0;l=r.next();){var u=n(l);if(this.metaMap[u].globalOffset-i>=t)return a?s||l:r.next()||l;s=l}if(!s)throw new Error("getIndexPathAtIndexPathWithOffset");return s}},{key:"getFirstVisibleIndexPath",value:function(e){var t=Math.max(this.scrollTop-this.offsetTop,0),a=new D["default"](0,0);return this.getIndexPathAtIndexPathWithOffset(a,t,!0,e)}},{key:"getLastVisibleIndexPath",value:function(e,t){var a=Math.min(this.bodyHeight,this.listHeight);return this.getIndexPathAtIndexPathWithOffset(e,a,!1,t)}},{key:"getPhysicalIndexPaths",value:function(e){for(var t=this.getFirstVisibleIndexPath(e),a=this.getLastVisibleIndexPath(t,e),o=D["default"].indexPathIterator(e,t),n=D["default"].indexPathIterator(e,a),r=void 0,i=void 0,l=e.extraItems;l--;){var s=o.prev();s&&(r=s),s=n.next(),s&&(i=s)}return{firstPhysicalIndexPath:r,lastPhysicalIndexPath:i}}},{key:"cancelScroll",value:function(){this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0,this.hanging=!1)}},{key:"disablePointerEvents",value:function(){this.busyId=j["default"].setBusy(this.busyId),this.pointerEvents||(this.props.onPointerEventsOff&&this.props.onPointerEventsOff(),C["default"].findDOMNode(this.refs.viewport).style.pointerEvents="none",this.pointerEvents=!0)}},{key:"scrollIntoViewIfNeeded",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this.props.keyForRowAtIndexPath(e),o=this.metaMap[a].globalOffset;this.scrollTarget&&(o<this.scrollTop-t||o>this.scrollTop+this.bodyHeight+t)&&(this.scrollTarget.scrollTop=o)}},{key:"getHeight",value:function(e){var t=this.props,a=t.heightForItem,o=t.heightForSection,n=this.metaMap[e],r=n.indexPath instanceof D["default"]?a:o;return"number"==typeof r?r:r(n.indexPath)}},{key:"boundGlobalOffset",value:function(e,t,a){return e&&t&&a?Math.min(t.globalOffset,Math.max(e.globalOffset,a.globalOffset)):void 0}},{key:"getAndUpdateRctKey",value:function(e,t,a){var o=this.prevMetaMap[e],n=this.metaMap[e],r=void 0;if(o&&"rctKey"in o){if(r=o.rctKey,"number"!=typeof r)throw new Error("List:rctKey must be defined.")}else if("rctKey"in n)r=n.rctKey;else{if(!(t.length>0))throw new Error("No free keys!");if(r=t.shift(),"number"!=typeof r)throw new Error("List:rctKey must be defined.")}return n.rctKey=r}},{key:"getComponents",value:function(){var e=this,t=this.props,a=t.itemForRowAtIndexPath,o=t.keyForRowAtIndexPath,n=t.sectionForSection;if(N["default"].size(this.metaMap)){for(var r=this.state,i=r.firstPhysicalIndexPath,s=r.lastPhysicalIndexPath,c=void 0,d=D["default"].indexPathIterator(this.props,i,s),f=new u["default"];c=d.next();){if(0===c.row){var p="section_"+c.section;p in this.metaMap&&f.set(p,n(c.section))}var h=o(c);h in f||f.set(h,a(c))}for(var m=N["default"].isEmpty(this.prevMetaMap)?this.metaMap:this.prevMetaMap,g={},_=0;_<f.size;_++)g[_]=_;for(var v in m){var b=m[v];"rctKey"in b&&(f.has(v)?delete g[b.rctKey]:delete b.rctKey)}var y=(0,l["default"])(g),S=new Array(f.size),C=this.numberOfItems(),M=this.metaMap[o(i)],k=this.metaMap[o(s)];return f.forEach(function(t,a){var o=e.metaMap[a],n=e.getAndUpdateRctKey(a,y,f.size),r=e.boundGlobalOffset(M,k,e.prevMetaMap[a]);
S[n]=E["default"].createElement(U["default"],{key:n,dataKey:a,animate:G["default"].shouldAnimate,rowHeight:e.getHeight(a),zIndex:C-o.globalIndex-1,rowOffset:o.globalOffset,prevRowOffset:r},t)}),S}}},{key:"render",value:function(){return E["default"].createElement("div",{className:(0,k["default"])(this.props.className)},E["default"].createElement("div",{className:P["default"].viewport,ref:"viewport",style:{height:this.listHeight}},this.getComponents()))}}]),t}(E["default"].Component);K.defaultProps={extraItems:q,animate:!1,numberOfSections:function(){return 1},heightForItem:W,heightForSection:function(e){return H},stickyHeaders:!1};var Q=function(e){function t(){return(0,p["default"])(this,t),(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).apply(this,arguments))}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"scrollIntoViewIfNeeded",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,r["default"])(t.prototype.__proto__||(0,d["default"])(t.prototype),"getComponent",this).call(this).scrollIntoViewIfNeeded(e,a)}}]),t}((0,R["default"])(K));t["default"]=Q},7137:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(12),_=o(g),v=a(3),b=o(v),y=a(72),E=o(y),S=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){var e=this,t=(0,r["default"])({},this.props.contextMenu,{uim:this.context.uim});_["default"].openContextMenu(t,function(t){return e.element=t})}},{key:"componentWillUnmount",value:function(){_["default"].closeContextMenu(this.context.uim)}},{key:"getElement",value:function(){return this.element}},{key:"render",value:function(){return null}}]),t}(v.Component);S.contextTypes={uim:b["default"].PropTypes.instanceOf(E["default"])},t["default"]=S},7138:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(12),b=o(v),y=a(94),E=o(y),S=a(93),C=o(S),M=a(53),k=o(M),w=a(7118),N=o(w);t["default"]=(0,N["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=void 0,t=void 0;switch(this.props.msg.type){case k["default"].TYPE.IMAGE:e=C["default"].t("retry_upload_photo_title"),t=C["default"].t("retry_upload_photo_text");break;case k["default"].TYPE.VIDEO:e=C["default"].t("retry_upload_video_title"),t=C["default"].t("retry_upload_video_text");break;case k["default"].TYPE.AUDIO:case k["default"].TYPE.PTT:e=C["default"].t("retry_upload_audio_title"),t=C["default"].t("retry_upload_audio_text");break;case k["default"].TYPE.DOCUMENT:e=C["default"].t("retry_upload_doc_title"),t=C["default"].t("retry_upload_doc_text");break;default:e=C["default"].t("retry_upload_media_title"),t=C["default"].t("retry_upload_media_text")}return _["default"].createElement(E["default"],{title:e,onOK:function(){b["default"].closeModal()},okText:C["default"].t("web_ok")},t)}}]),t}(_["default"].PureComponent),n.CONCERNS={msg:["type"]},r))},7139:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(264),l=o(i),s={scrollIntoViewIfNeeded:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=arguments[2];if(_.isFunction(e.scrollIntoViewIfNeeded))return e.scrollIntoViewIfNeeded(t);a=a||e.parentNode;var o=window.getComputedStyle(a,null),n=parseInt(o.getPropertyValue("border-top-width")),r=e.offsetTop-a.offsetTop<a.scrollTop,i=e.offsetTop-a.offsetTop+e.clientHeight-n>a.scrollTop+a.clientHeight,l=r&&!i;return(r||i)&&t&&(a.scrollTop=e.offsetTop-a.offsetTop-a.clientHeight/2-n+e.clientHeight/2),!r&&!i||t||e.scrollIntoView(l),!(r||i)},scrollIntoView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,a=arguments[2];a=a||e.parentNode;var o=window.getComputedStyle(a,null),n=parseInt(o.getPropertyValue("border-top-width")),r=e.offsetTop-a.offsetTop<a.scrollTop,i=e.offsetTop-a.offsetTop+e.clientHeight-n>a.scrollTop+a.clientHeight,l=r&&!i;return t?a.scrollTop=e.offsetTop-a.offsetTop-a.clientHeight/2-n+e.clientHeight/2:e.scrollIntoView(l),!(r||i)},scrollAt:function(e,t,a){a=a||{};var o=a.pos||"center",n=a.duration||1e3;t=t||e.offsetParent;var i=a.offset||0;switch(o){case"top":return t.scrollTop=e.offsetTop+i,r["default"].resolve();case"bottom":return t.scrollTop=e.offsetTop+e.clientHeight-t.clientHeight,r["default"].resolve();case"center":return a.animate?((0,l["default"])(e,"stop"),(0,l["default"])(t,"stop"),(0,l["default"])(e,"scroll",{duration:n,container:t,offset:(e.clientHeight-t.clientHeight)/2,easing:a.easing})):(t.scrollTop=e.offsetTop+e.clientHeight/2-t.clientHeight/2,r["default"].resolve());case"offset":return a.animate?((0,l["default"])(e,"stop"),(0,l["default"])(t,"stop"),(0,l["default"])(e,"scroll",{duration:n,container:t,offset:-i,easing:a.easing})):(t.scrollTop=e.offsetTop-i,r["default"].resolve())}return r["default"].resolve()}};e.exports=s},7140:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(181),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(176),E=o(y),S=a(127),C=o(S),M=a(175),k=o(M),w=a(261),N=o(w),T=a(177),P=o(T),I=a(93),R=o(I),A=a(23),x=o(A),O=a(39),D=a(172),L=o(D),U=a(126),F=o(U),j=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={searchText:"",isSearching:!1},o.onBlur=function(){o.props.setTimeout(function(){o.state.searchText||o.onCancel()},0)},o.onChange=function(e){e.target instanceof HTMLInputElement&&!function(){var t=e.target.value;o.setState({searchText:t},function(){o.props.onSearch(t)})}()},o.onCancel=function(){o.refs.input&&(o.refs.input.blur(),o.setState({searchText:"",isSearching:!1}),o.props.onSearch(""))},o.onReset=function(e){e.stopPropagation(),o.focus(),o.setState({searchText:""}),o.props.onSearch("")},o.onSearchOn=function(e){o.setState({isSearching:!0}),e&&e.persist(),o.props.setTimeout(function(){o.focus(e)},0)},o.focus=function(e){P["default"].focus(o.refs.input,e)},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillReceiveProps",value:function(e){this.state.isSearching&&!this.state.searchText&&(b["default"].findDOMNode(this).contains(document.activeElement)||this.onCancel())}},{key:"componentWillUnmount",value:function(){this.onCancel()}},{key:"isAtBeginning",value:function(){var e=this.refs.input;return 0===e.selectionStart&&0===e.selectionEnd}},{key:"isAtEnd",value:function(){var e=this.refs.input,t=e.value.length;return e.selectionStart===t&&e.selectionEnd===t}},{key:"select",value:function(){var e=this.refs.input;e.select()}},{key:"render",value:function(){var e=this.props,t=e.loading,a=e.placeholder,o=e.spellCheck,n=this.state,r=n.isSearching,i=n.searchText,l=null;r&&(t?l=_["default"].createElement("div",{className:"icon-spinner",key:"icon-clear-search",onClick:this.onReset},_["default"].createElement(k["default"],{size:20,stroke:5,color:"highlight"})):i.length&&(l=_["default"].createElement("button",{className:"icon-close-search",key:"icon-clear-search",onClick:this.onReset},_["default"].createElement(L["default"],{name:"x-alt"}))));var s=void 0;r&&(s=_["default"].createElement(N["default"],{displayName:"ListSearch",escapable:!0,requestDismiss:this.onCancel,requestFocus:this.focus}));var u=a||R["default"].t("search_or_start_new_chat"),c=r?this.onCancel:this.onSearchOn,d=(0,x["default"])("list-search",{active:r});return _["default"].createElement("div",{className:d},_["default"].createElement("button",{"data-a8n":E["default"].key("icon-search-morph"),className:"icon-search-morph",onMouseDown:c},_["default"].createElement("div",{className:"icon-morph icon-morph-back"},_["default"].createElement(L["default"],{name:"back-blue",directional:!0})),_["default"].createElement("div",{className:"icon-morph icon-morph-search"},_["default"].createElement(L["default"],{name:"search",directional:!0}))),_["default"].createElement(F["default"],{transitionName:"pop"},l),_["default"].createElement("div",{"data-a8n":E["default"].key("input-placeholder"),className:"input-placeholder"},i?null:u),_["default"].createElement("label",{htmlFor:"input-chatlist-search",className:"cont-input-search"},_["default"].createElement("input",{type:"text",ref:"input","data-a8n":E["default"].key("input-search"),className:(0,x["default"])("input-search",O.SELECTABLE_INPUT_CSS_CLASS),"data-tab":2,dir:"auto",spellCheck:o,title:u,value:i,onBlur:this.onBlur,onFocus:r?null:this.onSearchOn,onChange:r?this.onChange:null})),s)}}]),t}(_["default"].Component),B=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"focus",value:function(){(0,r["default"])(t.prototype.__proto__||(0,l["default"])(t.prototype),"getComponent",this).call(this).focus()}},{key:"isAtEnd",value:function(){return(0,r["default"])(t.prototype.__proto__||(0,l["default"])(t.prototype),"getComponent",this).call(this).isAtEnd()}},{key:"setState",value:function(e,a){(0,r["default"])(t.prototype.__proto__||(0,l["default"])(t.prototype),"getComponent",this).call(this).setState(e,a)}},{key:"select",value:function(){(0,r["default"])(t.prototype.__proto__||(0,l["default"])(t.prototype),"getComponent",this).call(this).select()}}]),t}((0,C["default"])(j));t["default"]=B},7141:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(23),l=o(i),s=a(176),u=o(s),c=function(e){var t=(0,l["default"])("chat",e.className,{"chat-drawer":"drawer-list"===e.theme,"chat-identity":"identity"===e.theme,"chat-plain":"plain"===e.theme,"chat-idle":e.idle}),a=void 0;e.image&&(a=e.customImage?e.image:r["default"].createElement("div",{className:"chat-avatar"},e.image));var o=e.primaryDetail?r["default"].createElement("div",{className:"chat-meta"},e.primaryDetail):null,n=void 0,i=void 0;e.secondary&&(i=e.secondaryDetail?r["default"].createElement("div",{className:"chat-meta"},e.secondaryDetail):null,n=r["default"].createElement("div",{className:"chat-secondary"},r["default"].createElement("div",{className:"chat-status"},e.secondary),i));var s=e.detail?r["default"].createElement("div",{className:"chat-body chat-detail"},e.detail):null;return r["default"].createElement("div",{"data-a8n":u["default"].key("chat-card"),className:t,style:e.style,onClick:e.onClick,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseOver:e.onMouseOver,onMouseLeave:e.onMouseLeave,onContextMenu:e.onContextMenu},a,r["default"].createElement("div",{className:"chat-body"},r["default"].createElement("div",{className:"chat-main"},r["default"].createElement("div",{className:"chat-title"},e.primary),o),n),s)};t["default"]=c},7142:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(7544),E=o(y),S=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onToggle=function(e){e&&e.stopPropagation(),o.props.onChange()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e,t,a=(0,b["default"])(E["default"].checkbox,(e={},(0,r["default"])(e,E["default"].checkedCheckbox,this.props.checked),(0,r["default"])(e,E["default"].disabled,this.props.disabled),e)),o=(0,b["default"])(E["default"].checkmark,(t={},(0,r["default"])(t,E["default"].checkedCheckmark,this.props.checked),(0,r["default"])(t,E["default"].uncheckedCheckmark,!this.props.checked),t));return _["default"].createElement("div",{className:E["default"].checkboxContainer,onClick:this.onToggle},_["default"].createElement("div",{className:a},_["default"].createElement("div",{className:o})))}}]),t}(_["default"].Component);t["default"]=S},7143:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.chat,a=e.contact,o=(0,f["default"])(e,["chat","contact"]);if(t&&!t.isUser)return M["default"].createElement(j,(0,c["default"])({chat:t},o));var n=a||t.contact;return M["default"].createElement(F,(0,c["default"])({contact:n},o))}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l,s,u=a(24),c=o(u),d=a(57),f=o(d),p=a(5),h=o(p),m=a(2),g=o(m),_=a(4),v=o(_),b=a(7),y=o(b),E=a(6),S=o(E);t["default"]=n;var C=a(3),M=o(C),k=a(23),w=o(k),N=a(497),T=o(N),P=a(7119),I=o(P),R=a(7118),A=o(R),x=a(488),O=a(172),D=o(O),L=a(7560),U=o(L),F=(0,A["default"])((i=r=function(e){function t(){return(0,g["default"])(this,t),(0,y["default"])(this,(t.__proto__||(0,h["default"])(t)).apply(this,arguments))}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.element,a=e.contact,o=e.highlightText,n=e.titlify,r=e.ellipsify,i=e.you,l=void 0;o&&(l=x.Configuration.Search({terms:[o]}));var s=(0,w["default"])(a.isPSA?U["default"].psa:null),u=i?a.formattedName:a.formattedUser,c=M["default"].createElement(I["default"],{text:u,element:t,className:s,formatters:l,titlify:n,ellipsify:r,direction:"auto"});return a.isVerified||a.isPSA?M["default"].createElement("span",{className:U["default"].verified},(0,T["default"])({text:c,icon:M["default"].createElement("div",{className:U["default"].icon},M["default"].createElement(D["default"],{name:"psa-verified"}))})):c}}]),t}(C.PureComponent),r.CONCERNS={contact:["isPSA","isVerified","formattedUser","formattedName"]},r.defaultProps={element:"span"},i)),j=(0,A["default"])((s=l=function(e){function t(){return(0,g["default"])(this,t),(0,y["default"])(this,(t.__proto__||(0,h["default"])(t)).apply(this,arguments))}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.element,a=e.chat,o=e.highlightText,n=e.titlify,r=e.ellipsify,i=void 0;return o&&(i=x.Configuration.Search({terms:[o]})),M["default"].createElement(I["default"],{text:a.title(),element:t,formatters:i,titlify:n,ellipsify:r,direction:"auto"})}}]),t}(C.PureComponent),l.CONCERNS={chat:["formattedTitle"]},s))},7144:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(3),l=o(i),s=a(23),u=o(s),c=a(176),d=o(c),f=a(7566),p=o(f),h=function(e){var t=e.large,a=e.a8nText,o=e.onClick,n=e.children,i=(0,u["default"])(p["default"].btn,(0,r["default"])({},p["default"].large,t));return l["default"].createElement("div",{"data-a8n":d["default"].key(a),role:"button",className:i,onClick:o},n)};t["default"]=h},7145:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a=e.children,o=e.onClick,n=e.icon,r=e.className,l=e.color,u=e.theme,d=n?s["default"].createElement("div",{className:h["default"].icon},n):null,p=(0,c["default"])(h["default"].container,r,(t={},(0,i["default"])(t,h["default"].containerNoIcon,!n),(0,i["default"])(t,h["default"].containerListAligned,"list-aligned"===u),t)),m=o?"button":null,_="string"==typeof a?a:null;return s["default"].createElement("div",{className:p,"data-a8n":f["default"].key(e.a8n),"data-ignore-capture":"any",onClick:o,role:m,title:_},d,s["default"].createElement("div",{className:h["default"].bodyContainer},s["default"].createElement("div",{className:h["default"].body},s["default"].createElement(g["default"],{theme:"title",color:l},a))))}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=o(r);t["default"]=n;var l=a(3),s=o(l),u=a(23),c=o(u),d=a(176),f=o(d),p=a(7602),h=o(p),m=a(7133),g=o(m)},7146:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(23),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(497),E=o(y),S=a(176),C=o(S),M=a(7119),k=o(M),w=a(126),N=o(w),T=a(175),P=o(T),I=a(172),R=o(I),A=a(488),x=a(7141),O=o(x),D=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={hover:!1,contextMenu:!1},o.onMenuClick=function(e){var t=o.props,a=t.contextEnabled,n=t.onContext;a()&&(e.stopPropagation(),e.preventDefault(),n&&n({anchor:e.target}))},o.onContextMenu=function(e){var t=o.props,a=t.contextEnabled,n=t.onContext;a()&&(e.stopPropagation(),e.preventDefault(),n&&n({event:e}))},o.openContextMenu=function(){o.props.contextEnabled()&&o.setState({contextMenu:!0},function(){b["default"].findDOMNode(o.refs.context).click()})},o.mouseOver=function(){o.state.hover||o.props.contextMenu||!o.props.contextEnabled()||o.setState({hover:!0})},o.mouseEnter=function(){o.state.hover||o.props.contextMenu||!o.props.contextEnabled()||o.setState({hover:!0})},o.mouseLeave=function(){o.state.hover&&o.setState({hover:!1})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillUpdate",value:function(e){this.props.contextMenu&&this.state.contextMenu&&!e.contextMenu&&this.setState({contextMenu:!1})}},{key:"onMenuMouseDown",value:function(e){e.stopPropagation()}},{key:"render",value:function(){var e=this.props.contextMenu||this.state.contextMenu,t=e||this.state.hover,a=(0,m["default"])(this.props.className,{hover:t}),o="string"==typeof this.props.primary?_["default"].createElement(k["default"],{text:this.props.primary,direction:"auto",formatters:A.Configuration.Search({terms:this.props.searchText?[this.props.searchText]:[]}),titlify:!0,ellipsify:!0}):this.props.primary,n=null,r=null;this.props.pendingAction?r=_["default"].createElement("div",{className:"btn-context"},_["default"].createElement(P["default"],{size:18,stroke:6,color:"highlight"})):t&&(n=_["default"].createElement("div",{"data-a8n":C["default"].key("context-btn"),className:"btn-context",key:"icon-context",ref:"context",onMouseDown:this.onMenuMouseDown,onClick:this.onMenuClick},_["default"].createElement(R["default"],{name:"down"})));var i=_["default"].createElement(N["default"],{transitionName:"fade"},r),l=_["default"].createElement(N["default"],{transitionName:"pop-fast-chat"},t?n:null),s=void 0,u=void 0;return this.props.secondary?(s=this.props.primaryDetail,u=(0,E["default"])({prop:this.props.secondaryDetail,spinner:i,button:l})):s=(0,E["default"])({prop:this.props.primaryDetail,spinner:i,button:l}),_["default"].createElement(O["default"],{image:this.props.image,customImage:this.props.customImage,className:a,style:this.props.style,theme:this.props.theme,primary:o,primaryDetail:s,secondary:this.props.secondary,secondaryDetail:u,detail:this.props.detail,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onContextMenu:this.props.contextEnabled()?this.onContextMenu:null,onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null})}}]),t}(_["default"].PureComponent);e.exports=D},7147:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(93),b=o(v),y=a(497),E=o(y),S=a(39),C="l10n",M=/(.*?)__(\w+?)__/g,k=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"translate",value:function(){var e=this.props,t=e.id,a=e.plural,o=e.params,n=b["default"].t(t,{_plural:a});if(!o||_["default"].isEmpty(o))return m["default"].createElement("span",{dir:b["default"].isRTL()?"rtl":"ltr"},n);for(var r=void 0,i={},l=void 0;r=M.exec(n);){var s=C+"_"+r.index;i[s]=m["default"].createElement("span",null,r[1]);var u=r[2];u&&o[u]&&(i[u]=o[u]),l=r.index+r[0].length}if("number"==typeof l&&l<n.length){var c=C+"_"+l;i[c]=m["default"].createElement("span",null,n.slice(l))}return _["default"].isEmpty(i)?m["default"].createElement("span",{dir:b["default"].isRTL()?"rtl":"ltr"},n):(0,E["default"])(i)}},{key:"render",value:function(){var e=this.props,t=e.onClick,a=e.wrapInHiddenToken;return m["default"].createElement(S.SelectableSpan,{selectable:!a,onClick:t},this.translate())}}]),t}(h.PureComponent);t["default"]=k},7148:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.DEFAULT_HEIGHT=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(71),m=o(h),g=a(7210),_=o(g),v=a(3),b=a(46),y=a(23),E=a(12),S=a(10),C=a(7341),M=t.DEFAULT_HEIGHT=72,k="data-list-scroll-container",w="data-list-scroll-offset",N=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.scrollTop=0,a.offsetTop=0,a.bodyHeight=0,a.pointerEvents=!0,a.enablePointerEvents=S.debounce(function(){E.setUiBusy(!1),a.pointerEvents=!1,b.findDOMNode(a.refs.viewport).style.pointerEvents="auto",a.props.onPointerEventsOn&&a.props.onPointerEventsOn()},150),a.onScroll=function(){a.animationFrame?a.hanging=!0:(a.hanging=!1,a.animationFrame=window.requestAnimationFrame(a._onScroll))},a._onScroll=function(){var e=a.state.scrollTarget;a.disablePointerEvents(),e&&(a.scrollTop=e.scrollTop);var t=a.getPhysicalIndexes(a.props),o=t.firstPhysicalIndex,n=t.lastPhysicalIndex,r=void 0;for(r=o;n>r;r++){var i=a.props.data[r].key;if(!a.renderedItems[i])break}return r===n?(a.animationFrame=void 0,void(a.hanging&&a.onScroll())):void a.setState({firstPhysicalIndex:o,lastPhysicalIndex:n},function(){a.animationFrame=void 0,a.hanging&&a.onScroll()})},a.state={scrollTarget:void 0,firstPhysicalIndex:0,lastPhysicalIndex:0},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillReceiveProps",value:function(e){if(void 0!==e.scrollTop&&this.state.scrollTarget&&(this.state.scrollTarget.scrollTop=e.scrollTop),this.props.scrollTarget!==e.scrollTarget||this.props.height!==e.height||this.props.data.length!==e.data.length)this.initialize(e);else{var t=this.state,a=t.firstPhysicalIndex,o=t.lastPhysicalIndex,n=this.getFirstVisibleIndex(e.height);(a>n||n>o)&&this.setState(this.getPhysicalIndexes(e))}}},{key:"componentDidMount",value:function(){var e=this;this.props.listeners.addAndRun(window,"resize",function(){return e.initialize()})}},{key:"componentWillUnmount",value:function(){this.cancelScroll(),this.enablePointerEvents.cancel()}},{key:"initialize",value:function(e){var t=e?e:this.props;if(this.cancelScroll(),this.state.scrollTarget){var a=_["default"]?{passive:!0}:void 0;this.props.listeners.remove(this.state.scrollTarget,"scroll",this.onScroll,a)}for(var o=b.findDOMNode(this),n=void 0,r=o,i=0;5>i;i++){if(r instanceof HTMLElement&&r.hasAttribute(k)){n=r;break}r=r&&r.parentNode}var l=void 0;r=o;for(var s=0;i>s;s++){if(r instanceof HTMLElement&&r.hasAttribute(w)){l=r;break}r=r&&r.parentNode}if(!n)throw new Error("list scroll container not found");var u=_["default"]?{passive:!0}:void 0;this.props.listeners.add(n,"scroll",this.onScroll,u),this.scrollTop=n.scrollTop,this.offsetTop=l?l.offsetTop:0,this.bodyHeight=n.clientHeight;var c=this.getPhysicalIndexes(t),d=c.firstPhysicalIndex,f=c.lastPhysicalIndex;return this.renderedItems={},this.setState({scrollTarget:n,firstPhysicalIndex:d,lastPhysicalIndex:f}),n}},{key:"getFirstVisibleIndex",value:function(e){return Math.floor(Math.max(this.scrollTop-this.offsetTop,0)/e)}},{key:"getPhysicalIndexes",value:function(e){var t=this.getFirstVisibleIndex(e.height),a=Math.max(this.offsetTop-this.scrollTop,0),o=Math.max(this.bodyHeight-a,0),n=Math.min(Math.ceil(o/e.height),e.data.length),r=Math.max(t-e.extraItems,0),i=Math.min(t+n+e.extraItems,e.data.length);return{firstPhysicalIndex:r,lastPhysicalIndex:i}}},{key:"cancelScroll",value:function(){this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0,this.hanging=!1)}},{key:"disablePointerEvents",value:function(){this.enablePointerEvents(),this.pointerEvents||(this.props.onPointerEventsOff&&this.props.onPointerEventsOff(),b.findDOMNode(this.refs.viewport).style.pointerEvents="none",E.setUiBusy(!0),this.pointerEvents=!0)}},{key:"getComponents",value:function(){var e=this,t=this.props,a=t.height,o=t.data,n=this.state,r=n.firstPhysicalIndex,i=n.lastPhysicalIndex,l={};return S(o).forEach(function(e,t){l[e.key]=t}).slice(r,i).forEach(function(t){e.renderedItems[t.key]=t}),S.sortBy(this.renderedItems,"key").map(function(e){return v.createElement(C,{key:e.key,rowHeight:a,zIndex:o.length-l[e.key]-1,rowNumber:l[e.key]},e)})}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.height,o=e.className,n=e.animate,r={container:{},viewport:{height:t.length*a}},i={container:y("infinite-list",o,{"infinite-list-animate":n&&!this.animationFrame}),viewport:"infinite-list-viewport"};return v.createElement("div",{className:i.container,style:r.container},v.createElement("div",{className:i.viewport,ref:"viewport",style:r.viewport},this.getComponents()))}}]),t}(v.Component);N.defaultProps={animate:!1,scrollTarget:null,className:null,data:null,height:M,extraItems:30};t.Component=N;t["default"]=(0,m["default"])(N)},7149:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.children;return v["default"].createElement("div",{className:T["default"].menu},t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuBarItem=void 0;var r=a(48),i=o(r),l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m);t.MenuBar=n;var _=a(3),v=o(_),b=a(126),y=o(b),E=a(176),S=o(E),C=a(23),M=o(C),k=a(261),w=o(k),N=a(7558),T=o(N),P=t.MenuBarItem=function(e){function t(e){(0,c["default"])(this,t);var a=(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).call(this,e));return a.onClose=function(){a.setState({active:!1})},a.handleClick=function(e){a.props.onClick&&a.props.onClick(e),e.isDefaultPrevented()||(e.preventDefault(),a.state.active||a.onOpen(e))},a.state={active:!1},a}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"onOpen",value:function(){this.setState({active:!0})}},{key:"render",value:function(){var e,t=this.props,a=t.children,o=t.icon,n=t.transitionName,r=t.title,l=t.disabled,s=this.state.active,u=a&&s?v["default"].createElement(w["default"],{displayName:"MenuBarMenuItem",escapable:!0,popable:!0,requestDismiss:this.onClose},v["default"].Children.only(a)):null,c=(0,M["default"])(T["default"].item,(e={},(0,i["default"])(e,T["default"].active,s),(0,i["default"])(e,T["default"].disabled,l),e));return v["default"].createElement("div",{"data-a8n":S["default"].key(this.props.a8n),className:c},v["default"].createElement("div",{role:"button",onMouseDown:this.handleClick,title:r},o),v["default"].createElement(y["default"],{transitionName:n},u))}}]),t}(v["default"].PureComponent);P.defaultProps={transitionName:"dropdown",disabled:!1}},7150:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(490),r=o(n),i=(0,r["default"])({FORWARD:void 0,BACKWARD:void 0});e.exports=function(e,t){var a=window.getSelection();if(!a||!a.rangeCount)return null;var o=a.getRangeAt(0);if(!o.collapsed)return null;var n=o.startContainer,r=o.startOffset;if(n===e){var l=n.childNodes,s=l.length;if(t===i.FORWARD&&r>s||t===i.BACKWARD&&!r)return null;var u=t===i.BACKWARD?1:0,c=l[r-u];return c instanceof Element?c:null}var d=n.length===r;if(t===i.BACKWARD&&r)return null;if(t===i.FORWARD&&!d)return null;var f=t===i.BACKWARD?"previousSibling":"nextSibling",p=n[f];return p instanceof Element?p:null},e.exports.Direction=i},7151:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(176),l=o(i),s=a(7238),u=o(s),c=a(7133),d=o(c),f=a(23),p=o(f),h=a(7604),m=o(h),g=function(e){var t=e.children,a=e.title,o=e.subtitle,n=e.titleOnClick,i=e.a8n,s=e["data-list-scroll-offset"],c=e.theme,f=c?m["default"][c]:null,h=(0,p["default"])(m["default"].container,m["default"].animate,f),g=void 0;return a&&(g=r["default"].createElement("div",{className:m["default"].title,"data-a8n":l["default"].key(i),role:n?"button":null,onClick:n},r["default"].createElement(u["default"],{side:o,ellipsify:!0},r["default"].createElement(d["default"],{theme:"section-title"},a)))),r["default"].createElement("div",{className:h,"data-list-scroll-offset":s},g,t)};t["default"]=g},7152:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(8),b=o(v),y=a(94),E=o(y),S=a(12),C=o(S),M=a(28),k=o(M),w=a(7611),N=o(w),T=a(7147),P=o(T),I={GUIDE_ALLOW:"guide-allow",GUIDE_UNBLOCK:"guide-unblock",GUIDE_NONE:"guide-none"},R={CHROME_MEDIA_ERROR:"__chrome_media_error__",FIREFOX_LOCK:"__firefox_lock__",OPERA_MEDIA:"__opera_media__"},A={ALLOW:a(7515),UNBLOCK:a(7519)},x={ALLOW:a(7514),UNBLOCK:a(7518)},O={ALLOW:a(7516),UNBLOCK:a(7520)},D=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e,t=this.props,a=t.type,o=t.onCancel,n=t.onConfirm,i=t.title,l=t.desc,s=void 0;if(a!==I.GUIDE_NONE){var u=void 0;u=k["default"].os===b["default"].OS_TYPE.MAC?A:k["default"].os===b["default"].OS_TYPE.CHROMEOS?x:O;var c=a===I.GUIDE_ALLOW?u.ALLOW:u.UNBLOCK;s=_["default"].createElement("div",{className:N["default"].guideContainer},_["default"].createElement("img",{className:N["default"].guideImage,src:c}))}var d=(e={},(0,r["default"])(e,R.CHROME_MEDIA_ERROR,_["default"].createElement("span",{className:N["default"].chromeMediaIcon})),(0,r["default"])(e,R.FIREFOX_LOCK,_["default"].createElement("span",{className:N["default"].firefoxLockIcon})),(0,r["default"])(e,R.OPERA_MEDIA,_["default"].createElement("span",{className:N["default"].operaMediaIcon})),e),f=l+"_"+k["default"].browser,p=l10n.hasT(f)?f:l;return _["default"].createElement(E["default"],{title:_["default"].createElement(P["default"],{id:i}),onOK:n,okText:l10n.t("ok_got_it"),onCancel:o,cancelText:o?l10n.t("learn_more"):void 0},s,_["default"].createElement("div",{className:N["default"].description},_["default"].createElement(P["default"],{id:p,params:d})))}}]),t}(_["default"].Component);D.TYPE=I,D.defaultProps={type:I.GUIDE_NONE,onConfirm:C["default"].closeModal.bind(C["default"])},t["default"]=D},7153:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ProfilePicThumbProxy=t["default"]=void 0;var n=a(0),r=o(n),i=a(74),l=a(179),s=a(3),u=a(8),c=a(1),d=a(38),f=a(47),p=a(14),h=a(73),m=a(32),g=a(12),_=a(129),v={SINGLE:"SINGLE",GROUP:"GROUP"},b=(0,i.defineState)("ProfilePicThumb",{Collection:"ProfilePicThumb",props:{id:"string",tag:"string",raw:"string",eurl:"string"},session:{stale:["boolean",!1,!0]
},derived:{img:{deps:["tag","raw","stale","eurl"],fn:function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;if(this.tag)return this.generateUrl("s")}},imgFull:{deps:["tag","raw","stale","eurl"],fn:function(){if((this.raw||!this.tag)&&this.stale)return null;if(!this.raw&&this.tag)return this.generateUrl("l")}},fallbackType:{deps:["id"],fn:function(){return m.isUser(this.id)?v.SINGLE:m.isGroup(this.id)?v.GROUP:v.GROUP}}},onError:function(e){switch(e){case 410:this.update()}},generateUrl:function(e){var t={t:e,u:this.id,i:this.tag};return _&&navigator.serviceWorker.controller&&this.eurl&&(t.e=this.eurl),h.build(u.PP_URL,t)},canSet:function(){return m.isGroup(this.id)&&f.supportsFeature(f.F.GROUP_SET_PIC)?!0:!(!m.isUser(this.id)||this.id!==Store.Conn.me||!f.supportsFeature(f.F.SET_PROFILE_PIC))},setPicture:function(e,t,a){var o=this;if(!this.canSet())return r["default"].reject(new p.ActionError);var n=d.sendSetPicture(this.id,e,t),i=this.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_setting")):new l.ActionType(l10n.t("action_group_icon_setting"));a=a||(0,l.genId)();var u=n["catch"](function(e){throw c.error("models:ProfilePicThumb:setPicture dropped")(e),o.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_set_failed")):new l.ActionType(l10n.t("action_group_icon_set_failed"))}).then(function(n){if(200===n.status)return o.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_set")):new l.ActionType(l10n.t("action_group_icon_set"));if(n.status>=400){var r=o.id===Store.Conn.me?l10n.t("action_profile_set_failed"):l10n.t("action_group_icon_set_failed");return new l.ActionType(r,l10n.t("action_try_again"),o.setPicture.bind(o,e,t,a))}});return g.openToast(s.createElement(l.ActionToast,{id:a,initialAction:i,pendingAction:u})),n.bind(this).then(function(e){200!==e.status||e._duplicate||this.set({tag:e.tag,eurl:e.eurl})})},canDelete:function(){return m.isGroup(this.id)&&f.supportsFeature(f.F.GROUP_SET_PIC)&&this.tag?!0:!!(m.isUser(this.id)&&this.id===Store.Conn.me&&f.supportsFeature(f.F.SET_PROFILE_PIC)&&this.tag)},deletePicture:function(e){var t=this;if(!this.canDelete())return r["default"].reject(new p.ActionError);var a=d.deletePicture(this.id),o=this.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_removing")):new l.ActionType(l10n.t("action_group_icon_removing"));e=e||(0,l.genId)();var n=a["catch"](function(e){throw c.error("models:ProfilePicThumb:deletePicture dropped")(e),t.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_remove_failed")):new l.ActionType(l10n.t("action_group_icon_remove_failed"))}).then(function(a){if(200===a.status)return t.id===Store.Conn.me?new l.ActionType(l10n.t("action_profile_removed")):new l.ActionType(l10n.t("action_group_icon_removed"));if(a.status>=400){var o=t.id===Store.Conn.me?l10n.t("action_profile_remove_failed"):l10n.t("action_group_icon_remove_failed");return new l.ActionType(o,l10n.t("action_try_again"),t.deletePicture.bind(t,e))}});return g.openToast(s.createElement(l.ActionToast,{id:e,initialAction:o,pendingAction:n})),a.bind(this).then(function(e){200!==e.status||e._duplicate||this.set({tag:void 0,eurl:void 0})})}}),y=b.ProfilePicThumb,E=b.ProfilePicThumbProxy;y.FALLBACK=v,t["default"]=y,t.ProfilePicThumbProxy=E},7154:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){"number"==typeof e&&(e="v"+e);var t=M[e];t||(l.error("binaryProtocol unknown version: "+e)(),s.updateImmediately("bp_unknown_version"));var a=t.OutputStream,o=new t.Writer(t.Dictionary),n=t.InputStream,r=new t.Reader(t.Dictionary),u=t.Crypto;this.Node=t.Node,this.read=function(e){return u.decrypt(e).then(function(e){return r.readNode(new n(e))})},this.write=function(e){return i["default"].callSynchronously(function(){var t=new a;return o.writeNode(t,e),u.encrypt(t.toBuffer())})},this.dropAllBecauseLogout=function(){return u.dropAllBecauseLogout()}}var r=a(0),i=o(r),l=a(1),s=a(33),u=function(e,t){return _.isArray(e)&&t?e.concat(t):void 0},c=function(e,t){if(e.Dictionary){var a={};_.mergeWith(a,t.Dictionary,e.Dictionary,u),e.Dictionary=a}return _.defaults(e,t)},d={OutputStream:a(7294),Writer:a(7296),InputStream:a(7292),Reader:a(7295),Dictionary:a(7291),Node:a(7293),Crypto:a(7212)},f={OutputStream:a(7300),Writer:a(7302),InputStream:a(7298),Reader:a(7301),Dictionary:a(7297),Node:a(7299),Crypto:a(7212)},p=c({Dictionary:a(7303)},f),h=c({Dictionary:a(7304)},p),m=c({Writer:a(7306),Reader:a(7305)},h),g=c({Dictionary:a(7307)},m),v=c({Dictionary:a(7308)},g),b=c({Dictionary:a(7309)},v),y=c({Dictionary:a(7310)},b),E=c({Dictionary:a(7311)},y),S=c({Dictionary:a(7312)},E),C=c({Dictionary:a(7313)},S),M={"01":d,"03":f,"04":p,"05":h,"06":m,v1:h,v2:m,v3:g,v4:v,v5:b,v6:y,v7:E,v8:S,v9:C};e.exports=n},7155:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=t.Mode=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(264),b=o(v),y=a(484),E=o(y),S=a(7195),C=o(S),M=a(7318),k=o(M),w=a(7118),N=o(w),T=a(71),P=o(T),I=a(173),R=o(I),A=a(7185),x=o(A),O=a(7315),D=o(O),L=a(174),U=a(10),F=o(U),j=a(7125),B=(o(j),a(94)),G=o(B),V=a(7156),Y=(o(V),a(7146)),W=o(Y),H=a(7123),q=o(H),z=a(7188),K=o(z),Q=a(7330),J=o(Q),X=a(7186),Z=o(X),$=a(7342),ee=o($),te=a(7346),ae=o(te),oe=a(7225),ne=a(8),re=o(ne),ie=a(12),le=o(ie),se=a(23),ue=o(se),ce=a(7139),de=o(ce),fe=a(14),pe=o(fe),he=a(7209),me=a(7137),ge=o(me),_e=a(261),ve=o(_e),be=a(177),ye=o(be),Ee=a(93),Se=o(Ee),Ce=a(7143),Me=o(Ce),ke=a(269),we=o(ke),Ne=a(34),Te=t.Mode={LAST:"LAST",INFO:"INFO"},Pe=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.hoverCounter=0,o.onSearch=function(){o.setState({searchText:o.props.searchQuery.trimmed})},o.onActiveChange=function(e,t,a){if("focus"===e){var n=_["default"].findDOMNode(o);ye["default"].focus(n,a),t&&de["default"].scrollIntoViewIfNeeded(n)}o.setState({active:!!e})},o.contextEnabled=function(){var e=o.props,t=e.chat,a=e.noContext;return!a&&(t.mute.canMute()||t.canArchive()||t.canDelete()||t.canExit())},o.onMenu=function(e){if(o.state.contextMenu)return void o.setState({contextMenu:void 0});var t=o.props.chat,a=[];t.canArchive()&&a.push(m["default"].createElement(J["default"],{key:"archive",onArchive:o.onArchive,chat:t._ProxyState$state})),t.mute.canMute()&&a.push(m["default"].createElement(K["default"],{key:"mute",onMute:o.onMute,mute:t.mute})),t.canDelete()&&a.push(m["default"].createElement(Z["default"],{key:"delete",onDeleteOrExit:o.onDeleteOrExit,chat:t._ProxyState$state})),we["default"].platform===we["default"].PLATFORMS.iphone&&t.isBroadcast||!t.canPin()||a.push(m["default"].createElement(ae["default"],{key:"pin",onPinOrUnpin:o.onPinOrUnpin,chat:t})),t.canMarkUnseen()&&a.push(m["default"].createElement(ee["default"],{key:"mark_unread",onMarkUnread:o.onMarkUnread,chat:t._ProxyState$state})),e.event&&e.event.persist(),o.setState({contextMenu:{menu:a,event:e.event,anchor:e.anchor}})},o.removeContext=function(){o.setState({contextMenu:void 0})},o.onMute=function(e){le["default"].muteChat(Store.Chat.get(o.props.chat.id),e,o)},o.onArchive=function(e){le["default"].archiveChat(Store.Chat.get(o.props.chat.id),e)},o.onDeleteOrExit=function(){le["default"].deleteOrExitChat(Store.Chat.get(o.props.chat.id),o)},o.onPinOrUnpin=function(e){!e||Store.Chat.filter(function(e){return e.pin}).length<3?le["default"].pinChat(Store.Chat.get(o.props.chat.id),e):le["default"].openModal(m["default"].createElement(G["default"],{onOK:le["default"].closeModal.bind(le["default"]),okText:Se["default"].t("web_ok")},Se["default"].t("action_chat_pin_failed_405")))},o.onMarkUnread=function(e){le["default"].markChatUnread(Store.Chat.get(o.props.chat.id),e)},o.onClick=function(e){F["default"].isFunction(o.props.onClick)&&o.props.onClick(e,Store.Chat.get(o.props.chat.id))},o.onMouseDown=function(e){0===e.button&&o.onClick(e)},o.onEnter=function(e){e.preventDefault(),e.stopPropagation(),(0,I.shouldIndicateFocus)(),o.onClick(e)},o.onDragEnter=function(e){if(o.props.chat.canSend){var t=e.dataTransfer;F["default"].includes(t.types,re["default"].DRAG_TYPE_FILE)&&(0===o.hoverCounter&&o.setState({dragging:!0}),o.hoverCounter+=1)}},o.onDragLeave=function(e){if(o.props.chat.canSend){var t=e.dataTransfer;F["default"].includes(t.types,re["default"].DRAG_TYPE_FILE)&&(o.hoverCounter-=1,0===o.hoverCounter&&o.setState({dragging:!1}))}},o.onDrop=function(e){var t=o.props.chat;if(t.canSend){o.setState({dragging:!1});var a=e.dataTransfer;(F["default"].includes(a.types,re["default"].DRAG_TYPE_FILE)||F["default"].includes(a.types,"text/uri-list")||F["default"].includes(a.types,"text/html"))&&(0,he.getFiles)(e).then(function(e){le["default"].openChatFromUnread(t).then(function(a){a&&le["default"].attachMediaDrawer({chat:t,files:e,fileOrigin:Ne.MEDIA_PICKER_ORIGIN_TYPE.PASTE})})})["catch"](pe["default"].MediaDragDropError,function(e){le["default"].openChatFromUnread(t).then(function(a){a&&le["default"].pasteChatTextInput(t,e.src)})})}},o.indicateFocus=function(e){e.stopPropagation(),e.preventDefault(),(0,I.indicateFocus)(o.cell,["#e9eaeb","#cbdde7"],{complete:o.onBlur})},o.onBlur=function(e){var t=_["default"].findDOMNode(o.cell);t&&((0,b["default"])(t,"stop"),t.style.backgroundColor="")},o.openContextMenu=function(){o.cell.openContextMenu()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.initListeners(this.props),this.setState({dragging:!1,contextMenu:void 0})}},{key:"componentWillReceiveProps",value:function(e){this.initListeners(e,this.props)}},{key:"initListeners",value:function(e,t){var a=e.listeners,o=e.active,n=e.chat,r=e.searchQuery;t&&t.searchQuery&&t.searchQuery!==r&&a.remove(r,V.SEARCH_EVENT,this.onSearch),!r||t&&r===t.searchQuery||a.add(r,V.SEARCH_EVENT,this.onSearch);var i=t&&t.chat.id;n.id!==i&&(t&&t.active&&a.remove(t.active,t.chat.id,this.onActiveChange),o&&a.add(o,n.id,this.onActiveChange));var l=o&&o.value instanceof E["default"]&&o.value.id===n.id;this.setState({searchText:r?r.trimmed:"",active:l})}},{key:"render",value:function(){var e=this.props,t=e.chat,a=e.mode,o=e.secondary,n=e.className,r=e.theme,i=this.state,l=i.searchText,s=i.active,u=i.dragging,c=i.contextMenu;n=(0,ue["default"])(n,{unread:t.hasUnread,active:!!s,"chat-drag":u});var d=void 0,f=void 0,p=void 0;switch(a){case Te.LAST:d=m["default"].createElement(x["default"],{chat:t}),o||(o=m["default"].createElement(D["default"],{chat:t}),f=m["default"].createElement(k["default"],{chat:t,mute:t.mute})),p={enter:this.onEnter},p[Se["default"].LR("right","left")]=this.openContextMenu;break;case Te.INFO:o||(o=t.isGroup?m["default"].createElement(oe.ParticipantsList,{groupMetadata:t.groupMetadata}):m["default"].createElement(C["default"],{presence:t.presence,chatstate:t.presence.chatstate,location:"list"})),p={enter:this.onEnter}}var h=m["default"].createElement(q["default"],{id:t.id,waitIdle:!0}),g=this.props.mouseDownAsClick,_=void 0;c&&(_=m["default"].createElement(ve["default"],{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.removeContext},m["default"].createElement(ge["default"],{contextMenu:c})));var v=m["default"].createElement(Me["default"],{chat:t,highlightText:l,titlify:!0,ellipsify:!0});return m["default"].createElement(R["default"],{handlers:p,onFocus:this.indicateFocus,onBlur:this.onBlur,className:"chat-drag-cover",onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop},m["default"].createElement(W["default"],{id:t.id,ref:(0,L.GetRef)("cell",this),className:n,theme:r,contextEnabled:this.contextEnabled,pendingAction:t.pendingAction,contextMenu:!!c,image:h,primary:v,primaryDetail:d,secondary:o,secondaryDetail:f,onClick:g?void 0:this.onClick,onMouseDown:g?this.onMouseDown:void 0,onContext:this.onMenu}),_)}}]),t}(m["default"].PureComponent);Pe.CONCERNS={chat:["id","hasUnread","isReadOnly","isGroup","pendingAction","canSend","isUser","contact","presence","groupMetadata","mute"]},Pe.defaultProps={mode:Te.LAST};t.Component=Pe;t["default"]=(0,P["default"])((0,N["default"])(Pe))},7156:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SEARCH_EVENT=void 0;var n=a(78),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(77),_=o(g),v=a(7504),b=o(v),y=a(10),E=o(y),S=t.SEARCH_EVENT="SEARCH_EVENT",C=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.query="",n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"updateQuery",value:function(e){var t=this.query;this.query=e,E["default"].trim(e)!==t&&this.trigger(S)}},{key:"clear",value:function(){this.updateQuery("")}},{key:"trimmed",get:function(){return E["default"].trim(this.query)}},{key:"highlighted",get:function(){var e=this.trimmed.toLowerCase().split(" ");return E["default"].uniq(E["default"].compact(e))}}]),t}(b["default"]);t["default"]=C,(0,r["default"])(C.prototype,_["default"])},7157:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){return c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("div",{className:g["default"].icon},c["default"].createElement("div",{className:g["default"].spinner},c["default"].createElement(f["default"],{size:50,stroke:3,color:"white"})),c["default"].createElement("div",{className:g["default"].cancel},c["default"].createElement(h["default"],{name:"media-disabled"}))))}function r(){return c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("div",{className:g["default"].icon},c["default"].createElement("div",{className:g["default"].spinner},c["default"].createElement(f["default"],{size:50,stroke:3,color:"white"})),c["default"].createElement("div",{className:g["default"].cancel},c["default"].createElement(h["default"],{name:"media-cancel"}))))}function i(e){var t=e.filesize,a=void 0===t?0:t,o=e.onClick;return a>0?c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("button",{className:g["default"].btnMeta,onClick:o},c["default"].createElement(h["default"],{name:"media-download-noborder",display:"inline"}),c["default"].createElement("span",null,l10n.filesize(a)))):c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("button",{className:g["default"].button,onClick:o},c["default"].createElement(h["default"],{name:"media-download"})))}function l(e){var t=e.filesize,a=void 0===t?0:t;return a>0?c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("button",{className:g["default"].btnMeta},c["default"].createElement(h["default"],{name:"media-upload-noborder",display:"inline"}),c["default"].createElement("span",null,l10n.filesize(a)))):c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("div",{className:g["default"].button},c["default"].createElement(h["default"],{name:"media-upload"})))}function s(){return c["default"].createElement("div",{className:g["default"].controls},c["default"].createElement("div",{className:g["default"].button},c["default"].createElement(h["default"],{name:"media-play"})))}Object.defineProperty(t,"__esModule",{value:!0}),t.Pending=n,t.PendingCancel=r,t.Download=i,t.Upload=l,t.Play=s;var u=a(3),c=o(u),d=a(175),f=o(d),p=a(172),h=o(p),m=a(7557),g=o(m)},7158:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=[];return e.forEach(function(e){return t.push(e)}),t}var r=a(182),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=function(){function e(){(0,s["default"])(this,e),this.internalHandlers=new i["default"]}return(0,c["default"])(e,[{key:"initialize",value:function(e){this.ctx=e}},{key:"registerHandler",value:function(e,t,a){var o=this.internalHandlers.get(t)||new i["default"];o.set(e,a),this.internalHandlers.set(t,o)}},{key:"unregisterHandler",value:function(e,t){var a=this.internalHandlers.get(t);a&&(a["delete"](e),a.size||this.internalHandlers["delete"](t))}},{key:"handle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this.internalHandlers.get(e);return a?n(a).some(function(e){return e.apply(null,t)}):!1}}]),e}();e.exports=d},7159:function(e,t){"use strict";e.exports=function(e){return!e.getModifierState("Shift")&&!e.getModifierState("Alt")&&!e.getModifierState("Control")}},7160:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(57),l=o(i),s=a(3),u=o(s),c=a(7569),d=o(c);t["default"]=function(e){var t=e.header,a=(0,l["default"])(e,["header"]);return u["default"].createElement("div",(0,r["default"])({className:d["default"].container},a),t)}},7161:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TextInputCustomStyleThemes=void 0;var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(23),_=o(g),v=a(7230),b=o(v),y=a(7177),E=o(y),S=a(173),C=o(S),M=a(3),k=o(M),w=a(126),N=o(w),T=a(175),P=o(T),I=a(7182),R=a(261),A=o(R),x=a(7137),O=o(x),D=a(489),L=a(174),U=a(7168),F=(o(U),a(172)),j=o(F),B=a(7571),G=o(B),V=a(490),Y=o(V),W=(t.TextInputCustomStyleThemes=(0,Y["default"])({groupInfoName:null}),function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={active:!1,locked:!!o.props.lockable,emojiPicker:null},o.onEmojiPicker=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=k["default"].createElement(E["default"],{onEmoji:o.onEmoji,onFocusRelease:o.restoreFocus});o.setState({emojiPicker:{menu:t,dirY:D.DirY.TOP,type:"emoji_picker",anchor:e.target}}),o.restoreFocus()},o.onEmojiPickerClose=function(){o.setState({emojiPicker:null})},o.onRestoreEmojiPickerFocus=function(){o.refs.emojiPickerUIE&&o.refs.emojiPickerUIE.getRef()&&o.refs.emojiPickerUIE.getRef().getElement()&&o.refs.emojiPickerUIE.getRef().getElement().component.restoreFocus()},o.onEmoji=function(e){o.inputLine&&o.inputLine.replaceSelection(e)},o.onEnter=function(e){o.props.lockable&&o.onSaveAndLock(),o.props.onEnter&&!o.props.multiline&&(e.persist(),o.props.onEnter(e))},o.onChange=function(e){o.props.onChange&&o.props.onChange(e)},o.restoreFocus=function(){o.inputLine&&o.inputLine.focus()},o.onBlur=function(e){o.state.active&&o.setState({active:!1}),o.props.onBlur&&o.props.onBlur(e)},o.onFocus=function(e){e.stopPropagation(),o.state.active||o.setState({active:!0}),o.props.onFocus&&o.props.onFocus(e)},o.onUnlock=function(){o.props.onBeginEdit&&o.props.onBeginEdit(),o.setState({locked:!1})},o.onSaveAndLock=function(){var e=!(!o.props.lowProfile&&o.props.error);o.props.validate&&e&&(e=o.props.validate(o.props.value)),e?(o.props.onSave&&o.props.onSave(),o.setState({locked:!0})):o.props.onError&&o.props.onError()},o.onCancel=function(){o.props.onCancel&&o.props.onCancel(),o.setState({locked:!0})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.props.focusOnMount&&this.restoreFocus()}},{key:"componentWillReceiveProps",value:function(e){this.inputLine&&!e.editing&&this.inputLine.value!==e.value&&this.inputLine.reset(e.value)}},{key:"render",value:function(){var e,a,o,n=this.props.maxLength||t.defaultProps.maxLength,i=this.props.editable&&!this.state.locked,l=i&&!!this.props.error&&!this.props.lowProfile,s=(0,I.numCodepoints)(this.props.value||""),u=50>n-s&&i,c=this.props.customStyleThemes,d=void 0===c?[]:c,f={container:(0,_["default"])(G["default"].textInput,d&&d.map(function(e){return G["default"][e]}),(e={},(0,r["default"])(e,G["default"].noPlaceholder,!this.props.placeholder),(0,r["default"])(e,G["default"].active,i),(0,r["default"])(e,G["default"].inputLarge,"large"===this.props.theme),e)),label:(0,_["default"])(G["default"].labelText,(0,r["default"])({},G["default"]["float"],!!this.props.value)),inputWrapper:(0,_["default"])(G["default"].wrapper,(a={},(0,r["default"])(a,G["default"].textError,l),(0,r["default"])(a,G["default"].textActive,this.state.active),(0,r["default"])(a,G["default"].locked,this.state.locked),a)),infoWrapper:(0,_["default"])(G["default"].infoStrip,(o={},(0,r["default"])(o,G["default"].textError,l),(0,r["default"])(o,G["default"].textActive,this.state.active),o))},p=this.props.showRemaining?k["default"].createElement("div",{className:(0,_["default"])(G["default"].buttonContainer,G["default"].charCounterContainer)},k["default"].createElement("div",{className:G["default"].charCounter},u?l10n.n(n-s):null)):null,h=i&&this.props.supportsEmoji?k["default"].createElement("div",{className:(0,_["default"])(G["default"].inputIcon,G["default"].inputEmoji),onClick:this.onEmojiPicker},k["default"].createElement(j["default"],{name:"emoji-input"})):void 0,m=void 0;this.props.lockable&&(this.props.pending?m=k["default"].createElement("div",{className:G["default"].iconSpinner},k["default"].createElement(P["default"],{size:18,stroke:6,color:"highlight"})):this.state.locked?this.props.editable&&(m=k["default"].createElement("div",{className:G["default"].inputIcon,onClick:this.onUnlock,key:"btn-edit",title:l10n.t("edit_button")},k["default"].createElement(j["default"],{name:"pencil",directional:!0}))):m=k["default"].createElement("div",{className:G["default"].inputIcon,onClick:this.onSaveAndLock,key:"btn-done",title:l10n.t("click_to_save_esc_to_cancel")},k["default"].createElement(j["default"],{name:"checkmark"})),m=k["default"].createElement(N["default"],{transitionName:"pop",component:"div",className:G["default"].buttonContainer},m));var g=this.props.lowProfile?null:k["default"].createElement("div",{className:f.infoWrapper},k["default"].createElement("div",{className:G["default"].errorText},l?this.props.error:null)),v=void 0;if(this.props.lockable&&!this.state.locked){var y=void 0;this.state.emojiPicker&&(y=k["default"].createElement(A["default"],{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},k["default"].createElement(O["default"],{contextMenu:this.state.emojiPicker}))),v=k["default"].createElement(A["default"],{displayName:"TextInput",escapable:!0,requestFocus:this.restoreFocus,requestDismiss:this.onCancel},k["default"].createElement("div",null,y))}else!this.props.lockable&&this.state.emojiPicker&&(v=k["default"].createElement(A["default"],{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},k["default"].createElement(O["default"],{contextMenu:this.state.emojiPicker})));var E=this.props.editable&&!this.state.locked;return k["default"].createElement(C["default"],{className:f.container,onFocus:this.restoreFocus},k["default"].createElement("span",{className:f.label},this.props.placeholder),k["default"].createElement("div",{className:G["default"].spacer}),k["default"].createElement("div",{className:f.inputWrapper,"data-trump-dominateparent":"click"},k["default"].createElement(b["default"],{ref:(0,L.GetRef)("inputLine",this),initialValue:this.props.value,theme:this.props.theme||"default",multiline:this.props.multiline,onChange:this.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onEnter:this.onEnter,onFiles:this.props.onFiles,pending:this.props.pending,spellCheck:this.props.spellCheck,maxLength:this.props.maxLength,readOnly:!E}),k["default"].createElement("div",{className:G["default"].inputControls},m,k["default"].createElement(N["default"],{transitionName:"pop",component:"div",className:G["default"].buttonContainer},h),p)),g,v)}}]),t}(M.Component));W.defaultProps={maxLength:25,editable:!0},t["default"]=W},7162:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){switch(Store.ServerProps.gifSearch){case"giphy":return s;case"tenor":default:return u}}Object.defineProperty(t,"__esModule",{value:!0}),t.GIPHY_LOCALES=t.BRAND_NAMES=t.GifInfo=t.TENOR=t.GIPHY=t.GAP_SIZE=t.TARGET_GIF_HEIGHT=void 0;var r=a(2),i=o(r);t.gifProvider=n;var l=t.TARGET_GIF_HEIGHT=130,s=(t.GAP_SIZE=6,t.GIPHY="giphy"),u=t.TENOR="tenor",c=0;t.GifInfo=function d(e,t,a,o,n,r,s){(0,i["default"])(this,d),this.rank=e,this.gifId=++c,this.url=t,this.previewUrl=a||t,this.nonVideoUrl=o,this.width=n,this.widthStr=n+"px",this.ratioStr=Math.ceil(100*l/n)+"%",this.attribution=r,this.trending=s},t.BRAND_NAMES={giphy:"GIPHY",tenor:"Tenor"},t.GIPHY_LOCALES=["es","pt","id","fr","ar","tr","th","vi","de","it","ja","zh-CN","zh-TW","ru","ko","pl","nl","ro","hu","sv","cs","hi","bn","da","fa","tl","fi","iw","ms","no","uk"]},7163:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.AttachMediaProxy=void 0;var n=a(74),r=o(n),i=a(1),l=o(i),s=a(76),u=o(s),c=a(109),d=a(75),f=a(10),p=o(f),h=a(272).prepRawMedia,m=a(14),g={READY:"ready",PROCESSING:"processing",ERROR:"error"},_=(0,n.defineState)("AttachMedia",{props:{id:"number",file:"object",uiProcessed:"boolean",fileOrigin:"string"},session:{state:{type:"string",values:p["default"].values(g)},mediaPrep:"object",mimetype:"string",processPromise:"object",exception:"object",chat:"object",caption:"string",type:{type:"string",values:p["default"].values(c.OUTWARD_TYPES),"default":c.OUTWARD_TYPES.UNKNOWN},preview:"string",fullPreview:"string",fullPreviewSize:"object",filename:"string",pdfPages:"number",isGif:"boolean",gifAttribution:"number"},derived:{previewable:{deps:["preview","fullPreview","type","filename","fullPreviewSize","mimetype"],fn:function(){if(!this.type||!this.mimetype||!this.fullPreview)return!1;switch(this.type){case c.OUTWARD_TYPES.DOCUMENT:return!!this.filename;case c.OUTWARD_TYPES.IMAGE:case c.OUTWARD_TYPES.VIDEO:return!(!this.fullPreviewSize||!this.preview);case c.OUTWARD_TYPES.AUDIO:case c.OUTWARD_TYPES.PTT:case c.OUTWARD_TYPES.UNKNOWN:return!0;default:throw new Error("Unsupported attach media type "+this.type)}}}},initialize:function(){return r["default"].prototype.initialize.call(this),this.processFile(this.file)},processFile:function(e){var t=this;return this.state=g.PROCESSING,this.processPromise=e.then(function(e){t.set(e);var a=void 0,o=e.file,n=e.isGif,r=e.gifAttribution;a=n?{asGif:n,gifAttribution:r}:{};var i=u["default"].createFromData(o,o.type),s=h(i,a);return t.set({mediaPrep:s}),s.waitForPrep().then(function(e){var a=e.documentPreview,o=window.URL.createObjectURL(e.mediaBlob),n={file:e.mediaBlob,fullPreview:o,type:e.type,filename:e.filename,mimetype:e.mimetype,preview:e.preview,state:g.READY,isGif:e.isGif,fullPreviewSize:void 0,pdfPages:void 0};e.fullWidth&&e.fullHeight&&(n.fullPreviewSize={height:e.fullHeight,width:e.fullWidth}),e.type===c.OUTWARD_TYPES.IMAGE&&(n.preview=o),e.type===c.OUTWARD_TYPES.DOCUMENT&&a&&(n.fullPreview=a.url,n.preview=a.thumbUrl,n.fullPreviewSize={height:a.height,width:a.width},n.pdfPages=a.pdfPages),t.set(n),l["default"].assert(t.previewable,"AttachMedia processFile","Invariant violated, processed file is not previewable")()})})["catch"](m.MediaFileTooLarge,m.InvalidMediaFileType,m.MediaFileFailedLoad,m.MediaFileEmpty,function(e){return t.set({exception:e,state:g.ERROR}),t})["catch"](function(e){return t.set({exception:new m.InvalidMediaFileType,state:g.ERROR}),t})},sendToChat:function(e,t){if(!this.mediaPrep)throw new Error("MediaPrep not available");if(this.state===g.ERROR)throw new Error(this.exception);if(!(this.state!==g.PROCESSING||this.previewable&&t.addEvenWhilePreparing))throw new Error("Media still processing");if(this.state===g.READY)return void this.mediaPrep.sendToChat(e,t);var a={mimetype:this.mimetype};switch(this.type){case c.OUTWARD_TYPES.VIDEO:a.isGif=this.isGif,a.gifAttribution=this.gifAttribution;case c.OUTWARD_TYPES.IMAGE:a.width=this.fullPreviewSize.width,a.height=this.fullPreviewSize.height,a.body=this.preview,t.placeholderProps=a;break;case c.OUTWARD_TYPES.DOCUMENT:a.pageCount=this.pdfPages,a.filename=this.filename,a.body=this.preview,t.placeholderProps=a;break;case c.OUTWARD_TYPES.AUDIO:case c.OUTWARD_TYPES.PTT:}this.mediaPrep.sendToChat(e,t)},getFileType:function(){return(0,d.typeFromMimetype)(this.file.type)},"delete":function(){this.fullPreview&&window.URL.revokeObjectURL(this.fullPreview),r["default"].prototype["delete"].call(this)}});_.AttachMedia.STATE=g,t["default"]=_.AttachMedia;t.AttachMediaProxy=_.AttachMediaProxy},7164:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChatPreferenceProxy=t["default"]=void 0;var o=a(74),n=(0,o.defineState)("ChatPreference",{Collection:"ChatPreference",props:{id:"string",wallpaperColor:"string"}}),r=n.ChatPreference,i=n.ChatPreferenceProxy;t["default"]=r,t.ChatPreferenceProxy=i},7165:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantProxy=t.GroupMetadataProxy=t["default"]=void 0;var n=a(0),r=o(n),i=a(3),l=o(i),s=a(74),u=o(s),c=a(12),d=o(c),f=a(270),p=o(f),h=a(499),m=o(h),g=a(8),_=o(g),v=a(486),b=o(v),y=a(14),E=o(y),S=a(47),C=o(S),M=a(1),k=o(M),w=a(38),N=o(w),T=a(179),P=(0,s.defineState)("Participant",{props:{id:"string",isAdmin:"boolean"},session:{contact:"object"},initialize:function(){u["default"].prototype.initialize.call(this),this.addChild("contact",Store.Contact.gadd(this.id))},"delete":function(){u["default"].prototype["delete"].call(this)}}),I=P.Participant,R=P.ParticipantProxy,A=p["default"].extend(m["default"],{model:I,comparator:function(e,t){return b["default"].Comparator(e.contact,t.contact)},initialize:function(){this.listenTo(this,"change:contact.name",this.sort),this.listenTo(d["default"],"locale_change",this.sort)},"delete":function(){this.invokeMap("delete"),this.stopListening(),this.reset()},addParticipant:function(e,t){var a=this;if(this.get(e.id))return k["default"].error("models:groupMetadata:participantCollection:addParticipant already a group member")(),r["default"].reject(new E["default"].ActionError);if(!this.canAdd())return r["default"].reject(new E["default"].ActionError);var o=N["default"].addParticipant(this.parent.id,e.id),n=new T.ActionType(l10n.t("action_participant_adding",{participant:e.formattedShortName}));t=t||(0,T.genId)();var i=o.then(function(t){return 200===t.status?new T.ActionType(l10n.t("action_participant_added",{participant:e.formattedShortName})):404===t.status?new T.ActionType(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new T.ActionType(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new T.ActionType(l10n.t("action_participant_add_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(o){return k["default"].error("models:groupMetadata:participantCollection:addParticipant dropped")(o),new T.ActionType(l10n.t("action_participant_add_failed"),l10n.t("action_try_again"),a.addParticipant.bind(a,e,t))});return d["default"].openToast(l["default"].createElement(T.ActionToast,{id:t,initialAction:n,pendingAction:i})),o},removeParticipant:function(e,t){var a=this;if(!this.canRemove(e))return r["default"].reject(new E["default"].ActionError);var o=N["default"].removeParticipant(this.parent.id,e.id),n=new T.ActionType(l10n.t("action_participant_removing",{
participant:e.contact.formattedShortName}));t=t||(0,T.genId)();var i=o.then(function(t){return 200===t.status?new T.ActionType(l10n.t("action_participant_removed",{participant:e.contact.formattedShortName})):404===t.status?new T.ActionType(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new T.ActionType(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new T.ActionType(l10n.t("action_participant_remove_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(o){return k["default"].error("models:groupMetadata:participantCollection:removeParticipant dropped")(o),new T.ActionType(l10n.t("action_participant_remove_failed"),l10n.t("action_try_again"),a.removeParticipant.bind(a,e,t))});return d["default"].openToast(l["default"].createElement(T.ActionToast,{id:t,initialAction:n,pendingAction:i})),o},promoteParticipant:function(e,t){var a=this;if(!this.canPromote(e))return r["default"].reject(new E["default"].ActionError);var o=N["default"].promoteParticipant(this.parent.id,e.id),n=new T.ActionType(l10n.t("action_participant_promoting",{participant:e.contact.formattedShortName}));t=t||(0,T.genId)();var i=o.then(function(t){return 200===t.status?new T.ActionType(l10n.t("action_participant_promoted",{participant:e.contact.formattedShortName})):404===t.status?new T.ActionType(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_404")):401===t.status?new T.ActionType(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_401")):403===t.status?new T.ActionType(l10n.t("action_participant_promote_failed")+" "+l10n.t("action_participant_failed_403")):void 0})["catch"](function(o){return k["default"].error("models:groupMetadata:participantCollection:removeParticipant dropped")(o),new T.ActionType(l10n.t("action_participant_promote_failed"),l10n.t("action_try_again"),a.promoteParticipant.bind(a,e,t))});return d["default"].openToast(l["default"].createElement(T.ActionToast,{id:t,initialAction:n,pendingAction:i})),o},canAdd:function(){return C["default"].supportsFeature(C["default"].F.GROUP_ADD_PARTICIPANT)?!!this.iAmAdmin():!1},canPromote:function(e){return C["default"].supportsFeature(C["default"].F.GROUP_PROMOTE_PARTICIPANT)&&e?Store.Conn.me===e.id?!1:this.iAmAdmin()?!e.isAdmin:!1:!1},canRemove:function(e){return C["default"].supportsFeature(C["default"].F.GROUP_REMOVE_PARTICIPANT)&&e?Store.Conn.me===e.id?!1:!!this.iAmAdmin():!1},canVerifyIdentity:function(e){return C["default"].supportsFeature(C["default"].F.QUERY_IDENTITY)&&e?Store.Conn.me===e.id?!1:!!e.contact.plaintextDisabled:!1},iAmMember:function(){return 1===this.where({id:Store.Conn.me}).length},iAmAdmin:function(){return 1===this.where({id:Store.Conn.me,isAdmin:!0}).length}}),x=(0,s.defineState)("GroupMetadata",{Collection:"GroupMetadata",props:{id:"string",creation:"number",owner:"string",desc:"string",descId:"string",descTime:"number",descOwner:"string"},session:{stale:["boolean",!1,!0],trusted:["boolean",!1,!0],inviteCode:"string",promises:{type:"object","default":function(){return{}}}},derived:{groupInviteLink:{deps:["inviteCode"],fn:function(){return this.inviteCode?""+_["default"].GROUP_INVITE_LINK_URL+this.inviteCode:null}}},collections:{participants:A},"delete":function(){u["default"].prototype["delete"].call(this),Store.GroupMetadata.remove(this.id),this.participants["delete"]()},canSetSubject:function(){return C["default"].supportsFeature(C["default"].F.GROUP_SET_SUBJECT)?!!this.participants.iAmMember():!1},initialize:function(){u["default"].prototype.initialize.call(this),this.listenTo(this.participants,"change:isAdmin change:contact.isMyContact sort remove reset",this.isTrusted),this.listenTo(this,"change:owner",this.isTrusted),this.isTrusted(),this.listenTo(this.participants,"add remove reset",this.onParticipantChange)},isTrusted:function(){if(this.stale)return this.trusted;if(!this.owner)return this.trusted=!1;if(this.owner===Store.Conn.me)return this.trusted=!0;var e=Store.Contact.get(this.owner);if(e&&e.isMyContact)return this.trusted=!0;for(var t=this.participants.models,a=0,o=t.length;o>a;++a){var n=t[a];if(n.isAdmin&&n.id!==Store.Conn.me&&n.contact.isMyContact)return this.trusted=!0}return this.trusted=!1},onParticipantChange:function(){Store.Contact.get(this.id).unset("_capabilities")},groupInviteCode:function(){var e=this;return this.promises.groupInviteCode?this.promises.groupInviteCode:this.promises.groupInviteCode=N["default"].groupInviteCode(this.id).then(function(t){var a=t.status,o=t.code;return 200===a&&(e.inviteCode=o),a})["finally"](function(){e.promises.groupInviteCode=null})},revokeGroupInvite:function(){var e=this;return this.promises.revokeGroupInvite?this.promises.revokeGroupInvite:this.promises.revokeGroupInvite=N["default"].revokeGroupInvite(this.id).then(function(t){var a=t.status,o=t.code;return 200===a&&(e.inviteCode=o),a})["finally"](function(){e.promises.revokeGroupInvite=null})}}),O=x.GroupMetadata,D=x.GroupMetadataProxy;t["default"]=O,t.GroupMetadataProxy=D,t.ParticipantProxy=R},7166:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantCollection=t.MsgInfoProxy=t["default"]=t.MsgInfoParticipantProxy=t.MsgInfoParticipant=void 0;var n=a(74),r=o(n),i=a(486),l=o(i),s=a(514),u=a(270),c=a(499),d=(0,n.defineState)("MsgInfoParticipant",{props:{id:"string",t:"number"},session:{contact:"object"},initialize:function(){r["default"].prototype.initialize.call(this),this.addChild("contact",Store.Contact.gadd(this.id))},getCollection:function(){return this.collection}}),f=d.MsgInfoParticipant,p=d.MsgInfoParticipantProxy,h=u.extend(c,{model:f,comparator:function(e,t){return l["default"].Comparator(e.contact,t.contact)},isStateStale:function(e){var t=this.get(e);return t&&t.stale}}),m=(0,n.defineState)("MsgInfo",{Collection:"MsgInfo",props:{id:"msgKey",isPTT:"boolean",playedRemaining:{type:"number","default":0},readRemaining:{type:"number","default":0},deliveryRemaining:{type:"number","default":0}},collections:{played:h,read:h,delivery:h},derived:{settled:{deps:["isPTT","playedRemaining","readRemaining"],fn:function(){return this.isPTT?!this.playedRemaining:!this.readRemaining}}}},s),g=m.MsgInfo,_=m.MsgInfoProxy;t.MsgInfoParticipant=f,t.MsgInfoParticipantProxy=p,t["default"]=g,t.MsgInfoProxy=_,t.ParticipantCollection=h},7167:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatusProxy=t["default"]=void 0;var o=a(74),n=(0,o.defineState)("Status",{Collection:"Status",props:{id:"string",status:"string"},session:{stale:["boolean",!1,!0]}}),r=n.Status,i=n.StatusProxy;t["default"]=r,t.StatusProxy=i},7168:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return t.reduce(function(t,a){var o=(0,f["default"])(e,function(e){return e.type===a});return o&&t.push(o),t},[])}var r=a(0),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7006),f=o(d),p=/\r\n/g,h=function(){function e(t){var a=this;(0,s["default"])(this,e),this.hasText=function(){return a.hasType("text/plain")},this.hasType=function(e){return-1!==a.types.indexOf(e)},this.data=t,this.types=t.types?Array.prototype.slice.call(t.types):[]}return(0,c["default"])(e,[{key:"getItems",value:function(){var e=this;if(this.data.items)return Array.prototype.slice.call(this.data.items);var t=this._getFileTypes();return this.types.map(function(a){return{type:a,data:e.data.getData(a),kind:t.indexOf(a)>=0?"string":"file"}})}},{key:"_getFileTypes",value:function(){return Array.prototype.slice.call(this.data.files).map(function(e){var t=e.type;return t})}},{key:"getText",value:function(e){return this._getText(e).then(function(e){return e?e.replace(p,"\n"):null})}},{key:"_getText",value:function(e){e=e||[],0===e.length&&e.push("text/plain");var t=this.data;if(t.getData){var a=void 0;return e.some(function(e){var o=t.getData(e);return o?(a=t.getData(e),!0):void 0}),i["default"].resolve(a)}var o=n(this.data.items,e);if(!o.length)return i["default"].resolve();var r=i["default"].all(o.map(function(e){return new i["default"](function(t){return e.getAsString(t)})}));return r.then(function(e){return e.find(function(e){return e.length})})}},{key:"getFiles",value:function(){return this.data.items?Array.prototype.slice.call(this.data.items).filter(function(e){var t=e.kind;return"file"===t}).map(function(e){return e.getAsFile()}).filter(function(e){return!!e}):Array.prototype.slice.call(this.data.files||[])}},{key:"getData",value:function(e){return this.data.getData(e)}},{key:"hasFiles",value:function(){return this.data.items?Array.prototype.slice.call(this.data.items).some(function(e){var t=e.kind;return"file"===t}):!!Array.prototype.slice.call(this.data.files||[]).length}}]),e}();e.exports=h},7169:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=!1,a=0;return s["default"].resolve().then(function(){var o="camera"===e?{video:{width:Store.ServerProps.imageMaxEdge,height:Store.ServerProps.imageMaxEdge}}:{audio:!0},n=void 0;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)n=navigator.mediaDevices.getUserMedia(o);else{if(!navigator.getUserMedia)throw new Error("MediaCapture:start no ability to capture media");n=new s["default"](function(e,t){window.navigator.getUserMedia(o,e,t)})}return a=setTimeout(function(){i(e),t=!0},1e3),n["catch"](function(e){var t=e&&e.name||e,a=p.GUM[t]||p.GUM.GUMError;return s["default"].reject(new a)})})["finally"](function(){t&&f["default"].closeModal(),a&&clearTimeout(a)})}function r(e){if("function"==typeof e.stop)e.stop();else for(var t=e.getTracks(),a=0;a<t.length;a++)t[a].stop()}function i(e){"camera"===e?f["default"].openModal(c["default"].createElement(m["default"],{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_description",type:m["default"].TYPE.GUIDE_ALLOW})):f["default"].openModal(c["default"].createElement(m["default"],{title:"guide_desktop_mic_title",desc:"guide_desktop_mic_description",type:m["default"].TYPE.GUIDE_ALLOW}))}Object.defineProperty(t,"__esModule",{value:!0});var l=a(0),s=o(l);t.start=n,t.stop=r;var u=a(3),c=o(u),d=a(12),f=o(d),p=a(14),h=a(7152),m=o(h)},7170:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=o(n),i=a(4),l=o(i),s=function(){function e(t,a){(0,r["default"])(this,e),this.row=t,this.section=a}return(0,l["default"])(e,null,[{key:"indexPathIterator",value:function(t,a,o){function n(){if(h){var t=h;return h=void 0,t}var a=i(f)-1;return a>p&&f<d.section||p<d.row&&f===d.section?new e(++p,f):f<d.section?(p=0,new e(p,++f)):void 0}function r(){if(h){var t=h;return h=void 0,t}return p>0&&f>c.section||p>0&&f===c.section?new e(--p,f):f>c.section?(p=i(--f)-1,new e(p,f)):void 0}var i=t.numberOfRowsInSection,l=t.numberOfSections,s=l()-1,u=i(s)-1,c=a?a:new e(0,0),d=o?o:new e(u,s);if(c.row<0||c.section<0)throw new Error("Invalid iterator range.");if(d.section>s||d.row>i(d.section))throw new Error("Invalid iterator range.");if(c.gt(d))throw new Error("Invalid iterator range.");var f=c.section,p=c.row,h=c;return{next:n,prev:r}}}]),(0,l["default"])(e,[{key:"lt",value:function(e){return this.section<e.section||this.section===e.section&&this.row<e.row}},{key:"gt",value:function(e){return this.section>e.section||this.section===e.section&&this.row>e.row}},{key:"equals",value:function(e){return this.row===e.row&&this.section===e.section}}]),e}();t["default"]=s},7171:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(e&&t){var a=[];return a.push(R["default"].t("links_count",{count:t,_plural:t})),a.push(R["default"].t("docs_count",{count:e,_plural:e})),a.join(R["default"].t("enumeration_comma"))}return t?R["default"].t("links_count",{count:t,_plural:t}):e?R["default"].t("docs_count",{count:e,_plural:e}):R["default"].t("no_media_links_docs")}var r=a(48),i=o(r),l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(10),v=o(_),b=a(176),y=o(b),E=a(484),S=(o(E),a(498)),C=(o(S),a(12)),M=o(C),k=a(8),w=o(k),N=a(23),T=o(N),P=a(7126),I=a(93),R=o(I),A=a(71),x=o(A),O=a(262),D=o(O),L=a(7134),U=o(L),F=a(7227),j=o(F),B=a(53),G=(o(B),a(7128)),V=(o(G),a(175)),Y=o(V),W=a(7118),H=o(W),q=a(487),z=a(174),K=a(7556),Q=o(K),J=a(3),X=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.onScroll=function(e){o.handleScroll(e.target)},o.handleScroll=v["default"].throttle(function(e){var t=o.props.mediaMsgs;t.hasMediaBefore&&e.scrollTop+w["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&o.queryMedia(v["default"].head(t.models))},100),n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.props.mediaMsgs.hasMediaBefore&&this.queryMedia()}},{key:"componentDidMount",value:function(){this.props.listeners.add(this.props.mediaMsgs,"add remove reset"),this.props.listeners.add(this.props.mediaMsgs,"query_media_before")}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel()}},{key:"queryMedia",value:function(e){var t=this,a=this.props.mediaMsgs;a.hasMediaBefore&&this.props.listeners.uiIdle(function(){a.queryMedia((0,q.unproxy)(t.props.chat),e)})}},{key:"render",value:function(){var e,t=this,a=this.props.mediaMsgs,o=this.props,r=o.fullCollection,l=o.selectedMessages,s=o.chat,u=a.map(function(e,o){var n=null;return!t.props.fullCollection&&o>=a.length-6&&o<=a.length-4&&(n=Q["default"].canvasSecondRow),J.createElement(ee,{msg:e,hoverEvent:r,selectable:t.props.selectable,selectedMessages:l,onMessageSelect:t.props.onMessageSelect,className:n,key:e.id})});u.reverse(),r||(u=v["default"].slice(u,0,6));var c=(0,T["default"])(Q["default"].container,(e={},(0,i["default"])(e,Q["default"].drawer,r),(0,i["default"])(e,Q["default"].galleryEmpty,0===a.length),e));if(a.queryMediaBefore&&(r||u.length<6)){var d,f=(0,T["default"])(Q["default"].more,Q["default"].canvasComponent,(d={},(0,i["default"])(d,Q["default"].canvasSecondRow,!r&&u.length>=3),(0,i["default"])(d,Q["default"].canvasFirst,0===a.length),d));u.push(J.createElement("div",{className:f,key:"spinner"},J.createElement(Y["default"],{stroke:6,size:24})))}if(0===a.length){if(r)return a.queryMediaBefore?J.createElement("div",{className:(0,T["default"])(Q["default"].drawer,Q["default"].drawerBody)},J.createElement(P.Loading,null)):J.createElement(P.MediaMsgs,null);a.queryMediaBefore||a.hasMediaBefore||(c=(0,T["default"])(c,Q["default"].galleryEmpty),u=[n(s.docCount,s.linkCount)])}else for(var p=0;6>p;p++)u.push(J.createElement("div",{className:Q["default"].canvasEmpty,key:"empty"+p}));return J.createElement("div",{onScroll:this.onScroll,"data-a8n":y["default"].key("media-gallery"),className:c},u)}}]),t}(J.Component);X.CONCERNS={chat:["linkCount","docCount"]};var Z=function(e){function t(){(0,c["default"])(this,t);var e=(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments));$.call(e);var a=e.props,o=a.msg,n=a.selectedMessages;return e.state={selected:!(!n||!n.isSelected(o))},e}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){this.props.selectedMessages&&this.props.listeners.add(this.props.selectedMessages,this.props.msg.id.toString(),this.onSelectChange)}},{key:"render",value:function(){var e=this.props.msg,t=e.mediaData,a=t.type===D["default"].TYPE.IMAGE&&t.renderableUrl?this.onDragStart:null,o=(0,T["default"])(this.props.className);return J.createElement(j["default"],{classes:o,onClick:this.onClick,hoverEvent:this.props.hoverEvent,selectable:this.props.selectable,selected:this.state.selected,onMessageSelect:this.props.onMessageSelect,onDragStart:a,msg:e,imgRef:(0,z.GetRef)("img",this)})}}]),t}(J.Component),$=function(){var e=this;this.onSelectChange=function(t){e.state.selected!==t&&e.setState({selected:t})},this.onClick=function(t){var a=e.props,o=a.msg,n=a.selectable,r=a.onMessageSelect,i=o.mediaData;if(n&&r)return void r(o,!e.state.selected);if(i.mediaStage===D["default"].STAGE.ERROR_MISSING)return void M["default"].openModal(J.createElement(U["default"],{msg:o}));t&&t.stopPropagation();var l=void 0,s=o.id;i.type===D["default"].TYPE.IMAGE&&!function(){var t=e.img;l=function(e){return s.equals(e)&&t?t:null}}(),M["default"].mediaViewerModal(o,l)},this.onDragStart=function(t){t.nativeEvent.dataTransfer.setData(w["default"].DRAG_TYPE_LOCAL_IMAGE,!0),t.nativeEvent.dataTransfer.setData("text/uri-list",e.props.msg.mediaData.renderableUrl)}},ee=(0,x["default"])(Z);e.exports=(0,x["default"])((0,H["default"])(X))},7172:function(e,t){"use strict";e.exports=function(e,t){for(var a=e.childNodes,o=0;o<a.length;++o)if(a[o]===t)return o;return-1}},7173:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(71),_=o(g),v=a(7573),b=o(v),y=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o._videoRef=null,o.setVideoRef=function(e){o._videoRef&&o.props.listeners.remove(o._videoRef,"playing",o.onPlay),o._videoRef=e,e&&o.props.listeners.add(e,"playing",o.onPlay)},o.onPlay=function(e){var t=o._videoRef;t&&(t.videoHeight&&t.videoWidth||(t.pause(),t.play()),t.videoHeight&&t.videoWidth&&o.props.onPlay&&o.props.onPlay(t))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"underlyingVideo",value:function(){return this._videoRef}},{key:"play",value:function(){var e=this._videoRef;e&&e.paused&&e.play()}},{key:"pauseAndReset",value:function(){var e=this._videoRef;e&&(e.currentTime=0,e.paused||e.pause())}},{key:"render",value:function(){var e=this.props;return m["default"].createElement("video",{ref:this.setVideoRef,src:e.src,className:b["default"].video,autoPlay:e.autoPlay,muted:e.muted,width:e.width,height:e.height,loop:e.loop,onClick:e.onClick,onEnded:e.onEnded},e.children)}}]),t}(h.PureComponent);t.Component=y;t["default"]=(0,_["default"])(y)},7174:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7123),_=o(g),v=a(172),b=o(v),y=a(23),E=o(y),S=a(73),C=o(S),M=a(71),k=o(M),w=a(10),N=o(w),T=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.promise=null,a._clearPromise=function(){a.promise=null},a._handleImageChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a.setState({img:e.img})},a.state={img:null},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.waid;t&&(this.promise=Store.ProfilePicThumb.find(t).then(function(t){e.props.listeners.add(t,"change:img",e._handleImageChange),e._handleImageChange(t)})["catch"](N["default"].noop)["finally"](this._clearPromise))}},{key:"componentWillUnmount",value:function(){this.promise&&this.promise.cancel()}},{key:"render",value:function(){if(this.state.img&&this.props.waid)return m["default"].createElement(_["default"],{id:this.props.waid,className:this.props.className,quoted:this.props.quoted,size:this.props.size,square:this.props.square,border:this.props.border});var e=this.props.size||_["default"].Size.SMALL,t={height:(0,g.getSize)(e),width:(0,g.getSize)(e)},a=(0,E["default"])("preview",this.props.className,{"preview-vcard":!this.props.thumb,"no-image":!this.props.thumb,"profile-image-square":this.props.square,"profile-image-border":this.props.border}),o=this.props.thumb?m["default"].createElement("div",{className:"preview-image",style:C["default"].thumbAsBackgroundImage(this.props.thumb)}):m["default"].createElement("div",{className:"profile-image-default"},m["default"].createElement(b["default"],{name:this.props.quoted?"default-user-square":"default-user",style:t}));return m["default"].createElement("div",{className:a,style:t},o)}}]),t}(m["default"].PureComponent);t["default"]=(0,k["default"])(T)},7175:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(46),v=n(_),b=a(62),y=o(b),E=a(8),S=n(E),C=a(23),M=n(C),k=a(7123),w=n(k),N=a(7139),T=n(N),P=a(7119),I=n(P),R=a(177),A=n(R),x=a(173),O=n(x),D=a(71),L=n(D),U=a(53),F=(n(U),a(7128)),j=(n(F),a(7125)),B=(n(j),a(264)),G=n(B),V=a(32),Y=n(V),W=a(7176),H=n(W),q=a(174),z=a(172),K=n(z);t["default"]=(0,L["default"])(function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));a.wrapper=null,a.onSelectionChange=function(e,t,o){var n="focus"===e;if(n){var r=v["default"].findDOMNode(a);A["default"].focus(r,o),t&&T["default"].scrollIntoViewIfNeeded(r)}a.setState({current:n})},a.onActiveChange=function(e,t,o){if("focus"===e){var n=v["default"].findDOMNode(a);A["default"].focus(n,o),T["default"].scrollIntoViewIfNeeded(n)}a.setState({active:!!e})},a.mouseOver=function(){a.state.hover||a.setState({hover:!0})},a.mouseEnter=function(){a.state.hover||a.setState({hover:!0})},a.mouseLeave=function(){a.state.hover&&a.setState({hover:!1})},a.onEnter=function(e){e.stopPropagation(),e.preventDefault(),a.props.onClickMsg&&a.props.onClickMsg(a.props.msg)},a.openContextMenu=function(){a.wrapper&&a.wrapper.contextOpen()},a.onFocus=function(e){a.setState({focus:!0}),a.indicateFocus(e)},a.onBlur=function(e){a.finishFocusIndication(e),a.setState({focus:!1})},a.indicateFocus=function(){var e=a.state.active?"#d6d7d8":"#e2e3e3";(0,x.indicateFocus)(a.row,[e,"#cbdde7"],{complete:a.finishFocusIndication})},a.finishFocusIndication=function(){var e=a.row;e&&((0,G["default"])(e,"stop"),e.style.backgroundColor="")};var o=e.currSelection,n=e.activeSelection,r=e.msg;return a.state={hover:!1,current:o?o.value===r:!1,active:n?n.value===r:!1,focus:!1},a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.msg,a=e.currSelection,o=e.activeSelection,n=e.listeners;a&&n.add(a,t.id.toString(),this.onSelectionChange),o&&n.add(o,t.id.toString(),this.onActiveChange)}},{key:"render",value:function(){var e=this,t=this.props,a=t.msg,o=t.selectedMessages,n=t.displayType,r=a.senderObj.formattedName,i=a.chat.isUser?Store.Contact.get(a.to).formattedName?Store.Contact.get(a.to).formattedName:Y["default"].formattedUser(a.to):a.chat.title(),l=(0,M["default"])("starred-msg-wrapper",{hover:this.state.hover,current:this.state.current&&this.state.focus,active:this.state.active}),s=n===S["default"].DISP_TYPE.GALLERY?null:g["default"].createElement("div",{className:"starred-msg-title"},g["default"].createElement("div",{className:"starred-title-main"},g["default"].createElement("div",{className:"starred-msg-avatar"},g["default"].createElement(w["default"],{id:a.senderObj.id,size:26})),g["default"].createElement(I["default"],{className:"starred-msg-author",text:r,direction:"auto",ellipsify:!0,titlify:!0}),g["default"].createElement("span",{className:"starred-title-divider"}),g["default"].createElement(I["default"],{className:"starred-msg-chat",text:i,direction:"auto",ellipsify:!0,titlify:!0})),g["default"].createElement("div",{className:"starred-title-meta"},y.relativeStr(a.t)),g["default"].createElement("div",{className:"starred-chevron-icon"},g["default"].createElement(K["default"],{name:"chevron-right-alt",directional:!0}))),u={enter:this.onEnter};u[l10n.LR("right","left")]=this.openContextMenu;var c=this.props.selectable||this.state.hover&&n===S["default"].DISP_TYPE.GALLERY;return g["default"].createElement(O["default"],{handlers:u,onFocus:this.onFocus,onBlur:this.onBlur},g["default"].createElement("div",{ref:(0,q.GetRef)("row",this),className:l,onClick:function(){return e.props.onClickMsg&&e.props.onClickMsg(a,o&&!o.isSelected(a))},onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null},s,g["default"].createElement(H["default"],{msg:a,key:a.id,ref:(0,q.GetRef)("wrapper",this),current:this.state.current&&this.state.focus,displayType:n||S["default"].DISP_TYPE.STARRED_MSGS,isMsgVisible:this.props.isMsgVisible,selectable:c,selectedMessages:o,onMessageSelect:this.props.onMessageSelect,position:W.MsgPosition.END,tailOverride:"left"})))}}]),t}(g["default"].Component))},7176:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){switch(e.type){case ae["default"].TYPE.NOTIFICATION:return"message-notification";case ae["default"].TYPE.GROUP_NOTIFICATION:return"message-group_notification";case ae["default"].TYPE.GP2:return"message-gp2";case ae["default"].TYPE.BROADCAST_NOTIFICATION:return"message-broadcast_notification";case ae["default"].TYPE.E2E_NOTIFICATION:return"message-e2e_notification";case ae["default"].TYPE.CALL_LOG:return"message-call_log";case ae["default"].TYPE.PROTOCOL:return"message-protocol";case ae["default"].TYPE.CHAT:return"message-chat";case ae["default"].TYPE.LOCATION:return e.isLive?null:"message-location";case ae["default"].TYPE.VCARD:return"message-vcard";case ae["default"].TYPE.CIPHERTEXT:return"message-ciphertext";case ae["default"].TYPE.MULTI_VCARD:return"message-multi_vcard";case ae["default"].TYPE.REVOKED:return"message-revoked";case ae["default"].TYPE.IMAGE:return"message-image";case ae["default"].TYPE.VIDEO:return e.mediaData.isGif?"message-gif":"message-video";case ae["default"].TYPE.AUDIO:return"message-audio";case ae["default"].TYPE.PTT:return"message-ptt";case ae["default"].TYPE.DOCUMENT:return"message-document";case ae["default"].TYPE.UNKNOWN:return"message-unknown";default:return}}function r(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0}),t.Wrapper=t.MsgPosition=void 0;var i,l,s=a(0),u=o(s),c=a(5),d=o(c),f=a(2),p=o(f),h=a(4),m=o(h),g=a(7),_=o(g),v=a(6),b=o(v),y=a(3),E=o(y),S=a(7142),C=o(S),M=a(12),k=o(M),w=a(495),N=o(w),T=a(94),P=o(T),I=a(8),R=o(I),A=a(23),x=o(A),O=a(7258),D=o(O),L=a(7139),U=o(L),F=a(491),j=o(F),B=a(7377),G=o(B),V=a(7201),Y=o(V),W=a(47),H=o(W),q=a(71),z=o(q),K=a(1),Q=o(K),J=a(262),X=(o(J),a(7385)),Z=o(X),$=a(7127),ee=o($),te=a(53),ae=o(te),oe=a(7248),ne=o(oe),re=a(7128),ie=(o(re),a(126)),le=o(ie),se=a(46),ue=o(se),ce=a(7138),de=o(ce),fe=a(7118),pe=o(fe),he=a(487),me=a(261),ge=o(me),_e=a(7137),ve=o(_e),be=a(264),ye=o(be),Ee=a(174),Se=a(172),Ce=o(Se),Me=t.MsgPosition={FRONT:"FRONT",MID:"MID",END:"END",SINGLE:"SINGLE"},ke=(0,z["default"])(function(e){function t(){var e,a,o,n;(0,p["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,_["default"])(this,(e=t.__proto__||(0,d["default"])(t)).call.apply(e,[this].concat(i))),o.scrollMsg=function(e,t){o.props.parent.scrollMsg(e,t)},o.flashFocusedMsg=function(e){o.props.parent.highlight(e)},n=a,(0,_["default"])(o,n)}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(k["default"],"scroll_to_focused_msg",this.scrollMsg),this.props.listeners.add(k["default"],"flash_focused_msg",this.flashFocusedMsg)}},{key:"render",value:function(){return null}}]),t}(E["default"].PureComponent)),we=(0,z["default"])(function(e){function t(){var e,a,o,n;(0,p["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,_["default"])(this,(e=t.__proto__||(0,d["default"])(t)).call.apply(e,[this].concat(i))),o.onSelectChange=function(e){o.props.parent.onSelectChange(e)},n=a,(0,_["default"])(o,n)}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.listeners,a=e.msgId,o=e.selectedMessages;t.add(o,a,this.onSelectChange)}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.listeners,o=t.msgId,n=t.selectedMessages;e.selectedMessages!==n&&(a.remove(e.selectedMessages,o,this.onSelectChange),a.add(n,o,this.onSelectChange))}},{key:"render",value:function(){return null}}]),t}(E["default"].PureComponent)),Ne=(0,pe["default"])((l=i=function(e){function t(){return(0,p["default"])(this,t),(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).apply(this,arguments))}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentDidUpdate",value:function(){this.props.parent.forceUpdate()}},{key:"render",value:function(){return null}}]),t}(E["default"].PureComponent),i.CONCERNS={mediaData:["isGif"]},l)),Te=t.Wrapper=function(e){function t(e){(0,p["default"])(this,t);var a=(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));return a.didCancel=!1,a.highlightAnimation=null,a.refMsgComponent=null,a.resend=function(){var e=a.props.msg;e.isMMS&&!H["default"].supportsFeature(H["default"].F.MEDIA_RETRY)?k["default"].openModal(E["default"].createElement(de["default"],{msg:e})):e.resend()["catch"](function(e){Q["default"].log("wrapper:resend failure: "+e)()})},a.mouseEnter=function(e){e.buttons||a.state.hover||!a.contextEnabled()||a.setState({hover:!0})},a.mouseLeave=function(){a.state.hover&&a.contextEnabled()&&a.setState({hover:!1})},a.mouseDown=function(){a.state.hover&&a.setState({hover:!1})},a.onMenu=function(e){if(e.stopPropagation(),e.preventDefault(),e.isTrusted&&a.state.contextMenu)return void a.setState({contextMenu:!1});var t=(0,he.unproxy)(a.props.msg),o=[];t.isSentByMe&&H["default"].supportsFeature(H["default"].F.MESSAGE_INFO)&&a.props.displayType!==R["default"].DISP_TYPE.MSG_INFO&&t.type!==ae["default"].TYPE.REVOKED&&o.push(E["default"].createElement(ee["default"],{key:"info",a8n:"mi-msg-info",action:function(){a.openInfoDrawer()}},l10n.t("message_info"))),t.canReply()&&(o.push(E["default"].createElement(ee["default"],{key:"reply",a8n:"mi-msg-reply",action:function(){a.onReplyMessage()}},l10n.t("reply"))),t.isGroupMsg&&!t.isSentByMe&&H["default"].supportsFeature(H["default"].F.PRIVATE_REPLY)&&o.push(E["default"].createElement(ee["default"],{key:"private_reply",a8n:"mi-msg-reply",action:function(){a.onPrivateReplyMessage()}},l10n.t("private_reply")))),t.mediaData&&t.mediaData.renderableUrl&&t.type!==ae["default"].TYPE.REVOKED&&o.push(E["default"].createElement(ee["default"],{key:"download",a8n:"mi-msg-download",action:function(){a.onDownload()}},l10n.t("web_button_download"))),t.canForward()&&o.push(E["default"].createElement(ee["default"],{key:"forward",a8n:"mi-msg-forward",action:function(){a.openForwardFlow(!0)}},l10n.t("forward_message"))),t.canStar()&&(t.star?o.push(E["default"].createElement(ee["default"],{key:"star",a8n:"mi-msg-unstar",action:function(){a.onUnstarMessage()}},l10n.t("unstar_message"))):o.push(E["default"].createElement(ee["default"],{key:"star",a8n:"mi-msg-star",action:function(){a.onStarMessage()}},l10n.t("star_message")))),H["default"].supportsFeature(H["default"].F.MESSAGE_DELETE)&&o.push(E["default"].createElement(ee["default"],{key:"delete",a8n:"mi-msg-delete",action:function(){a.onDeleteMessage()}},l10n.t("delete_message"))),t.isGroupMsg&&t.author&&!t.isSentByMe&&o.push(E["default"].createElement(ee["default"],{key:"author",a8n:"mi-msg-author",action:function(){a.openContactChat()}},l10n.t("message_author",{author:t.displayName()}))),a.setState({contextMenu:{menu:o,anchor:e.target,theme:$.ThemeOptions.COMPACT
}})},a.onSelectClick=function(e){e&&e.stopPropagation();var t=a.props.onMessageSelect;t?t((0,he.unproxy)(a.props.msg),!a.state.selected):Q["default"].assert(!1,"wrapper-onSelectClick","no onMessageSelect")()},a.onDoubleClick=function(e){var t=a.props.displayType,o=(0,he.unproxy)(a.props.msg);if(o.canReply()&&!a.props.selectable&&t===R["default"].DISP_TYPE.CONVERSATION){var n=function(e,t){for(var a=t;a;){if(a===e)return!0;a=a.parentNode}return!1};n(a.refs.bubble,e.target)||(o.chat.composeQuotedMsg=o,k["default"].focusChatTextInput(o.chat),a.highlight())}},a.state={contextMenu:!1,hover:!1,highlighting:!1,selected:e.selectedMessages?e.selectedMessages.isSelected((0,he.unproxy)(e.msg)):!1},a}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillUnmount",value:function(){var e=ue["default"].findDOMNode(this.refs.bubble);e&&(0,ye["default"])(e,"finish",!0)}},{key:"scrollMsg",value:function(e,t){Q["default"].info("scroll msg")(),Q["default"].info(t)();var a=ue["default"].findDOMNode(this);a?Q["default"].info("node found")():Q["default"].info("node not found!")(),Q["default"].info("calling DOM.scrollAt ")(),U["default"].scrollAt(a,null,t).then(e)}},{key:"highlight",value:function(e){var t=this,a=this.refs.highlightTail,o=this.refs.bubble;if(a&&o){this.setState({highlighting:!0}),this.highlightAnimation&&(this.didCancel=!0,this.highlightAnimation.cancel());var n=ue["default"].findDOMNode(a),r=ue["default"].findDOMNode(o);this.highlightAnimation=(this.highlightAnimation||u["default"].resolve()).then(function(){var e=250,a=250,o=(0,ye["default"])(n,{opacity:[1,0]},{duration:e}),i=(0,ye["default"])(n,{opacity:[0,1]},{duration:e,delay:a}),l=void 0,s=void 0;t.props.msg.isNotification?(l="#e1f2fb",s="#b6c9d2"):(l=t.props.msg.isSentByMe?"#dcf8c6":"#ffffff",s=t.props.msg.isSentByMe?"#b3cba1":"#cccccc");var c=(0,ye["default"])(r,{backgroundColor:[s,l]},{duration:e}),d=(0,ye["default"])(r,{backgroundColor:[l,s]},{duration:e,delay:a});return u["default"].all([o,i,c,d])}).cancellable().then(function(){t.onHighlightComplete(e)})["catch"](u["default"].CancellationError,function(){(0,ye["default"])(n,"stop",!0),(0,ye["default"])(r,"stop",!0)})["finally"](function(){t.didCancel?t.didCancel=!1:t.highlightAnimation=null})}}},{key:"onHighlightComplete",value:function(e){this.setState({highlighting:!1},function(){e&&e()})}},{key:"openForwardFlow",value:function(e){var t,a=this.props.msg;if(a.type===ae["default"].TYPE.CIPHERTEXT?t=l10n.t("err_unsent_forward_text_decrypting"):a.type===ae["default"].TYPE.REVOKED?t=l10n.t("err_unsent_forward_text_revoked"):a.isUnsentMedia&&(t=l10n.t("err_unsent_forward_text",{_plural:1})),t)k["default"].openModal(E["default"].createElement(P["default"],{title:l10n.t("err_unsent_forward_title"),onOK:k["default"].closeModal.bind(k["default"]),okText:l10n.t("web_ok")},t));else{if(e&&this.props.displayType===R["default"].DISP_TYPE.CONVERSATION)return void this.onSelectClick();k["default"].openModal(E["default"].createElement(Y["default"],{msgs:[(0,he.unproxy)(a)]}),"modal-flow")}}},{key:"openInfoDrawer",value:function(){k["default"].msgInfoDrawer((0,he.unproxy)(this.props.msg))}},{key:"openContactChat",value:function(){Store.Chat.find(this.props.msg.author).then(function(e){k["default"].openChatFromUnread(e).then(function(t){t&&k["default"].focusChatTextInput(e)})})}},{key:"contextEnabled",value:function(){return!this.props.msg.isNotification}},{key:"onDeleteMessage",value:function(){k["default"].openModal(E["default"].createElement(D["default"],{chat:this.props.msg.chat,msgList:[this.props.msg],deletePrompt:!0,revokePrompt:this.props.msg.canRevoke()}))}},{key:"onReplyMessage",value:function(){var e=(0,he.unproxy)(this.props.msg),t=e.chat;t.composeQuotedMsg=e,k["default"].focusChatTextInput(t)}},{key:"onPrivateReplyMessage",value:function(){var e=(0,he.unproxy)(this.props.msg);Store.Chat.find(e.sender).then(function(e){return u["default"].props({ok:k["default"].openChatBottom(e),chat:e})}).then(function(t){var a=t.ok,o=t.chat;a&&(o.composeQuotedMsg=e)})}},{key:"onDownload",value:function(){j["default"].initDownload((0,he.unproxy)(this.props.msg))}},{key:"onStarMessage",value:function(){var e=(0,he.unproxy)(this.props.msg);k["default"].sendStarMsgs(e.chat,[e])}},{key:"onUnstarMessage",value:function(){var e=(0,he.unproxy)(this.props.msg);k["default"].sendUnstarMsgs(e.chat,[e])}},{key:"contextOpen",value:function(){this.context&&this.context.click()}},{key:"contextClose",value:function(){this.setState({contextMenu:!1})}},{key:"getMsgComponent",value:function(){var e=this.props,t=e.msg,a=e.position,o=e.displayType,n=e.isMsgVisible,r=t.type!==ae["default"].TYPE.CHAT||o!==R["default"].DISP_TYPE.STARRED_MSGS&&!!t.quotedMsg||!(a===Me.MID||a===Me.END);return E["default"].createElement(ne["default"],{displayType:o,msg:t,ref:(0,Ee.GetRef)("refMsgComponent",this),displayAuthor:r,isMsgVisible:n})}},{key:"getMsgComponentRef",value:function(){return this.refMsgComponent&&this.refMsgComponent.ref}},{key:"onSelectChange",value:function(e){this.state.selected!==e&&this.setState({selected:e})}},{key:"render",value:function(){var e,t=this,a=this.props,o=a.msg,i=a.position,l=a.displayType,s=l===R["default"].DISP_TYPE.CONVERSATION;(this.state.hover&&!this.state.highlighting||this.props.current||this.state.contextMenu)&&l!==R["default"].DISP_TYPE.GALLERY&&(e=E["default"].createElement(Z["default"],{msg:o,position:i,key:"icon-context",ref:(0,Ee.GetRef)("context",this),onClick:this.onMenu}));var u=null;!o.isNotification&&this.props.selectable&&(u=E["default"].createElement("div",{className:"msg-select",onClick:this.onSelectClick},E["default"].createElement(C["default"],{onChange:this.onSelectClick,checked:this.state.selected})));var c=i===Me.MID||i===Me.END,d=!1;if(o.type===ae["default"].TYPE.CHAT){var f=N["default"].match(o.body);d=1===f.length&&f[0][4][0].length===o.body.length}var p=o.type,h=p===ae["default"].TYPE.CIPHERTEXT||p===ae["default"].TYPE.UNKNOWN,m=p===ae["default"].TYPE.CHAT&&!o.linkPreview,g=o.chat&&o.chat.isPSA,_=(0,x["default"])("msg",{"msg-continuation":i===Me.FRONT||i===Me.MID,"msg-group":o.isGroupMsg&&!c,"msg-psa":l!==R["default"].DISP_TYPE.STARRED_MSGS&&g,selected:this.state.selected,"msg-system":o.isNotification}),v=(0,x["default"])("message",n(o),{"message-system":o.isNotification,"message-out":!o.isNotification&&o.isSentByMe,"message-in":!o.isNotification&&!o.isSentByMe,hover:this.state.contextMenu||this.state.hover,tail:!(g||this.props.tailOverride||i!==Me.FRONT&&i!==Me.SINGLE),"tail-override-left":"left"===this.props.tailOverride,"tail-override-right":"right"===this.props.tailOverride,"message-chat":m||h||o.isLive,"message-code":d,"message-placeholder":h,"message-revoked-placeholder":o.isRevoked}),b=void 0;b=this.state.contextMenu?"none":"rtl"===o.dir||void 0===o.dir&&l10n.isRTL()?"pop-fast-reverse":"pop-fast";var y=E["default"].createElement("span",{className:"tail-container highlight",ref:"highlightTail"}),S=void 0;this.state.contextMenu&&(S=E["default"].createElement(ge["default"],{displayName:"MsgContextMenu",escapable:!0,popable:!0,requestDismiss:function(){return t.contextClose()}},E["default"].createElement(ve["default"],{contextMenu:this.state.contextMenu})));var M=void 0;this.props.isFocusedMsg&&(M=E["default"].createElement(ke,{parent:this}));var k=void 0;this.props.selectedMessages&&(k=E["default"].createElement(we,{parent:this,msgId:o.id.toString(),selectedMessages:this.props.selectedMessages}));var w=void 0;s&&!this.props.selectable&&o.canForward()&&(o.isMMS||o.linkPreview||o.type===ae["default"].TYPE.LOCATION)&&(w=E["default"].createElement("div",{className:"btn-forward-chat",onClick:function(){return t.openForwardFlow(!1)}},E["default"].createElement(Ce["default"],{name:"forward-chat",directional:!0})));var T=void 0;o.mediaData&&(T=E["default"].createElement(Ne,{parent:this,mediaData:o.mediaData}));var P=r;return E["default"].createElement("div",{className:_,onDoubleClick:this.onDoubleClick},E["default"].createElement(le["default"],{transitionName:"delay-leave"},u),E["default"].createElement("div",{className:v,ref:"bubble"},E["default"].createElement("div",{onContextMenu:P,onMouseOver:this.mouseEnter,onMouseEnter:this.mouseEnter,onMouseDown:this.mouseDown,onMouseUp:this.mouseEnter,onMouseLeave:this.mouseLeave},E["default"].createElement("span",{className:"tail-container"}),"  ",y,"                      ",E["default"].createElement(G["default"],{displayType:l,msg:o}),this.getMsgComponent(),E["default"].createElement(le["default"],{transitionName:b},e)),w),S,M,k,T)}}]),t}(E["default"].PureComponent);Te.defaultProps={displayType:R["default"].DISP_TYPE.CONVERSATION},Te.CONCERNS={msg:["author","body","chat","dir","id","isFailed","isGroupMsg","isLive","isMedia","isMMS","isNotification","isRevoked","isSentByMe","isUnsentMedia","linkPreview","mediaData","quotedMsg","sender","star","type"]},t["default"]=(0,pe["default"])(Te)},7177:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.EmojiPanel=t.DISP_LOCATION=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(23),b=o(v),y=a(10),E=o(y),S=a(21),C=o(S),M=a(126),k=o(M),w=a(7062),N=o(w),T=a(34),P=o(T),I=a(7406),R=o(I),A=a(7178),x=a(177),O=a(7139),D=o(O),L=a(95),U=o(L),F=a(7405),j=o(F),B=a(502),G=o(B),V=a(173),Y=o(V),W=a(7279),H=o(W),q=a(7162),z=a(71),K=o(z),Q=a(174),J=a(39),X=a(172),Z=o(X),$=1e3,ee=100,te=85,ae=62,oe=27,ne=62,re=33,ie=5,le=15,se=.7*ne,ue=1.5*ne,ce=t.DISP_LOCATION={COMPOSE_BOX:"COMPOSE_BOX",DROPDOWN:"DROPDOWN"},de=t.EmojiPanel=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));a.lastScrollTop=0,a.fastScroll=!1,a.lastClickTime=0,a.emojiTabRefs={},a.emojiTabContainerRefs={},a.getCurrentShownTabs=function(){return a.state.isPreview?E["default"].slice(A.TabsOrdered,0,2):A.TabsOrdered},a.getCurrentTabFromScroll=function(e){var t=a.getCurrentShownTabs(),o=E["default"].max([e.scrollTop,0]);return E["default"].findLast(t,function(e){var t=_["default"].findDOMNode(a.emojiTabContainerRefs[e.key]);return o+te>=t.offsetTop})},a.onScroll=function(){a.handleScroll()},a._handleScroll=function(){if(!(a.state.selected!==A.Tab.GIFS&&a.state.searchText||Date.now()-a.lastClickTime<$)){var e={};if(a.state.isPreview&&(e.isPreview=!1),a.scrollContainer){var t=a.scrollContainer,o=a.state.selected===A.Tab.GIFS?A.Tab.GIFS:a.getCurrentTabFromScroll(t);o!==a.state.selected&&(e.selected=o,a.lastFocusedSection=null);var n=t.scrollTop,r=0>=n;r!==a.state.scrolledToTop&&(e.scrolledToTop=r);var i=a.lastScrollTop-n,l=Math.abs(i)>ie;a.fastScroll=Math.abs(i)>le,0>i?a.state.showSearchInput&&(n>se&&l||a.lastScrollTop<se&&n>=se)&&(e.showSearchInput=!1):a.state.showSearchInput||(l||ue>n)&&(e.showSearchInput=!0),a.state.selected===A.Tab.GIFS&&a.gifPanel&&a.gifPanel.animateOnScroll(t),a.lastScrollTop=n,E["default"].isEmpty(e)||a.setState(e)}}},a.setEmojiTabRef=function(e,t){t?a.emojiTabRefs[e]=t:delete a.emojiTabRefs[e]},a.setEmojiTabContainerRef=function(e,t){t?a.emojiTabContainerRefs[e]=t:delete a.emojiTabContainerRefs[e]},a.scrollToPanel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=a.emojiTabContainerRefs[e.key];if(n){var r=_["default"].findDOMNode(n);t?(D["default"].scrollAt(r,r.parentNode,{pos:"offset",duration:300,animate:!0,easing:[.99,.13,.13,.99],offset:o}),a.lastScrollTop=r.offsetTop):D["default"].scrollAt(r,r.parentNode,{pos:"offset",offset:o})}},a.onSelectTab=function(e){a.lastClickTime=Date.now();var t=a.state.tabs.indexOf(a.state.selected),o=a.state.tabs.indexOf(e),n=a.state.searchText,r=a.state.searchResults;o!==t&&e!==A.Tab.GIFS&&(n=null,r=null),o===t&&a.restoreFocus(),a.lastFocusedSection=null,a.setState({selected:e,showSearchInput:!0,searchText:n,searchResults:r,isPreview:!1})},a.onEmoji=function(e){a.props.onEmoji(e),Store.RecentEmoji.increment(e)},a.restoreFocus=function(){a.lastFocusedSection?a.lastFocusedSection.restoreFocus():a.searchInput&&a.state.showSearchInput&&a.focusSearchInput()},a.onRotateFocus=function(e){var t=!1;e&&(a.stopEvent(e),t=!!e.shiftKey,(0,V.shouldIndicateFocus)()),a.searchInputHasFocus()?a.state.selected===A.Tab.GIFS?t?a.onSelectTab(A.Tab.RECENT):a.props.onFocusRelease(e):t?a.props.onFocusRelease(e):a.onSelectTab(A.Tab.GIFS):a.focusSearchInput(e)},a.getPanelContent=function(){if(a.state.selected===A.Tab.GIFS)return m["default"].createElement(R["default"],{ref:(0,Q.GetRef)("gifPanel",a),onGif:a.props.onGif,searchText:a.state.searchText});if(a.state.searchResults){var e=a.state.searchResults;return m["default"].createElement("div",{className:"emoji-panel-section",key:A.Tab.SEARCH_RESULT.key,ref:(0,Q.refWrapper)(function(e){return a.setEmojiTabContainerRef(A.Tab.SEARCH_RESULT.key,e)})},m["default"].createElement(j["default"],{tab:A.Tab.SEARCH_RESULT,ref:(0,Q.refWrapper)(function(e){return a.setEmojiTabRef("emojiTab-SEARCH_RESULT",e)}),key:a.state.searchText,emojiList:e,focusPrevSection:a.focusPrevSection,onFocusRelease:a.props.onFocusRelease,scrollEmojiIntoViewIfNeeded:a.scrollEmojiIntoViewIfNeeded,onEmoji:a.onEmoji}))}var t=a.getCurrentShownTabs();return E["default"].map(t,function(e){var t=e===A.Tab.RECENT?a.state.recentEmojis||[]:G["default"][e.key];return m["default"].createElement("div",{className:"emoji-panel-section",key:e.key,ref:(0,Q.refWrapper)(function(t){return a.setEmojiTabContainerRef(e.key,t)})},m["default"].createElement(j["default"],{tab:e,ref:(0,Q.refWrapper)(function(t){return a.setEmojiTabRef("emojiTab-"+e.key,t)}),emojiList:t,onEmoji:a.onEmoji,scrollEmojiIntoViewIfNeeded:a.scrollEmojiIntoViewIfNeeded,focusPrevSection:a.focusPrevSection,focusNextSection:a.focusNextSection,onFocusRelease:a.props.onFocusRelease}))})},a.stopEvent=function(e){e&&(e.preventDefault(),e.stopPropagation())},a.searchInputHasFocus=function(){var e=document.activeElement;return e?e===a.searchInput:!1},a.focusSearchInput=function(e){a.searchInput&&(a.searchInputHasFocus()||((0,x.focus)(a.searchInput,e),(0,V.indicateFocus)(a.searchContainer,["#e0e1e2","#d9f3ff"])))},a.onSearchDown=function(e){var t=a.getSectionToFocus();t.focusRow(a.getEmojiRowNumberToFocus(t),e),a.lastFocusedSection=t},a.getEmojiRowNumberToFocus=function(e){var t=_["default"].findDOMNode(e);if(!a.scrollContainer)return 0;var o=a.scrollContainer.scrollTop-t.offsetTop-oe;return a.state.showSearchInput&&(o=o+ne+re),0>o?0:Math.floor(o/A.EMOJI_HEIGHT)},a.onSearchEnter=function(e){if(a.state.searchText){var t=a.getSectionToFocus();t.keyboardSelectRow(e,a.getEmojiRowNumberToFocus(t)),a.lastFocusedSection=t}},a.getSectionToFocus=function(){return a.state.searchText?a.emojiTabRefs["emojiTab-SEARCH_RESULT"]:a.state.selected===A.Tab.RECENT?a.getFirstSectionWithEmoji():a.emojiTabRefs["emojiTab-"+a.state.selected.key]},a.getFirstSectionWithEmoji=function(){if(a.state.searchText)return a.emojiTabRefs["emojiTab-SEARCH_RESULT"];var e=a.emojiTabRefs["emojiTab-RECENT"];return a.state.recentEmojis?e:a.emojiTabRefs["emojiTab-SMILEYS_PEOPLE"]},a.scrollEmojiIntoViewIfNeeded=function(e){a.scrollContainer&&e.offsetTop-a.scrollContainer.scrollTop<ne&&D["default"].scrollIntoView(e,!0,a.scrollContainer)},a.focusPrevSection=function(e,t){var o=E["default"].findIndex(a.state.tabs,e);if(o--,o>=0){var n=a.state.tabs[o],r=a.emojiTabRefs["emojiTab-"+n.key],i=n===A.Tab.RECENT&&a.state.recentEmojis,l=n===A.Tab.SEARCH_RESULT&&a.state.searchResults,s=n!==A.Tab.RECENT&&n!==A.Tab.SEARCH_RESULT;i||l||s?(r&&r.focusLastRow(t),a.lastFocusedSection=r):((0,V.shouldIndicateFocus)(),a.focusSearchInput())}else(0,V.shouldIndicateFocus)(),a.focusSearchInput()},a.focusNextSection=function(e,t){var o=E["default"].findIndex(a.state.tabs,e);if(o++,o<a.state.tabs.length){var n=a.state.tabs[o],r=a.emojiTabRefs["emojiTab-"+n.key];r&&r.focusFirstRow(t),a.lastFocusedSection=r}},a.clearSearchText=function(){a.setState({searchText:null,searchResults:null})},a.getSearchBox=function(){var e=void 0;if(a.state.showSearchInput){var t=void 0,o=void 0;a.state.selected===A.Tab.GIFS?(t=l10n.t("search_gifs",{service:q.BRAND_NAMES[(0,q.gifProvider)()]}),o={}):(t=l10n.t("search_emoji"),o={enter:a.onSearchEnter,down:a.onSearchDown});var n=null;a.state.searchText&&(n=m["default"].createElement("button",{className:"emoji-search-cancel-icon",onClick:a.clearSearchText},m["default"].createElement(Z["default"],{name:"x-alt-small"})));var r=(0,b["default"])("emoji-search-row",{"emoji-search-row-shade":!a.state.scrolledToTop});e=m["default"].createElement(Y["default"],{handlers:o,"data-tab":4,className:r,key:a.state.showSearchInput,onFocus:a.focusSearchInput},m["default"].createElement("label",{ref:(0,Q.GetRef)("searchContainer",a),className:"emoji-search-row-input"},m["default"].createElement("div",{className:"input-container"},m["default"].createElement("input",{ref:(0,Q.GetRef)("searchInput",a),className:(0,b["default"])("input input-emoji-search",J.SELECTABLE_INPUT_CSS_CLASS),type:"text",dir:"auto",value:a.state.searchText||"",title:t,placeholder:t,onMouseDown:function(e){e.stopPropagation()},onChange:a.onSearch}),n)))}else e=null;var i=a.fastScroll?"emoji-search-slide-away-fast":"emoji-search-slide-away";return m["default"].createElement(k["default"],{transitionName:i},e)},a.onSearch=function(e){a.stopEvent(e);var t=void 0,o=E["default"].trimStart(e.target.value);0===o.length?(o=null,t=null):t=(0,H["default"])(o),null===a.state.searchText&&(a.scrollTopBeforeSearch=a.scrollContainer&&a.scrollContainer.scrollTop),a.setState({searchText:o,searchResults:t})},a.preventBlur=function(e){a.stopEvent(e),a.restoreFocus()};var o=a.props.onGif?A.ExtendedTabs:A.TabsOrdered,n=void 0;n=a.props.initialTab?a.props.initialTab:a.props.onGif&&A.Tab[C["default"].getLastEmojiTab()]===A.Tab.GIFS?A.Tab.GIFS:A.Tab.RECENT;var i=E["default"].uniq(E["default"].filter(Store.RecentEmoji.models.map(function(e){var t=U["default"].skinToneEmojis[e["char"]]?U["default"].skinToneEmojis[e["char"]]:e["char"];return U["default"].emojiMap[t]})));i.length||(i=null);var s=void 0;return s=null===a.props.initialShowSearchInput||void 0===a.props.initialShowSearchInput?!0:a.props.initialShowSearchInput,a.state={tabs:o,isPreview:!a.props.initialScrollPosition,selected:n,recentEmojis:i,searchText:null,searchResults:null,showSearchInput:s,scrolledToTop:!0},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.handleScroll=E["default"].throttle(this._handleScroll,ee)}},{key:"componentDidMount",value:function(){var e=this;this.props.initialScrollPosition&&(this.lastClickTime=Date.now(),this.scrollContainer&&(this.scrollContainer.scrollTop=this.props.initialScrollPosition));var t=this.state.selected.key;this.props.listeners.uiIdle(function(){e.restoreFocus(),new P["default"].WebcEmojiOpen({webcEmojiOpenTab:t}).commit(),e.setState({isPreview:!1})})}},{key:"componentWillUnmount",value:function(){C["default"].setLastEmojiTab(this.state.selected.key),this.state.selected===A.Tab.GIFS?(this.props.clearCurrentScrollPosition&&this.props.clearCurrentScrollPosition(),this.props.clearCurrentTab&&this.props.clearCurrentTab(),this.props.clearShowSearchInput&&this.props.clearShowSearchInput()):this.scrollContainer&&(this.state.searchResults?this.props.clearCurrentScrollPosition&&this.props.clearCurrentScrollPosition():this.props.setCurrentScrollPosition&&this.props.setCurrentScrollPosition(this.scrollContainer.scrollTop),this.props.setCurrentTab&&this.props.setCurrentTab(this.state.selected),this.props.setShowSearchInput&&this.props.setShowSearchInput(this.state.showSearchInput)),this.handleScroll.cancel()}},{key:"shouldComponentUpdate",value:function(e,t){return(0,N["default"])(this,e,t)}},{key:"componentDidUpdate",value:function(e,t){var a=t.selected!==this.state.selected,o=t.searchText!==this.state.searchText,n=Date.now()-this.lastClickTime>=$;if(a){if(n)return;if(this.state.selected!==A.Tab.GIFS){var r=this.state.showSearchInput?ae:0;this.scrollToPanel(this.state.selected,!0,r)}this.restoreFocus()}else if(o){if(!this.scrollContainer)return;this.state.searchText?this.scrollContainer.scrollTop=0:this.scrollTopBeforeSearch&&(this.scrollContainer.scrollTop=this.scrollTopBeforeSearch)}else!n&&this.state.showSearchInput&&this.scrollToPanel(this.state.selected,!0,ae),this.restoreFocus()}},{key:"render",value:function(){var e=this,t=this.state.tabs,a=t.indexOf(this.state.selected),o=t.map(function(t){var a=(0,b["default"])("menu-tab",{active:e.state.selected===t}),o=t.css||"emoji-people";return m["default"].createElement("div",{role:"button",className:a,onClick:function(){return e.onSelectTab(t)},key:t.key,title:t.title()},m["default"].createElement(Z["default"],{name:o}))}),n=l10n.isRTL()?-1:1,r={width:100/o.length+"%",transform:"translateX("+100*a*n+"%)"},i=this.getSearchBox(),l=this.getPanelContent(),s=(0,b["default"])("emoji-panel-body-container",{hasSearchBox:!!i}),u={tab:this.onRotateFocus,"shift+tab":this.onRotateFocus},c=(0,b["default"])("emoji-panel",{"emoji-panel-dropdown":this.props.displayLocation===ce.DROPDOWN});return m["default"].createElement(Y["default"],{handlers:u},m["default"].createElement("div",{className:c},m["default"].createElement("div",{className:"menu-tabs menu-tabs-emoji emoji-panel-header","data-active-tab":this.state.selected.key},m["default"].createElement("div",{style:r,className:"menu-tabs-marker"}),o),m["default"].createElement("div",{className:s,onMouseDown:this.preventBlur},i,m["default"].createElement("div",{className:"emoji-panel-body",onScroll:this.onScroll,ref:(0,Q.GetRef)("scrollContainer",this)},l))))}}]),t}(m["default"].Component);de.defaultProps={displayLocation:ce.DROPDOWN},t["default"]=(0,K["default"])(de)},7178:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,a){this.key=e,this.css=t,this.title=a,this.className="emoji-"+e}Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedTabs=t.TabsOrdered=t.Tab=t.SKIN_TONE_VARIATIONS=t.EMOJI_HEIGHT=t.EMOJI_WIDTH=void 0;var r,i=a(48),l=o(i);t.TabInfo=n;var s=a(95),u=o(s),c=a(130),d=c.EMOJI.CATEGORIES,f=(t.EMOJI_WIDTH=44,t.EMOJI_HEIGHT=44,t.SKIN_TONE_VARIATIONS=[""].concat(u["default"].skinToneVariations),t.Tab=(r={},(0,l["default"])(r,d.RECENT,new n(d.RECENT,"emoji-recent",function(){return l10n.t("emoji_tab_recent")})),(0,l["default"])(r,d.SMILEYS_PEOPLE,new n(d.SMILEYS_PEOPLE,"emoji-people",function(){return l10n.t("emoji_tab_smileys_people")})),(0,l["default"])(r,d.ANIMALS_NATURE,new n(d.ANIMALS_NATURE,"emoji-nature",function(){return l10n.t("emoji_tab_animals_nature")})),(0,l["default"])(r,d.FOOD_DRINK,new n(d.FOOD_DRINK,"emoji-food",function(){return l10n.t("emoji_tab_food_drink")})),(0,l["default"])(r,d.ACTIVITY,new n(d.ACTIVITY,"emoji-activity",function(){return l10n.t("emoji_tab_activity")})),(0,l["default"])(r,d.TRAVEL_PLACES,new n(d.TRAVEL_PLACES,"emoji-travel",function(){return l10n.t("emoji_tab_travel_places")})),(0,l["default"])(r,d.OBJECTS,new n(d.OBJECTS,"emoji-objects",function(){return l10n.t("emoji_tab_objects")})),(0,l["default"])(r,d.SYMBOLS,new n(d.SYMBOLS,"emoji-symbols",function(){return l10n.t("emoji_tab_symbols")})),(0,l["default"])(r,d.FLAGS,new n(d.FLAGS,"emoji-flags",function(){return l10n.t("emoji_tab_flags")})),(0,l["default"])(r,d.GIFS,new n(d.GIFS,"emoji-gifs",function(){return l10n.t("emoji_tab_gifs")})),(0,l["default"])(r,d.SEARCH_RESULT,new n(d.SEARCH_RESULT,null,null)),r)),p=t.TabsOrdered=[f.RECENT,f.SMILEYS_PEOPLE,f.ANIMALS_NATURE,f.FOOD_DRINK,f.ACTIVITY,f.TRAVEL_PLACES,f.OBJECTS,f.SYMBOLS,f.FLAGS];t.ExtendedTabs=p.concat([f.GIFS])},7179:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(12),_=o(g),v=a(94),b=o(v),y=a(491),E=o(y),S=a(93),C=o(S),M=a(53),k=(o(M),function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onDownload=function(){_["default"].closeModal(),E["default"].initDownload(o.props.msg)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement(b["default"],{onCancel:_["default"].closeModal.bind(_["default"]),onOK:this.onDownload,okText:C["default"].t("web_button_download"),cancelText:C["default"].t("web_cancel"),title:C["default"].t("download_unsupported_media_title")},C["default"].t("download_unsupported_media_prompt"))}}]),t}(h.Component));t["default"]=k},7180:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ListType=void 0;var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(7324),_=o(g),v=a(12),b=o(v),y=a(7120),E=o(y),S=a(7121),C=o(S),M=a(7122),k=o(M),w=a(173),N=o(w),T=a(7140),P=o(T),I=a(178),R=o(I),A=a(7454),x=o(A),O=a(7455),D=o(O),L=a(127),U=o(L),F=a(486),j=o(F),B=a(177),G=a(7128),V=a(3),Y=a(46),W=a(7125),H=t.ListType={CHAT_SELECT_MODAL:"CHAT_SELECT_MODAL",CONTACT_SELECT_MODAL:"CONTACT_SELECT_MODAL"},q=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(s))),o.setSearch=function(e){return o.search=e},o.setList=function(e){return o.list=e},o.state={searchText:""},o.onSearch=o.props.debounce(function(e){o.setState({searchText:e})},100),o.onFocusList=function(e){e&&(e.preventDefault(),e.stopPropagation()),o.list&&B.focus(Y.findDOMNode(o.list))},o.indicateSearchFocus=function(e){o.active.unset(),(0,w.indicateFocus)(o.search,["#fbfbfb","#D9F3FF"])},o.onLeaveList=function(e){(0,w.shouldIndicateFocus)(),B.focus(o.search)},o.handleEnter=function(e){o.list&&o.list.toggleFirst(!1)},o.handleForward=function(){var e=o.props,t=e.onChat,a=e.listType,n=o.selectedChats.getSelected();a===H.CONTACT_SELECT_MODAL?t(n):r["default"].map(n,function(e){return e instanceof j["default"]?Store.Chat.find(e.id):e}).then(function(e){t(e)})},o.handleSelectionChanged=function(e,t){o.search&&o.search.select()},o.onCancel=o.props.onCancel?o.props.onCancel:function(){return b["default"].closeModal()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.active=new W([],function(e){return e.id}),this.selectedChats=new G([],function(e){return e.id})}},{key:"componentWillUnmount",value:function(){this.onSearch.cancel()}},{key:"render",value:function(){var e={down:this.onFocusList,enter:this.handleEnter},t=void 0;switch(this.props.listType){case H.CHAT_SELECT_MODAL:t=V.createElement(x["default"],{ref:this.setList,msgType:this.props.msgType,excludeChat:this.props.excludeChat,getInitialItems:this.props.getInitialItems,searchText:this.state.searchText,activeChat:this.active,selectedChats:this.selectedChats,onLeaveList:this.onLeaveList,onSelectionChanged:this.handleSelectionChanged});break;case H.CONTACT_SELECT_MODAL:t=V.createElement(D["default"],{ref:this.setList,getInitialItems:this.props.getInitialItems,searchText:this.state.searchText,activeChat:this.active,selectedChats:this.selectedChats,onLeaveList:this.onLeaveList,onSelectionChanged:this.handleSelectionChanged});break;default:throw new Error("Invalid list type: "+this.props.listType)}var a=this.props.getInitialItems?0!==this.props.getInitialItems().length:!1;return V.createElement(R["default"],{type:I.TowerModalType},V.createElement(E["default"],{key:"chat-modal",onCancel:this.onCancel},V.createElement(k["default"],{title:this.props.title,type:M.DRAWER_HEADER_TYPE.POPUP,onCancel:this.onCancel}),V.createElement(N["default"],{handlers:e,onFocus:this.indicateSearchFocus},V.createElement(P["default"],{ref:this.setSearch,onSearch:this.onSearch,placeholder:l10n.t("search")})),V.createElement(C["default"],{"data-list-scroll-container":!0},t),V.createElement(_["default"],{selections:this.selectedChats,onForward:this.handleForward,startActive:a})))}}]),t}(V.Component);t["default"]=(0,U["default"])(q)},7181:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PresenceProxy=t["default"]=t.ChatstateProxy=t.Chatstate=void 0;var r=a(0),i=n(r),l=a(62),s=o(l),u=a(74),c=n(u),d=a(270),f=n(d),p=a(8),h=n(p),m=a(38),g=n(m),v=a(32),b=n(v),y=1500,E=2e3,S=(0,u.defineState)("Chatstate",{props:{id:"string",type:{type:"string",values:["available","unavailable","composing","recording"]},t:{type:"number",allowNull:!0},deny:"boolean"},session:{updateTime:"number",_expireTimerId:["number",!1,0]}}),C=S.Chatstate,M=S.ChatstateProxy;t.Chatstate=C,t.ChatstateProxy=M;var k=f["default"].extend({model:C}),w=(0,u.defineState)("Presence",{Collection:"Presence",props:{id:"string"},session:{isOnline:"boolean",stale:["boolean",!1,!0],hasData:["boolean",!1,!1],isSubscribed:["boolean",!1,!1],withholdDisplay:["boolean",!1,!0],forceDisplay:["boolean",!1,!1],chatActive:["boolean",!1,!1],withholdDisplayTimer:"number",forceDisplayTimer:"number",chatstate:"object"},collections:{chatstates:k},derived:{isGroup:{fn:function(){return b["default"].isGroup(this.id)}},isUser:{fn:function(){return b["default"].isUser(this.id)}}},initialize:function(){c["default"].prototype.initialize.call(this);var e=this.isGroup?{id:"",type:"unavailable"}:{id:this.id};this.addChild("chatstate",new C(e)),this.isGroup?this.listenTo(this.chatstates,"add change",_.debounce(function(){var e,t=!1;this.chatstates.forEach(function(a){"composing"!==a.type&&"recording"!==a.type||e&&!(e.updateTime<a.updateTime)||(e=a),t=t||"unavailable"!==a.type}),this.set({isOnline:t}),this.chatstate.set({id:e?e.id:"",type:e?e.type:"unavailable"})})):this.listenTo(this.chatstate,"change:type",function(){this.isOnline="unavailable"!==this.chatstate.type}),this.listenTo(this,"change:chatActive",this.onChatActiveChange)},"delete":function(){c["default"].prototype["delete"].call(this),Store.Presence.remove(this.id),this.chatstate["delete"](),this.chatstates.forEach(function(e){e["delete"]()})},handle:function(e){var t=!1;"undefined"==typeof e.type?e.type=this.chatstate.type||"unavailable":"paused"===e.type&&(t=!0,e.type="available"),this.isGroup&&"available"!==e.type&&(e.updateTime=Date.now());var a;if(this.isGroup){if(e.id=e.participant,e.participant=void 0,!e.id)return;a=this.chatstates.get(e.id),a||(a=this.chatstates.add({id:e.id}))}else a=this.chatstate;t&&"composing"!==a.type&&"recording"!==a.type||a.set(e),a._expireTimerId&&clearTimeout(a._expireTimerId),"composing"===a.type||"recording"===a.type?a._expireTimerId=_.delay(this._expireComposing,h["default"].PRESENCE_COMPOSING_TIMEOUT,a):a._expireTimerId=0;var o=this.forceDisplay||this.isOnline||this.isUser&&!this.chatstate.deny;this.set({hasData:!0,forceDisplay:o})},_expireComposing:function(e){var t=e.type;"composing"!==t&&"recording"!==t||(e.type="available")},reset:function(){this.hasData=!1,this.isGroup?this.chatstates.forEach(function(e){e.type="unavailable"}):this.isUser&&(this.chatstate.unset("t"),this.chatstate.unset("deny")),this.chatstate.set({id:this.isGroup?"":this.id,type:"unavailable",t:void 0,deny:void 0})},isActive:function(){var e=this.chatstate.type;return this.hasData&&("composing"===e||"recording"===e)},getFormattedString:function(){if(!this.hasData)return null;if(this.isGroup){var e=this.chatstate.id;if(!e)return null;var t=Store.Contact.get(e);if(!t)return null;var a=t.formattedShortName;return"composing"===this.chatstate.type?l10n.t("web_conversation_name_is_composing",{
participant:a}):l10n.t("web_conversation_name_is_recording",{participant:a})}if(!this.isUser)return null;var o=this.chatstate;switch(o.type){case"available":return l10n.t("web_conversation_contact_online");case"composing":return l10n.t("web_conversation_is_composing");case"recording":return l10n.t("web_conversation_is_recording");case"unavailable":return o.deny||!o.t?null:s.lastSeenStr(o.t)}},onChatActiveChange:function(){var e=this.chatActive;e?(this.hasData?this.withholdDisplay=!1:this.withholdDisplayTimer=_.delay(function(e){e.set({withholdDisplay:!1,withholdDisplayTimer:0})},y,this),this.forceDisplayTimer=_.delay(function(e){e.set({forceDisplay:!0,forceDisplayTimer:0})},E,this)):(this.withholdDisplayTimer&&(clearTimeout(this.withholdDisplayTimer),this.withholdDisplayTimer=0),this.forceDisplayTimer&&(clearTimeout(this.forceDisplayTimer),this.forceDisplayTimer=0))},subscribe:function(){return this.isSubscribed?i["default"].resolve():this.isUser?this.update():this.isGroup?(this.isSubscribed=!0,i["default"].all([this.update(),g["default"].presenceSubscribe(this.id)]).bind(this)["catch"](function(e){return this.isSubscribed=!1,i["default"].reject(e)})):i["default"].resolve()}}),N=w.Presence,T=w.PresenceProxy;t["default"]=N,t.PresenceProxy=T},7182:function(e,t){"use strict";function a(e){var t=e.search(n);if(-1===t)return e.length;0!==t&&(t-=1);for(var a=0,o=t,r=!1;o<e.length;o++){var i=e.charCodeAt(o);r&&i>=56320&&57344>i&&a++,r=i>=55296&&56320>i}return e.length-a}function o(e,t){if(!n.test(e))return e.substr(0,t);for(var a=0,o=0,r=!1;a<e.length&&t>o;a++){var i=e.charCodeAt(a);r&&i>=56320&&57344>i?(o++,r=!1):r?(o++,r=!1,a--):i>=55296&&56320>i?r=!0:(o++,r=!1)}return e.substr(0,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.numCodepoints=a,t.firstNCodepoints=o;var n=new RegExp("[-]")},7183:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.mimeType,a=e.filename,o=(0,s["default"])(f["default"].icon,h[t]?h[t].icon:null);return i["default"].createElement("div",{className:f["default"].container,"data-animate-attach-media":!0},i["default"].createElement("div",{className:f["default"].media},i["default"].createElement("div",{className:f["default"].document},i["default"].createElement("div",{className:o}),i["default"].createElement("div",{className:f["default"].text},a))))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(23),s=o(l),u=a(10),c=o(u),d=a(7523),f=o(d),p=a(128),h=c["default"].pickBy(p.MIMETYPES,function(e){return"document"===e.msgType})},7184:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(53),b=(o(v),a(7322)),y=o(b),E=a(93),S=o(E),C=a(7531),M=o(C),k=a(7320),w=o(k),N=a(7216),T=o(N),P=a(7119),I=o(P),R=a(488),A=a(7118),x=o(A);t["default"]=(0,x["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.searchQuery,o=void 0===a?[]:a,n=e.msgType,r=e.author,i=[];t.isSentByMe&&!t.isRevoked&&i.push(_["default"].createElement(w["default"],{msg:t,key:"symbol"})),"Search"===n||t.isSentByMe||!t.isGroupMsg||t.isNotification||i.push(_["default"].createElement(y["default"],{contact:t.senderObj,key:"author"})),r&&"Search"===n&&(i.push(_["default"].createElement(I["default"],{text:r,direction:"auto",key:"author"})),i.push(_["default"].createElement("span",{key:"divider"},":",""))),t.hasSymbol()&&i.push(_["default"].createElement(T["default"],{msg:t,key:"msg-symbol"})),i.push(_["default"].createElement(I["default"],{className:t.isRevoked?M["default"].revoked:null,direction:t.dir,text:t.msgText(!1),dirMismatch:t.rtl!==S["default"].isRTL(),formatters:R.Configuration[n]({mentions:t.mentionMap(),terms:o}),ellipsify:!0,inlineblock:!0,key:"status"}));var l=S["default"].embedDir(t.msgText(),t.rtl);return _["default"].createElement("span",{className:M["default"].last,title:l},i)}}]),t}(_["default"].PureComponent),n.CONCERNS={msg:["isSentByMe","isGroupMsg","isNotification","senderObj","dir","rtl","type","isRevoked"]},r))},7185:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(484),v=(n(_),a(53)),b=(n(v),a(62)),y=o(b),E=a(54),S=n(E),C=a(71),M=n(C),k=a(7118),w=n(k),N=a(12),T=n(N),P=a(7536),I=n(P),R=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.state={updater:!1},o.listening=!1,o.rerender=function(){o.setState({updater:!o.state.updater})},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){this.maybeRegMidnight()}},{key:"componentWillReceiveProps",value:function(){this.maybeRegMidnight()}},{key:"maybeRegMidnight",value:function(){var e=this.props,t=e.listeners,a=e.msg,o=(0,S["default"])().startOf("day").subtract(7,"day");a.t>=o.unix()?this.listening||(this.listening=!0,t.add(T["default"],"midnight",this.rerender)):this.listening&&(this.listening=!1,t.remove(T["default"],"midnight",this.rerender))}},{key:"render",value:function(){return g["default"].createElement("span",{className:I["default"].timestamp},y.relativeStr(this.props.msg.t))}}]),t}(g["default"].PureComponent);R.CONCERNS={msg:["t"]};var A=(0,M["default"])((0,w["default"])(R)),x=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props.chat;return e.previewMessage?g["default"].createElement(A,{msg:e.previewMessage}):null}}]),t}(g["default"].PureComponent);x.CONCERNS={chat:["previewMessage"]};var O=(0,w["default"])(x);t["default"]=function(e){var t=e.chat,a=e.msg;return t?g["default"].createElement(O,{chat:t}):a?g["default"].createElement(A,{msg:a}):void 0}},7186:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(484),b=o(v),y=a(7127),E=o(y),S=a(7118),C=o(S);t["default"]=(0,C["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=void 0;switch(this.props.chat.kind){case b["default"].KIND.GROUP:e=this.props.chat.isReadOnly?l10n.t("web_delete_group"):l10n.t("web_exit_group");break;case b["default"].KIND.BROADCAST:e=l10n.t("web_delete_list");break;case b["default"].KIND.CHAT:e=l10n.t("delete_chat")}return _["default"].createElement(E["default"],{a8n:"mi-delete",action:this.props.onDeleteOrExit,shortcut:"x",disabled:this.props.disabled},e)}}]),t}(_["default"].PureComponent),n.CONCERNS={chat:["isReadOnly","kind"]},r))},7187:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.side?s["default"].createElement("div",{className:f["default"].side},e.side):null,a=(0,c["default"])(f["default"].container,(0,i["default"])({},f["default"].multiline,e.multiline));return s["default"].createElement("div",{className:a,role:e.onClick?"button":null,onClick:e.onClick},s["default"].createElement("div",{className:f["default"].block},s["default"].createElement("div",{className:f["default"].main},e.children),t))}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=o(r);t["default"]=n;var l=a(3),s=o(l),u=a(23),c=o(u),d=a(7549),f=o(d)},7188:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7127),b=o(v),y=a(7118),E=o(y);t["default"]=(0,E["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.mute,a=e.disabled,o=this.props.onMute.bind(null,!t.isMuted),n=t.isMuted?l10n.t("web_menuitem_mute_off"):l10n.t("web_menuitem_mute");return _["default"].createElement(b["default"],{action:o,shortcut:"m",a8n:"mi-mute",disabled:a},n)}}]),t}(_["default"].PureComponent),n.CONCERNS={mute:["isMuted"]},r))},7189:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Type=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(10),m=o(h),g=a(12),_=o(g),v=a(94),b=o(v),y=a(8),E=o(y),S=a(7415),C=o(S),M=a(47),k=o(M),w=a(7417),N=o(w),T=a(267),P=o(T),I=a(172),R=o(I),A=a(1),x=o(A),O=a(280),D=o(O),L=a(7127),U=o(L),F=a(178),j=o(F),B=a(7132),G=o(B),V=a(7264),Y=o(V),W=a(3),H=o(W),q=a(126),z=o(q),K=a(7365),Q=o(K),J=a(261),X=o(J),Z=a(7137),$=o(Z),ee=a(7222),te=o(ee),ae=a(7221),oe=o(ae),ne=a(7563),re=o(ne),ie=t.Type={GROUP:"GROUP",PROFILE:"PROFILE"},le=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={img:o.props.startImage,hover:!1},o.onUpload=function(e){var t=o.refs.imageInput;return t.click(),!0},o.removeImage=function(){o.props.onImageSet(),_["default"].closeModal()},o.onRemove=function(e){var t=o.props.type===ie.GROUP?l10n.t("remove_group_icon"):l10n.t("remove_profile_photo");_["default"].openModal(H["default"].createElement(b["default"],{onOK:o.removeImage,okText:l10n.t("remove"),onCancel:_["default"].closeModal.bind(_["default"]),cancelText:l10n.t("web_cancel")},t))},o.onView=function(){var e=o.refs.imageContainer,t=function(t){t(e)},a=Store.Contact.get(o.props.id);_["default"].openModalMedia(H["default"].createElement(Y["default"],{contact:a,profilePicThumb:a.profilePicThumb,animateBorderRadius:!0,getZoomNode:t}),"profile-viewer")},o.onImageReceived=function(e,t){return e?void D["default"].loadImage(e).then(function(a){o.setState({img:e}),o.props.onImageSet(e,t)})["catch"](function(e){x["default"].error("PhotoPicker:onImageReceived failed to load image: "+e)();var t=o.props.type===ie.GROUP?l10n.t("action_group_icon_set_failed"):l10n.t("action_profile_set_failed");_["default"].openModal(H["default"].createElement(b["default"],{onOK:_["default"].closeModal.bind(_["default"])},t))}):void o.setState({img:void 0,imageSize:void 0})},o.onSearch=function(){_["default"].openModal(H["default"].createElement(j["default"],{type:F.BoxModalType},H["default"].createElement(N["default"],{onFinished:o.onImageReceived})))},o.onImagePick=function(e){o.contextClose();var t=e.target.files[0];if(!t)return!1;var a=URL.createObjectURL(t);D["default"].loadImage(a).then(function(e){e.width<E["default"].MIN_PIC_SIDE||e.height<E["default"].MIN_PIC_SIDE?_["default"].openModal(H["default"].createElement(b["default"],{onOK:_["default"].closeModal.bind(_["default"])},l10n.t("profile_or_group_image_too_small",{size:E["default"].MIN_PIC_SIDE,_plural:E["default"].MIN_PIC_SIDE}))):_["default"].openModal(H["default"].createElement(j["default"],{type:F.BoxModalType},H["default"].createElement(C["default"],{img:t,onFinished:o.onImageReceived,onRetake:o.onUpload})))})["catch"](function(e){var t=o.props.type===ie.GROUP?l10n.t("action_group_icon_set_failed"):l10n.t("action_profile_set_failed");_["default"].openModal(H["default"].createElement(b["default"],{onOK:_["default"].closeModal.bind(_["default"])},t))})["finally"](function(){URL.revokeObjectURL(a)}),e.target.value=""},o.onImageClick=function(e){if(o.props.readOnly)return void(o.state.img&&o.onView());e.stopPropagation(),e.preventDefault();var t=[];o.props.id&&o.state.img&&t.push(H["default"].createElement(U["default"],{a8n:"mi-view-photo",key:"view",action:o.onView},l10n.t("view_photo"))),navigator.getUserMedia&&t.push(H["default"].createElement(Q["default"],{key:"take",onImageTake:o.onImageReceived})),t.push(H["default"].createElement(U["default"],{a8n:"mi-upload-photo",key:"upload",action:o.onUpload},l10n.t("upload_photo"))),k["default"].supportsFeature(k["default"].F.BING_IMAGE_SEARCH)&&o.props.type===ie.GROUP&&t.push(H["default"].createElement(U["default"],{a8n:"mi-search-photo",key:"search",action:o.onSearch},l10n.t("web_search_menu_item"))),o.state.img&&t.push(H["default"].createElement(U["default"],{a8n:"mi-remove-photo",key:"remove",action:o.onRemove},l10n.t("remove_photo"))),e.persist(),o.setState({contextMenu:{menu:t,event:e}})},o.contextClose=function(){o.setState({contextMenu:void 0})},o.onMouseOver=function(e){o.state.hover||o.setState({hover:!0})},o.onMouseEnter=function(e){o.state.hover||o.setState({hover:!0})},o.onMouseLeave=function(e){o.state.hover&&o.setState({hover:!1})},o.onLoad=function(e){var t=e.target.clientWidth,a=e.target.clientHeight;o.setState({imageSize:{width:t,height:a}})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillReceiveProps",value:function(e){e.startImage&&this.props.startImage!==e.startImage?this.setState({img:e.startImage}):this.props.startImage!==e.startImage&&this.setState({img:e.startImage,imageSize:void 0})}},{key:"render",value:function(){var e=void 0;this.state.img&&(e=H["default"].createElement(G["default"],{type:B.FIT_TYPE.COVER,size:this.state.imageSize},H["default"].createElement(P["default"],{src:this.state.img,crossOrigin:!1,style:{height:"100%",width:"100%"},onLoad:this.onLoad})));var t=void 0;(this.props.pending||this.state.img&&!this.state.imageSize)&&(t=H["default"].createElement(te["default"],null));var a=null;if(!this.props.pending&&!this.props.readOnly&&(!this.state.img||this.state.imageSize)&&(!this.state.img||this.state.contextMenu||this.state.hover)){var o=void 0;switch(this.props.type){case ie.GROUP:o=this.state.img?l10n.t("change_group_icon"):l10n.t("add_group_icon");break;case ie.PROFILE:o=this.state.img?l10n.t("change_profile_photo"):l10n.t("add_profile_photo")}a=H["default"].createElement(oe["default"],{icon:H["default"].createElement(R["default"],{name:"camera-light"}),text:o})}var n=this.props.readOnly||this.props.pending||!this.state.imageSize&&this.state.img?m["default"].noop:this.onImageClick,r=void 0;this.state.contextMenu&&(r=H["default"].createElement(X["default"],{displayName:"PhotoPickerContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},H["default"].createElement($["default"],{contextMenu:this.state.contextMenu})));var i=void 0;if(this.props.pending||!this.state.img||this.state.img&&!this.state.imageSize){var l=this.props.type===ie.PROFILE?"default-user":"default-group";i=H["default"].createElement("div",{className:re["default"].defaultIcon},H["default"].createElement(R["default"],{name:l}))}return H["default"].createElement("div",{className:re["default"].container},H["default"].createElement("div",{className:re["default"].body,onClick:n,onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:"imageContainer",dir:"ltr"},H["default"].createElement("div",{className:re["default"].imageContainer},e,i),H["default"].createElement(z["default"],{transitionName:"fade"},t,a)),H["default"].createElement("input",{ref:"imageInput",type:"file",accept:"image/gif,image/jpeg,image/jpg,image/png",style:{display:"none"},onChange:this.onImagePick}),r)}}]),t}(H["default"].Component);t["default"]=le},7190:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(490),r=o(n);e.exports=(0,r["default"])({CHANGE:void 0,MOUNT:void 0})},7191:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return{handlers:r(e,K)}}function r(e,t){return t.reduce(function(t,a){return Array.isArray(a)?t[a[0]]=e[a[1]]:t[a]=e[a],t},{})}function i(e){return e.which===H&&(e.getModifierState("Shift")||e.getModifierState("Alt")||e.getModifierState("Control"))}function l(e,t,a){var o={};return a.forEach(function(a){return o[a]=e[a]!==t[a]}),o}var s=a(96),u=o(s),c=a(24),d=o(c),f=a(17),p=o(f),h=a(5),m=o(h),g=a(2),_=o(g),v=a(4),b=o(v),y=a(7),E=o(y),S=a(6),C=o(S),M=a(7502),k=o(M),w=a(7503),N=o(w),T=a(173),P=o(T),I=a(7351),R=o(I),A=a(493),x=a(39),O=a(7158),D=a(7168),L=a(177),U=a(7190),F=a(3),j=a(7348),B=a(7349),G=a(7350),V=a(23),Y=a(7232),W=a(7352),H=13,q=function(e){function t(){var e,a,o,n;(0,_["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,E["default"])(this,(e=t.__proto__||(0,m["default"])(t)).call.apply(e,[this].concat(i))),z.call(o),n=a,(0,E["default"])(o,n)}return(0,C["default"])(t,e),(0,b["default"])(t,[{key:"serialize",value:function(e){var t=e?e:this.state.value;return this.plugins.reduce(function(e,t){var a=(0,p["default"])(e,2),o=a[0],n=a[1];return t.serialize?t.serialize(o,n):[o,n]},[t,{}])}},{key:"replaceSelection",value:function(e){if(!this.props.readOnly){var t=this.refs.input;this._hasFocus(t)||(L.focus(t),this.selection&&this.restoreSelection(this.selection));var a=this.trimToFit(e);if(a.length){this.props.multiline||(a=a.replace(/\r?\n/g,"")),window.getSelection().getRangeAt(0).deleteContents();var o=t.scrollTop,n=t.scrollHeight;document.execCommand("insertHTML",!1,W(a,this.plugins)),this.onSelect();var r=t.scrollHeight,i=t.clientHeight;i>=r||(t.scrollTop=(o||0)+(r-n))}}}},{key:"restoreSelection",value:function(e){var t=this.refs.input;if(t){var a=e.anchorIndex,o=e.focusIndex,n=e.anchorOffset,r=e.focusOffset,i=t.childNodes,l=-1===a?t:i[a],s=-1===o?t:i[o];if(l&&s)try{if(l===s&&n>r){var u=[r,n];n=u[0],r=u[1]}var c=document.createRange();c.setStart(l,n),c.setEnd(s,r);var d=window.getSelection();d.removeAllRanges(),d.addRange(c);try{var f=document.createRange();f.setStart(s,r),f.setEnd(s,r);var p=f.getBoundingClientRect(),h=p.bottom,m=p.top,g=this.refs.input.getBoundingClientRect(),_=g.bottom,v=g.top;if(m>=v&&_>=h)return;this.refs.input.scrollTop+=v>h?m-v:h-_}catch(b){}}catch(b){this.focus(!0)}}}},{key:"getSelection",value:function(){var e=this.refs.input;if(!e||document.activeElement!==e)return null;for(var t=window.getSelection(),a=t.anchorNode,o=t.anchorOffset,n=t.focusNode,r=t.focusOffset,i=e.childNodes,l=-1,s=-1,u=0,c=void 0;(0>l||0>s)&&(c=i[u++]);)a===c&&(l=u-1),n===c&&(s=u-1);return{anchorIndex:l,anchorOffset:o,focusIndex:s,focusOffset:r}}},{key:"trimToFit",value:function(e){var t=this.props.maxLength;if(!t)return e;var a=this.selectionLength,o=this.length,n=t+a-o;return 0>=n?"":(0,A.graphemeSubstring)(String(e),0,n)}},{key:"cursorAtEnd",value:function(){return this.state.focused&&""===this.state.value?!0:(0,k["default"])(this.refs.input)}},{key:"cursorAtStart",value:function(){return this.state.focused&&""===this.state.value?!0:(0,N["default"])(this.refs.input)}},{key:"isFocused",value:function(){return this.state.focused}},{key:"render",value:function(){var e=this.props.placeholder,t=this.state.value,a=t.length?"hidden":"visible",o=W(t,this.plugins),n={"default":"pluggable-input-default",compose:"pluggable-input-compose",large:"pluggable-input-large","status-reply":"pluggable-input-status-reply"},r=V("pluggable-input",this.props.className,this.props.theme?n[this.props.theme]:null,{focused:this.state.focused});return F.createElement(P["default"],{className:r,handlers:this.hotKeyMap,onRef:this.setContainerRef},F.createElement("div",{className:"pluggable-input-placeholder",ref:"placeholder",style:{visibility:a}},e),F.createElement("div",(0,d["default"])({},this.handlerMap,{className:V("pluggable-input-body",x.SELECTABLE_INPUT_CSS_CLASS),contentEditable:!this.props.readOnly,dangerouslySetInnerHTML:{__html:o},"data-tab":this.props.readOnly?null:1,dir:"auto",ref:"input",spellCheck:this.props.spellCheck})))}},{key:"value",get:function(){return this.state.value}},{key:"selectionLength",get:function(){if(this.props.readOnly)return 0;var e=this.refs.input;this._hasFocus(e)||L.focus(e);var t=window.getSelection();return t.rangeCount?(0,A.graphemeLength)(Y(t.getRangeAt(0).cloneContents(),this.plugins)):0}},{key:"length",get:function(){return(0,A.graphemeLength)(this.state.value)}},{key:"isComposing",get:function(){return this.__isComposing}}]),t}(F.Component),z=function(){var e=this;this.__changeDueToReset=!1,this.__isMounted=!0,this.__isComposing=!1,this.containerRef=null,this.selection=this.props.initialSelection,this.state={focused:!1,value:this.props.initialValue||""},this.trigger=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=e.hookMap[t];o&&o.apply(void 0,(0,u["default"])(a))},this.serializeNode=function(t){return Y(t,e.plugins)},this.serializeTextBeforeCursor=function(){return(0,R["default"])(e.refs.input,window.getSelection())},this._hasFocus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.refs.input;if(!t)return!1;var a=document,o=a.activeElement;return o?o===t||t.contains(o):!1},this.forceFocus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,a=arguments[1];if(!e.props.readOnly&&e.__isMounted){var o=e.refs.input;if(o){var n=e._hasFocus(o);if(!n||t)if(n||L.focus(o,a),!t&&e.selection)e.restoreSelection(e.selection);else{var r=window.getSelection();r&&r.rangeCount&&(r.selectAllChildren(o),r.collapseToEnd())}}}},this.focus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,a=arguments[1];a&&a.persist(),setTimeout(e.forceFocus,0,t,a)},this.reset=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e.__changeDueToReset=!0,e.selection=null,e._setValue(t)},this._setValue=function(t){t!==e.state.value&&e.setState({value:t},function(){e.trigger(U.CHANGE,[t]),e.props.onChange&&e.props.onChange(t)})},this.onSelect=function(){e.selection=e.getSelection(),e.props.onSelect&&e.props.onSelect(e.selection)},this.shouldComponentUpdate=function(t,a){var o=a.value,n=a.focused,r=n!==e.state.focused;r&&e.containerRef&&(n?e.containerRef.classList.add("focused"):e.containerRef.classList.remove("focused")),e.__changeDueToReset&&(e.__changeDueToReset=!1,e.refs.input&&(e.refs.input.innerHTML=W(o,e.plugins)));var i=!o.length&&!!e.state.value.length,l=!!o.length&&!e.state.value.length;if(!l&&!i)return!1;var s=l?"hidden":"visible";return e.refs.placeholder&&e.refs.placeholder.setAttribute("style","visibility: "+s),i&&(e.refs.input.innerHTML=""),!1},this.componentWillReceiveProps=function(t){var a=l(e.props,t,["readOnly"]);a.readOnly&&e.refs.input.setAttribute("contentEditable",String(!t.readOnly))},this.componentWillUnmount=function(){e.__isMounted=!1,e.refs.input.restoreFocus=null},this.onInput=function(t){var a=Y(e.refs.input,e.plugins),o="\n"===a?"":a,n=e.props.maxLength;if(n>0&&(0,A.graphemeLength)(o)>n){var r=e.selection;return e.refs.input.innerHTML=W(e.state.value,e.plugins),void(r&&e.restoreSelection(r))}e._setValue(o)},this.onPaste=function(t){t.preventDefault(),t.stopPropagation();var a=new D(t.clipboardData),o=e.props,n=o.onFiles,r=o.onTextPaste;a.hasFiles()&&n&&n(a)||a.hasText()&&a.getText(e.props.textPasteMimePriority).then(function(t){if(t&&(!r||!r(t))){var a=e.length-e.selectionLength;if(a+(0,A.graphemeLength)(t)>e.props.maxLength){var o=e.props.onMaxPasteExceeded;return o&&o()}e.replaceSelection(t)}})},this.onBeforeInput=function(t){if(e.props.readOnly)return!0;var a=e.props.maxLength;if(!a)return!1;var o=t.data.charCodeAt(0);if(8===o||127===o)return!1;var n=e.selectionLength,r=e.length,i=a+n-r;return(0,A.graphemeLength)(t.data)>i},this.onKeyDown=function(t){return e.props.onKeyDown&&e.props.onKeyDown(t)?!0:t.which!==H?!1:e.props.multiline&&i(t)?!1:(e.props.onEnter&&e.props.onEnter(t),!0)},this.componentDidMount=function(){e.refs.input.restoreFocus=function(t){e.focus(!1,t)},e.trigger(U.MOUNT)},this.onBlur=function(t){e.setState({focused:!1}),e.props.onBlur&&e.props.onBlur(t)},this.onFocus=function(t){e.setState({focused:!0}),e.props.onFocus&&e.props.onFocus(t)},this.onCompositionStart=function(t){return!(e.__isComposing=!0)},this.onCompositionEnd=function(){return e.__isComposing=!1},this.setContainerRef=function(t){e.containerRef=t}};e.exports=function(e){var t=function(t){function a(){var t,o,r,i;(0,_["default"])(this,a);for(var l=arguments.length,s=Array(l),c=0;l>c;c++)s[c]=arguments[c];return o=r=(0,E["default"])(this,(t=a.__proto__||(0,m["default"])(a)).call.apply(t,[this].concat(s))),r.plugins=[].concat((0,u["default"])(e.map(function(e){return e instanceof O&&e.initialize(r),e})),[n(r)]),r.handlerMap=j(r.plugins,r),r.hookMap=B(r.plugins,r),r.hotKeyMap=G(r.plugins,r),i=o,(0,E["default"])(r,i)}return(0,C["default"])(a,t),a}(q);return t};var K=["onBeforeInput","onBlur","onCompositionEnd","onCompositionStart","onFocus","onInput","onKeyDown","onPaste","onSelect"]},7192:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(78),l=o(i),s=a(95),u=s.emojiRegex,c=s.emojiMap,d=a(8),f=d.ONE_BY_ONE_TRANS_GIF,p=a(7190),h=u(),m=function(e){var t=c[e];if(!t)return null;var a=document.createElement("img");return a.setAttribute("alt",e),a.setAttribute("draggable","false"),a.setAttribute("class",s.getClasses(t)),(0,l["default"])(a.style,s.getStyle(t)),a.setAttribute("src",f),a},g={serializers:[["img.emoji",function(e){return e.getAttribute("alt")||""}]],parsers:[function(e){return e.replace("","")},function(e){return e.replace(h,function(e,t){var a=m(t);return a?a.outerHTML:""})}],hooks:(0,r["default"])({},p.MOUNT,function(){document.execCommand("enableObjectResizing",!1,!1)}),handlers:{onBeforeInput:function(e,t){var a=e.data,o=h.exec(a);return o?(t.replaceSelection(o[0]),!0):!1},onClick:function(e){if(!e.target)return!1;var t=e.target.getAttribute("class");if(!t||!~t.indexOf("emoji"))return!1;var a=window.getSelection(),o=new Range;return e.pageX<e.target.x+e.target.width/2?(o.setStartBefore(e.target),o.setEndBefore(e.target)):(o.setStartAfter(e.target),o.setEndAfter(e.target)),a.removeAllRanges(),a.addRange(o),!0}}};t["default"]=g},7193:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return function(a,o){return t.state.active&&t.state.results.length?a&&(0,M["default"])(a)?!1:(e.call(t,a,o),!0):!1}}function r(e,t){if(t.isMe)return!1;var a=[t.searchName||t.formattedName];return!t.isMyContact&&t.notifyName&&a.push(t.notifyName.toLowerCase()),a.some(function(t){return i(e,t)})}function i(e,t){var a=-1;do if(t.indexOf(e,a+1)===a+1)return!0;while(-1!==(a=t.indexOf(" ",a+1)));return!1}Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeOptions=void 0;var l=a(48),s=o(l),u=a(5),c=o(u),d=a(2),f=o(d),p=a(4),h=o(p),m=a(7),g=o(m),_=a(6),v=o(_),b=a(10),y=o(b),E=a(23),S=o(E),C=a(7231),M=o(C),k=a(7148),w=o(k),N=a(7235),T=o(N),P=a(3),I=o(P),R=a(46),A=o(R),x=a(7360),O=o(x),D=a(7118),L=o(D),U=a(261),F=o(U),j=a(126),B=o(j),G=a(7565),V=o(G),Y=a(490),W=o(Y),H=t.ThemeOptions=(0,W["default"])({MEDIA_CAPTION:null}),q={active:!1,offset:0,omitted:"",query:"",results:[],scrollTop:0},z=52,K=function(e){function t(){var e,a,o,r;(0,f["default"])(this,t);for(var i=arguments.length,l=Array(i),u=0;i>u;u++)l[u]=arguments[u];return a=o=(0,g["default"])(this,(e=t.__proto__||(0,c["default"])(t)).call.apply(e,[this].concat(l))),o.state=q,o.onEnter=n(function(){return o.handleSelect(o.state.offset)},o),o.onInactive=n(function(){return o.setState(q)},o),o.onSearch=function(e){var t=o,a=t.state.omitted;a&&y["default"].startsWith(e,a)||o.props.chat&&o.props.chat.isGroup&&o.setState({active:!0,offset:0,omitted:null,query:e,results:o.getResults(e)})},o.onEscape=function(){o.setState({active:!1,offset:0,omitted:o.state.query,query:"",results:[]})},o.onUp=n(function(){var e=Math.max(o.state.offset-1,0);o.setOffset(e)},o),o.onDown=n(function(){var e=o.state.results.length-1,t=Math.min(o.state.offset+1,e);o.setOffset(t)},o),o.renderList=function(e,t,a){if(!e||!t.length)return null;var n=t.map(function(e,t){return I["default"].createElement(O["default"],{key:e.id,contact:e,term:a,ref:"mention-result-"+t,selected:t===o.state.offset,theme:o.props.theme===H.MEDIA_CAPTION?"mediaCaption":null,onMouseDown:function(e){return e.preventDefault()},onMouseUp:function(){return o.handleSelect(t)},onMouseOver:function(){return o.setOffset(t,!0)}})});return I["default"].createElement(F["default"],{displayName:"MentionSuggestions",escapable:!0,requestDismiss:o.onEscape},I["default"].createElement("div",{className:(0,S["default"])(V["default"].overlayContainer,(0,s["default"])({},V["default"].mediaCaption,o.props.theme===H.MEDIA_CAPTION))},I["default"].createElement("div",{className:V["default"].resultsContainer,"data-list-scroll-container":"true",ref:"overflow"},I["default"].createElement(w["default"],{data:n,height:z,scrollTop:o.state.scrollTop,animate:!1}))))},r=a,(0,g["default"])(o,r)}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.plugin;e.registerHandler(this,T["default"].ENTER,this.onEnter),e.registerHandler(this,T["default"].TAB,this.onEnter),e.registerHandler(this,T["default"].SEARCH,this.onSearch),e.registerHandler(this,T["default"].INACTIVE,this.onInactive),e.registerHandler(this,T["default"].UP,this.onUp),e.registerHandler(this,T["default"].DOWN,this.onDown)}},{key:"componentWillUnmount",value:function(){var e=this.props.plugin;e.unregisterHandler(this,T["default"].ENTER),e.unregisterHandler(this,T["default"].TAB),e.unregisterHandler(this,T["default"].SEARCH),e.unregisterHandler(this,T["default"].INACTIVE),e.unregisterHandler(this,T["default"].UP),e.unregisterHandler(this,T["default"].DOWN)}},{key:"handleSelect",value:function(e){var t=this.state.results[e];if(t&&t.id){var a=this.props.chat.assignedColor(t.id);this.props.plugin.handleSelect(t,a)}}},{key:"getResults",value:function(e){var t=this.props.chat.groupMetadata.participants,a=t.models.map(function(e){var t=e.contact;return t}),o=(e||"").toLowerCase(),n=a.filter(function(e){return r(o,e)});return n}},{key:"setOffset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=e*z,o=a+z,n=A["default"].findDOMNode(this.refs.overflow),r=n.scrollTop,i=r+n.clientHeight,l={offset:e,scrollTop:r};t||(r>a?l.scrollTop=a:o>i&&(l.scrollTop+=o-i)),this.setState(l)}},{key:"render",value:function(){var e=this.state,t=e.query,a=e.results,o=e.active;return I["default"].createElement(B["default"],{component:"div",className:V["default"].positioningContainer,transitionName:"slide-up"},this.renderList(o,a,t))}}]),t}(I["default"].Component);K.CONCERNS={chat:["groupMetadata","isGroup"]},t["default"]=(0,L["default"])(K)},7194:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(7),u=o(s),c=a(6),d=o(c),f=a(7158),p=o(f),h=a(7361),m=o(h),g=a(7362),_=o(g),v=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,u["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.handlers={onBeforeInput:m["default"],onKeyDown:_["default"]},n=a,(0,u["default"])(o,n)}return(0,d["default"])(t,e),t}(p["default"]);e.exports=new v},7195:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{
value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7118),_=o(g),v=a(7181),b=(o(v),a(7224)),y=o(b),E=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.presence,t=void 0;return t="list"===this.props.location?e.getFormattedString():e.withholdDisplay?this.props.placeholder:e.getFormattedString()||(e.forceDisplay?"":this.props.placeholder),t?m["default"].createElement(y["default"],{text:t,location:this.props.location,chatType:"user"}):null}}]),t}(m["default"].PureComponent);E.CONCERNS={presence:["withholdDisplay","forceDisplay","hasData"],chatstate:["type","deny","t"]},t["default"]=(0,_["default"])(E)},7196:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){return A["default"].isGecko||A["default"].isSafari}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(3),v=o(_),b=a(10),y=a(12),E=o(y),S=a(8),C=o(S),M=a(71),k=o(M),w=a(33),N=o(w),T=a(7118),P=o(T),I=a(7208),R=a(28),A=o(R),x=a(21),O=o(x),D=(0,b.debounce)(function(e,t){O["default"].setVideoVolumeSettings(e,t)},500);t["default"]=(0,k["default"])((0,P["default"])((i=r=function(e){function t(){var e,a,o,r;(0,c["default"])(this,t);for(var i=arguments.length,l=Array(i),u=0;i>u;u++)l[u]=arguments[u];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(l))),o.state={hasSentPlayed:!1},o.checkIteration=0,o.checkForSuccessInterval=0,o.hasCalledPlaying=!1,o.videoRef=null,o.setVideoRef=function(e){if(o.videoRef!==e&&(o.videoRef=e,e)){var t=O["default"].getVideoVolumeSettings();t&&((0,b.isNumber)(t.volume)&&(e.volume=t.volume),(0,b.isBoolean)(t.muted)&&(e.muted=t.muted)),n()&&o.props.autoPlay&&o.startCheckForSuccess()}},o.onVolumeChange=function(){var e=o.videoRef;e&&D(e.volume,e.muted)},o.onTimeUpdate=function(){var e=o.videoRef;e&&(e.currentTime/e.duration>.5||e.currentTime>10)&&(o.props.msg.sendPlayed(),o.setState({hasSentPlayed:!0}))},o.startCheckForSuccess=function(){o.checkIteration=0,o.checkForSuccessInterval||(o.checkForSuccessInterval=setInterval(o.checkForSuccess,250))},o.clearCheckForSuccess=function(){o.checkForSuccessInterval&&(clearInterval(o.checkForSuccessInterval),o.checkIteration=0,o.checkForSuccessInterval=0)},o.checkForSuccess=function(){if(N["default"].state===N["default"].STATE.CONNECTED){o.checkIteration++;var e=o.videoRef&&o.videoRef.buffered;e&&e.length&&e.end(0)>0?o.onPlaying({target:o.videoRef}):o.checkIteration>240&&o.clearCheckForSuccess()}},o.onPlayerError=function(){o.clearCheckForSuccess()},o.onOtherPlaying=function(e){e!==o&&o.videoRef&&o.videoRef.pause()},o.onPlaying=function(){o.clearCheckForSuccess(),E["default"].mediaPlaying(o)},o.setStartTime=function(){o.props.startTime&&o.videoRef&&(o.videoRef.currentTime=o.props.startTime)},r=a,(0,h["default"])(o,r)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(E["default"],"mediaPlaying",this.onOtherPlaying)}},{key:"componentWillUnmount",value:function(){D.flush(),this.clearCheckForSuccess()}},{key:"componentDidUpdate",value:function(e){e.startTime!==this.props.startTime&&this.setStartTime()}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.mediaData.mediaBlob,o=void 0;o=a?a.url():(0,I.checkStreamingSupported)()?C["default"].VIDEO_STREAM_URL+"?key="+this.props.msg.id.toString():void 0;var r=!this.state.hasSentPlayed&&t.canSendPlayed()?this.onTimeUpdate:void 0,i=e.startTime?this.setStartTime:void 0,l=n()&&!e.autoPlay?this.startCheckForSuccess:void 0;return v["default"].createElement("video",{ref:this.setVideoRef,src:o,poster:e.poster,className:e.className,controls:e.controls,autoPlay:e.autoPlay,onClick:e.onClick,onDoubleClick:e.onDoubleClick,onVolumeChange:this.onVolumeChange,onLoadedMetadata:i,onPlay:l,onPlaying:this.onPlaying,onTimeUpdate:r,onError:this.clearCheckForSuccess},e.children)}}]),t}(v["default"].Component),r.CONCERNS={msg:["id","isSentByMe","ack","type","isGif"],mediaData:["mediaBlob","streamable"]},i)))},7197:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.title,a=e.description,o=e.canonicalUrl,n=e.thumbnail,r=e.onClick,l=e.invite,u=e.compose,d=n?i["default"].createElement("img",{className:"link-preview-media",src:"data:image/jpeg;base64,"+n}):null,f=a?i["default"].createElement("div",{className:"link-preview-description",title:a},i["default"].createElement(c["default"],{text:a})):null,p=o?i["default"].createElement("div",{className:"link-preview-source ellipsify"},i["default"].createElement(c["default"],{text:o})):null,h=(0,s["default"])("link-preview-container",{"link-preview-invite":l,"link-preview-compose":u}),m=(0,s["default"])("link-preview-body",{nothumb:!n});return i["default"].createElement("div",{className:h,onClick:r},d,i["default"].createElement("div",{className:m},i["default"].createElement("div",{className:"link-preview-title",title:t},i["default"].createElement(c["default"],{text:t})),f,p))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(23),s=o(l),u=a(7119),c=o(u)},7198:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(486),b=(o(v),a(53)),y=(o(b),a(7118)),E=o(y),S=a(283),C=a(62);t["default"]=(0,E["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.className,o=e.contact,n=e.msg,r=e.onClick,i=(0,C.timeStr)(n.t);return _["default"].createElement(S.CopyableDiv,{className:a,onClick:r,prePlainText:"["+i+"] "+o.formattedUser+": "},t)}}]),t}(_["default"].PureComponent),n.CONCERNS={contact:["formattedUser"],msg:["senderObj","t"]},r))},7199:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7119),b=o(v),y=a(7118),E=o(y),S=a(488);t["default"]=(0,E["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.trusted,o=!0,n=a?S.Configuration.TrustedConversation:S.Configuration.UntrustedConversation,r=n({mentions:t.mentionMap(),selectable:o});return _["default"].createElement("div",{className:"message-text","data-id":t.id},_["default"].createElement(b["default"],{direction:t.dir,dirMismatch:!(!t.dir||t.rtl===l10n.isRTL()),selectable:o,text:t.caption,formatters:r}))}}]),t}(_["default"].PureComponent),n.CONCERNS={msg:["t","id","dir","rtl","caption"]},r))},7200:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(62),v=o(_),b=a(7129),y=n(b),E=a(484),S=(n(E),a(12)),C=n(S),M=a(8),k=n(M),w=a(23),N=n(w),T=a(14),P=n(T),I=a(7119),R=n(I),A=a(265),x=n(A),O=a(47),D=n(O),L=a(7384),U=n(L),F=a(53),j=n(F),B=a(7248),G=n(B),V=a(7216),Y=n(V),W=a(7174),H=n(W),q=a(7421),z=n(q),K=a(126),Q=n(K),J=a(261),X=n(J),Z=a(266),$=n(Z),ee=a(488),te=a(263),ae=n(te),oe=a(172),ne=n(oe),re=j["default"].TYPE,ie=re.CHAT,le=re.IMAGE,se=re.VIDEO,ue=re.LOCATION,ce=re.DOCUMENT,de=re.VCARD,fe=re.AUDIO,pe=re.MULTI_VCARD,he=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.state={hover:!1,quotedMsgPreview:!1},o.onClick=function(){var e=o.props,t=e.rootMsg,a=e.msg;if(a.isStatusV3)return void(t&&t.isQuotedMsgAvailable?D["default"].supportsFeature(D["default"].F.STATUS_V3_UI_VIEWING)&&Store.ServerProps.statusV3&&Store.StatusV3.find(a.sender).then(function(e){var o=function(){t&&(t.isQuotedMsgAvailable=!1)};C["default"].openModalMedia(g["default"].createElement(z["default"],{removeTopDrawer:!1,statusV3:e,msgKey:a.id,onMsgNotFound:o}),"quoted-status-v3-modal")}):C["default"].openToast(g["default"].createElement(ae["default"],{msg:l10n.t("status_v3_msg_not_found"),id:(0,te.genId)()})));if(t&&!t.isQuotedMsgAvailable)return void o.setState({quotedMsgPreview:!0});var n=a.id,r=a.chat,i=Store.Msg.get(n),l=r.getSearchContext(i||n,t);l&&(l.slideToMsg=!0),C["default"].openChatAt(r,l),i||l.collection.loadAroundPromise["catch"](P["default"].E404,function(){C["default"].openChatAt(r,r.getSearchContext(t))})},o.onMouseOver=function(e){o.hoverable()&&o.setState({hover:!0})},o.onMouseEnter=function(e){o.hoverable()&&o.setState({hover:!0})},o.onMouseLeave=function(e){o.state.hover&&o.setState({hover:!1})},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"hoverable",value:function(){return!this.state.hover&&!!this.props.rootMsg}},{key:"render",value:function(){var e=this,t=this.props,a=t.msg,o=t.displayType,n=t.chat,r=n.assignedColor(a.sender),i=o===k["default"].DISP_TYPE.CONVERSATION,l=g["default"].createElement(y["default"],{msg:a,contact:a.senderObj,className:"quoted-msg-author",chat:n,quoted:!0,displaySelf:a.sender===Store.Conn.me,disableClick:!0}),s=null,u=this.props.rootMsg;if(this.state.quotedMsgPreview&&u){var c=(0,N["default"])("quoted-msg-preview",u.isSentByMe?"right":"left",{"chat-msg":a.type===ie});s=g["default"].createElement(X["default"],{displayName:"QuotedMsgPreview",escapable:!0,popable:!0,requestDismiss:function(){return e.setState({quotedMsgPreview:!1})}},g["default"].createElement("div",{className:c},g["default"].createElement(G["default"],{msg:a}),g["default"].createElement("div",{className:"nib-wrapper"},g["default"].createElement("div",{className:"nib"}))))}var d=(0,N["default"])("quoted-msg",{"quoted-msg-hover":this.state.hover,"quoted-msg-clickable":i});return g["default"].createElement("div",{onMouseOver:i?this.onMouseOver:null,onMouseEnter:i?this.onMouseEnter:null,onMouseLeave:i?this.onMouseLeave:null},g["default"].createElement(Q["default"],{transitionName:"quoted-msg-preview",className:"quoted-msg-preview-wrapper"},s),g["default"].createElement("div",{className:d,onClick:i?this.onClick:null},g["default"].createElement("div",{className:"quoted-msg-status"},g["default"].createElement("span",{className:"bg-color-"+r+" quoted-msg-color-bar"}),g["default"].createElement("div",{className:"quoted-msg-info"},g["default"].createElement("div",null,l,g["default"].createElement(me,{msg:a})))),g["default"].createElement(ge,{msg:a,onOmit:this.props.onOmit,inConversation:i})))}}]),t}(g["default"].PureComponent);t["default"]=he;var me=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=[];e.hasSymbol()&&t.push(g["default"].createElement(Y["default"],{msg:e,key:"msg-symbol"})),[se,fe].indexOf(e.type)>-1&&!e.isGif&&!e.caption&&t.push(v.durationStr(e.duration)+" ");var a=ee.Configuration.Format({mentions:e.mentionMap()});return[le,se,ie].indexOf(e.type)>-1?t.push(g["default"].createElement(R["default"],{formatters:a,text:x["default"].msgText(e,!1),direction:"auto",key:"status"})):t.push(g["default"].createElement(R["default"],{formatters:a,text:x["default"].msgText(e),direction:"auto",key:"status"})),g["default"].createElement("div",{className:"message-text quoted-msg-text"},t)}}]),t}(g["default"].PureComponent),ge=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.onOmit,o=e.inConversation,n=void 0,r=void 0,i="quoted-msg-image";switch(t.type){case le:case se:case ce:n=g["default"].createElement(U["default"],{mediaData:t.mediaData,className:i});break;case ue:t.body&&(n=g["default"].createElement("div",{style:{backgroundImage:"url(data:image/jpeg;base64,"+t.body+")"},className:i}));break;case ie:t.thumbnail&&(n=g["default"].createElement("div",{style:{backgroundImage:'url("data:image/jpeg;base64,'+t.thumbnail+'")'},className:i}));break;case de:r=o?55:67,n=g["default"].createElement(H["default"],{waid:t.getVCardThumbnailWAid(),thumb:t.body&&$["default"].thumbnail(t.body),quoted:!0,square:!0,size:r,className:i});break;case pe:r=o?55:67,n=g["default"].createElement(H["default"],{className:i,size:r,square:!0,quoted:!0})}return a?g["default"].createElement("div",{style:{display:"flex",flex:"0 0 auto"}},n,g["default"].createElement("div",{className:"btn-background"},g["default"].createElement("button",{className:"quoted-msg-cancel-icon",onClick:a},g["default"].createElement(ne["default"],{name:"x"})))):n?g["default"].createElement("div",{className:"quoted-msg-image-wrapper"},n):null}}]),t}(g["default"].PureComponent)},7201:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(7180),b=o(v),y=a(12),E=o(y),S=a(94),C=o(S),M=a(14),k=o(M),w=a(7124),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.requestFocus=function(){if(o.uieElement){var e=o.uieElement.refs.uiElement.getComponent();e.onFocusList&&e.onFocusList()}},o.onForwardConfirmed=function(e){Store.Chat.forwardMessagesToChats(o.props.msgs,e)["catch"](k["default"].ForwardError,function(e){o.showMediaSendError(e.reasons)}),o.end(),_["default"].isFunction(o.props.onForward)&&o.props.onForward(o.props.msgs),E["default"].openChatFromUnread(_["default"].head(e))},o.showMediaSendError=function(e){var t=e.map(function(e){var t=e.chat,a=e.reason;return m["default"].createElement("p",{key:t.id},t.formattedTitle," : ",a)});E["default"].openModal(m["default"].createElement(C["default"],{onOK:E["default"].closeModal.bind(E["default"]),okText:l10n.t("web_ok")},t),void 0)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=l10n.t("forward_message_to",{_plural:this.props.msgs.length||1}),t=_["default"].head(this.props.msgs),a=t&&t.chat,o=void 0;o="video"!==t.type&&"image"!==t.type?"message":t.type,this.push(m["default"].createElement(b["default"],{onChat:this.onForwardConfirmed,excludeChat:a,msgType:o,title:e,listType:v.ListType.CHAT_SELECT_MODAL}))}}]),t}(N["default"]);t["default"]=T},7202:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RETRY_OPTIONS=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(7345),b=o(v),y=a(7120),E=o(y),S=a(7122),C=o(S),M=a(7121),k=o(M),w=a(7132),N=o(w),T=a(126),P=o(T),I=a(7144),R=o(I),A=a(73),x=o(A),O=a(172),D=o(O),L=361,U=500,F=t.RETRY_OPTIONS={RETAKE:"retake",RESTART:"restart"},j=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={img:o.props.img,doneEditing:!1,loaded:!1,editorSize:{width:U,height:L}},o.onDoneEditing=function(){o.setState({doneEditing:!0})},o.onObjectLoad=function(e){if(e){var t={};!o.state.editorSize||o.state.editorSize.width===e.clientWidth&&o.state.editorSize.height===e.clientHeight||(t.editorSize={width:e.clientWidth,height:e.clientHeight}),o.state.loaded||(t.loaded=!0),_["default"].isEmpty(t)||o.setState(t)}},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e,t=this.props,a=t.attributionUrl,o=t.noContainer,n=t.onCancel,r=t.onFinished,i=t.onRetake,l=t.retryText,s=this.state.loaded?m["default"].createElement("div",{className:"drawer-controls-right btn-send",key:"btn-send"},m["default"].createElement(R["default"],{large:!0,onClick:this.onDoneEditing},m["default"].createElement(D["default"],{name:"checkmark-light-l"}))):null,u=o?S.DRAWER_HEADER_TYPE.POPUP:S.DRAWER_HEADER_TYPE.OFFSET,c=m["default"].createElement(b["default"],{img:this.state.img,onImageSet:r,doneEditing:this.state.doneEditing,size:this.state.editorSize});if(i){var d;switch(l){case F.RETAKE:d=l10n.t("retake");break;case F.RESTART:default:d=l10n.t("retry")}e=m["default"].createElement("div",{className:"drawer-header-action",onClick:i},m["default"].createElement(D["default"],{name:"refresh-light"}),d)}var f="https://www.whatsapp.com/legal/";f=x["default"].build(f,{lg:l10n.getLocale()});var p=a?m["default"].createElement("div",{className:"edit-image-drawer-attribution"},m["default"].createElement("a",{className:"edit-image-drawer-attribution-link ellipsify",href:a,target:"_blank"},x["default"].hostname(a)),m["default"].createElement("span",null,l10n.t("image_search_copyright_disclaimer"),"",m["default"].createElement("a",{href:f,target:"_blank"},l10n.t("image_search_tos_link")))):null,h=m["default"].createElement("div",{className:"drawer-edit-footer"},m["default"].createElement(P["default"],{transitionName:"btn"},s),p),g=this.props.imageSize?this.props.imageSize:{width:U,height:L};return m["default"].createElement(E["default"],{key:"attach-edit-modal",className:"drawer-edit",variant:"noheader"},m["default"].createElement(C["default"],{title:l10n.t("adjust_image"),type:u,onCancel:n},e),m["default"].createElement(k["default"],{overflow:"hidden"},m["default"].createElement("div",{className:"media-body"},m["default"].createElement("div",{className:"media-body-container-background"},m["default"].createElement(P["default"],{transitionName:"capture"},m["default"].createElement(N["default"],{type:w.FIT_TYPE.COVER,size:g,onObjectLoad:this.onObjectLoad},c)))),h))}}]),t}(m["default"].Component);t["default"]=j},7203:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StatusV3Text=t["default"]=void 0;var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(7118),v=n(_),b=a(71),y=n(b),E=a(174),S=a(23),C=n(S),M=a(10),k=n(M),w=a(7461),N=n(w),T=a(267),P=n(T),I=a(7196),R=n(I),A=a(7119),x=n(A),O=a(488),D=a(7499),L=n(D),U=a(7498),F=a(7123),j=n(F),B=a(173),G=n(B),V=a(175),Y=n(V),W=a(7132),H=n(W),q=a(493),z=a(7280),K=n(z),Q=a(53),J=n(Q),X=a(7131),Z=(n(X),a(484)),$=(n(Z),a(62)),ee=o($),te=a(177),ae=n(te),oe=a(172),ne=n(oe),re=a(46),ie=a(261),le=a(72),se=a(262),ue=a(1),ce=4500,de=2e3,fe=3e3,pe=2e3,he=function(e){function t(){(0,s["default"])(this,t);var e=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments));me.call(e),e.state={chat:void 0,narrow:!1};var a=e.props.mediaData;if(a)if(a.type===se.TYPE.IMAGE){var o=ce;k["default"].isEmpty(e.props.msg.caption)||(o+=de*Math.min((0,q.graphemeLength)(e.props.msg.caption)/150,1)),e.playbackController=new U.StatusV3CountdownController(o)}else a.type===se.TYPE.VIDEO?e.props.msg.isGif?e.playbackController=new U.StatusV3GifController:e.playbackController=new U.StatusV3VideoController:e.playbackController=new U.StatusV3CountdownController(fe);else if(e.props.msg.type===J["default"].TYPE.CHAT){var n=pe+60*Math.min((0,q.graphemeLength)(e.props.msg.body),1e3);e.playbackController=new U.StatusV3CountdownController(n)}else e.playbackController=new U.StatusV3CountdownController(fe);return e}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){var e=this,t=this.refs.progressBar;this.playbackController.addListeners(t.onStart.bind(t),t.onPause.bind(t),function(){t.onEnded()["finally"](function(){e.props.onNext()})});var a=this.props.mediaData;a?a.mediaStage===se.STAGE.RESOLVED&&(this.playbackController.play(),this.props.markRead(this.props.statusV3,this.props.msg)):this.props.msg.type===J["default"].TYPE.CHAT?(this.playbackController.play(),this.props.markRead(this.props.statusV3,this.props.msg)):(this.playbackController.play(),this.props.markRead(this.props.statusV3,this.props.msg));var o=re.findDOMNode(this.refs.wrapper);o.focus();var n=this.props.listeners;n.add(window,"focus",this.onWindowGainedFocus),n.add(window,"blur",this.onWindowLostFocus),n.add(window,"resize",k["default"].debounce(this.onWindowResize)),this.onWindowResize()}},{key:"render",value:function(){var e,t=this,a=this.props,o=a.msg,n=a.mediaData,r=a.statusV3;if(n&&n.preview)e={backgroundImage:"url("+n.preview.url()+")"};else if(o.type===J["default"].TYPE.CHAT){var i=o.statusV3TextBg;e={backgroundColor:i}}var l;if(n)switch(n.type){case se.TYPE.IMAGE:l=g["default"].createElement(_e,{ref:"media",msg:o,statusV3:r,mediaData:n,markRead:this.props.markRead,playbackController:this.playbackController,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp});break;case se.TYPE.VIDEO:l=g["default"].createElement(be,{ref:"media",msg:o,statusV3:r,mediaData:n,markRead:this.props.markRead,playbackController:this.playbackController,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp});break;default:ue.error("Invalid status v3 image type: "+n.type)()}else l=o.type===J["default"].TYPE.CHAT?g["default"].createElement(ye,{ref:"media",msg:o,playbackController:this.playbackController,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp}):g["default"].createElement(Ee,{ref:"media",playbackController:this.playbackController,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp});var s=g["default"].createElement(L["default"],{ref:"progressBar",current:this.props.msgIdx,total:this.props.totalMsgs}),u=void 0;o.type!==J["default"].TYPE.CHAT&&(u=g["default"].createElement("div",{className:"caption-backdrop"},g["default"].createElement(x["default"],{ref:"caption",className:"media-caption",text:o.caption})));var c=function(e){e||t.props.closeStatusViewer()},d=(0,C["default"])("status-v3-profile",{"status-v3-profile-narrow":this.state.narrow}),f=(0,C["default"])("status-v3-profile","status-v3-measuring-profile",{}),p=(0,C["default"])("status-v3-back-icon",{}),h=g["default"].createElement("button",{className:p,onClick:function(){return t.props.closeStatusViewer()}},g["default"].createElement(ne["default"],{name:"back-light",directional:!0})),m=g["default"].createElement("div",{ref:"profile",className:d},g["default"].createElement("div",{className:"status-v3-player-avatar"},g["default"].createElement(j["default"],{id:r.contact.id,size:40})),g["default"].createElement("div",{className:"status-v3-msg-info"},g["default"].createElement(x["default"],{className:"status-v3-msg-info-name",text:r.contact.formattedName}),g["default"].createElement("div",{className:"status-v3-timestamp"},ee.relativeDateAndTimeStr(o.t)))),_=g["default"].createElement("div",{ref:"measuringProfile",className:f},g["default"].createElement("div",{className:"status-v3-player-avatar"},g["default"].createElement(j["default"],{id:r.contact.id,size:40})),g["default"].createElement("div",{className:"status-v3-msg-info"},g["default"].createElement(x["default"],{className:"status-v3-msg-info-name",text:r.contact.formattedName}),g["default"].createElement("div",{className:"status-v3-timestamp"},ee.relativeDateAndTimeStr(o.t)))),v=(0,C["default"])("status-v3-x",{}),b=g["default"].createElement("button",{className:v,onClick:function(){return t.props.closeStatusViewer(!0)}},g["default"].createElement(ne["default"],{name:"status-v3-x"})),y={tab:this.onTab,"shift+tab":this.onTab},S=function(e){return e.stopPropagation()},M={left:S,right:S},k=void 0;n&&(k=g["default"].createElement(Ce,{mediaData:n}));var w=void 0;this.props.statusV3.contact.isMe||(w=g["default"].createElement(G["default"],{handlers:M},g["default"].createElement(N["default"],{msg:this.props.msg,dismissReply:this.dismissReply,playbackController:this.playbackController,ref:(0,E.GetRef)("composeBox",this)})));var T=(0,C["default"])("status-v3-player-background",{media:n}),P=void 0,I=(0,C["default"])("progress-bar-backdrop",{"progress-bar-backdrop-narrow":this.state.narrow});return o.type!==J["default"].TYPE.CHAT&&(P=g["default"].createElement("div",{className:I})),g["default"].createElement(ie,{displayName:"StatusV3Player",escapable:!0,requestDismiss:c,requestFocus:this.dismissReply},g["default"].createElement(G["default"],{handlers:y},g["default"].createElement("div",{className:"status-v3-player-wrapper",key:o.id,tabIndex:-1,ref:"wrapper"},h,_,m,b,P,s,u,g["default"].createElement("div",{className:T,style:e}),l,k,w)))}}]),t}(g["default"].Component),me=function(){var e=this;this.onWindowResize=function(){if(e.refs.measuringProfile&&e.refs.progressBar){var t=re.findDOMNode(e.refs.measuringProfile).getBoundingClientRect(),a=re.findDOMNode(e.refs.progressBar).getBoundingClientRect();!l10n.isRTL()&&t.right>a.left-5||l10n.isRTL()&&t.left<a.right+5?e.setState({narrow:!0}):e.setState({narrow:!1})}},this.onTab=function(t){if(t&&(t.stopPropagation(),t.preventDefault()),!e.props.statusV3.contact.isMe){var a=e.composeBox;a.isFocused()?e.dismissReply(t):e.startReply(t)}},this.onWindowGainedFocus=function(){var t=e.props.mediaData;if(!t||t.mediaStage===se.STAGE.RESOLVED){var a=e.composeBox;a&&a.isPaused()||e.playbackController.resume()}},this.onWindowLostFocus=function(){var t=e.props.mediaData;t&&t.mediaStage!==se.STAGE.RESOLVED||e.playbackController.pause()},this.onMouseDown=function(t){var a=e.props.mediaData;a&&a.mediaStage!==se.STAGE.RESOLVED||e.playbackController.pause()},this.onMouseUp=function(t){var a=e.props.mediaData;if(!a||a.mediaStage===se.STAGE.RESOLVED){var o=e.composeBox;o&&o.isPaused()||e.playbackController.resume()}},this.dismissReply=function(t){var a=re.findDOMNode(e.refs.wrapper);a&&ae["default"].focus(a,t)},this.startReply=function(t){var a=e.composeBox;a.restoreFocus(t)}};he.contextTypes={uim:g["default"].PropTypes.instanceOf(le)};var ge=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.mediaData;e.mediaStage!==se.STAGE.RESOLVED&&this.props.msg.forceDownloadMedia()}},{key:"componentDidUpdate",value:function(){var e=this.props.mediaData;e.mediaStage===se.STAGE.RESOLVED&&(this.props.playbackController.play(),this.props.markRead(this.props.statusV3,this.props.msg))}},{key:"componentWillUnmount",value:function(){this.props.playbackController.stop()}},{key:"render",value:function(){var e=this.props.mediaData,t=e.mediaStage!==se.STAGE.RESOLVED,a=(0,C["default"])("status-v3-player-content","status-v3-image",{loading:t});return e.mediaStage===se.STAGE.RESOLVED?g["default"].createElement("div",{className:a,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp},g["default"].createElement(H["default"],{type:W.FIT_TYPE.CONTAIN,size:{width:e.fullWidth,height:e.fullHeight}},g["default"].createElement(P["default"],{src:e.renderableUrl}))):g["default"].createElement("div",{className:a,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp},g["default"].createElement(H["default"],{type:W.FIT_TYPE.CONTAIN,size:{width:e.aspectRatio,height:1}},g["default"].createElement(P["default"],{src:e.preview&&e.preview.url()})))}}]),t}(g["default"].PureComponent);ge.CONCERNS={mediaData:["mediaStage","renderableUrl","preview","fullWidth","fullHeight","aspectRatio"]};var _e=(0,v["default"])(ge),ve=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.mediaData;e.mediaStage!==se.STAGE.RESOLVED&&this.props.msg.forceDownloadMedia()}},{key:"componentDidUpdate",value:function(){var e=this.props.mediaData;e.mediaStage===se.STAGE.RESOLVED&&(this.props.playbackController.play(),this.props.markRead(this.props.statusV3,this.props.msg))}},{key:"componentWillUnmount",value:function(){this.props.playbackController.stop()}},{key:"render",value:function(){var e=this.props.mediaData,t=e.mediaStage!==se.STAGE.RESOLVED,a=(0,C["default"])("status-v3-player-content","status-v3-video",{loading:t}),o=e.preview?e.preview.url():void 0;return g["default"].createElement("div",{className:a,onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp},g["default"].createElement(R["default"],{msg:this.props.msg,mediaData:this.props.mediaData,ref:"player",poster:o}))}},{key:"componentDidMount",value:function(){var e=re.findDOMNode(this.refs.player),t=this.props.playbackController;t.setVideo(e)}}]),t}(g["default"].PureComponent);ve.CONCERNS={mediaData:["preview","mediaStage"]};var be=(0,v["default"])(ve),ye=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){K["default"].load(this.props.msg.font)["catch"](k["default"].noop)}},{key:"componentWillUnmount",value:function(){this.props.playbackController&&this.props.playbackController.stop()}},{key:"render",value:function(){var e=(0,q.graphemeLength)(this.props.msg.body),t=void 0,a=void 0,o={};return o["status-v3-text-font-"+(this.props.msg.font||0)]=!0,60>=e?(t=(0,C["default"])("status-v3-text","text-size-large",o),a=O.Configuration.StatusV3Text()):240>=e?(t=(0,C["default"])("status-v3-text","text-size-medium",o),a=O.Configuration.StatusV3Text()):t=(0,C["default"])("status-v3-text","text-size-small",o),g["default"].createElement("div",{className:"status-v3-player-content",onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp},g["default"].createElement("div",{className:t},g["default"].createElement(x["default"],{text:this.props.msg.body,formatters:a})))}}]),t}(g["default"].PureComponent),Ee=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillUnmount",value:function(){this.props.playbackController.stop()}},{key:"render",value:function(){return g["default"].createElement("div",{className:"status-v3-player-content",onMouseDown:this.props.onMouseDown,onMouseUp:this.props.onMouseUp},g["default"].createElement("div",{className:"status-v3-unknown"},l10n.t("status_v3_unknown_placeholder")))}}]),t}(g["default"].PureComponent),Se=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props.mediaData,t=e.mediaStage!==se.STAGE.RESOLVED;return t?g["default"].createElement("div",{className:"media-state-controls"},g["default"].createElement("button",{className:"icon-media-disabled"},g["default"].createElement(Y["default"],{size:50,stroke:4,color:"white"}))):null;
}}]),t}(g["default"].Component);Se.CONCERNS={mediaData:["mediaStage"]};var Ce=(0,v["default"])(Se),Me=(0,y["default"])(he);t["default"]=Me,t.StatusV3Text=ye},7204:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=document.createElement("a");t.href=e,t.target="_blank",t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function r(e){return e.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7141),E=o(y),S=a(12),C=o(S),M=a(7259),k=o(M),w=a(93),N=o(w),T=a(7119),P=o(T),I=a(7123),R=o(I),A=a(7174),x=o(A),O=a(39),D=a(266),L=o(D),U=a(32),F=o(U),j=a(172),B=o(j),G=a(7621),V=o(G),Y=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"openChat",value:function(e){C["default"].closeModal(),Store.Chat.find(F["default"].numberToWid(e)).then(function(e){C["default"].openChatFromUnread(e).then(function(t){t&&C["default"].focusChatTextInput(e)})})}},{key:"sendEmail",value:function(e){var t="mailto:"+e;n(t)}},{key:"openLocation",value:function(e){var t=b["default"].map(b["default"].filter(e),encodeURIComponent).join(", "),a="https://maps.google.com/maps/search/"+t+"?hl="+N["default"].getLocale();n(a)}},{key:"getHeader",value:function(){var e=this.props.parsedVCard,t=L["default"].vcardWAids(e),a=_["default"].createElement(P["default"],{text:L["default"].getNameFromParsedVCard(e),direction:"auto",titlify:!0,ellipsify:!0}),o=L["default"].getOrganizationString(e),n=_["default"].createElement(x["default"],{thumb:this.props.thumbnail,size:R["default"].Size.SMALL,waid:L["default"].thumbnailWAid(t)});return _["default"].createElement(E["default"],{image:n,theme:"plain",primary:a,secondary:o})}},{key:"render",value:function(){var e=this,t=this.props.parsedVCard,a=b["default"].filter(t.TEL,function(e){return e.properties.waid}),o=b["default"].filter(t.TEL,function(e){return!e.properties.waid}),n=b["default"].map(a,function(t){var a=b["default"].first(t.properties.waid),o=function(){return e.openChat(a)},n=_["default"].createElement(B["default"],{name:"chat",onClick:o}),r=_["default"].createElement(O.SelectableSpan,{selectable:!0},F["default"].formattedUser(a));return _["default"].createElement(k["default"],{title:r,icon:n,key:"vCard-"+t.index},L["default"].getType(t))}),i=b["default"].map(t.EMAIL,function(t){return _["default"].createElement(k["default"],{title:t.value,onClick:function(){return e.sendEmail(t.value)},key:"vCard-"+t.index},L["default"].getType(t))}),l=b["default"].map(t.ADR,function(t){var a=r(t.value);return _["default"].createElement(k["default"],{title:a,onClick:function(){return e.openLocation(t.value)},key:"vCard-"+t.index},L["default"].getType(t))}),s=b["default"].map(o,function(e){return _["default"].createElement(k["default"],{title:e.value,key:"vCard-"+e.index},L["default"].getType(e))}),u=b["default"].map(t.SERVICE,function(e){return _["default"].createElement(k["default"],{title:e.value,key:"vCard-"+e.index},L["default"].getType(e))}),c=b["default"].map(t.BDAY,function(e){return _["default"].createElement(k["default"],{title:L["default"].getDate(e.value),key:"vCard-"+e.index},N["default"].t("vcard_birthday"))}),d=b["default"].map(t.NICKNAME,function(e){return _["default"].createElement(k["default"],{title:e.value,key:"vCard-"+e.index},N["default"].t("vcard_nickname"))}),f=this.getHeader();return _["default"].createElement("div",null,f,_["default"].createElement("div",{className:V["default"].content},n,i,l,s,c,d,u))}}]),t}(g.Component);t["default"]=Y},7205:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7163),l=o(i),s=a(7283),u=o(s),c=a(63),d=a(75),f=d.FILETYPE,p=d.typeFromMimetype,h=a(8),m=a(14),g=l["default"].STATE,_=g.ERROR,v=g.PROCESSING,b=f.IMAGE,y=f.VIDEO,E=f.DOCUMENT,S=f.AUDIO,C=1,M=c.extend({model:l["default"],initialize:function(){this.errorMsgs=null,this.ignored=0,c.prototype.initialize.call(this),this.mediaPickerStatsLogger=new u["default"]},removeSingleton:function(e,t){t||this.mediaPickerStatsLogger.logDelete(e.id,e.type,e.fileOrigin),e.url&&window.URL.revokeObjectURL(e.url),e.original&&e.original.url&&window.URL.revokeObjectURL(e.original.url)},remove:function(e,t){var a=this;Array.isArray(e)?e.forEach(function(e){return a.removeSingleton(e,t)}):this.removeSingleton(e,t),c.prototype.remove.call(this,e,t)},"delete":function(){var e=this;this.models.forEach(function(t){return e.removeSingleton(t)}),c.prototype["delete"].call(this)},contains:function(e){return this.indexOf(e)>-1},replace:function(e,t){var a=this.get(e);if(a){var o=this.indexOf(a),n=a.caption;this.remove(a,{silent:!0}),a["delete"]();var r=new l["default"]({id:e,caption:n,file:this._normalizeFile(t),chat:a.chat,uiProcessed:!1});return this.add(r,o?{at:o}:{}),r.processPromise}},getPreviewableMedias:function(){return this.filter({previewable:!0})},getAfter:function(e){var t=this.getPreviewableMedias(),a=t.indexOf(e);return 0>a||a===t.length-1?null:t[a+1]},getBefore:function(e){var t=this.getPreviewableMedias(),a=t.indexOf(e);return 0>=a?null:t[a-1]},processFiles:function(e,t,a){var o=this,n=this.getPreviewableMedias().length,i=e.length+n>h.MAX_FILES?Math.max(h.MAX_FILES-n,0):e.length,s=e.length-i;0===i?s&&this.trigger("max_upload_limit",s):this.ignore(s);var u=e.slice(0,i).map(function(e){var n=new l["default"]({id:C++,file:o._normalizeFile(e),chat:t,uiProcessed:!1,fileOrigin:a});return o.add(n)});return r["default"].map(u,function(e){return e.processPromise})},_logMediaAdd:function(e){this.mediaPickerStatsLogger.chatRecipients||(this.mediaPickerStatsLogger.chatRecipients=e.chat.groupMetadata&&e.chat.groupMetadata.participants.length||1);var t=e.isGif?"gif":e.type;this.mediaPickerStatsLogger.logAdd(e.id,t,e.fileOrigin)},_normalizeFile:function(e){return r["default"].resolve(e).then(function(e){var t=void 0;return t=e instanceof File?{file:e,filename:e.name,mimetype:e.type}:e instanceof Blob?{file:e,mimetype:e.type}:e,!t.type&&t.mimetype&&(t.type=p(t.mimetype)),t})},ignore:function(e){e>0&&(this.ignored+=e)},uiProcessMsgs:function(){var e=this,t=[],a=void 0,o=void 0,n=0,r=0,i=0,l=0,s=0,u=0,c=0,d=0,f=0,p=!1,g=l10n.filesize(Store.ServerProps.media),C=l10n.filesize(Store.ServerProps.maxFileSize);if(this.forEach(function(t){if(!t.uiProcessed&&(!a&&t.previewable&&(a=t,e._logMediaAdd(t)),t.state!==v&&(t.uiProcessed=!0,t.state===_)))if(t.exception instanceof m.MediaFileTooLarge)switch(t.getFileType()){case b:n+=1;break;case y:r+=1;break;case S:i+=1;break;case E:l+=1}else if(t.exception instanceof m.MediaFileEmpty)switch(t.getFileType()){case b:s+=1;break;case y:u+=1;break;case S:c+=1;break;case E:d+=1}else t.exception instanceof m.MediaFileFailedLoad?p=!0:f+=1}),n>0&&t.push(l10n.t("image_too_big",{number:n,_plural:n,maxSize:g})),r>0&&t.push(l10n.t("video_too_big",{number:r,_plural:r,maxSize:g})),i>0&&t.push(l10n.t("audio_too_big",{number:i,_plural:i,maxSize:g})),l>0&&t.push(l10n.t("document_too_big",{number:l,_plural:l,maxSize:C})),s>0&&t.push(l10n.t("image_empty",{number:s,_plural:s})),u>0&&t.push(l10n.t("video_empty",{number:u,_plural:u})),c>0&&t.push(l10n.t("audio_empty",{number:c,_plural:c})),d>0&&t.push(l10n.t("document_empty",{number:d,_plural:d})),f>0&&t.push(l10n.t("files_not_supported",{number:f,_plural:f})),p&&(t=[],t.push(l10n.t("media_failed_load"))),t.length>1){t=[];var M=n+r+i+l,k=s+u+c+d,w=M+k+f;0===f?(0!==M&&t.push(l10n.t("files_too_big",{number:M,_plural:M,maxSize:C})),0!==k&&t.push(l10n.t("files_empty",{number:k,_plural:k}))):t.push(l10n.t("files_not_added",{number:w,_plural:w}))}return this.errorMsgs=t.join(" "),this.ignore(this.getPreviewableMedias().length-h.MAX_FILES),o=this.ignored,this.ignored=0,o&&this.trigger("max_upload_limit",o),{activeMedia:a,errorMsgs:this.errorMsgs}},canSend:function(){return!this.some({state:v,previewable:!1})}});e.exports=M},7206:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t={"default":e,type:v.PROPS};return t}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t={"default":e,type:v.SESSION};return t}function i(e,t){var a={fn:e,deps:t,type:v.DERIVED};return a}function l(e){var t=e["default"];return t===b?{}:{"default":t}}function s(e,t){var a=new t,o={props:{},session:{},derived:{}},n=["constructor"];g["default"].forOwn(a,function(t,a){switch(t.type){case v.PROPS:o.props[a]=l(t);break;case v.SESSION:o.session[a]=l(t);break;case v.DERIVED:o.derived[a]=g["default"].omit(t,"type"),n.push(t.fn.name);break;default:throw new Error("Invalid defineState Class type for "+e+":"+a+".")}}),t.Collection&&(o.Collection=t.Collection);var r=(0,f["default"])(a),i=g["default"].difference((0,c["default"])(r),n),s=g["default"].pick(r,i);g["default"].assign(o,s);for(var u=arguments.length,d=Array(u>2?u-2:0),p=2;u>p;p++)d[p-2]=arguments[p];return _.defineState.apply(void 0,[e,o].concat(d))}Object.defineProperty(t,"__esModule",{value:!0}),t.NO_DEFAULT_VALUE=void 0;var u=a(6998),c=o(u),d=a(5),f=o(d),p=a(523),h=o(p);t.prop=n,t.session=r,t.derived=i,t.defineStateClass=s;var m=a(10),g=o(m),_=a(74),v={PROPS:"Props",SESSION:"Session",DERIVED:"Derived"},b=t.NO_DEFAULT_VALUE=(0,h["default"])("NO_DEFAULT_VALUE")},7207:function(e,t,a){"use strict";function o(e){d(this,o,e)}function n(e){d(this,n,e)}var r=a(494),i=r.Message,l=a(501),s=l.MessageKey,u=a(274),c=u.defineProtobufClass,d=u.construct,f=64,p=256,h=3,m=4,g=7,_=8,v=12,b=13,y=14,E={ERROR:0,PENDING:1,SERVER_ACK:2,DELIVERY_ACK:3,READ:4,PLAYED:5},S={UNKNOWN:0,REVOKE:1,CIPHERTEXT:2,FUTUREPROOF:3,NON_VERIFIED_TRANSITION:4,UNVERIFIED_TRANSITION:5,VERIFIED_TRANSITION:6,VERIFIED_LOW_UNKNOWN:7,VERIFIED_HIGH:8};c(o,{key:[1,p|y,s],message:[2,y,i],messageTimestamp:[3,m],status:[4,_,E],participant:[5,v],ignore:[16,g],starred:[17,g],broadcast:[18,g],pushName:[19,v],mediaCiphertextSha256:[20,b],multicast:[21,g],urlText:[22,g],urlNumber:[23,g],messageStubType:[24,_,S],clearMedia:[25,g],messageStubParameters:[26,f|v],duration:[27,h]},{status:E.PENDING}),c(n,{timestamp:[2,m],unreadChats:[3,h],notifyMessageCount:[4,h],notifyMessages:[5,f|y,o]}),o.STATUS=E,o.STUBTYPE=S,e.exports={WebMessageInfo:o,WebNotificationsInfo:n}},7208:function(e,t){"use strict";function a(){return o?n:n}Object.defineProperty(t,"__esModule",{value:!0}),t.checkStreamingSupported=a;var o=null,n=!1},7209:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){var a=e.target.files||e.dataTransfer.files,o=(0,s["default"])(a);if(t&&!function(){var e="string"==typeof t?[t]:t,a=e.map(function(e){return new RegExp(e)});o=o.filter(function(e){return a.some(function(t){return e.type.match(t)})})}(),o.length)return i["default"].resolve(o);var n=e.dataTransfer;if(n&&n.getData("text/uri-list"))return f["default"].urlToFile(n.getData("text/uri-list")).then(function(e){return[e]});if(n&&n.getData("text/html")){var r=new DOMParser,l=r.parseFromString(n.getData("text/html"),"text/html");if(l.createNodeIterator(l.childNodes[0],NodeFilter.SHOW_TEXT).nextNode()){if(n.getData("text/plain")){var u=new c["default"].MediaDragDropError("dropped html has text nodes",n.getData("text/plain"));return i["default"].reject(u)}}else{var d=l.getElementsByTagName("img");if(d.length)return f["default"].urlToFile(d[0].src).then(function(e){return[e]})}}return i["default"].resolve(o)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),i=o(r),l=a(293),s=o(l);t.getFiles=n;var u=a(14),c=o(u),d=a(180),f=o(d)},7210:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=!1;try{var o={get passive(){a=!0}};window.addEventListener("test",null,o)}catch(n){}t["default"]=a},7211:function(e,t){"use strict";var a={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,BINARY_8:252,BINARY_20:253,SINGLE_BYTE_MAX:256};e.exports=a},7212:function(e,t,a){"use strict";var o=a(187),n=a(14),r=a(289),i=a(131),l={encrypt:function(e){if(!e)throw new Error("Missing ArrayBuffer in cryptoAsync:encrypt");var t=i.get(),a=(0,o.encryptAndMac)(t.encKey,t.macKey,e);return this._encryptQueue.enqueue(a)},decrypt:function(e){if(!e)throw new Error("Missing ArrayBuffer in cryptoAsync:decrypt");var t=i.get(),a=(0,o.macAndDecrypt)(t.encKey,t.macKey,e);return this._decryptQueue.enqueue(a)},dropAllBecauseLogout:function(){var e=new n.LogoutDrop("cancelled binary protocol call");this._encryptQueue.cancelAll(e),this._decryptQueue.cancelAll(e)},_encryptQueue:new r,_decryptQueue:new r};e.exports=l},7213:function(e,t){"use strict";var a={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,BINARY_8:252,BINARY_20:253,BINARY_32:254,NIBBLE_8:255,SINGLE_BYTE_MAX:256,NIBBLE_MAX:254};e.exports=a},7214:function(e,t){"use strict";var a={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,HEX_8:251,BINARY_8:252,BINARY_20:253,BINARY_32:254,NIBBLE_8:255,SINGLE_BYTE_MAX:256,PACKED_MAX:254};e.exports=a},7215:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(71),_=o(g),v=a(7128),b=(o(v),a(484)),y=o(b),E=a(486),S=(o(E),a(7125)),C=(o(S),a(7155)),M=o(C),k=a(7135),w=o(k),N=a(7142),T=o(N),P=a(93),I=o(P),R=a(7528),A=o(R);t["default"]=(0,_["default"])(function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={selected:o.props.selections.isSelected(o.props.chat)},o.onSelectChange=function(e){o.state.selected!==e&&o.setState({selected:e})},o.onSelect=function(){o.props.onSelect(o.props.chat,!o.state.selected)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(this.props.selections,this.props.chat.id.toString(),this.onSelectChange)}},{key:"render",value:function(){var e=this.props,t=e.chat,a=e.active,o=void 0;return o=t instanceof y["default"]?m["default"].createElement(M["default"],{className:A["default"].checkboxChatCell,active:a,chat:t,contact:t.contact,mode:C.Mode.INFO,noContext:!0,onClick:this.onSelect}):m["default"].createElement(w["default"],{className:A["default"].checkboxChatCell,active:a,contact:t,onClick:this.onSelect,secondary:t.isBlocked()?I["default"].t("confirm_unblock_contact_and_forward_text"):null}),m["default"].createElement("div",{className:A["default"].checkboxChatWrapper},m["default"].createElement("div",{className:A["default"].checkboxChatControl},m["default"].createElement(T["default"],{onChange:this.onSelect,checked:this.state.selected})),o)}}]),t}(h.Component))},7216:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(23),_=o(g),v=a(1),b=o(v),y=a(53),E=o(y),S=a(7118),C=o(S),M=a(172),k=o(M),w=a(7533),N=o(w),T=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=void 0;switch(e.type){case E["default"].TYPE.LOCATION:case E["default"].TYPE.VIDEO:case E["default"].TYPE.AUDIO:case E["default"].TYPE.VCARD:case E["default"].TYPE.MULTI_VCARD:case E["default"].TYPE.DOCUMENT:case E["default"].TYPE.CIPHERTEXT:case E["default"].TYPE.UNKNOWN:case E["default"].TYPE.IMAGE:var a={location:"status-location",video:"status-video",audio:"status-audio",vcard:"status-vcard",multi_vcard:"status-vcard",document:"status-document",ciphertext:"status-ciphertext",unknown:"status-unknown",image:"status-image"};t=e.isGif?"status-gif":a[e.type];break;case E["default"].TYPE.CALL_LOG:"miss_video"===e.subtype&&(t="status-miss_video"),t="status-miss";break;case E["default"].TYPE.PTT:t=4===e.ack?"status-ptt-blue":e.isSentByMe?"status-ptt-gray":"status-ptt-green";break;case E["default"].TYPE.REVOKED:t="recalled-in";break;default:t="status-unknown",b["default"].log('chat:getClasses Invalid msg type:"'+e.type+'"')()}var o=(0,_["default"])(N["default"].symbol,e.isRevoked?null:N["default"].margin);return m["default"].createElement("div",{className:o},m["default"].createElement(k["default"],{name:t}))}}]),t}(m["default"].PureComponent);T.CONCERNS={msg:["ack","isGif","type","subtype","isRevoked","isSentByMe"]},t["default"]=(0,C["default"])(T)},7217:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7167),b=(o(v),a(7119)),y=o(b),E=a(7118),S=o(E),C=a(487),M=a(7226),k=o(M),w=a(7535),N=o(w);t["default"]=(0,S["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props.status,t=_["default"].createElement("span",{className:N["default"].statusLoading},l10n.t("contact_status_loading")),a=_["default"].createElement(y["default"],{direction:"auto",ellipsify:!0,titlify:!0,text:e.status}),o=function(){return Store.Status.find(e.id),"undefined"!=typeof e.status?a:t},n=(0,C.unproxy)(e).stale?t:a;return _["default"].createElement(k["default"],{id:e.id,onComplex:o,waitIdle:this.props.waitIdle},n)}}]),t}(_["default"].PureComponent),n.WEAK_CONCERNS={status:["id","stale","status"]},r))},7218:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a=(0,g["default"])(f["default"].count,(t={},(0,i["default"])(t,f["default"].ffFix,h["default"].isGecko),(0,i["default"])(t,f["default"].muted,e.muted),t));return s["default"].createElement("span",{className:a},e.count>0?c["default"].n(e.count):null)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=o(r);t["default"]=n;var l=a(3),s=o(l),u=a(93),c=o(u),d=a(7537),f=o(d),p=a(28),h=o(p),m=a(23),g=o(m)},7219:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(7135),b=o(v),y=a(173),E=o(y),S=a(7136),C=o(S),M=a(7160),k=o(M),w=a(7223),N=o(w),T=a(7125),P=o(T),I=a(7539),R=o(I),A=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onFocusGain=function(e){e.target===_["default"].findDOMNode(o)&&(o.selection.index<0?o.focusFirst(e):o.selection.reset(!0,e))},o.focusFirst=function(e){o.selection.setFirst(!0,e)},o.onNextContact=function(e){e.preventDefault(),e.stopPropagation(),o.selection.setNext(!0,e)},o.onPrevContact=function(e){e.preventDefault(),e.stopPropagation();var t=o.selection.prev();t>-1?o.selection.setPrev(!0,e):(o.selection.unset(),o.props.onFocusSearch(e))},o.setItems=function(e){for(var t,a=[],n=e.length>10,r="XXX",i=0;i<e.length;i++){var l=e[i];if(n){var s=l.header;i<e.length-1&&s!==e[i+1].header&&(t=m["default"].createElement(N["default"],{key:"separator-"+s})),s!==r&&(a.push(m["default"].createElement("div",{key:s,className:R["default"].header},t,m["default"].createElement(k["default"],{header:s}))),r=s)}var u=l.id,c=void 0;l.isBlocked()&&(c=l10n.t("contact_list_blocked_contact")),a.push(m["default"].createElement(b["default"],{contact:l,active:o.selection,onClick:o.props.onClick,secondary:c,key:u}))}o.items=a},o.keyForRowAtIndexPath=function(e){return o.items[e.row].key},o.itemForRowAtIndexPath=function(e){return o.items[e.row]},o.numberOfRowsInSection=function(e){return o.items.length},o.numberOfSections=function(){return 1},o.sectionForSection=function(e){return null},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.selection=new P["default"](this.props.contacts,function(e){return e.id}),this.setItems(this.props.contacts)}},{key:"componentWillReceiveProps",value:function(e){this.selection.init(e.contacts),this.setItems(e.contacts)}},{key:"render",value:function(){var e={down:this.onNextContact,up:this.onPrevContact};return m["default"].createElement(E["default"],{handlers:e,onFocus:this.onFocusGain,"data-tab":3},m["default"].createElement(C["default"],{keyForRowAtIndexPath:this.keyForRowAtIndexPath,itemForRowAtIndexPath:this.itemForRowAtIndexPath,numberOfSections:this.numberOfSections,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,extraItems:4}))}}]),t}(m["default"].PureComponent);t["default"]=A},7220:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(33),b=o(v),y=a(12),E=o(y),S=a(28),C=o(S),M=a(71),k=o(M),w=a(127),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.startCheckForSuccess=function(){o.checkIteration=0,o.checkForSuccessInterval=o.props.setInterval(o.checkForSuccess,250)},o.clearCheckForSuccess=function(){o.checkForSuccessInterval&&(o.props.clearInterval(o.checkForSuccessInterval),delete o.checkForSuccessInterval,delete o.checkIteration)},o.checkForSuccess=function(){if(b["default"].state===b["default"].STATE.CONNECTED){o.checkIteration++;var e=o.props.url;if(o.checkIteration>40)return void o.onPlayerError({target:{src:e,error:{code:window.MediaError.MEDIA_ERR_NETWORK}}});var t=_["default"].findDOMNode(o),a=t.buffered;a&&a.length&&a.end(0)>0&&o.onPlaying({target:t})}},o.onPlayerError=function(e){o.clearCheckForSuccess(),o.props.onError&&o.props.onError(e.target.src)},o.onOtherPlaying=function(e){e!==o&&_["default"].findDOMNode(o).pause()},o.onPlaying=function(e){o.clearCheckForSuccess(),E["default"].mediaPlaying(o),o.props.onPlay&&o.props.onPlay(e)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){var e=this.props.listeners,t=_["default"].findDOMNode(this);e.add(t,"error",this.onPlayerError,!0),e.add(t,"playing",this.onPlaying),e.add(E["default"],"mediaPlaying",this.onOtherPlaying),(C["default"].isGecko||C["default"].isSafari)&&(this.props.autoPlay?(this.checkIteration=0,this.checkForSuccessInterval=this.props.setInterval(this.checkForSuccess,250)):this.props.autoPlay?this.startCheckForSuccess():e.add(t,"play",this.startCheckForSuccess))}},{key:"render",value:function(){return m["default"].createElement("audio",{src:this.props.url,className:this.props.className,onClick:this.props.onClick,controls:this.props.controls,preload:this.props.preload,type:this.props.type,autoPlay:this.props.autoPlay},this.props.children)}}]),t}(m["default"].Component);t["default"]=(0,k["default"])((0,N["default"])(T))},7221:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(176),_=o(g),v=a(7540),b=o(v),y=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement("div",{className:b["default"].overlay,key:"avatar-overlay"},this.props.icon,m["default"].createElement("div",{"data-a8n":_["default"].key("avatar-text"),className:b["default"].text},this.props.text))}}]),t}(m["default"].Component);t["default"]=y},7222:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(175),_=o(g),v=a(7541),b=o(v),y=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement("div",{className:b["default"].container},m["default"].createElement(_["default"],{size:50,stroke:3,color:"solidwhite"}))}}]),t}(m["default"].Component);t["default"]=y},7223:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){return i["default"].createElement("div",{className:s["default"].border})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7542),s=o(l)},7224:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=(0,c["default"])(h["default"].chatSubtitle,(0,i["default"])({},h["default"].chatSubtitleHeader,"title"===e.location));return s["default"].createElement("div",{className:t},s["default"].createElement(f["default"],{titlify:!0,className:h["default"].chatSubtitleText,direction:"inherit",text:e.text}))}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=o(r);t["default"]=n;var l=a(3),s=o(l),u=a(23),c=o(u),d=a(7119),f=o(d),p=a(7543),h=o(p)},7225:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return e.map(function(e){return e.contact.formattedShortNameWithNonBreakingSpaces})}Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantsList=void 0;var r,i,l,s,u=a(5),c=o(u),d=a(2),f=o(d),p=a(4),h=o(p),m=a(7),g=o(m),_=a(6),v=o(_),b=a(3),y=o(b),E=a(7165),S=(o(E),a(71)),C=o(S),M=a(55),k=o(M),w=a(7118),N=o(w),T=a(7224),P=o(T),I="sort remove reset add",R=t.ParticipantsList=(0,C["default"])((0,N["default"])((i=r=function(e){function t(e){(0,f["default"])(this,t);var a=(0,g["default"])(this,(t.__proto__||(0,c["default"])(t)).call(this,e));a.onParticipantsUpdate=function(){a.recalculateParticipantsTimer.debounce(100)},a.recalculateParticipantsTimer=new k["default"](function(){a.setState({participants:n(a.props.groupMetadata.participants)})});var o=e.listeners,r=e.groupMetadata.participants;return a.state={participants:n(r)},o.add(r,I,a.onParticipantsUpdate),a}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.props.groupMetadata.participants,a=e.groupMetadata.participants;if(a!==t){var o=e.listeners;o.remove(t,I,this.onParticipantsUpdate),o.add(a,I,this.onParticipantsUpdate),this.recalculateParticipantsTimer.cancel(),this.setState({participants:n(a)})}}},{key:"componentWillUnmount",value:function(){this.recalculateParticipantsTimer.cancel()}},{key:"render",value:function(){var e=this.props.overridingText||this.state.participants.join(l10n.t("enumeration_comma"))||this.props.placeholder;return e?y["default"].createElement(P["default"],{text:e,location:this.props.location,chatType:"group"}):null}}]),t}(b.PureComponent),r.CONCERNS={groupMetadata:["participants"]},i)));t["default"]=(0,N["default"])((s=l=function(e){function t(){return(0,f["default"])(this,t),(0,g["default"])(this,(t.__proto__||(0,c["default"])(t)).apply(this,arguments))}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.presence.withholdDisplay?e.placeholder:e.presence.getFormattedString();return y["default"].createElement(R,{groupMetadata:e.groupMetadata,overridingText:t,placeholder:e.placeholder,location:e.location})}}]),t}(b.PureComponent),l.CONCERNS={chatstate:["id","type","deny","t"],groupMetadata:[],presence:["forceDisplay","withholdDisplay"]},s))},7226:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(496),_=o(g),v=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={isBusy:_["default"].isBusy()},o.onIdle=function(){o.setState({isBusy:!1})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.waitIdle&&(this.idleTaskId=_["default"].enqueue(this.onIdle))}},{key:"componentWillReceiveProps",value:function(e){if(this.props.id!==e.id||!e.waitIdle){this.state.isBusy&&_["default"].dequeue(this.idleTaskId);var t=_["default"].isBusy();t&&e.waitIdle&&(this.idleTaskId=_["default"].enqueue(this.onIdle)),this.setState({isBusy:t})}}},{key:"componentWillUnmount",value:function(){this.props.waitIdle&&_["default"].dequeue(this.idleTaskId)}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.onComplex,o=e.waitIdle,n=this.state.isBusy;return n&&o?t:a()}}]),t}(m["default"].Component);t["default"]=v},7227:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.duration,a=v.durationStr(t);return a?w.createElement("span",{className:"media-canvas-duration"},a):null}var i=a(5),l=n(i),s=a(2),u=n(s),c=a(4),d=n(c),f=a(7),p=n(f),h=a(6),m=n(h),g=a(53),_=(n(g),a(62)),v=o(_),b=a(7331),y=n(b),E=a(71),S=n(E),C=a(174),M=a(172),k=n(M),w=a(3),N=a(262),T=a(23),P=function(e){function t(){(0,u["default"])(this,t);var e=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments));return e.onSelectClick=function(t){e.props.onMessageSelect&&e.props.onMessageSelect(e.props.msg,!e.props.selected)},e.onMouseOver=function(t){e.state.hover||e.setState({hover:!0})},e.onMouseEnter=function(t){e.state.hover||e.setState({hover:!0})},e.onMouseLeave=function(t){e.state.hover&&e.setState({hover:!1})},e.state={hover:!1},e}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(this.props.msg.mediaData,"change:preview"),this.props.listeners.add(this.props.msg,"change:star"),this.props.imgRef&&this.props.imgRef(this.img)}},{key:"componentWillUnmount",value:function(){this.props.imgRef&&this.props.imgRef(null)}},{key:"render",value:function(){var e=this.props,t=e.msg.mediaData,a=e.selected,o=e.selectable,n=void 0,i=null,l=null,s=null,u=null,c=null;switch(this.props.msg.star&&(t.type!==N.TYPE.AUDIO&&(l=w.createElement("div",{className:"media-canvas-shade"})),c=w.createElement("div",{className:"media-canvas-icon-star"},w.createElement(k["default"],{name:"star-light"}))),t.type){case N.TYPE.AUDIO:n="media-canvas attach-media-audio-thumb",s=w.createElement("div",{className:"media-canvas-icon-type"},w.createElement(k["default"],{name:"msg-audio-light"})),u=w.createElement(r,{duration:t.duration});break;case N.TYPE.VIDEO:l=w.createElement("div",{className:"media-canvas-shade"}),t.isGif?(n=t.preview?"media-canvas":"media-canvas media-video-thumb",s=w.createElement("div",{className:"media-canvas-icon-type"},w.createElement(k["default"],{name:"msg-gif-light"}))):(n="media-canvas",s=w.createElement("div",{
className:"media-canvas-icon-type"},w.createElement(k["default"],{name:"msg-video-light"})),u=w.createElement(r,{duration:t.duration})),t.preview&&(i={backgroundImage:'url("'+t.preview.url()+'")'});break;case N.TYPE.IMAGE:n="media-canvas",t.renderableUrl?i={backgroundImage:"url("+t.renderableUrl+")"}:t.preview&&(i={backgroundImage:'url("'+t.preview.url()+'")'})}var d=void 0;d=this.props.onDragStart?w.createElement("div",{className:n,style:i,onClick:this.props.onClick||null,ref:(0,C.GetRef)("img",this),onDragStart:this.props.onDragStart,draggable:!0},l):w.createElement("div",{className:n,style:i,onClick:this.props.onClick||null,ref:(0,C.GetRef)("img",this)},l);var f=void 0;(o||this.state.hover)&&(f=w.createElement("div",{className:"media-select"},w.createElement("div",{className:"media-canvas-shade-top",onClick:this.props.onClick||null}),w.createElement(y["default"],{onChange:this.onSelectClick,hover:this.state.hover,checked:a})));var p=null,h=null,m=null;this.props.hoverEvent&&(p=this.onMouseOver,h=this.onMouseEnter,m=this.onMouseLeave);var g=T(this.props.classes,"media-canvas-component",{"media-canvas-selected":a});return w.createElement("div",{className:g,onMouseOver:p,onMouseEnter:h,onMouseLeave:m},f,w.createElement("div",{className:"media-canvas-body"},s,u,c),d)}}]),t}(w.Component);e.exports=(0,S["default"])(P)},7228:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7118),_=o(g),v=a(53),b=o(v),y=a(7164),E=(o(y),a(7242)),S=o(E),C=a(23),M=o(C),k=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.chatPreference,o=(0,M["default"])("pane-preview-wrapper",{"pane-preview-resize":t.type===b["default"].TYPE.PTT||t.type===b["default"].TYPE.IMAGE||t.type===b["default"].TYPE.LOCATION||t.type===b["default"].TYPE.VCARD||t.isGif});return m["default"].createElement("div",{className:o},m["default"].createElement("div",{className:"pane-preview"},m["default"].createElement(S["default"],{wallpaperColor:a.wallpaperColor}),this.props.children))}}]),t}(m["default"].Component);k.CONCERNS={chatPreference:["wallpaperColor"]},t["default"]=(0,_["default"])(k)},7229:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(484),b=(o(v),a(7142)),y=o(b),E=a(12),S=o(E),C=a(94),M=o(C),k=a(7187),w=o(k),N=a(7118),T=o(N),P=a(487),I=a(7133),R=o(I);t["default"]=(0,T["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onMute=function(e){S["default"].muteChat((0,P.unproxy)(o.props.chat),e,o)},o.onUnmute=function(){var e=o.props.chat.isGroup?l10n.t("confirm_unmute_group"):l10n.t("confirm_unmute_chat");S["default"].openModal(_["default"].createElement(M["default"],{onOK:o.unmute,okText:l10n.t("action_chat_unmute"),onCancel:function(){return S["default"].closeModal()},cancelText:l10n.t("web_cancel")},e))},o.unmute=function(){o.onMute(!1),S["default"].closeModal()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this,t=this.props.mute.isMuted,a=t?this.onUnmute:function(){e.onMute(!0)},o=_["default"].createElement(y["default"],{checked:t,onChange:a}),n=t?l10n.t("web_chat_muted"):l10n.t("web_menuitem_mute");return _["default"].createElement(w["default"],{side:o,onClick:a},_["default"].createElement(R["default"],{theme:"title"},n))}}]),t}(_["default"].PureComponent),n.CONCERNS={chat:["isGroup"],mute:["isMuted"]},r))},7230:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(7),u=o(s),c=a(6),d=o(c),f=a(7192),p=o(f),h=a(7191),m=o(h),g=a(7194),_=o(g),v=function(e){function t(){return(0,l["default"])(this,t),(0,u["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,d["default"])(t,e),t}((0,m["default"])([p["default"],_["default"]]));t["default"]=v},7231:function(e,t){"use strict";function a(e){return e.metaKey||e.shiftKey||e.altKey||e.ctrlKey}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a},7232:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return e.msMatchesSelector?e.msMatchesSelector(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):e.matches(t)}function r(e,t){for(var a=0;a<t.length;++a){var o=t[a].serializers;if(o)for(var r=0;r<o.length;++r){var i=(0,s["default"])(o[r],2),l=i[0],u=i[1];if(n(e,l))return u}}return null}function i(e,t){for(var a=[],o=e.cloneNode(!0),n=o.firstChild;n;){switch(n.nodeType){case 1:var i=r(n,t);if(i){a.push(i(n));break}switch(n.tagName){case"P":case"BR":case"PRE":a.push("\n");break;case"DIV":n.firstChild&&3!==n.firstChild.nodeType||a.push("\n")}break;case 3:a.push(n.nodeValue)}if(n.hasChildNodes())n=n.firstChild;else{for(;n&&!n.nextSibling;)if(n=n.parentNode,n===e){n=null;break}n&&(n=n.nextSibling)}}return a.join("")}var l=a(17),s=o(l);e.exports=i},7233:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(24),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=function(e,t){var a,o;return o=a=function(a){function o(){return(0,u["default"])(this,o),(0,p["default"])(this,(o.__proto__||(0,l["default"])(o)).apply(this,arguments))}return(0,m["default"])(o,a),(0,d["default"])(o,[{key:"render",value:function(){return g.createElement(e,(0,r["default"])({},this.props,t))}}]),o}(g.Component),a.displayName="Wrapper("+(e.displayName||e.name)+")",o};e.exports=_},7234:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(490),r=o(n);e.exports=(0,r["default"])({EMOJI_ENTER:void 0,EMOJI_INACTIVE:void 0,EMOJI_LEFT:void 0,EMOJI_RIGHT:void 0,EMOJI_SEARCH:void 0,EMOJI_TAB:void 0})},7235:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(490),r=o(n);e.exports=(0,r["default"])({SEARCH:void 0,INACTIVE:void 0,ENTER:void 0,TAB:void 0,DOWN:void 0,UP:void 0})},7236:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e.hasChildNodes())for(;e.childNodes.length;)e.removeChild(e.childNodes[0])}function r(e,t){if(!e.rangeCount)return null;var a=e.getRangeAt(0);if(!a.collapsed)return null;for(var o=0;5>o;++o)e.modify("extend","backward","word");var n=e.getRangeAt(0).cloneContents(),r=t.serializeNode(n),u=s(L,r);if(!u)return i(e,a);i(e,a);for(var c=u[0].length;c--;)e.modify("extend","backward","character");var d=k.findDOMNode(t.refs.input),f=d.querySelectorAll("span[data-mention-jid]");return l(e,f)?i(e,a):{original:a,range:e.getRangeAt(0),match:u}}function i(e,t){e.removeAllRanges(),e.addRange(t)}function l(e,t){var a=t.length;if(!a)return 0;for(var o=0,n=0;a>n;++n)e.containsNode(t[n],!0)&&++o;return o}function s(e,t){var a=void 0,o=void 0;for(e.lastIndex=0;o=e.exec(t);)a=o;return a}var u=a(48),c=o(u),d=a(5),f=o(d),p=a(2),h=o(p),m=a(4),g=o(m),_=a(7),v=o(_),b=a(6),y=o(b),E=a(7158),S=a(7235),C=a(47),M=a(7190),k=a(46),w=a(186),N=w.dir,T=a(28),P=T.isGecko,I=T.isTrident,R=a(7358),A=a(7359),x=a(7357),O=a(7356),D=/\u200B((\d+)@c\.us)\u200B/g,L=/(?:\B|^)@((?:[^\s@]+ ?){1,3}(?:[^\s@]+)?)?$/g,U={Enter:S.ENTER,Tab:S.TAB,ArrowUp:S.UP,ArrowDown:S.DOWN},F=function(e){function t(){var e,a,o,l,s;(0,h["default"])(this,t);for(var u=arguments.length,d=Array(u),p=0;u>p;p++)d[p]=arguments[p];return o=l=(0,v["default"])(this,(e=t.__proto__||(0,f["default"])(t)).call.apply(e,[this].concat(d))),l.serializers=[["span[data-mention-jid]",function(e){return n(e),""+(e.getAttribute("data-mention-jid")||"")+""}]],l.parsers=[function(e){return e.replace(D,function(e,t,a){var o=window.Store.Contact.get(t);if(!o)return t;var n=!o.isMyContact&&o.notifyName?o.notifyName:o.formattedName,r=document.createElement("span");r.setAttribute("data-mention-jid",o.id);var i=document.createElement("span");i.setAttribute("class","at-symbol"),i.appendChild(document.createTextNode("@"));var l=document.createElement("span");return l.setAttribute("dir",N(n)||"auto"),l.appendChild(document.createTextNode(n)),r.appendChild(i),r.appendChild(l),r.outerHTML})}],l.serialize=function(e,t){t.mentionedJidList=[];var a=e.replace(D,function(e,a,o){return t.mentionedJidList.push(a),"@"+o});return[a,t]},l.hooks=(a={},(0,c["default"])(a,M.CHANGE,function(e,t){var a=t.refs.input;if(P)for(var o=a.querySelectorAll("[data-mention-jid]"),n=0;n<o.length;++n){var r=o[n].nextSibling;r&&r instanceof Element&&"BR"===r.tagName&&"_moz"===r.getAttribute("type")&&r.remove()}}),(0,c["default"])(a,M.MOUNT,function(e){for(var t=e.refs.input,a=t.querySelectorAll("[data-mention-jid]"),o=0;o<a.length;++o)a[o].setAttribute("contenteditable","false")}),a),l.handlers={onKeyDown:function(e,t){if(!this.ctx.isComposing){var a=t.refs.input,o=e.key;if("Backspace"===o&&R(e,a)||"Delete"===o&&A(e,a))return!1;if("ArrowRight"===o&&x(e,a)||"ArrowLeft"===o&&O(e,a))return!0}var n=U[e.key];return n?this.handle(n,[e,t]):!1},onBlur:function(){return this.handle(S.INACTIVE),!1},onSelect:function(e,t){var a=C.supportsFeature(C.F.MENTIONS_OUT);if(I||this.ctx.isComposing||!a)return!1;if(t.value.indexOf("@")<0)return this.handle(S.INACTIVE);var o=window.getSelection(),n=r(o,t);if(!n)return this.handle(S.INACTIVE);var l=n.original,s=n.match;return this.handle(S.SEARCH,[s[1]||""]),i(o,l),!1}},s=o,(0,v["default"])(l,s)}return(0,y["default"])(t,e),(0,g["default"])(t,[{key:"handleSelect",value:function(e,t){var a=window.getSelection(),o=a.anchorNode,n=Boolean(o&&o.textContent&&" "===o.textContent.slice(a.anchorOffset,a.anchorOffset+1));if(r(a,this.ctx)){var i=n?"":" ";this.ctx.replaceSelection(""+e.id+""+i),this.handle(S.INACTIVE);for(var l=this.ctx.refs.input,s=l.querySelectorAll("[data-mention-jid]"),u=0;u<s.length;++u)s[u].setAttribute("contenteditable","false")}}}]),t}(E);e.exports=F},7237:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return i["default"].createElement("div",{className:s["default"].icon},e.children)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7567),s=o(l)},7238:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(3),l=o(i),s=a(23),u=o(s),c=a(7568),d=o(c),f=function(e){var t=e.children,a=e.side,o=e.ellipsify,n=e.onClick,i=(0,u["default"])((0,r["default"])({},d["default"].clickable,n)),s=(0,u["default"])(d["default"].main,(0,r["default"])({},d["default"].mainEllipsify,o)),c=a?l["default"].createElement("div",{className:d["default"].side},a):null;return l["default"].createElement("div",{className:i,onClick:n},l["default"].createElement("div",{className:d["default"].body},l["default"].createElement("div",{className:s},t),c))};t["default"]=f},7239:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(12),b=o(v),y=a(72),E=o(y),S=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){var e=this,t=(0,r["default"])({},this.props.tooltip,{uim:this.context.uim});b["default"].openTooltip(t,function(t){return e.element=t})}},{key:"componentWillUnmount",value:function(){b["default"].closeTooltip(this.context.uim)}},{key:"getElement",value:function(){return this.element}},{key:"render",value:function(){return null}}]),t}(g.Component);S.contextTypes={uim:_["default"].PropTypes.instanceOf(E["default"])},t["default"]=S},7240:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){return Fe}function r(e){e&&(e.preventDefault(),e.stopPropagation())}function i(e){for(var t=A["default"].TEXTSIZE_CLASS_MAP,a=0;a<t.length;a++)if(t[a].scale===e)return t[a].classname}function l(){return Y["default"].supportsFeature(Y["default"].F.LINK_PREVIEW)||!1}Object.defineProperty(t,"__esModule",{value:!0});var s=a(0),u=o(s),c=a(5),d=o(c),f=a(2),p=o(f),h=a(4),m=o(h),g=a(7),_=o(g),v=a(6),b=o(v);t.hasText=n;var y=a(3),E=o(y),S=a(10),C=o(S),M=a(7329),k=o(M),w=a(484),N=(o(w),a(12)),T=o(N),P=a(94),I=o(P),R=a(8),A=o(R),x=a(23),O=o(x),D=a(14),L=o(D),U=a(7177),F=o(U),j=a(75),B=a(177),G=o(B),V=a(47),Y=o(V),W=a(173),H=o(W),q=a(180),z=o(q),K=a(279),Q=o(K),J=a(7197),X=o(J),Z=a(7281),$=o(Z),ee=a(1),te=o(ee),ae=a(71),oe=o(ae),ne=a(7347),re=o(ne),ie=a(53),le=o(ie),se=a(7401),ue=o(se),ce=a(7200),de=o(ce),fe=a(46),pe=o(fe),he=a(55),me=o(he),ge=a(7402),_e=o(ge),ve=a(7118),be=o(ve),ye=a(487),Ee=a(172),Se=o(Ee),Ce=a(263),Me=o(Ce),ke=a(261),we=o(ke),Ne=a(73),Te=o(Ne),Pe=a(97),Ie=o(Pe),Re=a(174),Ae=(a(7178),a(127)),xe=o(Ae),Oe=a(495),De=a(506),Le=a(34),Ue=/^https?:\/\/media\.giphy\.com\/media\/([a-zA-Z0-9]+)/,Fe=!1,je="urn:schemas-microsoft-com:office",Be="urn:schemas-microsoft-com:office:excel",Ge=700,Ve=function(e){function t(e){(0,p["default"])(this,t);var a=(0,_["default"])(this,(t.__proto__||(0,d["default"])(t)).call(this,e));Ye.call(a);var o=e.chat,n=o.getComposeContents();a.text=n.text||"",a.selection=n.selection,a.preview=a.omittedURL=n.omittedURL,a.emojiPanelCurrentScrollPosition=null,a.emojiPanelCurrentTab=null,a.emojiPanelShowInput=null,a.saveComposeContentDebounced=a.props.debounce(a.saveComposeContent,200);var r;return r=0,a.state={hasText:!!a.text,emojiExpanded:!1,recording:!1,linkPreview:null,textsize:r},a}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentDidMount",value:function(){this.height=pe["default"].findDOMNode(this.refs.composeBlock).clientHeight,l()&&this.scanForLinksTimer.debounceAndCap(50,50)}},{key:"componentWillUnmount",value:function(){this.scanForLinksTimer.cancel(),this.restoreFocusTimer.cancel(),this.saveComposeContent(),this.removeEmojisFromTouchBar()}},{key:"render",value:function(){var e=this.state.emojiExpanded?E["default"].createElement("button",{className:"compose-btn-emoji",onClick:this.closeEmojiPanel},E["default"].createElement(Se["default"],{name:"hide"})):E["default"].createElement("button",{className:"compose-btn-emoji",onClick:this.openEmojiPanel},E["default"].createElement(Se["default"],{name:"smiley"})),t={enter:this.handleEmojiButtonClick},a=(0,O["default"])("input-container",{disabled:this.state.recording}),o={pagedown:this.onPageUpDown,pageup:this.onPageUpDown},n=l10n.t("type_a_message"),r=(0,O["default"])("block-compose",i(this.state.textsize),{"ptt-open":this.state.recording}),l={tab:this.handleTab,"shift+tab":this.handleTab};return E["default"].createElement(we["default"],{displayName:"ComposeBox",ref:"container",state:we["default"].State.PASSIVE,requestFocus:this.restoreFocus},E["default"].createElement(H["default"],{component:"footer",handlers:o,className:this.props.className,onMouseDown:this.preventBlur,onContextMenu:this.preventBlur},E["default"].createElement("div",{className:r,ref:"composeBlock"},E["default"].createElement(H["default"],{ref:"emojiButton",className:"emoji-button-container","data-tab":4,handlers:t,onFocus:this.onEmojiButtonFocus},e),E["default"].createElement(H["default"],{ref:"input_hotkey",className:a,handlers:l,onFocus:this.onInputFocus,onBlur:this.onInputBlur},E["default"].createElement(re["default"],{placeholder:n,readOnly:this.state.recording,ref:"input",initialValue:this.text,initialSelection:this.selection,spellCheck:!0,multiline:!0,maxLength:A["default"].MAX_TXT_MSG_SIZE,onMaxPasteExceeded:this.onMaxPasteExceeded,onEnter:this.onEnter,onFiles:this.onFiles,onTextPaste:this.onTextPaste,onChange:this.onChange,onSelect:this.onSelectionChange,textPasteMimePriority:[De.APP_TEXT_MIMETYPE,"text/plain"],theme:"compose"})),this.renderSendButton()),this.renderPopupPanel(),E["default"].createElement(re["default"].EmojiSuggestions,{chat:(0,ye.unproxy)(this.props.chat)}),E["default"].createElement(We,{key:this.props.chat.id,parent:this,chatId:this.props.chat.id}),E["default"].createElement(re["default"].Suggestions,{chat:(0,ye.unproxy)(this.props.chat)})))}}]),t}(E["default"].Component);Ve.CONCERNS={chat:["id","trusted","composeContents","composeQuotedMsg","isPSA","isVisible","presence","contact","composeAttachMediaContents"]};var Ye=function(){var e=this;this.height=0,this.pendingLinkPreviewPromises=[],this.pasteTriggeredOnChange=!1,this.saveComposeContent=function(){e.props.chat.setComposeContents({text:e.text,selection:e.selection,omittedURL:e.omittedURL})},this.onTextSizeChange=function(t){e.setState({textsize:t})},this.pasteEmojiInput=function(t){return" "!==t||e.hasText()?void(e.refs.input&&(e.refs.input.focus(!0),e.refs.input.replaceSelection(t))):T["default"].scrollMessages()},this.handleRoutedPaste=function(t){e.refs.input&&(e.refs.input.focus(!0),e.refs.input.onPaste(t))},this.onMaxPasteExceeded=function(){T["default"].openModal(E["default"].createElement(I["default"],{title:l10n.t("message_too_large_title"),onOK:function(){T["default"].closeModal()},okText:l10n.t("web_ok")},l10n.t("message_too_large_text")))},this.restoreFocus=function(t){e.refs.input&&e.refs.input.focus(!1,t)},this.clearLinkPreview=function(){e.preview=null,e.omitLinkPreview()},this.cancelPendingLinkPreviews=function(){e.pendingLinkPreviewPromises.forEach(function(e){return e.cancel()}),e.pendingLinkPreviewPromises=[]},this.omitLinkPreview=function(t){t!==!0&&e.state.linkPreview&&(e.omittedURL=e.preview,e.setState({linkPreview:null}))},this.omitQuotedPreview=function(t){t!==!0&&(e.props.chat.composeQuotedMsg=null)},this._findFirstWebLink=function(){var t=(0,Oe.removeCodeBlocks)(e.text);return Q["default"].findLinks(t,!0)[0]},this.scanForLinksTimer=new me["default"](function(){if(!e.state.hasText)return void e.clearLinkPreview();var t=e._findFirstWebLink();if(!t)return void e.clearLinkPreview();var a=t.url;if(!e.preview||e.preview!==a){e.preview=a,e.omittedURL=null;var o=(0,$["default"])(a).cancellable().tap(function(t){t&&e.preview&&e.preview===t.url&&t.data&&(t.data.title||t.data.description)&&e.setState({linkPreview:t})});e.pendingLinkPreviewPromises.push(o),o["catch"](L["default"].Unmount,L["default"].WapDrop,u["default"].CancellationError,function(){})}}),this.onInputFocus=function(t){e.indicateFocus(t),e.addEmojisToTouchBar()},this.onInputBlur=function(t){e.removeEmojisFromTouchBar()},this.indicateFocus=function(t){var a=e.refs.container;a&&a.activate(),(0,W.indicateFocus)(e.refs.input_hotkey,["#FFFFFF","#D9F3FF"],void 0,{borderColor:["#FFFFFF","#CBE4EF"]}),e.refs.input.focus(!1,t)},this.addEmojisToTouchBar=function(){},this.removeEmojisFromTouchBar=function(){},this.onEmojiButtonFocus=function(t){var a=pe["default"].findDOMNode(e.refs.emojiButton);G["default"].focus(a,t)},this.onPageUpDown=function(t){e.props.onPageUpDown&&(t.stopPropagation(),e.props.onPageUpDown(t),t.persist(),e.restoreFocusTimer.debounce(0,t))},this.restoreFocusTimer=new me["default"](function(t){e.refs.input&&e.refs.input.focus(!0,t)}),this.handleEmoji=function(t){e.refs.input.replaceSelection(t)},this.handleGif=function(t,a){var o=Ie["default"].get(t,Ie["default"].RESP_TYPE.BLOB,{Accept:"video/mp4"}).then(function(e){if(200!==e.status)throw te["default"].error("failed loading gif (status: "+e.status+")")(),new L["default"].MediaFileFailedLoad;var t=e.response;return z["default"].generateVideoThumbAndDuration(t,A["default"].IMG_THUMB_MAX_EDGE).then(function(e){var o=e.thumb,n=(e.duration,{width:o.fullWidth,height:o.fullHeight});return{file:t,mimetype:t.type,isGif:!0,gifAttribution:a,fullPreview:window.URL.createObjectURL(t),fullPreviewSize:n,preview:Te["default"].parseDataURL(o.url).data}})});return e.saveComposeContentDebounced.flush(),T["default"].attachMediaDrawer({chat:e.props.chat,files:[o],initCaption:e.getCurrentComposeContent(),fileOrigin:Le.MEDIA_PICKER_ORIGIN_TYPE.CHAT_GIF_INAPP,onComplete:function(t,a){e.updateTextAfterMediaDrawerClose(t,a),t&&e.closeEmojiPanel()}}),o["catch"](C["default"].noop),o},this.openEmojiPanel=function(){e.setState({emojiExpanded:!0})},this.closeEmojiPanel=function(){e.setState({emojiExpanded:!1})},this.onPTTRecState=function(t){e.setState({recording:t})},this.preventBlur=function(t){var a=t.target,o=pe["default"].findDOMNode(e.refs.input),n=pe["default"].findDOMNode(e.refs.container);do if(a===o)return;while(a!==n&&(a=a.parentNode));r(t),e.refs.input.focus(!1)},this.onChange=function(t){var a=pe["default"].findDOMNode(e.refs.composeBlock),o=a.clientHeight,n=o-e.height;n&&e.props.onComposeHeightChange({input:n},!1),e.height=o;var r=e.hasText();e.text=t;var i=e.hasText();if(i!==r&&e.setState({hasText:i}),i?(e.props.chat.presence.subscribe()["catch"](L["default"].WapDrop,function(){}),e.props.chat.markComposing()):e.props.chat.markPaused(),l()){var s=e._findFirstWebLink();(!s&&e.preview||s&&s.url!==e.preview)&&e.clearLinkPreview(),e.pasteTriggeredOnChange?e.scanForLinksTimer.onOrBefore(1):e.scanForLinksTimer.debounce(Ge)}e.pasteTriggeredOnChange=!1,e.saveComposeContentDebounced()},this.setEmojiPanelCurrentScrollPosition=function(t){e.emojiPanelCurrentScrollPosition=t},this.clearEmojiPanelCurrentScrollPosition=function(){e.emojiPanelCurrentScrollPosition=null},this.setEmojiPanelCurrentTab=function(t){e.emojiPanelCurrentTab=t},this.clearEmojiPanelCurrentTab=function(){e.emojiPanelCurrentTab=null},this.setEmojiPanelShowInput=function(t){e.emojiPanelShowInput=t},this.clearEmojiPanelShowInput=function(){e.emojiPanelShowInput=null},this.renderSendButton=function(){var t=navigator.getUserMedia&&window.AudioContext;if(e.state.hasText||!t)return E["default"].createElement("button",{className:"compose-btn-send",onClick:e.onSendText,disabled:!e.hasText},E["default"].createElement(Se["default"],{name:"send",directional:!0}));var a=e.props.chat;return E["default"].createElement(ue["default"],{key:"ptt",chat:a,onRecState:e.onPTTRecState})},this._restoreEmojiPanelFocus=function(){e.emojiPanel&&e.emojiPanel.restoreFocus()},this.renderPopupPanel=function(){var t=void 0;if(e.state.linkPreview){var a=e.state.linkPreview.data,o=a.title,n=a.canonicalUrl,r=a.description,i=a.matchedText,l=a.thumbnail;t=E["default"].createElement(we["default"],{displayName:"ComposeBoxLinkPreview",escapable:!0,requestDismiss:e.omitLinkPreview},E["default"].createElement("div",{className:"compose-popup-panel"},E["default"].createElement("div",{className:"compose-link-preview"},E["default"].createElement(X["default"],{title:o,compose:!0,canonicalUrl:n,description:r,matchedText:i,thumbnail:l}),E["default"].createElement("button",{className:"btn-background link-preview-cancel-icon",onClick:e.omitLinkPreview},E["default"].createElement(Se["default"],{name:"x"})))))}var s=e.props.chat.composeQuotedMsg,u=void 0;s&&(u=E["default"].createElement(we["default"],{displayName:"ComposeBoxQuotedMsg",escapable:!0,requestFocus:e.restoreFocus,requestDismiss:e.omitQuotedPreview},E["default"].createElement("div",{className:"compose-popup-panel"},E["default"].createElement(de["default"],{msg:s,key:s.id.toString(),onOmit:e.omitQuotedPreview,chat:s.chat}))));var c=null;e.state.emojiExpanded&&(c=E["default"].createElement(we["default"],{displayName:"ComposeBoxEmojiPanel",escapable:!0,requestDismiss:e.closeEmojiPanel,requestFocus:e._restoreEmojiPanelFocus},E["default"].createElement("div",null,E["default"].createElement(F["default"],{ref:(0,Re.GetRef)("emojiPanel",e),key:"compose-emoji-panel",initialScrollPosition:e.emojiPanelCurrentScrollPosition,initialTab:e.emojiPanelCurrentTab,initialShowSearchInput:e.emojiPanelShowInput,setCurrentScrollPosition:e.setEmojiPanelCurrentScrollPosition,clearCurrentScrollPosition:e.clearEmojiPanelCurrentScrollPosition,setCurrentTab:e.setEmojiPanelCurrentTab,clearCurrentTab:e.clearEmojiPanelCurrentTab,setShowSearchInput:e.setEmojiPanelShowInput,clearShowSearchInput:e.clearEmojiPanelShowInput,onEmoji:e.handleEmoji,onFocusRelease:e.restoreFocus,onGif:Store.ServerProps.gifSearch?e.handleGif:void 0,displayLocation:U.DISP_LOCATION.COMPOSE_BOX}))));var d=(0,ye.unproxy)(e.props.chat),f=null;return!d.isPSA&&d.isVisible&&!d.trusted&&d.msgs&&d.msgs.length>0&&Y["default"].supportsFeature(Y["default"].F.SPAM)&&(f=E["default"].createElement(_e["default"],{chat:d,contact:d.contact})),E["default"].createElement("div",{className:"compose-box-items-positioning-container"},E["default"].createElement("div",{className:"compose-box-items-overlay-container"},E["default"].createElement(k["default"],{onHeightChange:e.onHeightChange},f,c,u,t)))},this.onHeightChange=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;e.props.onComposeHeightChange({overlay:t},a)},this.onFiles=function(t){var a=t.getFiles().filter(function(e){var t=(0,j.typeFromMimetype)(e.type);return"image"===t||"video"===t});if(t.hasType("text/html")){var o=t.getData("text/html"),n=o&&-1!==o.indexOf(je),r=n&&-1!==o.indexOf(Be);if(n&&!r)return!1}return a.length?(e.saveComposeContentDebounced.flush(),T["default"].attachMediaDrawer({chat:e.props.chat,files:a,initCaption:e.getCurrentComposeContent(),onComplete:e.updateTextAfterMediaDrawerClose}),!0):void 0},this.updateTextAfterMediaDrawerClose=function(t,a){t&&a&&e.refs.input.reset()},this.getCurrentComposeContent=function(){return e.props.chat.getComposeContents()},this.onTextPaste=function(t){var a=Ue.exec(t);if(a){var o="https://media.giphy.com/media/"+a[1]+"/200w.mp4";return e.handleGif(o,le["default"].GIF_ATTRIBUTION.GIPHY)["catch"](function(a){T["default"].closeDrawerMid(),e.refs.input&&(e.refs.input.focus(!0),e.refs.input.replaceSelection(t)),T["default"].openToast(E["default"].createElement(Me["default"],{msg:l10n.t("media_failed_load"),id:(0,Ce.genId)()}))}),!0}return e.pasteTriggeredOnChange=!0,!1},this.onSelectionChange=function(t){e.selection=t},this.hasText=function(){return Fe=e.text.trim().length>0},this.onEnter=function(t){t&&t.repeat||e.onSendText()},this.onSendText=function(){var t=e.refs.input.serialize(),a=[t[0].trim(),t[1]],o=a[0],n=a[1];o.length&&(e.props.chat.sendMessage(o,e.state.linkPreview&&e.state.linkPreview.data,e.props.chat.composeQuotedMsg,n.mentionedJidList||[]),e.cancelPendingLinkPreviews(),e.setState({emojiExpanded:!1,hasText:!1,linkPreview:null}),e.props.chat.composeQuotedMsg=null,e.props.chat.setComposeContents({}),e.refs.input.reset(),e.text="",e.hasText())},this.handleEmojiButtonClick=function(t){return r(t),e.state.emojiExpanded?e.closeEmojiPanel():e.openEmojiPanel()},this.handleTab=function(t){e.state.emojiExpanded&&((0,W.shouldIndicateFocus)(),e.emojiPanel&&e.emojiPanel.focusSearchInput(t),r(t))}};t["default"]=(0,xe["default"])((0,be["default"])(Ve));var We=(0,oe["default"])(function(e){function t(){var e,a,o,n;(0,p["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,_["default"])(this,(e=t.__proto__||(0,d["default"])(t)).call.apply(e,[this].concat(i))),o.restoreFocus=function(){o.props.parent.restoreFocus()},o.pasteEmojiInput=function(e){o.props.parent.pasteEmojiInput(e)},o.handleRoutedPaste=function(e){o.props.parent.handleRoutedPaste(e)},o.onSendText=function(){o.props.parent.onSendText()},o.onTextSizeChange=function(e){o.props.parent.onTextSizeChange(e)},n=a,(0,_["default"])(o,n)}return(0,b["default"])(t,e),(0,m["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.chatId,a=e.listeners;a.add(T["default"],"focus_chat_text_input_"+t,this.restoreFocus),a.add(T["default"],"paste_chat_text_input_"+t,this.pasteEmojiInput),a.add(T["default"],"send_paste_to_compose_"+t,this.handleRoutedPaste),a.add(T["default"],"enter_chat_text_input_"+t,this.onSendText),a.add(T["default"],"focus_chat_text_input",this.restoreFocus),a.add(T["default"],"textsize_change",this.onTextSizeChange)}},{key:"render",value:function(){return null}}]),t}(E["default"].PureComponent))},7241:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7118),b=o(v),y=a(12),E=o(y),S=a(93),C=o(S),M=a(7147),k=o(M),w=a(489),N=o(w),T=a(7127),P=o(T),I=a(7188),R=o(I),A=a(7186),x=o(A),O=a(7143),D=o(O),L=a(7256),U=o(L),F=a(94),j=o(F);t["default"]=(0,b["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.reportSpam=function(){o.props.chat.reportSpam(),E["default"].closeModal()},o.onReportSpam=function(){E["default"].openModal(_["default"].createElement(j["default"],{onOK:o.reportSpam,okText:C["default"].t("report_contact_spam"),onCancel:E["default"].closeModal.bind(E["default"]),cancelText:C["default"].t("web_cancel")},_["default"].createElement(k["default"],{id:"report_spam_ack"})))},o.setBlock=function(e){o.props.contact.setBlock(e),E["default"].closeModal()},o.onBlockContact=function(){E["default"].openModal(_["default"].createElement(U["default"],{contact:o.props.contact,onCancel:E["default"].closeModal.bind(E["default"]),blockContact:function(){return o.setBlock(!0)},reportSpam:o.reportSpam}))},o.onUnblockContact=function(){var e=_["default"].createElement(D["default"],{contact:o.props.contact});E["default"].openModal(_["default"].createElement(j["default"],{okText:C["default"].t("unblock_button"),onOK:function(){return o.setBlock(!1)},cancelText:C["default"].t("web_cancel"),onCancel:E["default"].closeModal.bind(E["default"])},_["default"].createElement(k["default"],{id:"unblock_confirmation",params:{contact:e}})))},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"menus",value:function(){var e=this.props,t=e.chat,a=e.contact,o=e.onSelectMessages,n=[];return t.isPSA||n.push(_["default"].createElement(P["default"],{key:"info",a8n:"mi-contact",action:function(){return E["default"].chatInfoDrawer(t)},shortcut:"i"},C["default"].t("web_contact_info"))),a.verified&&n.push(_["default"].createElement(P["default"],{key:"report",a8n:"report",action:this.onReportSpam,shortcut:"r"},C["default"].t("report_spam")),_["default"].createElement(P["default"],{key:"block",a8n:"block",action:a.isBlocked()?this.onUnblockContact:this.onBlockContact,shortcut:"b"},a.isBlocked()?C["default"].t("unblock_button"):C["default"].t("block"))),n.push(_["default"].createElement(P["default"],{a8n:"mi-select-messages",key:"select",action:o,shortcut:"e"},C["default"].t("web_select_messages"))),t.mute.canMute()&&n.push(_["default"].createElement(R["default"],{key:"mute",onMute:function(e){return E["default"].muteChat(t,e)},mute:t.mute})),t.canClear()&&n.push(_["default"].createElement(P["default"],{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return E["default"].clearChatMsgs(t)}},C["default"].t("clear_chat"))),t.canDelete()&&n.push(_["default"].createElement(x["default"],{key:"delete",onDeleteOrExit:function(){return E["default"].deleteOrExitChat(t)},chat:t})),n}},{key:"render",value:function(){return this.props.toContextMenuManager?_["default"].createElement("div",null,this.menus()):_["default"].createElement(N["default"],{type:"dropdown_menu",key:"ContactMenuDropdown",flipOnRTL:!0,dirX:"left"},this.menus())}}]),t}(g.PureComponent),n.CONCERNS={chat:["isPSA","mute"],contact:["verified"]},r))},7242:function(e,t,a){"use strict";function o(e){
return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.wallpaperColor;if(t===s["default"].DEFAULT_CHAT_WALLPAPER)return i["default"].createElement("div",{className:"pane-chat-tile"});var a={background:t};return i["default"].createElement("div",{className:"pane-chat-color-bg",style:a})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(8),s=o(l)},7243:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){var a=[];return a.push(f.createElement(l["default"],{key:"info",a8n:"mi-group-info",action:function(){return p.chatInfoDrawer(e)},shortcut:"i"},l10n.t("web_group_info"))),a.push(f.createElement(l["default"],{a8n:"mi-select-messages",key:"select",action:t,shortcut:"e"},l10n.t("web_select_messages"))),e.mute.canMute()&&a.push(f.createElement(u["default"],{key:"mute",onMute:function(t){return p.muteChat(e,t)},mute:e.mute})),e.canClear()&&a.push(f.createElement(l["default"],{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return p.clearChatMsgs(e)}},l10n.t("clear_chat"))),e.canDelete()&&a.push(f.createElement(d["default"],{key:"delete",onDeleteOrExit:function(){return p.deleteOrExitChat(e)},chat:e})),a}function r(e,t){var a=[];return a.push(f.createElement(l["default"],{key:"info",a8n:"mi-broadcast-info",action:function(){return p.chatInfoDrawer(e)},shortcut:"i"},l10n.t("web_list_info"))),a.push(f.createElement(l["default"],{a8n:"mi-select-messages",key:"select",action:t,shortcut:"e"},l10n.t("web_select_messages"))),e.canClear()&&a.push(f.createElement(l["default"],{key:"clear",a8n:"mi-clear",shortcut:"e",action:function(){return p.clearChatMsgs(e)}},l10n.t("clear_chat"))),e.canDelete()&&a.push(f.createElement(d["default"],{key:"delete",onDeleteOrExit:function(){return p.deleteOrExitChat(e)},chat:e})),a}var i=a(7127),l=o(i),s=a(7188),u=o(s),c=a(7186),d=o(c),f=a(3),p=a(12);e.exports={group:n,broadcast:r}},7244:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(8),l=o(i),s=a(23),u=o(s),c=a(53),d=(o(c),a(7130)),f=o(d),p=function(e){var t=e.msg,a=(0,u["default"])("bubble bubble-audio audio-state-default",{"audio-state-played":t.ack===l["default"].ACK_PLAYED,"bubble-audio-in":!t.isSentByMe,"bubble-audio-out":t.isSentByMe,"bubble-audio-has-author":e.author}),o=e.status?r["default"].createElement("div",{className:"bubble-audio-status"},e.status):null,n=e.author?r["default"].createElement("div",{className:"bubble-audio-author"},e.author):null;return r["default"].createElement("div",{className:a},e.quotedMsg?n:null,e.quotedMsg,r["default"].createElement("div",{className:"wrapper"},e.quotedMsg?null:n,r["default"].createElement("div",{className:"bubble-audio-body"},r["default"].createElement("div",{className:"bubble-audio-player"},e.player),o,r["default"].createElement("div",{className:"bubble-audio-avatar"},e.avatar)),r["default"].createElement("div",{className:"bubble-audio-meta"},r["default"].createElement(f["default"],{msg:t}))))};t["default"]=p},7245:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(175),l=o(i),s=function(e){var t=e.spinner?r["default"].createElement("div",{className:"audio-spinner"},r["default"].createElement(l["default"],{stroke:3,size:34,outgoingMsg:e.outgoingMsg})):null,a=e.icon?r["default"].createElement("button",{className:"audio-button",onClick:e.action},e.icon):null;return r["default"].createElement("div",{className:"audio"},r["default"].createElement("div",{className:"audio-controls"},t,a),r["default"].createElement("div",{className:"audio-body"},r["default"].createElement("input",{type:"range",className:"audio-track",min:0,max:100,value:0,disabled:"disabled"})))};t["default"]=s},7246:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7335),_=o(g),v=a(172),b=o(v),y=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={hover:!1},o._onMouseEnter=function(){o.setState({hover:!0})},o._onMouseLeave=function(){o.setState({hover:!1})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement("div",{onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave,className:"icon-error-container"},this.state.hover?m["default"].createElement(_["default"],null,this.props.tooltip):null,m["default"].createElement("button",{className:"error",onClick:this.props.onClick},m["default"].createElement(b["default"],{name:"error"})))}}]),t}(m["default"].PureComponent);t["default"]=y},7247:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.PREVIEW_HEIGHT=void 0;var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(10),E=o(y),S=a(53),C=(o(S),a(7130)),M=o(C),k=a(7129),w=o(k),N=a(73),T=o(N),P=a(267),I=o(P),R=a(7118),A=o(R),x=a(71),O=o(x),D=a(485),L=o(D),U=a(180),F=o(U),j=a(288),B=o(j),G=a(14),V=o(G),Y=["foursquare.com","facebook.com","maps.google.com"],W=t.PREVIEW_HEIGHT=150,H=270,q=50;t["default"]=(0,O["default"])((0,L["default"])((0,A["default"])((r=n=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.updateImgSrcUrl=function(e){var t=W+q,o=B["default"].currentRes===B["default"].RES.HIGH?2:1,n=T["default"].build("https://maps.googleapis.com/maps/api/staticmap",{markers:"color:red|"+e.lat+", "+e.lng,zoom:14,size:H+"x"+t,scale:o,language:l10n.getLocale(),client:T["default"].GSM_NAME});T["default"].gsmURL(n,T["default"].GSM_NUMS).checkpoint(a.props.rejectOnUnmount()).then(function(e){a.setState({imgSrcUrl:e,hiResAvail:F["default"].isCached(e)})})["catch"](V["default"].Unmount,E["default"].noop)},a.getClientThumb=function(){return"data:image/jpeg;base64,"+a.props.msg.body},a.getMapUrl=function(){var e=a.props.msg,t=a.loc();return t&&t.name?["https://maps.google.com/maps/search",encodeURIComponent(t.name),"@"+e.lat+","+e.lng+",17z"].join("/")+"?hl="+l10n.getLocale():T["default"].build("https://maps.google.com/maps",{q:e.lat+","+e.lng,z:17,hl:l10n.getLocale()})},a.loc=function(){var e=a.props.msg.get("loc");return e?(e=e.split("\n"),2===e.length?{name:e[0],addr:e[1]}:{name:e}):void 0},a.getLocationDetails=function(){var e=a.props.msg,t=a.loc(),o=a.props.msg.clientUrl||a.getMapUrl(),n=void 0,r=void 0,i=void 0,l=T["default"].hostname(o),s=E["default"].isEmpty(Y.filter(function(e){return l.indexOf(e)>-1}));if(i=s?_["default"].createElement("div",{className:"location-page-host location-caption"},l):null,t){n=t.name?_["default"].createElement("a",{href:o,title:t.name,target:"_blank",className:"location-text-title"},t.name):null;var u=(0,b["default"])("location-text-contents",{"location-caption":!i});r=t.addr?_["default"].createElement("div",{title:t.addr,className:u},t.addr):null}var c=n&&r?_["default"].createElement("div",{className:"message-text","data-id":e.id},n,r,i):null;return c},a.onImgLoaded=function(){a.state.hiResAvail||a.setState({hiResAvail:!0})},a.onClick=function(e){e.stopPropagation()},a.state={imgSrcUrl:null,hiResAvail:!1},a.updateImgSrcUrl(e.msg),a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.props.listeners.add(window,"dpichange",function(){return e.updateImgSrcUrl(e.props.msg)})}},{key:"componentWillReceiveProps",value:function(e){this.updateImgSrcUrl(e.msg)}},{key:"render",value:function(){var e=this.props.msg,t=this.getLocationDetails(),a=t?null:_["default"].createElement("div",{className:"shade"}),o=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?_["default"].createElement("div",{className:"bubble-location-author"},_["default"].createElement(w["default"],{msg:e,contact:e.senderObj})):null,n=(0,b["default"])("bubble-location",{"bubble-location-caption":t,"bubble-broadcast":t&&e.broadcast,"bubble-star":t&&e.star}),r={background:"url("+this.getClientThumb()+")",backgroundSize:"cover",width:H,height:this.state.hiResAvail?void 0:W},i={height:W},l=(0,b["default"])("image-thumb-body",{"image-thumb-location-lores":!this.state.hiResAvail});return _["default"].createElement("div",{className:n},o,this.props.quotedMsg,_["default"].createElement("div",{className:"image-thumb",onClick:this.onClick,style:i},_["default"].createElement("a",{href:this.getMapUrl(),target:"_blank"},_["default"].createElement(I["default"],{src:this.state.imgSrcUrl||"",className:l,style:r,hasPrivacyChecks:!1,onLoaded:this.onImgLoaded,noXHR:!0})),a),t,_["default"].createElement("div",{className:"bubble-location-meta"},_["default"].createElement(M["default"],{msg:e})))}}]),t}(_["default"].PureComponent),n.CONCERNS={msg:["clientUrl","id","isSentByMe","isGroupMsg","broadcast","star","body","lat","lng","senderObj"]},r))))},7248:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MsgComponent=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7372),_=o(g),v=a(7373),b=o(v),y=a(8),E=o(y),S=a(7376),C=o(S),M=a(7380),k=o(M),w=a(47),N=o(w),T=a(7383),P=o(T),I=a(7247),R=o(I),A=a(1),x=o(A),O=a(53),D=o(O),L=a(7389),U=o(L),F=a(7390),j=o(F),B=a(7391),G=o(B),V=a(7392),Y=o(V),W=a(7118),H=o(W),q=a(487),z=a(7395),K=o(z),Q=a(7397),J=o(Q),X=a(7398),Z=o(X),$=a(7388),ee=o($),te=a(7399),ae=o(te),oe=a(7200),ne=o(oe),re=a(174),ie=t.MsgComponent=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"getQuotedMsg",value:function(){var e=this.props,t=e.displayType,a=e.msg,o=void 0;if(N["default"].supportsFeature(N["default"].F.REPLIES_IN)&&t!==E["default"].DISP_TYPE.GALLERY){var n=a.quotedMsgObj();n&&(o=m["default"].createElement(ne["default"],{msg:n,key:n.id.toString(),rootMsg:(0,q.unproxy)(a),displayType:t,chat:a.chat}))}return o}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.displayAuthor,o=e.isMsgVisible,n=e.displayType;switch(t.type){case D["default"].TYPE.CHAT:return m["default"].createElement(K["default"],{msg:(0,q.unproxy)(t),contact:t.senderObj,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),trusted:t.isTrusted(),displayType:n,displayAuthor:a});case D["default"].TYPE.IMAGE:return m["default"].createElement(j["default"],{msg:t,mediaData:t.mediaData,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),isMsgVisible:o,trusted:t.isTrusted(),displayAuthor:a});case D["default"].TYPE.GROUP_NOTIFICATION:case D["default"].TYPE.GP2:case D["default"].TYPE.BROADCAST_NOTIFICATION:case D["default"].TYPE.NOTIFICATION:case D["default"].TYPE.NOTIFICATION_TEMPLATE:case D["default"].TYPE.E2E_NOTIFICATION:case D["default"].TYPE.CALL_LOG:return m["default"].createElement(U["default"],{msg:t,ref:(0,re.GetRef)("ref",this)});case D["default"].TYPE.AUDIO:return m["default"].createElement(_["default"],{msg:t,mediaData:t.mediaData,quotedMsg:this.getQuotedMsg(),isMsgVisible:o,displayAuthor:a,ref:(0,re.GetRef)("ref",this)});case D["default"].TYPE.VIDEO:return t.isGif?m["default"].createElement(k["default"],{msg:t,mediaData:t.mediaData,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),isMsgVisible:o,trusted:t.isTrusted(),displayAuthor:a}):m["default"].createElement(ae["default"],{msg:t,mediaData:t.mediaData,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),isMsgVisible:o,trusted:t.isTrusted(),displayAuthor:a});case D["default"].TYPE.VCARD:return m["default"].createElement(Z["default"],{msg:t,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),displayAuthor:a});case D["default"].TYPE.MULTI_VCARD:return m["default"].createElement(ee["default"],{msg:t,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),displayAuthor:a});case D["default"].TYPE.LOCATION:return t.isLive?m["default"].createElement(P["default"],{msg:(0,q.unproxy)(t),ref:(0,re.GetRef)("ref",this),displayAuthor:a}):m["default"].createElement(R["default"],{msg:(0,q.unproxy)(t),ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),trusted:t.isTrusted(),displayAuthor:a});case D["default"].TYPE.PTT:return m["default"].createElement(G["default"],{msg:t,mediaData:t.mediaData,profilePicThumb:t.senderObj.profilePicThumb,quotedMsg:this.getQuotedMsg(),displayAuthor:a,ref:(0,re.GetRef)("ref",this)});case D["default"].TYPE.DOCUMENT:return m["default"].createElement(C["default"],{msg:t,displayType:n,mediaData:t.mediaData,ref:(0,re.GetRef)("ref",this),quotedMsg:this.getQuotedMsg(),trusted:t.isTrusted(),displayAuthor:a});case D["default"].TYPE.UNKNOWN:return m["default"].createElement(J["default"],{msg:(0,q.unproxy)(t),displayAuthor:a});case D["default"].TYPE.CIPHERTEXT:return m["default"].createElement(b["default"],{msg:t,ref:(0,re.GetRef)("ref",this),displayAuthor:a});case D["default"].TYPE.REVOKED:return m["default"].createElement(Y["default"],{msg:(0,q.unproxy)(t),ref:(0,re.GetRef)("ref",this)});default:return x["default"].log("messageList:render Unknown message type: "+t.type)(),m["default"].createElement(J["default"],{msg:(0,q.unproxy)(t),ref:(0,re.GetRef)("ref",this),displayAuthor:a})}}}]),t}(m["default"].PureComponent);ie.CONCERNS={msg:["chat","isGif","isLive","mediaData","senderObj","type"]},t["default"]=(0,H["default"])(ie)},7249:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(10),v=n(_),b=a(7220),y=n(b),E=a(71),S=n(E),C=a(46),M=n(C),k=a(174),w=a(62),N=o(w),T=a(172),P=n(T),I=function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.onPlayClick=function(){var e=a._audioNode();a.props.playing?e.pause():e.play()},a.onPlaying=function(){a.props.onPlayingUpdate(!0)},a.onPause=function(){a.props.onPlayingUpdate(!1)},a.onEnded=function(){var e=a._audioNode();e.currentTime=0,e.load()},a.onTimeUpdate=function(){var e=a._audioNode(),t=0;v["default"].isFinite(e.duration)&&(t=Math.round(100*Math.min(1,e.currentTime/e.duration)),a.props.onTimeUpdate(e.currentTime)),a.setState({progress:t})},a.onDrag=function(e){var t=a._audioNode(),o=e.target.value;a.setState({progress:o}),t.duration&&(t.currentTime=t.duration/100*o)},a.onPlayerError=function(e){},a.state={progress:0},a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){var e=this._audioNode();this.props.listeners.add(e,"playing",this.onPlaying),this.props.listeners.add(e,"pause",this.onPause),this.props.listeners.add(e,"ended",this.onEnded),this.props.listeners.add(e,"timeupdate",this.onTimeUpdate),this.props.listeners.add(e,"durationchange",this.onTimeUpdate),this.props.listeners.add(e,"progress",this.onTimeUpdate)}},{key:"_audioNode",value:function(){return M["default"].findDOMNode(this.audioRef)}},{key:"render",value:function(){var e=this.props.playing?"audio-pause":"audio-play",t={width:this.state.progress-this.state.progress/100*3+"%"},a=this.props.duration?g["default"].createElement("div",{className:"audio-duration"},N.durationStr(this.props.duration)):null;return g["default"].createElement("div",{className:"audio"},g["default"].createElement("div",{className:"audio-controls"},g["default"].createElement("button",{ref:"play_pause",className:"audio-button",onClick:this.onPlayClick},g["default"].createElement(P["default"],{name:e,directional:!0}))),g["default"].createElement("div",{className:"audio-body"},a,g["default"].createElement("div",{className:"audio-track-container"},g["default"].createElement("span",{className:"audio-progress",style:t}),g["default"].createElement("input",{type:"range",className:"audio-track",value:this.state.progress,onChange:this.onDrag,min:"0",max:"100"}))),g["default"].createElement(y["default"],{ref:(0,k.GetRef)("audioRef",this),url:this.props.url,preload:"auto",onError:this.onPlayerError,autoPlay:this.props.autoPlay}))}}]),t}(g["default"].PureComponent);t["default"]=(0,S["default"])(I)},7250:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=(a(7162),a(28)),_=o(g),v=a(172),b=o(v),y=a(7588),E=o(y),S=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.setVideoRef=function(e){a._videoRef=e,a.synchronizeVideo()},a.synchronizeVideo=function(){var e=a._videoRef;e&&(a.state.animate?e.paused&&e.play():e.paused||(e.pause(),e.currentTime=0))},a.setShouldAnimate=function(e){a.state.animate===e&&a.state.show||a.setState({animate:e,show:!0},a.synchronizeVideo)},a.handleClick=function(){a.props.onSend(a.props.gif)},a._videoRef=null,a.state={animate:!1,show:!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.gif,t=null;this.state.show&&(t=_["default"].troublesWithLotsOfVideos&&e.nonVideoUrl?m["default"].createElement("img",{className:E["default"].body,onClick:this.handleClick,src:e.nonVideoUrl}):m["default"].createElement("video",{className:E["default"].body,onClick:this.handleClick,controls:!1,autoPlay:this.state.animate,loop:!0,muted:!0,ref:this.setVideoRef,src:e.previewUrl}));var a=void 0;return this.props.isStarred&&this.props.onUnstarMsg&&(a=m["default"].createElement("button",{className:E["default"].icon,onClick:this.props.onUnstarMsg},m["default"].createElement(b["default"],{name:"star-light"}))),m["default"].createElement("div",{className:E["default"].preview,style:{flexBasis:e.widthStr}},m["default"].createElement("div",{style:{width:e.widthStr},className:E["default"].wrapper},m["default"].createElement("div",{style:{paddingBottom:e.ratioStr},className:E["default"].container},t)),a)}}]),t}(m["default"].Component);t["default"]=S},7251:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7430),_=o(g),v=a(7436),b=o(v),y=a(7124),E=o(y),S=a(47),C=o(S),M=a(7444),k=o(M),w=a(7260),N=o(w),T=a(7451),P=o(T),I=a(7255),R=o(I),A=a(7266),x=o(A),O=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onStarred=function(){var e=m["default"].createElement(x["default"],{chat:o.props.chat,starredMsgs:o.props.chat.getStarredMsgs(),onClose:o._pop});o.push(e)},o.onContactCard=function(){o.push(m["default"].createElement(R["default"],{chat:o.props.chat,onClose:o._pop}))},o.onMediaGallery=function(){var e=m["default"].createElement(P["default"],{chat:o.props.chat,onBack:o._pop});o.push(e)},o.onGroupInviteLink=function(){var e=m["default"].createElement(N["default"],{chat:o.props.chat,groupMetadata:o.props.chat.groupMetadata,onBack:o._pop});o.push(e)},o._pop=function(){o.pop()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=C["default"].supportsFeature(C["default"].F.STARRED)&&C["default"].supportsFeature(C["default"].F.FULL_TEXT_SEARCH)&&C["default"].supportsFeature(C["default"].F.STARRED_PAGINATION),t=e?this.onStarred:null,a=C["default"].supportsFeature(C["default"].F.MEDIA_GALLERY)?this.onMediaGallery:null,o=this.props.chat;this.props.chat.isGroup?this.push(m["default"].createElement(k["default"],{chat:o,groupMetadata:o.groupMetadata,contact:o.contact,profilePicThumb:o.contact.profilePicThumb,onVerification:this.onVerification,onStarred:t,onMediaGallery:a,onGroupInviteLink:this.onGroupInviteLink,onClose:this._pop})):o.isBroadcast?this.push(m["default"].createElement(_["default"],{chat:o,contact:o.contact,onStarred:t,onMediaGallery:a,onClose:this._pop})):o.isUser&&this.push(m["default"].createElement(b["default"],{contact:o.contact,status:Store.Status.get(o.contact.id),onVerification:this.onVerification,onStarred:t,onContactCard:this.onContactCard,onMediaGallery:a,onClose:this._pop}))}}]),t}(E["default"]);t["default"]=O},7252:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(12),b=o(v),y=a(7120),E=o(y),S=a(7122),C=o(S),M=a(7121),k=o(M),w=a(7148),N=o(w),T=a(7126),P=a(7155),I=o(P),R=a(7125),A=o(R),x=a(177),O=o(x),D=a(72),L=o(D),U=a(173),F=o(U),j=a(71),B=o(j),G=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.selection=new A["default"]([],function(e){return e.id}),o.onClick=function(e,t){b["default"].openChatFromUnread(t).then(function(e){e&&b["default"].focusChatTextInput(t)}),o.onClose()},o.onClose=function(){o.context.uim.uie.requestDismiss()},o.getList=function(){return Store.Chat.filter("archive")},o.onNextChat=function(e){e.preventDefault(),e.stopPropagation(),o.selection.setNext(!0,e)},o.onPrevChat=function(e){e.preventDefault(),e.stopPropagation(),o.selection.setPrev(!0,e)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(Store.Chat,"change:archive add remove"),this.refs.list&&O["default"].focus(_["default"].findDOMNode(this.refs.list))}},{key:"render",value:function(){var e=this,t=void 0,a=this.getList();if(this.selection.init(a,!0),a.length>0){var o=a.map(function(t){return m["default"].createElement(I["default"],{chat:t,contact:t.contact,mode:P.Mode.LAST,key:t.id,active:e.selection,onClick:e.onClick})}),n={down:this.onNextChat,up:this.onPrevChat};t=m["default"].createElement(F["default"],{handlers:n,ref:"list","data-list-scroll-container":!0},m["default"].createElement(N["default"],{data:o,extraItems:4}))}else t=m["default"].createElement(T.Archived,null);return m["default"].createElement(E["default"],{onCancel:this.onClose},m["default"].createElement(C["default"],{title:l10n.t("archived_flow_title"),onBack:this.onClose,type:S.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(k["default"],null,t))}}]),t}(m["default"].Component);G.contextTypes={uim:m["default"].PropTypes.instanceOf(L["default"])},e.exports=(0,B["default"])(G)},7253:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(8),_=o(g),v=a(23),b=o(v),y=a(7120),E=o(y),S=a(7121),C=o(S),M=a(7122),k=o(M),w=a(265),N=o(w),T=a(180),P=o(T),I=a(1),R=o(I),A=a(7132),x=o(A),O=a(76),D=o(O),L=a(126),U=o(L),F=a(7144),j=o(F),B=a(55),G=o(B),V=a(7161),Y=o(V),W=a(73),H=o(W),q=a(7173),z=o(q),K=a(174),Q=a(172),J=o(Q),X=a(7283),Z=o(X),$=a(34),ee="CAPTURE_MEDIA",te={ANIMATING:"ANIMATING",LOADING:"LOADING",RECORDING:"RECORDING",SENDING:"SENDING"},ae=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={state:te.ANIMATING,img:void 0,url:void 0,caption:void 0,videoSize:void 0},o.videoRef=null,o.startTimer=new G["default"](function(){o.setState({state:te.LOADING,url:window.URL.createObjectURL(o.props.stream)})}),o.onCapture=function(){if(o.videoRef){var e=o.videoRef.underlyingVideo();if(e){var t=o.props.chat,a=document.createElement("canvas");a.height=e.videoHeight,a.width=e.videoWidth;var n=a.getContext("2d");if(!n)return void R["default"].warn("CaptureDrawer:onCapture can not get 2d context")();n.translate(a.width,0),n.scale(-1,1),n.drawImage(e,0,0,e.videoWidth,e.videoHeight);var r=o.props.onCaptured;if(r)P["default"].canvasToBlob(a).then(function(e){r(e)});else{o.mediaLogger=new Z["default"],o.mediaLogger.logAdd(ee,$.MEDIA_TYPE.PHOTO,$.MEDIA_PICKER_ORIGIN_TYPE.MENU_CAMERA_CAPTURE),o.mediaLogger.chatRecipients=t&&t.groupMetadata?t.groupMetadata.participants.length:1;var i=a.toDataURL("image/jpeg");o.setState({state:te.SENDING,img:i})}}}},o.onVideoLoaded=function(e){o.setState({state:te.RECORDING,videoSize:{width:e.videoWidth,height:e.videoHeight}})},o.onRetake=function(){o.setState({state:te.RECORDING,caption:void 0})},o.onSend=function(){var e=o.state,t=e.img,a=e.caption,n=o.props.onSend;if(n)if(t){var r=t;n({getImg:D["default"].createFromBase64Jpeg(H["default"].parseDataURL(r).data),caption:a?N["default"].emojify(a.trim()):void 0}),o.mediaLogger.logSend(ee)}else R["default"].assert(t,"capture-drawer-no-img")();else R["default"].assert(n,"capture-drawer-no-onSend")()},o.onCaptionChange=function(e){o.setState({caption:e})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.startTimer.onOrBefore(300)}},{key:"componentWillUnmount",value:function(){this.startTimer.cancel();var e=this.state.url;e&&window.URL.revokeObjectURL(e),this.mediaLogger&&this.mediaLogger.logCancel()}},{key:"render",value:function(){var e=void 0,t=void 0,a=void 0,o=void 0;switch(this.state.state){case te.ANIMATING:break;case te.LOADING:case te.RECORDING:var n=(0,b["default"])("capture-video media-viewer-img webcam",{"capture-video-inactive":this.state.state===te.LOADING});a=m["default"].createElement("div",{key:"webcam"},m["default"].createElement(x["default"],{type:this.props.layoutType,size:this.state.videoSize},m["default"].createElement("div",{className:n},m["default"].createElement(z["default"],{autoPlay:!0,ref:(0,K.GetRef)("videoRef",this),onPlay:this.onVideoLoaded,src:this.state.url})))),e=m["default"].createElement("div",{className:"capture-controls fade",key:"btn-capture"},m["default"].createElement(j["default"],{large:!0,onClick:this.onCapture},m["default"].createElement(J["default"],{name:"camera-light"})));break;case te.SENDING:a=m["default"].createElement(x["default"],{type:this.props.layoutType,size:this.state.videoSize},m["default"].createElement("img",{className:"capture-image snapshot",src:this.state.img})),e=m["default"].createElement("div",{className:"capture-controls drawer-controls btn-send",key:"btn-send"},m["default"].createElement(j["default"],{large:!0,onClick:this.onSend},m["default"].createElement(J["default"],{name:"send-light",directional:!0}))),t=m["default"].createElement("div",{className:"drawer-header-action",onClick:this.onRetake},m["default"].createElement("div",{className:"capture-refresh-icon"},m["default"].createElement(J["default"],{name:"refresh-light"})),l10n.t("retake")),o=m["default"].createElement(Y["default"],{ref:"emojiInput",editable:!0,value:this.state.caption,maxLength:_["default"].MAX_CAPTION_LENGTH,showRemaining:!0,placeholder:l10n.t("add_a_caption"),onEnter:this.onSend,onChange:this.onCaptionChange,supportsEmoji:!0,focusOnMount:!0});break;default:R["default"].log("captureDrawer:render Unhandled video capture state "+this.state.state)()}var r=this.props.caption?m["default"].createElement(U["default"],{transitionName:"media-caption",className:"media-caption"},o):null;return m["default"].createElement(E["default"],{key:"attach-capture-modal",className:"drawer-capture",variant:"noheader"},m["default"].createElement(k["default"],{title:l10n.t("take_photo"),type:M.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack},t),m["default"].createElement(C["default"],{overflow:"hidden"},m["default"].createElement("div",{className:"media-body"},m["default"].createElement("div",{className:"media-body-container capture-body-container"},m["default"].createElement(U["default"],{transitionName:"capture"},a))),m["default"].createElement("div",{className:"capture-footer"},r,m["default"].createElement(U["default"],{transitionName:"pop_delay"},e))))}}]),t}(h.PureComponent);ae.defaultProps={caption:!1},t["default"]=ae},7254:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i,l,s,u,c,d=a(0),f=o(d),p=a(5),h=o(p),m=a(2),g=o(m),_=a(4),v=o(_),b=a(7),y=o(b),E=a(6),S=o(E),C=a(3),M=o(C),k=a(46),w=o(k),N=a(10),T=o(N),P=a(7146),I=o(P),R=a(484),A=(o(R),a(12)),x=o(A),O=a(7278),D=o(O),L=a(8),U=o(L),F=a(486),j=(o(F),a(23)),B=o(j),G=a(7139),V=o(G),Y=a(7120),W=o(Y),H=a(7121),q=o(H),z=a(7122),K=o(z),Q=a(14),J=o(Q),X=a(7126),Z=a(177),$=o(Z),ee=a(7272),te=o(ee),ae=a(47),oe=o(ae),ne=a(173),re=o(ne),ie=a(7148),le=o(ie),se=a(71),ue=o(se),ce=a(7140),de=o(ce),fe=a(53),pe=(o(fe),a(485)),he=o(pe),me=a(55),ge=o(me),_e=a(7125),ve=o(_e),be=a(175),ye=o(be),Ee=a(7118),Se=o(Ee),Ce=a(487),Me=a(7182),ke=a(7185),we=o(ke),Ne=a(72),Te=o(Ne),Pe=a(264),Ie=o(Pe),Re=a(7184),Ae=o(Re),xe=2;t["default"]=(0,ue["default"])((0,he["default"])((r=n=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o.state={searchText:"",searching:!1,resultsUnavailable:!1},o.setSearch=function(e){return o.search=e},o.ftsMsgs=new te["default"],o.selection=new ve["default"]([],function(e){return e.id.toString()}),o.pending=!1,o._batchRenderState={},o._handleScroll=function(e){o.shouldFTSSearch(e)&&(o.fts(),o.pending=!0)},o.handleScroll=T["default"].throttle(o._handleScroll,100),o._debounceSetState=new ge["default"](function(){o.setState(o._batchRenderState),o._batchRenderState={}}),o.batchSetState=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:75;T["default"].assign(o._batchRenderState,e),o._debounceSetState.debounce(t)},o.fts=T["default"].debounce(function(){o.pending=!1;var e=T["default"].trim(o.state.searchText||"");(0,Me.numCodepoints)(e)<xe||(o._ftsPromise&&o._ftsPromise.cancel(),o._ftsPromise=f["default"].resolve().then(function(){o.isFTSSearching()||o.batchSetState({searching:!0})}).then(function(){return o.ftsMsgs.search(e,o.props.chat)}).checkpoint(o.props.rejectOnUnmount()).then(function(t){e===T["default"].trim(o.state.searchText)&&o.batchSetState({searching:!1,resultsUnavailable:!1})})["catch"](J["default"].Unmount,T["default"].noop)["catch"](function(e){o.pending||o.batchSetState({searching:!1,resultsUnavailable:e instanceof J["default"].E404})}))},750),o.fullTextSearch=function(e){var t=T["default"].trim(e);(0,Me.numCodepoints)(t)>=xe&&oe["default"].supportsFeature(oe["default"].F.FULL_TEXT_SEARCH)?(o.fts(),o.pending=!0):(o.fts.cancel(),o.ftsMsgs.resetSearch(),o.ftsMsgs["delete"](),o._ftsPromise&&o._ftsPromise.cancel(),o.pending=!1,o.state.searching&&o.batchSetState({searching:!1,resultsUnavailable:!1}))},o.shouldFTSSearch=function(e){return!o.ftsMsgs.hasMoreMsgs||o.pending||o.state.searching||o.ftsMsgs.searchPromise||(0,Me.numCodepoints)(o.state.searchText||"")<xe?!1:e.scrollTop+U["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight},o.isFTSSearching=function(){var e=o._batchRenderState;return"searching"in e?e.searching:o.state.searching},o.onSearch=function(e){if(!e)return void o.onStopSearch();var t=o.state.searchText;if(e!==t){var a={searchText:e,resultsUnavailable:!1
};o.fullTextSearch(e),o.setState({searchText:e}),o.batchSetState(a)}},o.onStopSearch=function(){o.fts.cancel(),o.ftsMsgs.resetSearch(),o.ftsMsgs["delete"](),o._ftsPromise&&o._ftsPromise.cancel(),o.pending=!1,o.setState({searchText:"",searching:!1})},o.onFocusList=function(e){e.repeat||o.refs.msglist&&o.search.isAtEnd()&&(e.preventDefault(),e.stopPropagation(),(0,ne.shouldIndicateFocus)(),o.refs.msglist.focusFirst(e))},o.onOpenFirst=function(e){e.preventDefault();var t=o.ftsMsgs.head();if(t){var a=t.chat,n=a.getSearchContext(t);x["default"].focusChatTextInput(a),x["default"].openChatAt(a,n)}},o.onFocusSearch=function(){(0,ne.shouldIndicateFocus)(),$["default"].focus(o.search)},o.onClose=function(){o.context.uim.uie.requestDismiss()},o.indicateFocus=function(e){(0,ne.indicateFocus)(o.refs.input_hotkey,["#FBFBFB","#D9F3FF"])},o.onScroll=function(e){o.handleScroll(e.target)},o.getEmptyChatlistState=function(e){if(e.length)return null;var t=T["default"].trim(o.state.searchText||"");return(0,Me.numCodepoints)(t)>=xe?o.state.searching?M["default"].createElement(X.SearchingMessages,null):o.state.resultsUnavailable?M["default"].createElement(X.SearchMessagesUnavailable,null):M["default"].createElement(X.SearchMessages,null):(0,X.BeforeSearchMessages)(o.props.chat.title())},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentDidMount",value:function(){this.onFocusSearch(),this.props.listeners.add(this.ftsMsgs,"bulk_remove")}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel(),this.fts.cancel(),this.ftsMsgs["delete"](!0),this._ftsPromise&&this._ftsPromise.cancel(),this._debounceSetState.cancel()}},{key:"render",value:function(){var e=this.ftsMsgs.models,t=this.getEmptyChatlistState(e);if(!t){var a=this.state.searchText?T["default"].trim(this.state.searchText):null;t=M["default"].createElement(Oe,{ref:"msglist",isSearching:!!this.state.searchText,searchText:a,ftsResult:e,selection:this.selection,onFocusSearch:this.onFocusSearch})}var o={down:this.onFocusList,enter:this.onOpenFirst},n=this.state.searching&&e.length?M["default"].createElement("div",{className:"chat-search-spinner"},M["default"].createElement(ye["default"],{stroke:6,size:24})):null;return M["default"].createElement(W["default"],{key:"search-modal",variant:"panel",className:"drawer-chat-search",onCancel:this.onClose},M["default"].createElement(K["default"],{title:l10n.t("search_msgs"),type:z.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),M["default"].createElement(re["default"],{handlers:o,onFocus:this.indicateFocus,ref:"input_hotkey",className:"chatlist-panel-search"},M["default"].createElement(de["default"],{ref:this.setSearch,onSearch:this.onSearch,placeholder:l10n.t("search"),loading:this.state.searching})),M["default"].createElement(q["default"],null,M["default"].createElement("div",{ref:"panel",className:"chatlist-panel-body",onScroll:this.onScroll,id:"pane-side","data-list-scroll-container":!0},t,n)))}}]),t}(M["default"].Component),n.contextTypes={uim:M["default"].PropTypes.instanceOf(Te["default"])},r)));var Oe=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o._listPointerEvents=!0,o.onListPointerEventsOff=function(){o._listPointerEvents=!1},o.onListPointerEventsOn=function(){o._listPointerEvents=!0},o.onClick=function(e,t,a){e.preventDefault(),e.stopPropagation(),Store.Chat.find(t.id).then(function(e){2===D["default"].column&&o.context.uim.uie.requestDismiss(),x["default"].focusChatTextInput(e),x["default"].openChatAt(e,a)})},o.getSelection=function(){return o.props.ftsResult||[]},o.getList=function(){return o.props.ftsResult.map(function(e){return e.sender&&e.isGroupMsg&&!e.isNotification&&!e.isSentByMe?M["default"].createElement(De,{contact:e.senderObj,msg:e,chat:e.chat,searchText:o.props.searchText,onClick:o.onClick,active:o.props.selection,key:e.id.toString()}):M["default"].createElement(Le,{msg:e,chat:e.chat,searchText:o.props.searchText,onClick:o.onClick,active:o.props.selection,key:e.id.toString()})})},o.restoreFocus=function(e){o.props.selection.reset(!0,e)},o.onFocusGain=function(e){e.target===w["default"].findDOMNode(o)&&o._listPointerEvents&&(o.props.selection.index<0?o.focusFirst(e):o.props.selection.reset(!0,e))},o.focusFirst=function(e){o.props.selection.setFirst(!0,e)},o.onNextChat=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=o.props.selection.next();o.props.selection.index!==t&&o.props.selection.setNext(!0,e)},o.onPrevChat=function(e){e&&(e.stopPropagation(),e.preventDefault());var t=o.props.selection.prev();t>-1?o.props.selection.setPrev(!0,e):o.props.onFocusSearch()},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentWillMount",value:function(){this.props.selection.init(this.getSelection())}},{key:"render",value:function(){var e=this,t={down:function(t){return e.onNextChat(t)},up:function(t){return e.onPrevChat(t)}};return M["default"].createElement(re["default"],{handlers:t,onFocus:this.onFocusGain,"data-tab":3},M["default"].createElement(le["default"],{data:this.getList(),height:72,animate:!0,extraItems:4,onPointerEventsOff:this.onListPointerEventsOff,onPointerEventsOn:this.onListPointerEventsOn}))}}]),t}(M["default"].Component);Oe.contextTypes={uim:M["default"].PropTypes.instanceOf(Te["default"])};var De=(0,Se["default"])((l=i=function(e){function t(){return(0,g["default"])(this,t),(0,y["default"])(this,(t.__proto__||(0,h["default"])(t)).apply(this,arguments))}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"render",value:function(){var e=this.props.msg;return M["default"].createElement(Le,{msg:e,chat:e.chat,author:this.props.contact.formattedShortName,searchText:this.props.searchText,onClick:this.props.onClick,active:this.props.active,key:e.id.toString()})}}]),t}(M["default"].Component),i.CONCERNS={msg:["id","chat"],contact:["formattedShortName"]},l)),Le=(0,ue["default"])((0,Se["default"])((u=s=function(e){function t(e){(0,g["default"])(this,t);var a=(0,y["default"])(this,(t.__proto__||(0,h["default"])(t)).call(this,e));c.call(a);var o=e.msg,n=e.author,r=e.active;return a.state={active:r?r.value===o:!1,author:n?n:null},a}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentWillMount",value:function(){this.props.active&&this.props.listeners.add(this.props.active,this.props.msg.id.toString(),this.onActiveChange)}},{key:"componentWillReceiveProps",value:function(e){e.author!==this.props.author&&this.setState({author:e.author})}},{key:"render",value:function(){var e=this.props.msg,t=M["default"].createElement(we["default"],{msg:e}),a=M["default"].createElement(Ae["default"],{msg:e,msgType:"Search",author:this.state.author,searchQuery:this.props.searchText?[this.props.searchText]:[]}),o={enter:this.onEnter},n=(0,B["default"])("cell-message","cell-message-simplified",{active:!!this.state.active});return M["default"].createElement(re["default"],{handlers:o,onFocus:this.indicateFocus,onBlur:this.onBlur},M["default"].createElement(I["default"],{id:e.id+"",ref:"cell",contextEnabled:this.contextEnabled,className:n,primaryDetail:t,secondary:a,primary:void 0,onClick:this.onClick}))}}]),t}(M["default"].Component),s.CONCERNS={msg:["id","chat","isSentByMe","senderObj","rtl","dir","type"]},c=function(){var e=this;this.onActiveChange=function(t,a){if("focus"===t){var o=w["default"].findDOMNode(e);$["default"].focus(o),a&&V["default"].scrollIntoViewIfNeeded(o)}e.setState({active:!!t})},this.onClick=function(t){if(T["default"].isFunction(e.props.onClick)){var a=(0,Ce.unproxy)(e.props.msg),o=a.chat,n=o.getSearchContext(a);n.msg=a,e.props.onClick(t,o,n)}},this.onEnter=function(t){t.preventDefault(),t.stopPropagation(),(0,ne.shouldIndicateFocus)(),e.onClick(t)},this.indicateFocus=function(t){(0,ne.indicateFocus)(e.refs.cell,["#e9eaeb","#cbdde7"],{complete:e.onBlur})},this.onBlur=function(t){var a=w["default"].findDOMNode(e.refs.cell);a&&((0,Ie["default"])(a,"stop"),a.style.backgroundColor="")},this.contextEnabled=function(){return!1}},u)))},7255:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7120),_=o(g),v=a(7122),b=o(v),y=a(7121),E=o(y),S=a(484),C=(o(S),a(72)),M=o(C),k=a(7175),w=o(k),N=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onClose=function(){o.props.onClose?o.props.onClose():o.context.uim.uie.requestDismiss()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.chat.getReceivedVCardMsgs(),t=e.map(function(e){return m["default"].createElement(w["default"],{key:e.id,msg:e})});return m["default"].createElement(_["default"],{onCancel:this.onClose},m["default"].createElement(b["default"],{title:l10n.t("contact_card",{_plural:e.length}),onBack:this.onClose,type:v.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(E["default"],null,t))}}]),t}(m["default"].Component);N.contextTypes={uim:m["default"].PropTypes.instanceOf(M["default"])},t["default"]=N},7256:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(173),_=o(g),v=a(7147),b=o(v),y=a(7143),E=o(y),S=a(178),C=o(S),M=a(486),k=(o(M),a(492)),w=o(k),N=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.blockContact=function(e){e.stopPropagation(),e.preventDefault(),o.props.blockContact()},o.onCancel=function(e){e.stopPropagation(),e.preventDefault(),o.props.onCancel()},o.reportSpam=function(e){e.stopPropagation(),e.preventDefault(),o.props.reportSpam()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=m["default"].createElement(w["default"],{type:"primary",onClick:this.blockContact,key:0},l10n.t("block")),t=m["default"].createElement(w["default"],{type:"plain",onClick:this.reportSpam,key:1},l10n.t("report_contact_spam")),a=m["default"].createElement(w["default"],{type:"plain",onClick:this.onCancel,key:2},l10n.t("web_cancel")),o={enter:this.blockContact,escape:this.onCancel},n=[e,t,a],r=m["default"].createElement(E["default"],{contact:this.props.contact}),i=m["default"].createElement(b["default"],{id:"block_confirmation",params:{contact:r}});return m["default"].createElement(_["default"],{handlers:o},m["default"].createElement(C["default"],{title:l10n.t("block"),children:i,actions:n}))}}]),t}(m["default"].Component);t["default"]=N},7257:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7135),E=o(y),S=a(486),C=(o(S),a(23)),M=o(C),k=a(7126),w=a(265),N=o(w),T=a(71),P=o(T),I=a(7261),R=o(I),A=a(7160),x=o(A),O=a(7125),D=o(O);t["default"]=(0,P["default"])((r=n=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.onSelect=function(e,t){if(t instanceof y.Component){var o=t.props.contact;a.props.filter(o)===!0&&a.props.onSelect(o)}},a.onSearch=b["default"].debounce(function(e){a.setState({searchFilter:e})},100),a.selection=new D["default"]([],function(e){return e.id}),a.state={searchFilter:void 0},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.props.contacts||this.props.listeners.add(Store.Contact,"add remove change:name")}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.onCancel,o=e.filter,n=e.onSelect,r=l10n.accentFold(this.state.searchFilter),i=N["default"].numberSearch(r),l=this.props.contacts||Store.Contact,s=l.filter(function(e){return o(e)&&(!r||r&&e.searchMatch(r,i))}),u=[];if(s.length){this.selection.init(s.filter(function(e){return o(e)===!0}));for(var c=void 0,d=void 0,f=s.length>10,p=0;p<s.length;p++){c=s[p],f&&c.header!==d&&u.push(_["default"].createElement(x["default"],{key:c.header,header:c.header}));var h=b["default"].isString(o(c)),m=void 0;p<s.length-1&&s[p+1].header!==c.header&&(m="last");var g=void 0;h&&(g=o(c),m=(0,M["default"])(m,"member")),u.push(_["default"].createElement(E["default"],{contact:c,active:this.selection,className:m,secondary:g,onClick:h?void 0:b["default"].once(n.bind(null,c)),key:c.id})),d=c.header}}else u=_["default"].createElement(k.SearchContacts,null);return _["default"].createElement(R["default"],{title:t,selection:this.selection,onSearch:this.onSearch,searchPlaceholder:l10n.t("search_contacts"),onSelect:this.onSelect,onCancel:a},u)}}]),t}(_["default"].Component),n.defaultProps={filter:function(e){return Store.Contact.isFilteredContact(e)}},r))},7258:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(173),_=o(g),v=a(93),b=o(v),y=a(178),E=o(y),S=a(261),C=o(S),M=a(492),k=o(M),w=a(7284),N=o(w),T=a(7440),P=o(T),I=a(8),R=o(I),A=a(21),x=o(A),O=a(7124),D=o(O),L=a(484),U=(o(L),a(53)),F=(o(U),function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this));e.onDelete=function(){e.end()},e.onRevoke=function(){e.showRevokeNux?(e.push(e.renderRevokeNux(),"none"),x["default"].setNUX(R["default"].NUX.REVOKE_LEGAL_DISCLAIMER_NUX,{views:1,maxViews:1})):e.end()},e.onPopupCancel=function(){e.end()},e.onCancel=function(){e.end()},e.openRevokeLearnMore=function(){window.open(R["default"].FAQ_BASE_URL+"/faq/web/26000097","_blank")},e.onRevokeNuxClicked=function(){e.end()},e.renderRevokeNux=function(){var t=[m["default"].createElement(k["default"],{type:"plain",onClick:e.openRevokeLearnMore,key:1},b["default"].t("learn_more")),m["default"].createElement(k["default"],{type:"primary",onClick:e.onRevokeNuxClicked,key:0},b["default"].t("web_ok"))];return m["default"].createElement(C["default"],{escapable:!1},m["default"].createElement(_["default"],{handlers:{enter:e.onRevokeNuxClicked}},m["default"].createElement(E["default"],{actions:t},m["default"].createElement("div",{className:N["default"].label},b["default"].t("revoke_legal_disclaimer_nux")))))};var a=x["default"].getNUX(R["default"].NUX.REVOKE_LEGAL_DISCLAIMER_NUX);return e.showRevokeNux=!a||a.views<a.maxViews,e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props,t=e.chat,a=e.msgList,o=e.deletePrompt,n=e.revokePrompt,r=e.toastPosition,i=e.onCancel;this.push(m["default"].createElement(P["default"],{chat:t,msgList:a,deletePrompt:o,revokePrompt:n,toastPosition:r,onDelete:this.onDelete,onRevoke:this.onRevoke,onPopupCancel:this.onPopupCancel,onCancel:i}))}}]),t}(D["default"]));t["default"]=F},7259:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(3),l=o(i),s=a(23),u=o(s),c=a(39),d=a(7603),f=o(d),p=function(e){var t=e.title,a=e.icon,o=e.onClick,n=e.children,i=(0,u["default"])(f["default"].itemBody,(0,r["default"])({},f["default"].row,a)),s=(0,u["default"])((0,r["default"])({},f["default"].main,a)),d=(0,u["default"])((0,r["default"])({},f["default"].side,a));return l["default"].createElement("div",{className:f["default"].item,onClick:o,role:o?"button":""},l["default"].createElement("div",{className:i},l["default"].createElement("div",{className:s},l["default"].createElement(c.SelectableDiv,{className:f["default"].primary,selectable:!0},t),l["default"].createElement("div",{className:f["default"].secondary},n)),l["default"].createElement("div",{className:d},a)))};t["default"]=p},7260:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(484),E=(o(y),a(7165)),S=(o(E),a(7120)),C=o(S),M=a(7122),k=o(M),w=a(7121),N=o(w),T=a(14),P=o(T),I=a(7123),R=o(I),A=a(7126),x=a(7119),O=o(x),D=a(7145),L=o(D),U=a(7416),F=o(U),j=a(7422),B=o(j),G=a(12),V=o(G),Y=a(39),W=a(263),H=o(W),q=a(93),z=o(q),K=a(172),Q=o(K),J=a(7141),X=o(J),Z=a(7118),$=o(Z),ee=a(485),te=o(ee),ae=a(7607),oe=o(ae),ne={LOADING:0,REVOKING:1,SUCCESS:2},re=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(s))),o.state={state:ne.LOADING},o.getErrorMessageFromStatusCode=function(e){switch(e){case 401:return z["default"].t("group_invite_query_401");case 403:return z["default"].t("group_invite_query_403");case 404:return z["default"].t("group_invite_query_404");default:return z["default"].t("group_invite_query_406")}},o.handleLoadingStatusCode=function(e){if(200===e)o.setState({state:ne.SUCCESS});else{var t=o.getErrorMessageFromStatusCode(e);o.props.onBack(),V["default"].openToast(_["default"].createElement(H["default"],{msg:t,id:(0,W.genId)()}))}},o.handleRevokeGroupInvite=function(){V["default"].openModal(_["default"].createElement(F["default"],{pushTransition:"none",popTransition:"none",chat:o.props.chat,onConfirm:o.handleConfirmRevokeGroupInvite}),"modal-flow")},o.handleRevokingStatusCode=function(e){if(200===e)V["default"].openToast(_["default"].createElement(H["default"],{msg:z["default"].t("group_invite_revoke_success"),id:(0,W.genId)()})),o.setState({state:ne.SUCCESS});else{var t=o.getErrorMessageFromStatusCode(e);o.props.onBack(),V["default"].openToast(_["default"].createElement(H["default"],{msg:t,id:(0,W.genId)()}))}},o.handleConfirmRevokeGroupInvite=function(){o.setState({state:ne.REVOKING});var e=o.props.groupMetadata.revokeGroupInvite();r["default"].delay(500)["return"](e).checkpoint(o.props.rejectOnUnmount()).then(function(e){o.handleRevokingStatusCode(e)})["catch"](P["default"].Unmount,b["default"].noop)},o.handleSendGroupInviteLink=function(){V["default"].openModal(_["default"].createElement(B["default"],{chat:o.props.chat,pushTransition:"none",popTransition:"none"}),"modal-flow")},o.handleClickGroupInviteLink=function(e){e.preventDefault(),o.handleSendGroupInviteLink()},o.handleCopyLink=function(){window.getSelection().removeAllRanges();var e=document.querySelector("#group-invite-link-anchor"),t=document.createRange();t.selectNode(e),window.getSelection().addRange(t);var a=void 0;try{a=document.execCommand("copy"),window.getSelection().removeAllRanges()}catch(o){a=!1}a?V["default"].openToast(_["default"].createElement(H["default"],{msg:z["default"].t("group_invite_link_copy_success"),id:(0,W.genId)()})):V["default"].openToast(_["default"].createElement(H["default"],{msg:z["default"].t("group_invite_link_copy_failed"),id:(0,W.genId)()}))},o.renderDrawerBody=function(){var e=o.props.groupMetadata,t=void 0;if(o.state.state===ne.LOADING)t=_["default"].createElement(A.LoadingWithText,{text:z["default"].t("group_invite_check_link")});else if(o.state.state===ne.REVOKING)t=_["default"].createElement(A.LoadingWithText,{text:z["default"].t("group_invite_revoke_in_progress",{groupName:o.props.chat.contact.name})});else{var a=e.groupInviteLink,n=null;document.queryCommandSupported("copy")&&(n=_["default"].createElement(L["default"],{icon:_["default"].createElement(Q["default"],{name:"copy",directional:!0}),a8n:"li-copy-link",onClick:o.handleCopyLink},z["default"].t("group_invite_drawer_copy_link")));var r=_["default"].createElement(R["default"],{id:o.props.chat.id,size:82,quality:R["default"].Quality.HIGH}),i=_["default"].createElement("span",{className:oe["default"].linkContainer},_["default"].createElement(Y.SelectableLink,{id:"group-invite-link-anchor",href:a,onClick:o.handleClickGroupInviteLink,selectable:!0},a));t=_["default"].createElement(N["default"],null,_["default"].createElement(X["default"],{image:r,primary:_["default"].createElement(O["default"],{text:o.props.chat.contact.name,direction:"auto"}),theme:"identity",secondary:i}),_["default"].createElement("div",{className:oe["default"].descContainer},z["default"].t("group_invite_link_description")),_["default"].createElement(L["default"],{icon:_["default"].createElement(Q["default"],{name:"share",directional:!0}),a8n:"li-share-link",onClick:o.handleSendGroupInviteLink},z["default"].t("group_invite_drawer_send_link")),n,_["default"].createElement(L["default"],{icon:_["default"].createElement(Q["default"],{name:"revoke",directional:!0}),a8n:"li-revoke-link",onClick:o.handleRevokeGroupInvite},z["default"].t("group_invite_drawer_revoke_link")))}return t},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.props.groupMetadata.groupInviteCode().checkpoint(this.props.rejectOnUnmount()).then(this.handleLoadingStatusCode)["catch"](P["default"].Unmount,b["default"].noop)}},{key:"render",value:function(){return _["default"].createElement(C["default"],{onCancel:this.props.onBack},_["default"].createElement(k["default"],{title:z["default"].t("group_invite_link"),onBack:this.props.onBack,type:M.DRAWER_HEADER_TYPE.SMALL}),this.renderDrawerBody())}}]),t}(_["default"].Component);re.CONCERNS={groupMetadata:["inviteCode","groupInviteLink"]},t["default"]=(0,te["default"])((0,$["default"])(re))},7261:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7120),_=o(g),v=a(7121),b=o(v),y=a(7122),E=o(y),S=a(177),C=o(S),M=a(173),k=o(M),w=a(7148),N=o(w),T=a(7140),P=o(T),I=a(178),R=o(I),A=a(7125),x=(o(A),a(174)),O=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.setSearch=function(e){return o.search=e},o.onNext=function(e){e.preventDefault(),e.stopPropagation();var t=o.props.selection;t&&t.setNext(!0,e)},o.onPrev=function(e){var t=o.props.selection;if(t){e.preventDefault(),e.stopPropagation();var a=t.prev();a>-1?t.setPrev(!0,e):(t.unset(),(0,M.shouldIndicateFocus)(),C["default"].focus(o.search))}},o.onFocusList=function(e){o.list&&(e.preventDefault(),e.stopPropagation(),(0,M.shouldIndicateFocus)(),o.props.selection.setFirst(!0,e))},o.onSelectFirst=function(e){e.preventDefault(),e.stopPropagation();var t=o.props.children,a=Array.isArray(t)?t[0]:t;a&&o.props.onSelect(e,a)},o.onSearch=function(e){o.props.onSearch(e)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.onCancel,o=e.onSearch,n=e.searchPlaceholder,r=e.children,i={down:this.onFocusList,enter:this.onSelectFirst},l={down:this.onNext,up:this.onPrev},s=void 0;o&&(s=m["default"].createElement(k["default"],{handlers:i},m["default"].createElement(P["default"],{ref:this.setSearch,onSearch:this.onSearch,placeholder:n||l10n.t("search")})));var u=void 0;if(r){var c=Array.isArray(r)?r:[r];u=c.length?m["default"].createElement(k["default"],{handlers:l},m["default"].createElement(N["default"],{ref:(0,x.GetRef)("list",this),data:c,height:72,extraItems:4})):r}else u=r;return m["default"].createElement(R["default"],{type:I.TowerModalType},m["default"].createElement(_["default"],{key:"contact-modal",onCancel:a},m["default"].createElement(E["default"],{title:t,type:y.DRAWER_HEADER_TYPE.POPUP,onCancel:a}),s,m["default"].createElement(b["default"],{"data-list-scroll-container":!0},u)))}}]),t}(m["default"].Component);t["default"]=O},7262:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(176),b=o(v),y=a(486),E=(o(y),a(7120)),S=o(E),C=a(7121),M=o(C),k=a(7122),w=o(k),N=a(265),T=o(N),P=a(93),I=o(P),R=a(7189),A=o(R),x=a(126),O=o(x),D=a(7144),L=o(D),U=a(7161),F=o(U),j=a(172),B=o(j),G=a(7615),V=o(G),Y=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.onPreventBlur=function(e){e.preventDefault(),e.stopPropagation(),a.refs.emojiInput&&a.refs.emojiInput.restoreFocus()},a.onImageSet=function(e,t){a.setState({thumb:e,full:t})},a.onContinue=function(){var e=T["default"].emojify(a.state.text.trim());Store.Chat.createGroup(e,a.state.thumb,a.state.full,a.props.participants),a.props.onContinue()},a.onSubjectChange=function(e){a.setState({text:e})},a.state={text:e.subject||"",thumb:e.thumb,full:e.full},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.refs.emojiInput.restoreFocus()}},{key:"render",value:function(){var e=this.state.text.trim().length>0,t=e?m["default"].createElement("div",{className:V["default"].nextButton},m["default"].createElement(L["default"],{a8nText:"create-group-btn",onClick:_["default"].once(this.onContinue)},m["default"].createElement(B["default"],{name:"checkmark-light"}))):null;return m["default"].createElement(S["default"],{onCancel:this.props.onBack},m["default"].createElement(w["default"],{title:I["default"].t("new_group_flow_title"),type:k.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),m["default"].createElement(M["default"],null,m["default"].createElement("div",{className:V["default"].section},m["default"].createElement(A["default"],{type:R.Type.GROUP,startImage:this.state.full,onImageSet:this.onImageSet,ref:"photoPicker"})),m["default"].createElement("div",{"data-a8n":b["default"].key("group-subject"),className:V["default"].section,onMouseDown:this.onPreventBlur},m["default"].createElement(F["default"],{ref:"emojiInput",value:this.state.text,maxLength:25,showRemaining:!0,onChange:this.onSubjectChange,placeholder:I["default"].t("group_subject"),onEnter:e?_["default"].once(this.onContinue):_["default"].noop,supportsEmoji:!0})),m["default"].createElement(O["default"],{transitionName:"btn"},t)))}}]),t}(h.Component);t["default"]=Y},7263:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(176),b=o(v),y=a(12),E=o(y),S=a(94),C=o(S),M=a(7219),k=o(M),w=a(23),N=o(w),T=a(7120),P=o(T),I=a(7121),R=o(I),A=a(7122),x=o(A),O=a(14),D=o(O),L=a(177),U=o(L),F=a(265),j=o(F),B=a(173),G=o(B),V=a(93),Y=o(V),W=a(7327),H=o(W),q=a(485),z=o(q),K=a(3),Q=o(K),J=a(126),X=o(J),Z=a(7144),$=o(Z),ee=a(175),te=o(ee),ae=a(263),oe=o(ae),ne=a(39),re=a(172),ie=o(re),le=(0,ae.genId)("max_participant_toast");t["default"]=(0,z["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={searchText:"",participants:o.props.participants,shouldFocus:!0,isBusy:!1},o.setRefParticipantList=function(e){o.refParticipantList=e},o.setRefList=function(e){o.refList=e},o.onKeyDown=function(e){if("Backspace"===e.key&&!o.state.searchText&&!_["default"].isEmpty(o.state.participants)){e.preventDefault();var t=o.state.participants;o.setState({participants:t.slice(0,t.length-1),shouldFocus:!0})}},o.onInput=function(e){o.setState({searchText:e.target.value})},o.onReset=function(){o.setState({searchText:"",shouldFocus:!0})},o.focus=function(){U["default"].focus(o.refs.input)},o.onBack=function(){var e=o.props;e.onBack()},o.onContinue=function(){var e=o.props;e.onContinue(o.state.participants)},o.onDelete=function(e,t){var a=_["default"].filter(o.state.participants,function(e){return e.id!==t.id});o.setState({participants:a,shouldFocus:!a.length})},o.onContactClick=function(e,t){var a=_["default"].find(o.state.participants,function(e){return e.id===t.id});a?o.removeContact(t):t.isBlocked()?E["default"].openModal(Q["default"].createElement(C["default"],{title:Y["default"].t("add_blocked_title"),onOK:function(){o.unblockAndAddContact(t),E["default"].closeModal()},onCancel:E["default"].closeModal.bind(E["default"]),okText:Y["default"].t("web_yes"),cancelText:Y["default"].t("web_no")},Y["default"].t("add_blocked_contact_to_group"))):o.addContact(t)},o.onFocusList=function(e){o.refList&&(e.preventDefault(),e.stopPropagation(),(0,B.shouldIndicateFocus)(),o.refList.focusFirst())},o.onFocusParticipants=function(e){e.repeat||0!==o.refs.input.selectionStart||o.refParticipantList&&(e.preventDefault(),e.stopPropagation(),G["default"].flashFocus=0,o.refParticipantList.focusLast(e))},o.onSelectFirst=function(e){e.preventDefault(),e.stopPropagation();var t=_["default"].head(o.getFilteredContacts());t&&o.onContactClick(e,t)},o.onFocusSearch=function(e){(0,B.shouldIndicateFocus)(),U["default"].focus(o.refs.input)},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.focus()}},{key:"componentDidUpdate",value:function(){this.adjustInput()}},{key:"getFilteredContacts",value:function(){var e=_["default"].difference(Store.Contact.getFilteredContacts(),this.state.participants),t=this.state.searchText;if(!t)return e;t=Y["default"].accentFold(t);var a=j["default"].numberSearch(t);return e.filter(function(e){return e.searchMatch(t,a)})}},{key:"adjustInput",value:function(){var e=this.refs.input.offsetParent.offsetWidth-10,t=this.refs.sizer.offsetWidth,a=t>e?e:t;this.refs.input.style.width=a+"px";var o;o=e-this.refs.input.offsetLeft-a>0?e-this.refs.input.offsetLeft:e,this.refs.input.style.width=o+"px",this.state.shouldFocus&&this.focus()}},{key:"addContact",value:function(e){var t=this.state.participants;if(t.length>=Store.ServerProps.maxParticipants){var a=Y["default"].t("action_group_create_failed_participant",{max:Store.ServerProps.maxParticipants});E["default"].openToast(Q["default"].createElement(oe["default"],{msg:a,id:le}))}else this.setState({participants:t.concat(e),searchText:"",shouldFocus:!0})}},{key:"removeContact",value:function(e){var t=this.state.participants;this.setState({participants:_["default"].filter(t,function(t){return t.id!==e.id}),shouldFocus:!0})}},{key:"unblockAndAddContact",value:function(e){var t=this;this.setState({isBusy:!0}),e.setBlock(!1).checkpoint(this.props.rejectOnUnmount()).then(function(){t.addContact(e),t.setState({isBusy:!1})})["catch"](D["default"].Unmount,_["default"].noop)["catch"](function(e){t.setState({isBusy:!1})})}},{key:"render",value:function(){var e=void 0;this.state.isBusy?e=Q["default"].createElement("div",{className:"new-group-spinner"},Q["default"].createElement(te["default"],{stroke:6,size:24})):_["default"].size(this.state.participants)&&(e=Q["default"].createElement($["default"],{a8nText:"group-participants-btn",onClick:this.onContinue},Q["default"].createElement(ie["default"],{name:"forward-light",directional:!0})));var t=_["default"].size(this.state.participants)?" ":Y["default"].t("group_participant_hint"),a={down:this.onFocusList,enter:this.state.searchText?this.onSelectFirst:_["default"].size(this.state.participants)?this.onContinue:_["default"].noop,up:this.onFocusParticipants};return a[Y["default"].LR("left","right")]=this.onFocusParticipants,
Q["default"].createElement(P["default"],{onCancel:this.onBack},Q["default"].createElement(x["default"],{title:Y["default"].t("add_group_participants_title"),type:A.DRAWER_HEADER_TYPE.LARGE,onBack:this.onBack}),Q["default"].createElement(R["default"],null,Q["default"].createElement("div",{className:"drawer-section new-group-search"},Q["default"].createElement("div",{className:"input-clear input-ext"},Q["default"].createElement(G["default"],{handlers:a,className:"input input-line"},Q["default"].createElement("div",{className:"list-names list-deletable new-group-preview"},Q["default"].createElement("div",{className:"new-group-participants","data-list-scroll-container":!0},Q["default"].createElement(H["default"],{ref:this.setRefParticipantList,contacts:this.state.participants,onDelete:this.onDelete,onFocusSearch:this.onFocusSearch}))),Q["default"].createElement("input",{"data-a8n":b["default"].key("inputarea"),className:(0,N["default"])("inputarea",ne.SELECTABLE_INPUT_CSS_CLASS),ref:"input",placeholder:t,onKeyDown:this.onKeyDown,onChange:this.onInput,value:this.state.searchText}),Q["default"].createElement("span",{className:"inputarea-sizer",ref:"sizer"},this.state.searchText)))),Q["default"].createElement("div",{className:"new-group-contacts","data-list-scroll-container":!0},Q["default"].createElement(k["default"],{ref:this.setRefList,contacts:this.getFilteredContacts(),onFocusSearch:this.onFocusSearch,onClick:this.onContactClick})),Q["default"].createElement(X["default"],{transitionName:"btn",className:"drawer-section drawer-controls drawer-controls-centered"},e)))}}]),t}(K.Component),n.defaultProps={participants:[]},r))},7264:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(23),_=o(g),v=a(264),b=o(v),y=a(267),E=o(y),S=a(7123),C=o(S),M=a(7119),k=o(M),w=a(7132),N=o(w),T=a(486),P=(o(T),a(7153)),I=(o(P),a(12)),R=o(I),A=a(261),x=o(A),O=a(7118),D=o(O),L=a(93),U=o(L),F=a(172),j=o(F),B=a(7141),G=o(B),V=a(7616),Y=o(V),W=500,H=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={style:{visibility:"hidden"}},o.onScroll=function(e){Math.abs(e.deltaY)>3&&o.onClose()},o.onClose=function(){if(!o.closing){o.closing=!0;var e=void 0;if(o.props.getZoomNode(function(t){e=t}),!e)return R["default"].closeModalMedia();var t=o.refs.image,a=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.top-a.top,i=n.left-a.left,l=e.clientWidth/t.clientWidth;(0,b["default"])(t,{translateX:[i,0],translateY:[r,0],scale:[l,1]},{duration:200,easing:[.1,.82,.25,1]}).then(function(){R["default"].closeModalMedia()})}},o.onImageLoad=function(e){var t=e.target;o.setState({size:{width:t.naturalWidth,height:t.naturalHeight}},function(){o.props.getZoomNode(function(e){var a=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.top-a.top,i=n.left-a.left,l=e.clientWidth/t.clientWidth,s={visibility:"hidden",transform:"translateX("+i+"px) translateY("+r+"px) scale("+l+")",transition:"transform 0s",borderRadius:void 0};o.props.animateBorderRadius&&(s.borderRadius="50%"),o.setState({style:s},function(){var e={transform:"translateX(0px) translateY(0px) scale(1)",transition:"transform "+W+"ms cubic-bezier(.1,.82,.25,1)"};o.props.animateBorderRadius&&(e={transform:"translateX(0px) translateY(0px) scale(1)",borderRadius:"0%",transition:"transform "+W+"ms cubic-bezier(.1,.82,.25,1),\n                                         border-radius "+W+"ms cubic-bezier(.1,.82,.25,1)"}),o.setState({style:e})})})})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.profilePicThumb.imgFull?!0:(this.onClose(),!1)}},{key:"render",value:function(){var e=this.props,t=e.contact,a=e.profilePicThumb,o=(0,_["default"])(Y["default"].headerContainer,{});return m["default"].createElement(x["default"],{displayName:"PhotoViewer",escapable:!0,requestDismiss:this.onClose},m["default"].createElement("div",{className:Y["default"].container,onWheel:this.onScroll,onClick:this.onClose},m["default"].createElement("div",{className:o},m["default"].createElement("div",{className:Y["default"].profileThumb},m["default"].createElement(G["default"],{image:m["default"].createElement(C["default"],{id:t.id,size:40}),theme:"plain",primary:m["default"].createElement(k["default"],{text:t.formattedUser})})),m["default"].createElement("div",{className:Y["default"].close},m["default"].createElement(j["default"],{name:"x-viewer",title:U["default"].t("web_close"),onClick:this.onClose}))),m["default"].createElement("div",{className:Y["default"].profileContainer,dir:"ltr",ref:"container"},m["default"].createElement("div",{className:Y["default"].media},m["default"].createElement(N["default"],{type:w.FIT_TYPE.SCALE_DOWN,size:this.state.size},m["default"].createElement("div",{className:Y["default"].profileViewer,ref:"image",style:this.state.style},m["default"].createElement(E["default"],{src:a.imgFull,hasPrivacyChecks:!0,onLoad:this.onImageLoad,className:Y["default"].profileViewerImg})))))))}}]),t}(m["default"].Component);H.CONCERNS={contact:["formattedUser","id"],profilePicThumb:["imgFull"]},t["default"]=(0,D["default"])(H)},7265:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(176),b=o(v),y=a(7120),E=o(y),S=a(7122),C=o(S),M=a(7151),k=o(M),w=a(7121),N=o(w),T=a(7189),P=o(T),I=a(94),R=o(I),A=a(12),x=o(A),O=a(7161),D=o(O),L=a(7133),U=o(L),F=a(8),j=o(F),B=a(265),G=o(B),V=a(72),Y=o(V),W=a(14),H=o(W),q=a(524),z=o(q),K=a(7167),Q=(o(K),a(7153)),J=(o(Q),a(269)),X=(o(J),a(7118)),Z=o(X),$=a(485),ee=o($),te=a(7617),ae=o(te),oe=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.onBack=function(){a.props.onClose?a.props.onClose():a.context.uim.uie.requestDismiss()},a.validateStatus=function(e){return!!(e||"").trim()},a.onStatusBegin=function(){a.isEditingStatus=!0},a.onSetStatusError=function(){x["default"].openModal(m["default"].createElement(R["default"],{onOK:x["default"].closeModal.bind(x["default"]),okText:l10n.t("web_ok")},l10n.t("action_status_empty")))},a.onSetStatus=function(e){if((0,z["default"])(a.state.status))return void a.onCancelStatus();if(a.isEditingStatus=!1,Store.Status.canSetMyStatus()){var t=a.props.status.status,o=G["default"].emojify(a.state.status);if(o===t)return a.setState({status:o});a.setState({pendingStatus:!0}),Store.Status.setMyStatus(G["default"].emojify(a.state.status)).checkpoint(a.props.rejectOnUnmount()).then(function(){a.setState({pendingStatus:!1})})["catch"](H["default"].Unmount,_["default"].noop)}},a.onStatusChange=function(e){a.setState({status:e})},a.onCancelStatus=function(){a.isEditingStatus=!1,a.setState({status:a.props.status.status})},a.onPushnameBegin=function(){a.isEditingPushname=!0},a.validatePushname=function(e){return!!(e||"").trim()},a.onSetPushname=function(e){if(a.isEditingPushname=!1,Store.Conn.canSetMyPushname()){var t=a.props.conn.pushname,o=G["default"].emojify(a.state.pushname);if(o===t)return a.setState({pushname:o});a.setState({pendingPushname:!0}),Store.Conn.updatePushname(G["default"].emojify(a.state.pushname)).checkpoint(a.props.rejectOnUnmount()).then(function(){a.setState({pendingPushname:!1})})["catch"](H["default"].Unmount,_["default"].noop)}},a.onSetPushnameError=function(){x["default"].openModal(m["default"].createElement(R["default"],{onOK:x["default"].closeModal.bind(x["default"]),okText:l10n.t("web_ok")},l10n.t("action_pushname_empty")))},a.onPushnameChange=function(e){a.setState({pushname:e})},a.onCancelPushname=function(){a.isEditingPushname=!1,a.setState({pushname:a.props.pushname})},a.onImageSet=function(e,t){var o=a.props.profilePicThumb;a.setState({pendingPhoto:!0});var n;n=e&&t?o.setPicture(e,t):o.deletePicture(),n.checkpoint(a.props.rejectOnUnmount()).then(function(){a.setState({pendingPhoto:!1})})["catch"](H["default"].Unmount,_["default"].noop)},a.state={pushname:e.conn.pushname,status:e.status.status,pendingPushname:!1,pendingStatus:!1,pendingPhoto:!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.conn,a=e.status,o=e.profilePicThumb,n=void 0;if(Store.ServerProps.statusV2){var r=this.isEditingStatus||this.state.pendingStatus?this.state.status:a.status;n=m["default"].createElement(k["default"],{a8n:"col-main-profile",title:l10n.t("web_status"),theme:"padding"},m["default"].createElement(D["default"],{value:r,editable:Store.Status.canSetMyStatus(),pending:this.state.pendingStatus,showRemaining:!0,validate:this.validateStatus,maxLength:j["default"].MAX_STATUS_LENGTH,onBeginEdit:this.onStatusBegin,onChange:this.onStatusChange,onSave:this.onSetStatus,onError:this.onSetStatusError,onCancel:this.onCancelStatus,supportsEmoji:!0,lockable:!0,lowProfile:!0}))}var i=Store.ServerProps.statusV2?l10n.t("menuitem_profile_status"):l10n.t("menuitem_profile"),l=!o.canSet()&&!o.canDelete(),s=this.isEditingPushname||this.state.pendingPushname?this.state.pushname:t.pushname;return m["default"].createElement(E["default"],{onCancel:this.onBack},m["default"].createElement(C["default"],{a8n:"drawer-title-profile",title:i,onBack:this.onBack,type:S.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(N["default"],null,m["default"].createElement("div",{className:ae["default"].photoPickerWrapper},m["default"].createElement(P["default"],{type:T.Type.PROFILE,id:o.id,pending:this.state.pendingPhoto,startImage:o.imgFull,readOnly:l,onImageSet:this.onImageSet})),m["default"].createElement(k["default"],{a8n:"col-main-profile",title:l10n.t("pushname"),theme:"padding"},m["default"].createElement(D["default"],{value:s,editable:Store.Conn.canSetMyPushname(),pending:this.state.pendingPushname,showRemaining:!0,validate:this.validatePushname,maxLength:j["default"].MAX_PUSHNAME_LENGTH,onBeginEdit:this.onPushnameBegin,onChange:this.onPushnameChange,onSave:this.onSetPushname,onError:this.onSetPushnameError,onCancel:this.onCancelPushname,supportsEmoji:!0,lockable:!0,lowProfile:!0})),m["default"].createElement("div",{"data-a8n":b["default"].key("pushname-description"),className:ae["default"].nameWrapper},m["default"].createElement(U["default"],{theme:"muted"},l10n.t("pushname_description"))),n))}}]),t}(m["default"].Component);oe.contextTypes={uim:m["default"].PropTypes.instanceOf(Y["default"])},oe.CONCERNS={profilePicThumb:["imgFull","id"],status:["status"],conn:["pushname"]},t["default"]=(0,ee["default"])((0,Z["default"])(oe))},7266:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return e.scrollTop+S["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7),f=o(d),p=a(6),h=o(p),m=a(3),g=o(m),_=a(46),v=o(_),b=a(10),y=o(b),E=a(8),S=o(E),C=a(12),M=o(C),k=a(7120),w=o(k),N=a(7126),T=a(7122),P=o(T),I=a(7121),R=o(I),A=a(126),x=o(A),O=a(7175),D=o(O),L=a(7125),U=o(L),F=a(7282),j=o(F),B=a(175),G=o(B),V=a(14),Y=o(V),W=a(47),H=o(W),q=a(1),z=o(q),K=a(53),Q=o(K),J=a(177),X=o(J),Z=a(484),$=(o(Z),a(500)),ee=(o($),a(7149)),te=a(7127),ae=o(te),oe=a(489),ne=o(oe),re=a(7466),ie=o(re),le=a(72),se=o(le),ue=a(173),ce=o(ue),de=a(93),fe=o(de),pe=a(172),he=o(pe),me=a(174),ge=a(485),_e=o(ge),ve=a(71),be=o(ve),ye=a(7619),Ee=o(ye),Se=function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.msgRefs={},a.getInitialState=function(){return{cursor:new j["default"](a.props.starredMsgs,void 0,S["default"].RENDOR_CURSOR.STARRED_DRAWER).loadAfter(S["default"].MSG_PRELOAD_THRESHOLD)}},a.handleStarChange=function(e){a.initSelectionObjects(),a.setState({})},a.initSelectionObjects=function(){var e=a.props.starredMsgs.models;a.currSelection.init(e,!0),a.activeSelection.init(e)},a.setMsgComponentRef=function(e,t){t?a.msgRefs[e.id]=t:delete a.msgRefs[e.id]},a.loadEarlierMsgs=function(){var e=a.state.cursor,t=a.props.chat&&a.props.chat.id,o=a.props.starredMsgs.models;if(e.end<o.length)a.setState({cursor:e.loadAfter()});else{if(a.props.starredMsgs.isSynced)return;a.props.starredMsgs.sync(t).checkpoint(a.props.rejectOnUnmount()).then(function(){e.hasAfter()&&a.setState({cursor:e.loadAfter()})})["catch"](Y["default"].Unmount,y["default"].noop)["catch"](function(e){z["default"].log("StarredDrawer:loadEarlierMsgs failed")(),z["default"].log(e)()})}},a.onClose=function(){a.props.onClose?a.props.onClose():a.context.uim.uie.requestDismiss()},a.focus=function(){a.body&&X["default"].focus(v["default"].findDOMNode(a.body))},a.onFocusGain=function(e){if(a.body){var t=e?e.target:document.activeElement;t===v["default"].findDOMNode(a.body)&&(a.currSelection.index<0?a.currSelection.setFirst(!0,e):a.currSelection.reset(!1,e))}},a.onNextMsg=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=a.currSelection.next();a.currSelection.index!==t&&a.currSelection.setNext(!0,e)},a.onPrevMsg=function(e){e&&(e.stopPropagation(),e.preventDefault());var t=a.currSelection.prev();t>-1&&a.currSelection.setPrev(!0,e)},a.onScroll=function(e){a.handleScroll(e.target)},a._handleScroll=function(e){a.updateMsgListInfo(),n(e)&&a.loadEarlierMsgs()},a.selectMsg=function(e){a.currSelection.setVal(e),a.activeSelection.setVal(e),M["default"].openChatAt(e.chat,e.chat.getSearchContext(e)),M["default"].focusShowMsg(e.id)},a.getMsgList=function(){var e=a.state.cursor,t=a.props.starredMsgs.models,o=a.props.starredMsgs.isSynced?e.end:Math.min(e.end,t.length);return t=t.slice(e.start,o),a.length=t.length,t},a.getMsgVisibility=function(e){if(!e)return S["default"].VISIBILITY.BELOW;if(a.scrollContainer){var t=v["default"].findDOMNode(a.scrollContainer),o=t.previousSibling.clientHeight,n=t.scrollTop+o,r=n+t.clientHeight,i=v["default"].findDOMNode(e);return i?i.offsetTop+i.clientHeight<=n?S["default"].VISIBILITY.ABOVE:i.offsetTop>=r?S["default"].VISIBILITY.BELOW:S["default"].VISIBILITY.VISIBLE:S["default"].VISIBILITY.BELOW}},a.isMsgVisible=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return!!a.msgListInfo.visibleMsgs[e.toString()]&&(t?!0:a.getMsgComponent(e))},a.getMsgComponent=function(e){var t=a.msgRefs[e.toString()];if(t){var o=t.wrapper;if(o)return o.getMsgComponentRef()}},a._updateMsgListInfo=function(){for(var e=a.getMsgList(),t={},o=0,n=a.length-1;n>o;){var r=Math.floor((o+n)/2),i=a.msgRefs[e[r].id.toString()];a.getMsgVisibility(i)===S["default"].VISIBILITY.ABOVE?o=r+1:n=r}for(var l=o;l<e.length;l++){var s=a.msgRefs[e[l].id.toString()];if(a.getMsgVisibility(s)!==S["default"].VISIBILITY.VISIBLE)break;t[e[l].id.toString()]=!0}a.pauseHiddenGifs(a.msgListInfo.visibleMsgs,t),a.msgListInfo.visibleMsgs=t},a.pauseHiddenGifs=function(e,t){for(var o in e)if(!t[o]){var n=a.props.starredMsgs.get(o);if(n&&n.isGif){var r=a.getMsgComponent(o);r&&r.playCount&&r.pause()}}},a.handleScroll=y["default"].throttle(a._handleScroll,100),a.updateMsgListInfo=y["default"].throttle(a._updateMsgListInfo,100),a.msgListInfo={visibleMsgs:{}},a.state=a.getInitialState(),a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){this.currSelection=new U["default"]([],function(e){return e.id.toString()}),this.activeSelection=new U["default"]([],function(e){return e.id.toString()})}},{key:"componentDidMount",value:function(){var e=this;this.focus(),this.props.listeners.add(window,"resize",this.updateMsgListInfo),!this.props.starredMsgs.isSynced&&this.props.starredMsgs.length<S["default"].PAGE_SIZE&&this.props.listeners.uiIdle(this.loadEarlierMsgs),this.props.listeners.addAndRun(this.props.starredMsgs,"reset sync",function(){e.initSelectionObjects(),e.setState({})}),this.props.listeners.add(this.props.starredMsgs,"add remove",this.handleStarChange),this.onFocusGain(),this.props.listeners.add(this.props.starredMsgs,"reset",function(){e.msgListInfo={visibleMsgs:{}},e.setState(e.getInitialState()),e.loadEarlierMsgs()})}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel(),this.updateMsgListInfo.cancel()}},{key:"componentDidUpdate",value:function(){this.updateMsgListInfo()}},{key:"render",value:function(){var e=this,t=this.getMsgList(),a=this.state.cursor,o=this.props.chat||null,n=void 0,r=void 0;if(r=this.props.starredMsgs.isSynced&&a.end>=t.length?null:this.props.starredMsgs.syncPromise?g["default"].createElement("div",{className:Ee["default"].more,title:fe["default"].t("loading_messages")},g["default"].createElement(G["default"],{stroke:6,size:24})):g["default"].createElement("div",{className:Ee["default"].more},g["default"].createElement("div",{title:fe["default"].t("load_earlier_messages"),onClick:this.loadEarlierMsgs},g["default"].createElement(he["default"],{name:"refresh"}))),t.length>0){var i=t.map(function(t){var a=t.type===Q["default"].TYPE.IMAGE||t.type===Q["default"].TYPE.VIDEO||t.type===Q["default"].TYPE.AUDIO;return g["default"].createElement(D["default"],{key:t.id,ref:(0,me.refWrapper)(function(a){return e.setMsgComponentRef(t,a)}),msg:t,isMsgVisible:a?e.isMsgVisible:y["default"].noop,currSelection:e.currSelection,activeSelection:e.activeSelection,onClickMsg:e.selectMsg})});n=g["default"].createElement(x["default"],{transitionName:"slide"},i)}else this.props.starredMsgs.isSynced?n=g["default"].createElement(N.StarredMsgs,null):(n=g["default"].createElement(N.Loading,null),r=null);var l={down:this.onNextMsg,up:this.onPrevMsg},s=t.length||this.props.starredMsgs.isSynced,u=H["default"].supportsFeature(H["default"].F.UNSTAR_ALL)?g["default"].createElement(ee.MenuBarItem,{a8n:"starred-menu",icon:g["default"].createElement(he["default"],{name:"menu-white"}),title:fe["default"].t("menutitle_menu"),disabled:!s},g["default"].createElement(Ce,{chat:o,msgs:t})):null;return g["default"].createElement(w["default"],{className:Ee["default"].container,onCancel:this.onClose},g["default"].createElement(ce["default"],{className:Ee["default"].hotKeyWraper,handlers:l,onFocus:this.onFocusGain,"data-tab":2,ref:(0,me.GetRef)("body",this)},g["default"].createElement(P["default"],{title:fe["default"].t("starred_flow_title"),onBack:this.onClose,type:T.DRAWER_HEADER_TYPE.LARGE,menu:u}),g["default"].createElement(R["default"],{onScroll:this.onScroll,ref:(0,me.GetRef)("scrollContainer",this)},n,r)))}}]),t}(g["default"].Component);Se.contextTypes={uim:g["default"].PropTypes.instanceOf(se["default"])};var Ce=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.sendUnstarAll=function(){M["default"].openModal(g["default"].createElement(ie["default"],{msgs:o.props.msgs,chat:o.props.chat}))},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props.msgs;return g["default"].createElement(ne["default"],{type:"dropdown_menu",flipOnRTL:!0,key:"StarredDrawerHeader",dirX:"left"},g["default"].createElement(ae["default"],{a8n:"mi-unstar-all menu-item",action:this.sendUnstarAll,disabled:0===e.length},fe["default"].t("unstar_all")))}}]),t}(g["default"].Component);t["default"]=(0,_e["default"])((0,be["default"])(Se))},7267:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(5),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(2),m=o(h),g=a(3),_=o(g),v=a(126),b=o(v),y=a(14),E=o(y),S=a(173),C=o(S),M=a(1),k=o(M),w=a(7203),N=o(w),T=a(7131),P=(o(T),a(53)),I=o(P),R=a(108),A=(o(R),a(7280)),x=o(A),O=a(175),D=o(O),L=a(263),U=o(L),F=a(12),j=o(F),B=a(93),G=o(B),V=a(485),Y=o(V),W=a(172),H=o(W),q=a(10),z=a(262),K=E["default"].define("InvalidStatusV3Iterator"),Q=function $(e,t){var a=this;if((0,m["default"])(this,$),J.call(this),t){var o=q.find(e.msgs.models,function(e){return t&&e.id.toString()===t.toString()});this.statuses=[{statusV3:e,totalCount:1,unreadCount:0,msgs:[o],readMsgKeys:[o.id.toString()]}]}else if(e.unreadCount>0&&!e.contact.isMe&&!e.contact.statusMute)!function(){var e=Store.StatusV3.getUnexpired(!0),t=[];q.forEach(e,function(e){if(!e.contact.statusMute){var a=e.msgs.models,o=e.totalCount-e.unreadCount,n=q.take(a,o),r=q.map(n,function(e){return e.id.toString()});t.push({statusV3:e,totalCount:e.totalCount,unreadCount:e.unreadCount,msgs:a,readMsgKeys:r})}}),a.statuses=t}();else{var n=e.msgs.models,r=e.totalCount-e.unreadCount,i=q.take(n,r),l=q.map(i,function(e){return e.id.toString()}),s=[{statusV3:e,totalCount:e.totalCount,unreadCount:e.unreadCount,msgs:n,readMsgKeys:l}];this.statuses=s}},J=function(){var e=this;this.getFirstUnread=function(t,a,o){var n=q.findIndex(e.statuses,{statusV3:t});if(-1===n)return r["default"].reject("Invalid statusV3 object");var i=function(){var i=e.statuses[n],l=i.readMsgKeys,s=void 0;return o?(s=q.findIndex(i.msgs,function(e){return o&&e.id.toString()===o.toString()}),{v:r["default"].resolve({msgIdx:s,statusIdx:n})}):(s=q.findIndex(i.msgs,function(e){return-1===l.indexOf(e.id.toString())}),-1===s&&t.msgs.msgLoadState.noEarlierMsgs?(s=a?0:i.msgs.length-1,{v:r["default"].resolve({msgIdx:s,statusIdx:n})}):-1!==s?{v:r["default"].resolve({msgIdx:s,statusIdx:n})}:0===i.unreadCount&&a?{v:r["default"].resolve({msgIdx:0,statusIdx:n})}:{v:e.fetchMore(t).then(function(){return e.getFirstUnread(t,a,o)})["catch"](function(e){return k["default"].error("error while getting first unread status: "+e)(),r["default"].resolve({msgIdx:0,statusIdx:n})})})}();return"object"==typeof i?i.v:void 0},this.hasNext=function(t){var a=e.statuses[t.statusIdx];return t.msgIdx+1<a.totalCount?!0:t.statusIdx+1<e.statuses.length},this.getNext=function(t){var a=e.statuses[t.statusIdx],o=a.statusV3;if(t.msgIdx+1<a.msgs.length)return r["default"].resolve({msgIdx:t.msgIdx+1,statusIdx:t.statusIdx});if(o.msgs.msgLoadState.noEarlierMsgs){if(t.statusIdx+1<e.statuses.length){var n=e.statuses[t.statusIdx+1].statusV3;return e.getFirstUnread(n,!0)}return r["default"].reject(new K)}return e.fetchMore(o).then(function(){return e.getNext(t)})["catch"](function(a){if(k["default"].error("error while loading more status msgs: "+a)(),t.statusIdx+1<e.statuses.length){var o=e.statuses[t.statusIdx+1].statusV3;return e.getFirstUnread(o,!0)}return r["default"].reject(new K)})},this.hasPrev=function(e){return e.msgIdx>0?!0:e.statusIdx>0},this.getPrev=function(t){if(t.msgIdx>0)return r["default"].resolve({msgIdx:t.msgIdx-1,statusIdx:t.statusIdx});if(t.statusIdx>0){var a=e.statuses[t.statusIdx-1].statusV3;return e.getFirstUnread(a,!1)}return r["default"].reject(new K)},this.fetchMore=function(t){return t.loadMore().then(function(){var a=q.findIndex(e.statuses,{statusV3:t});if(-1!==a){var o=e.statuses[a],n=o.totalCount,r=o.unreadCount,i=q.take(t.msgs.models,n),l=n-r,s=q.take(i,l),u=q.map(s,function(e){return e.id.toString()});o.msgs=i,o.readMsgKeys=q.uniq(q.concat(o.readMsgKeys,u))}})}},X=function(e){function t(){(0,m["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments));Z.call(e);var a=e.props.initialStatusV3;if(e.props.quotedMsgKey)!function(){e.state={};var t=e.props.quotedMsgKey,o=q.findIndex(a.msgs.models,function(e){return e.id.toString()===t.toString()});if(-1!==o){e.statusSnapshot=new Q(a,t);var n=e.statusSnapshot.getFirstUnread(a,!0,t);n.checkpoint(e.props.rejectOnUnmount()).then(function(t){e.setState({iterator:t,loading:!1})})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)}else e.state={loading:!0},a.loadMore(a.totalCount).then(function(){e.setState({loading:!1});var o=q.findIndex(a.msgs.models,function(e){return e.id.toString()===t.toString()});if(-1!==o){e.statusSnapshot=new Q(a,t);var n=e.statusSnapshot.getFirstUnread(a,!0,t);n.checkpoint(e.props.rejectOnUnmount()).then(function(t){e.setState({iterator:t,loading:!1})})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)}else e.props.onMsgNotFound&&e.props.onMsgNotFound(),j["default"].openToast(_["default"].createElement(U["default"],{msg:G["default"].t("status_v3_msg_not_found"),id:(0,L.genId)()})),e.props.closeStatusViewer()})["catch"](function(){j["default"].openToast(_["default"].createElement(U["default"],{msg:G["default"].t("status_v3_msg_not_found"),id:(0,L.genId)()})),e.props.closeStatusViewer()})["finally"](function(){e.setState({loading:!1})})}();else{var o=e.props.initialStatusMsg;e.statusSnapshot=new Q(a);var n=e.statusSnapshot.getFirstUnread(a,!0,o&&o.id);n.isFulfilled()?e.state={}:e.state={loading:!0},n.checkpoint(e.props.rejectOnUnmount()).then(function(t){e.setState({iterator:t,loading:!1})})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)}return e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.preloadNextStatus()}},{key:"componentDidUpdate",value:function(){this.preloadNextStatus()}},{key:"render",value:function(){var e=this,t=this.state.iterator,a=void 0,o=void 0,n=void 0,r=void 0,i=void 0,l=void 0,s=void 0,u=void 0;t&&(i=this.statusSnapshot,l=i.statuses[t.statusIdx],s=l.statusV3,u=l.msgs[t.msgIdx],i.hasPrev(t)&&(n=_["default"].createElement("div",{className:"status-v3-chevron-left"},_["default"].createElement(H["default"],{name:"chevron-left"})),r=_["default"].createElement("div",{className:"icon-chevron-left-bg",onClick:this.onPrev})),i.hasNext(t)&&(a=_["default"].createElement("div",{className:"status-v3-chevron-right"},_["default"].createElement(H["default"],{name:"chevron-right"})),o=_["default"].createElement("div",{className:"icon-chevron-right-bg",onClick:function(){e.onNext(),e.markRead(s,u)}})));var c={left:this.onPrev,right:this.onNext},d=void 0;d=!this.state.transitioning&&!this.state.loading&&u&&t&&l?_["default"].createElement("div",{className:"status-v3-player-container",key:u.id},_["default"].createElement(N["default"],{key:u.id,statusV3:s,msg:u,mediaData:u.mediaData,msgIdx:t.msgIdx,totalMsgs:l.totalCount,markRead:this.markRead,closeStatusViewer:this.closeStatusViewer,onNext:this.onNext,onPrev:this.onPrev})):null;var f=void 0;return this.state.loading&&(f=_["default"].createElement("div",{className:"media-state-controls"},_["default"].createElement("button",{className:"icon-media-disabled"},_["default"].createElement(D["default"],{size:50,stroke:4,color:"white"})))),_["default"].createElement(C["default"],{handlers:c},_["default"].createElement("div",{className:"status-v3-viewer"},r,n,o,a,f,_["default"].createElement(b["default"],{transitionName:"status-v3-player",transitionAppear:!0},d)))}}]),t}(_["default"].Component),Z=function(){var e=this;this.preloadNextStatus=function(){var t=e.state.iterator;if(t&&e.statusSnapshot.hasNext(t)){var a=e.statusSnapshot.getNext(t);a.checkpoint(e.props.rejectOnUnmount()).then(function(t){var a=e.statusSnapshot.statuses[t.statusIdx],o=a.msgs[t.msgIdx];if(o.type===I["default"].TYPE.CHAT)x["default"].load(o.font)["catch"](q.noop);else{var n=o.mediaData;n&&n.mediaStage!==z.STAGE.RESOLVED&&o.forceDownloadMedia()}})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)["catch"](K,function(){k["default"].error("Invalid iterator while preloading next status")()})}},this.onPrev=function(){var t=e.state.iterator;t&&e.statusSnapshot.hasPrev(t)&&!function(){var a=t.statusIdx,o=e.statusSnapshot.getPrev(t);o.checkpoint(e.props.rejectOnUnmount()).then(function(t){t.statusIdx===a?e.setState({iterator:t}):(e.setState({transitioning:!0}),r["default"].delay(200).checkpoint(e.props.rejectOnUnmount()).then(function(){e.setState({iterator:t,transitioning:!1})})["catch"](E["default"].Unmount,q.noop))})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)["catch"](K,function(){k["default"].error("Invalid iterator while getting previous status msg")()})}()},this.onNext=function(){var t=e.state.iterator;t&&e.statusSnapshot.hasNext(t)?!function(){var a=t.statusIdx,o=e.statusSnapshot.getNext(t);o.isFulfilled()||e.setState({loading:!0}),o.checkpoint(e.props.rejectOnUnmount()).then(function(t){t.statusIdx===a?e.setState({iterator:t}):(e.setState({transitioning:!0,loading:!1}),r["default"].delay(200).checkpoint(e.props.rejectOnUnmount()).then(function(){e.setState({iterator:t,transitioning:!1})})["catch"](E["default"].Unmount,q.noop))})["catch"](E["default"].Unmount,q.noop)["catch"](E["default"].EphemeralDrop,q.noop)["catch"](K,function(){k["default"].error("Invalid iterator while getting next status msg")(),e.closeStatusViewer()})["finally"](function(){e.setState({loading:!1})})}():e.closeStatusViewer()},this.markRead=function(t,a){if(a){var o=t.unreadCount,n=t.totalCount,r=q.findIndex(t.msgs.models,a);r>=n-o&&t.sendReadStatus(a.id,a.author);var i=q.find(e.statusSnapshot.statuses,{statusV3:t});i&&i.readMsgKeys.push(a.id.toString())}},this.closeStatusViewer=function(t){e.setState({transitioning:!0}),r["default"].delay(200).checkpoint(e.props.rejectOnUnmount()).then(function(){e.props.closeStatusViewer(t)})["catch"](E["default"].Unmount,q.noop)}};e.exports=(0,Y["default"])(X)},7268:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BlocklistProxy=t["default"]=void 0;var n=a(2),r=o(n),i=a(4),l=o(i),s=a(7206),u=function(){function e(){(0,r["default"])(this,e),this.id=(0,s.prop)(),this.contact=(0,s.session)()}return(0,l["default"])(e,[{key:"initialize",value:function(){this.addChild("contact",Store.Contact.gadd(this.id))}}]),e}();u.Collection="Blocklist";var c=(0,s.defineStateClass)("Blocklist",u),d=c.Blocklist,f=c.BlocklistProxy;t["default"]=d,t.BlocklistProxy=f},7269:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.CallProxy=t["default"]=void 0;var n=a(1),r=o(n),i=a(74),l=o(i),s=a(12),u=o(s),c=(0,i.defineState)("Call",{Collection:"Call",props:{id:"string",type:"string",from:"string"},initialize:function(){l["default"].prototype.initialize.call(this),this.listenToAndRun(this,"change:type",this.updateNotification)},updateNotification:function(){r["default"].log("call:"+this.type+" id:"+this.id+" from:"+this.from)(),"offer"===this.type||"offer_video"===this.type?u["default"].alertCall(this.id,this.from,"offer_video"===this.type):u["default"].cancelCall(this.id)}}),d=c.Call,f=c.CallProxy;t["default"]=d,t.CallProxy=f},7270:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.ConversionTupleExpiry=t.ConversionTupleProxy=t["default"]=void 0;var n=a(2),r=o(n),i=a(4),l=o(i),s=a(74),u=o(s),c=a(7206),d=a(62),f=a(184),p=o(f),h=a(1),m=o(h),g=6048e5,_=function(){function e(){(0,r["default"])(this,e),this.id=(0,c.prop)(),this.conversionData=(0,c.prop)(),this.conversionSource=(0,c.prop)(),this.timestamp=(0,c.prop)(function(){return 1e3*(0,d.globalUnixTime)()}),this.alarmId=(0,c.prop)()}return(0,l["default"])(e,[{key:"initialize",value:function(){u["default"].prototype.initialize.call(this),this.listenTo(this,"change:timestamp",this._setExpiryTimer),this._setExpiryTimer()}},{key:"_setExpiryTimer",value:function(){var e=this,t=this.timestamp+g;return 0>t?(m["default"].error("Invalid conversionTuple timer")(),void this["delete"]()):void(this.alarmId=p["default"].setTimeout(function(){e["delete"]()},t,this.alarmId))}},{key:"_clearAlarm",value:function(){this.alarmId&&(p["default"].clearTimeout(this.alarmId),this.alarmId=void 0)}},{key:"elapsedSeconds",value:function(){return(0,d.globalUnixTime)()-this.timestamp}},{key:"toJSON",
value:function(){var e={conversionDelaySeconds:this.elapsedSeconds()};return this.conversionData&&(e.conversionData=this.conversionData),this.conversionSource&&(e.conversionSource=this.conversionSource),e}},{key:"delete",value:function(){u["default"].prototype["delete"].call(this),Store.ConversionTuple.remove(this.id),this._clearAlarm()}}]),e}(),v=(0,c.defineStateClass)("ConversionTuple",_),b=v.ConversionTuple,y=v.ConversionTupleProxy;t["default"]=b,t.ConversionTupleProxy=y,t.ConversionTupleExpiry=g},7271:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmojiVariantProxy=t["default"]=void 0;var o=a(74),n=(0,o.defineState)("EmojiVariant",{props:{id:"string","char":"string",variant:"string"},initialize:function(e){this.id=e.id||e["char"]}}),r=n.EmojiVariant,i=n.EmojiVariantProxy;t["default"]=r,t.EmojiVariantProxy=i},7272:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(53),l=o(i),s=a(63),u=a(14),c=a(47),d=100,f=s.extend({model:l["default"],initialize:function(){var e=this;s.prototype.initialize.call(this),this.hasMoreMsgs=!0,this.resultPage=0,this.listenTo(Store.Msg,"remove_msgs",function(t){var a=e.remove(t,{silent:!0});a&&e.trigger("bulk_remove")}),this.listenTo(Store.Chat,"remove",function(t){var a=[];e.forEach(function(e){e.chat===t&&a.push(e)});var o=e.remove(a,{silent:!0});o&&e.trigger("bulk_remove")})},"delete":function(e){e&&this.stopListening(),s.prototype["delete"].call(this)},resetSearch:function(e){this.hasMoreMsgs=!0,this.resultPage=0,this.searchTerm=e,this.searchPromise&&this.searchPromise.cancel()},search:function(e,t){var a=this;if(this.searchTerm!==e&&(this.searchTerm&&0===e.indexOf(this.searchTerm)||(this.searchTerm=e,this["delete"]()),this.resultPage=0,this.hasMoreMsgs=!0),this.searchPromise){if(this.searchTerm===e)return this.searchPromise;this.searchPromise.cancel()}var o=void 0;return o=t?t.fts(e,++this.resultPage,d):Store.Msg.search(e,++this.resultPage,d),this.searchPromise=o.cancellable().then(function(t){c.supportsFeature(c.F.FTS_PAGINATION)&&!t.eof||(a.hasMoreMsgs=!1),a.searchTerm!==e&&a["delete"](),a.searchTerm=e,a.add(t.messages)})["catch"](u.WapDrop,r["default"].CancellationError,_.noop)["finally"](function(){a.searchPromise=null,a.trigger("searchPromise_update")}),this.trigger("searchPromise_update"),this.searchPromise}});e.exports=f},7273:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MuteProxy=t["default"]=void 0;var n=a(0),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(74),d=o(c),f=a(7206),p=a(179),h=a(3),m=a(1),g=a(32),_=a(38),v=a(12),b=a(47),y=a(14),E=a(184),S=a(54),C=a(10),M=function(){function e(){(0,l["default"])(this,e),this.id=(0,f.prop)(),this.expiration=(0,f.prop)(0),this._unmuteTimer=(0,f.session)(),this.promises=(0,f.session)(function(){return{}}),this.isMuted=(0,f.derived)(this._isMuted,["expiration"])}return(0,u["default"])(e,[{key:"_isMuted",value:function(){return!!this.expiration}},{key:"initialize",value:function(){d["default"].prototype.initialize.call(this),this.expiration&&this.mute(this.expiration)}},{key:"setMute",value:function(e,t){(e||this.expiration)&&e!==this.expiration&&(e?this.mute(e,t):this.unmute(t))}},{key:"mute",value:function t(e,a,o){var n=this;if(!C.isNumber(e))return m.log("models:Mute:mute called with invalid expiration "+e)(),r["default"].reject(new y.ActionError);e=Math.round(e),e>2e9&&m.log("models:Mute:mute called with wrong units?"+this.id+" exp:"+e)();var t=function(){this.isMuted&&this._clearUnmuteTimer();var t=e-S().unix();m.log("models:Mute:mute "+this.id+" duration:"+t)(),this._unmuteTimer=E.setTimeout(this.unmute.bind(this),1e3*e),this.set({expiration:e})}.bind(this),i=g.isGroup(this.id);if(a){if(this.promises.mute)return this.promises.mute;var l=this.promises.mute=_.sendConversationMute(this.id,e,this.expiration),s=i?new p.ActionType(l10n.t("action_group_muting")):new p.ActionType(l10n.t("action_chat_muting"));o=o||(0,p.genId)();var u=this.promises.mute["catch"](function(t){m.error("models:Mute:mute dropped")(t);var r=i?l10n.t("action_group_mute_failed"):l10n.t("action_chat_mute_failed");throw new p.ActionType(r,l10n.t("action_try_again"),n.mute.bind(n,e,a,o))}).then(function(e){if(200===e.status){var t=i?l10n.t("action_group_muted"):l10n.t("action_chat_muted");return new p.ActionType(t,l10n.t("action_undo"),n.unmute.bind(n,a,o))}if(e.status>=400)throw i?new p.ActionType(l10n.t("action_group_mute_failed")):new p.ActionType(l10n.t("action_chat_mute_failed"))});return v.openToast(h.createElement(p.ActionToast,{id:o,initialAction:s,pendingAction:u})),l.then(function(e){200!==e.status||e._duplicate||t()})["finally"](function(){n.promises.mute=null})}return t(),r["default"].resolve()}},{key:"canMute",value:function(){return b.supportsFeature(b.F.MUTE)&&g.isGroup(this.id)||b.supportsFeature(b.F.MUTE_1_1)&&g.isUser(this.id)}},{key:"_clearUnmuteTimer",value:function(){E.clearTimeout(this._unmuteTimer),this.unset("_unmuteTimer"),this.expiration=0}},{key:"unmute",value:function a(e,t){var o=this,a=function(){m.log("models:Mute:unmute "+this.id)(),this._clearUnmuteTimer()}.bind(this),n=g.isGroup(this.id);if(e){if(this.promises.unmute)return this.promises.unmute;var i=this.promises.unmute=_.sendConversationMute(this.id,!1,this.expiration),l=n?new p.ActionType(l10n.t("action_group_unmuting")):new p.ActionType(l10n.t("action_chat_unmuting"));t=t||(0,p.genId)();var s=this.promises.unmute["catch"](function(a){m.error("models:Mute:unmute dropped")(a);var i=n?l10n.t("action_group_unmute_failed"):l10n.t("action_chat_unmute_failed");return r["default"].reject(new p.ActionType(i,l10n.t("action_try_again"),o.unmute.bind(o,e,t)))}).then(function(e){if(200===e.status)return n?new p.ActionType(l10n.t("action_group_unmuted")):new p.ActionType(l10n.t("action_chat_unmuted"));if(e.status>=400)throw n?new p.ActionType(l10n.t("action_group_unmute_failed")):new p.ActionType(l10n.t("action_chat_unmute_failed"))});return v.openToast(h.createElement(p.ActionToast,{id:t,initialAction:l,pendingAction:s})),i.then(function(e){200!==e.status||e._duplicate||a()})["finally"](function(){o.promises.unmute=null})}return a(),r["default"].resolve()}},{key:"delete",value:function(){d["default"].prototype["delete"].call(this),Store.Mute.remove(this.id),this._clearUnmuteTimer()}}]),e}(),k=(0,f.defineStateClass)("Mute",M),w=k.Mute,N=k.MuteProxy;t["default"]=w,t.MuteProxy=N},7274:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecentEmojiProxy=t["default"]=void 0;var o=a(74),n=(0,o.defineState)("RecentEmoji",{props:{id:"string","char":"string",weight:"number"},initialize:function(e){this.id=e.id||e["char"]}}),r=n.RecentEmoji,i=n.RecentEmojiProxy;t["default"]=r,t.RecentEmojiProxy=i},7275:function(e,t,a){"use strict";function o(e){return"number"==typeof e&&e>0?e-1:s.MAX_GROUP_SIZE}function n(e){return"number"==typeof e&&e>0?1024*e*1024:s.MAX_MEDIA_UPLOAD_SIZE}function r(e){return"number"==typeof e&&e>0?1024*e*1024:s.MAX_FILE_SIZE}function i(e){return"number"==typeof e&&e>0?1024*e:s.IMG_MAX_BYTES}Object.defineProperty(t,"__esModule",{value:!0}),t.ServerPropsProxy=t["default"]=void 0;var l=a(74),s=a(8),u=a(34),c=a(38),d=a(47),f={gifSearch:"SHOW_GIF_SEARCH",imageMaxEdge:"IMG_MAX_EDGE",imageMaxKBytes:["IMG_MAX_BYTES",i],maxParticipants:["MAX_GROUP_SIZE",o],maxSubject:"MAX_SUBJECT_LENGTH",media:["MAX_MEDIA_UPLOAD_SIZE",n],maxFileSize:["MAX_FILE_SIZE",r],statusV2:"STATUS_V2",statusV3:"STATUS_V3",edit:"REVOKE_SERVER_PROP",notificationQuery:"USE_NOTIFICATION_QUERY",webPresence:"WEB_PRESENCE"},p=(0,l.defineState)("ServerProps",{props:_.mapValues(f,function(e){var t=_.isArray(e)?e[0]:e;return{type:typeof s[t],"default":s[t]}}),"delete":function(){this.set(_.mapValues(f,function(e){return s[_.isArray(e)?e[0]:e]}))},updateProps:function(e){var t;u.Global.webcBucket=e.bucket||null;for(t in f){var a,o,n=f[t];_.isArray(n)?(a=n[0],o="undefined"==typeof e[t]?s[a]:n[1](e[t])):(a=n,o="undefined"==typeof e[t]?s[a]:e[t]),a&&(this[t]=o)}for(t in d.F)"undefined"!=typeof e[t]&&d.setFeature(t,e[t])},handle:function(e){var t=e.shift();"number"==typeof t.status&&t.status>=400||this.updateProps(t)},fetch:function(){var e=this;return c.queryServerProps().then(function(t){"number"==typeof t.status&&t.status>=400||e.updateProps(t)})}}),h=p.ServerProps,m=p.ServerPropsProxy,g=new h({id:1});t["default"]=g,t.ServerPropsProxy=m},7276:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(24),l=o(i),s=a(57),u=o(s),c=a(0),d=o(c),f=a(5),p=o(f),h=a(2),m=o(h),g=a(4),_=o(g),v=a(7),b=o(v),y=a(6),E=o(y),S=a(3),C=o(S),M=a(10),k=o(M),w=a(12),N=o(w),T=a(94),P=o(T),I=a(23),R=o(I),A=a(7258),x=o(A),O=a(491),D=o(O),L=a(7201),U=o(L),F=a(47),j=o(F),B=a(71),G=o(B),V=a(53),Y=o(V),W=a(7128),H=(o(W),a(172)),q=o(H),z=a(263),K=o(z);t["default"]=(0,G["default"])((r=n=function(e){function t(){var e,a,o,n;(0,m["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,b["default"])(this,(e=t.__proto__||(0,p["default"])(t)).call.apply(e,[this].concat(i))),o.onStarChanged=function(e){o.props.selectedMessages.isSelected(e)&&o.setState({})},o.onStarSelected=function(){var e=o.props,t=e.chat,a=e.selectedMessages,n=e.toastPosition,r=a.getSelected();N["default"].sendStarMsgs(t,r,null,n),o.props.onCancel()},o.onUnstarSelected=function(){var e=o.props,t=e.chat,a=e.selectedMessages,n=e.toastPosition,r=a.getSelected();N["default"].sendUnstarMsgs(t,r,null,n),o.props.onCancel()},o.onDownloadSelected=function(){var e=k["default"].filter(o.props.selectedMessages.getSelected(),function(e){return e.mediaData});if(e.length){var t=k["default"].filter(e,function(e){return!e.mediaData.renderableUrl});t.length>0?(N["default"].openToast(C["default"].createElement(K["default"],{msg:l10n.t("download_progress"),id:(0,z.genId)()})),d["default"].all(k["default"].map(t,function(e){return e.forceDownloadMedia()})).then(function(){var t=k["default"].filter(e,function(e){return e.mediaData.renderableUrl});e.length>t.length&&N["default"].openToast(C["default"].createElement(K["default"],{msg:l10n.t("files_failed_to_download",{_plural:e.length-t.length,count:e.length-t.length}),id:(0,z.genId)()})),t.length&&D["default"].initDownload(t)})):D["default"].initDownload(e),o.props.onCancel()}},o.onDeleteSelected=function(){var e=o.props,t=e.chat,a=e.selectedMessages,n=e.toastPosition,r=a.getSelected(),i=k["default"].every(r,function(e){return e.canRevoke()});N["default"].openModal(C["default"].createElement(x["default"],{chat:t,msgList:r,deletePrompt:!0,revokePrompt:i&&!o.props.disableRevoke,toastPosition:n,onCancel:o.props.onCancel}))},o.onForwardSelected=function(){var e=o.props.selectedMessages.getSelected();o.props.noSortOnForward||(e=o.props.chat.sortMsgs(e));var t=k["default"].size(e),a=function(){o.props.onCancel()},n=k["default"].filter(e,function(e){return e.canForward()});if(k["default"].size(n))if(t!==k["default"].size(n)){var r=function(){N["default"].openModal(C["default"].createElement(U["default"],{msgs:n,pushTransition:"none",popTransition:"none",onForward:a}),"modal-flow")};N["default"].openModal(C["default"].createElement(P["default"],{title:l10n.t("confirm_forward_partial_messages_title"),onOK:r,okText:l10n.t("forward"),onCancel:N["default"].closeModal.bind(N["default"]),cancelText:l10n.t("web_cancel")},l10n.t("confirm_forward_partial_messages_text")))}else N["default"].openModal(C["default"].createElement(U["default"],{msgs:e,pushTransition:"none",popTransition:"none",onForward:a}),"modal-flow");else N["default"].openModal(C["default"].createElement(P["default"],{title:l10n.t("err_unsent_forward_title"),onOK:N["default"].closeModal.bind(N["default"]),okText:l10n.t("web_ok")},l10n.t("err_unsent_forward_text",{_plural:t})))},n=a,(0,b["default"])(o,n)}return(0,E["default"])(t,e),(0,_["default"])(t,[{key:"componentWillMount",value:function(){var e=this;k["default"].forEach(this.props.selectedMessages.getSelected(),function(t){e.props.listeners.add(t,"change:star")}),this.props.listeners.add(this.props.selectedMessages,"all"),this.props.listeners.add(Store.Msg,"change:star",this.onStarChanged)}},{key:"render",value:function(){var e=this.props.selectedMessages.getSelected(),t=k["default"].size(e),a=j["default"].supportsFeature(j["default"].F.ENC_DOC)||k["default"].every(e,function(e){return e.type!==Y["default"].TYPE.DOCUMENT}),o=k["default"].every(e,function(e){return e.canForward()}),n=k["default"].every(e,function(e){return e.canStar()}),r=k["default"].every(e,function(e){return e.mediaData}),i=C["default"].createElement(Q,{name:"forward",disabled:t&&a&&o?null:"disabled",title:l10n.t("forward_message",{count:t,_plural:t}),onClick:this.onForwardSelected}),l=void 0;j["default"].supportsFeature(j["default"].F.MESSAGE_DELETE)&&(l=C["default"].createElement(Q,{name:"delete",disabled:t?null:"disabled",title:l10n.t("delete_message",{count:t,_plural:t}),onClick:this.onDeleteSelected}));var s=void 0;if(j["default"].supportsFeature(j["default"].F.STARRED)){var u=void 0,c=void 0,d=void 0;t&&k["default"].every(e,"star")?(u=this.onUnstarSelected,c="unstar-btn",d=l10n.t("unstar_message",{count:t,_plural:t})):(u=this.onStarSelected,c="star-btn",d=l10n.t("star_message",{count:t,_plural:t})),s=C["default"].createElement(Q,{name:c,disabled:t&&n?null:"disabled",title:d,onClick:u})}var f=void 0;return Modernizr.adownload&&this.props.downloadButton&&r&&(f=C["default"].createElement(Q,{name:"download",disabled:t?null:"disabled",title:l10n.t("web_button_download"),onClick:this.onDownloadSelected})),C["default"].createElement("div",{className:(0,R["default"])("multi-controls",this.props.className)},C["default"].createElement(Q,{name:"x",onClick:this.props.onCancel}),C["default"].createElement("span",{className:"multi-count"},l10n.t("selected_count",{count:t,_plural:t})),s,l,i,f)}}]),t}(C["default"].Component),n.defaultProps={downloadButton:!0},r));var Q=function(e){var t=e.name,a=e.title,o=e.onClick,n=(0,u["default"])(e,["name","title","onClick"]);return C["default"].createElement("button",(0,l["default"])({className:"multiselect-icon",title:a,onClick:o},n),C["default"].createElement(q["default"],{name:t}))}},7277:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7118),_=o(g),v=a(7131),b=(o(v),a(486)),y=(o(b),a(7496)),E=o(y),S=a(7203),C=a(53),M=o(C),k=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.statusV3,a=e.contact,o=void 0,n=t.lastStatus;o=n&&n.type===M["default"].TYPE.CHAT?m["default"].createElement(w,{msg:n}):m["default"].createElement(N,{renderedThumbnail:t.renderedThumbnail});var r=void 0;return a.statusMute||(r=m["default"].createElement(E["default"],{statusV3:t})),m["default"].createElement("div",{className:"status-image-container",onClick:this.props.onClick},r,o)}}]),t}(h.PureComponent);k.CONCERNS={statusV3:["renderedThumbnail","lastStatus"],contact:["statusMute"]};var w=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=e.statusV3TextBg,a={backgroundColor:t};return m["default"].createElement("div",{className:"status-image status-text-thumb",style:a},m["default"].createElement(S.StatusV3Text,{msg:e}))}}]),t}(h.PureComponent),N=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.renderedThumbnail;e&&e.retain()}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.renderedThumbnail,a=e.renderedThumbnail;t!==a&&(t&&t.autorelease(),a&&a.retain())}},{key:"componentWillUnmount",value:function(){var e=this.props.renderedThumbnail;e&&e.autorelease()}},{key:"render",value:function(){var e=this.props.renderedThumbnail,t={backgroundImage:e&&"url("+e.url()+")"};return m["default"].createElement("div",{className:"status-image",style:t})}}]),t}(h.PureComponent);t["default"]=(0,_["default"])(k)},7278:function(e,t){"use strict";var a=window.matchMedia("\nonly screen and (max-width: 1024px)\n"),o={column:a.matches?2:3},n=function(e){var t=e.matches?2:3;if(o.column!==t){o.column=t;var a=document.createEvent("Event");a.initEvent("columnChange",!0,!0),window.dispatchEvent(a)}};a.addListener(n),e.exports=o},7279:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return p["default"].loop(function(t,o,n){var r=p["default"].delay(M["default"].expBackoff(n,12e4,1e3,.1));return a(505)("./"+e)().then(function(e){var a=(0,d["default"])(e,3),o=a[2];return t(o)})["catch"](function(){return r})})["catch"](function(){return{}})}function r(){var e=["en"],t=l10n.getLocale();"en"!==t&&_.indexOf(N,t)>=0&&e.push(t),A=p["default"].map(e,function(e){return n(e)}).then(function(e){var t=e[0];e.length>1&&(t=_.assign({},t,e[1]));var a=_.map(t,function(e,t){t=t.toLowerCase();var a=t.substring(0,5);return{value:e,keyword:t,shortKeyword:a}});R=(0,m["default"])(a,"shortKeyword",{splitRegex:I})})["catch"](_.noop)["finally"](function(){A=null})}function i(e){if(!R)return[];if(e.length<=5)return R.getMatches(e,{splitRegex:I});var t=e.substring(0,5),a=R.getMatches(t,{splitRegex:I});return a=_.filter(a,function(t){return _.startsWith(t.keyword,e)})}function l(e){var t=[];if(e){var a=s(e.toLowerCase());t=_.uniq(a)}return t}function s(e){var t=i(e),a=_.flatMap(_.filter(t,{keyword:e}),"value");t=_.flatMap(t,"value");var o=_.intersection(_.map(Store.RecentEmoji.models,"char"),t),n=_.intersection(T,t),r=_.intersection(_.union(o,n),a);return r=_.compact(_.map(r,function(e){return v["default"].emojiMap[e]})),a=_.compact(_.map(a,function(e){return v["default"].emojiMap[e]})),a=u(a),o=_.compact(_.map(o,function(e){return v["default"].emojiMap[e]})),n=_.compact(_.map(n,function(e){return v["default"].emojiMap[e]})),t=_.compact(_.map(t,function(e){return v["default"].emojiMap[e]})),t=_.difference(t,_.union(a,o,n)),t=u(t),_.union(r,a,o,n,t)}function u(e){var t={};return _.forEach(P,function(e){t[e]=[]}),_.forEach(e,function(e){var a=v["default"].getCategoryString(e);t[a].push(e)}),_.forEach(t,function(e,a){e.length>0&&(t[a]=_.intersection(y["default"][a],e))}),_.flatMap(t)}Object.defineProperty(t,"__esModule",{value:!0});var c=a(17),d=o(c),f=a(0),p=o(f);t["default"]=l;var h=a(6990),m=o(h),g=a(95),v=o(g),b=a(502),y=o(b),E=a(12),S=o(E),C=a(49),M=o(C),k=a(35),w=o(k),N=["en","de","es","it","pt","ru"],T=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],P=["SMILEYS_PEOPLE","ANIMALS_NATURE","FOOD_DRINK","ACTIVITY","TRAVEL_PLACES","OBJECTS","SYMBOLS","FLAGS","VARIATION"],I="^>",R=null,A=null;S["default"].on("locale_change",function(){A&&A.cancel(),r()}),w["default"].waitForBBEvent(Store.Stream,"change:mode",function(){return Store.Stream.mode===Store.Stream.MODE.MAIN}).then(function(){A||r()})},7280:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(494),d=o(c),f=d["default"].Message.ExtendedTextMessage.FONTTYPE,p=a(7513),h={};h[f.ROBOTO]={google:{families:["Roboto"]}},h[f.SANS_SERIF]={google:{families:["Droid Serif"]}},h[f.NORICAN_REGULAR]={google:{families:["Norican"]}},h[f.BRYNDAN_WRITE]={custom:{families:["Bryndan-Write"]}},h[f.OSWALD_HEAVY]={google:{families:["Oswald:bold"]}};var m={};m[f.BRYNDAN_WRITE]='@font-face {font-family:"Bryndan-Write"; src:url("'+p+'") format("truetype");}';var g=function(){function e(){(0,l["default"])(this,e),this.loadedFonts={},this.loadingPromise={}}return(0,u["default"])(e,[{key:"load",value:function(e){var t=this;if(this.loadedFonts[e])return r["default"].resolve();if(this.loadingPromise[e])return this.loadingPromise[e];var a=h[e],o=m[e],n=void 0;n=o?new r["default"](function(e,t){var a=document.createElement("style");a.appendChild(document.createTextNode(o)),a.onload=e,a.onerror=t,document.head.appendChild(a)}):r["default"].resolve();var i=n.then(function(){return new r["default"](function(o,n){var r=_.assign({},a,{active:function(){t.loadedFonts[e]=!0,o()},inactive:function(){t.loadingPromise[e]=void 0,n("Failed to load font: "+e)}});WebFont.load(r)})});return this.loadingPromise[e]=i,i}}]),e}();e.exports=new g},7281:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){return l.hasOwnProperty(e)?l[e]:l[e]=i["default"].queryLinkPreview(e).then(function(t){var a=t.title,o=t.description,n=t.canonicalUrl,r=t.matchedText,i=t.thumbnail;return r&&(a||o)?{url:e,data:{title:a||void 0,description:o||void 0,canonicalUrl:n||void 0,matchedText:r,thumbnail:i||void 0}}:null})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(38),i=o(r),l={}},7282:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,a){var o=e.models;if(a===S.BEFORE){var n=function(){var e=0;return{v:{hasNext:function(){return t>=e},next:function(){return o[t--]}}}}();if("object"==typeof n)return n.v}else{if(a!==S.AFTER)throw new Error("RendorCursor:invalid direction");var r=function(){var e=o.length-1;return{v:{hasNext:function(){return e>=t},next:function(){return o[t++]}}}}();if("object"==typeof r)return r.v}}function r(e,t,a){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=T*o,i=n(e,t,a),l=0,u=0,c=void 0;i.hasNext();){var d=i.next(),f=s(d),p=2*d.isNotification+d.isSentByMe,h=p&&p===c?C:M;if(l+=f+h,u++,l>r)break;c=p}return u}function i(e,t,a){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=T*o,i=n(e,t,a),l=0,u=0,c=void 0;i.hasNext();){var d=i.next(),f=s(d),p=d.author||(d.isSentByMe?Store.Conn.me:void 0),h=p&&!d.isSentByMe&&p!==c?k:0,m=p&&p===c?C:M;if(l+=f+h+m,u++,l>r)break;c=p}return u}function l(e,t,a){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=T*o,i=n(e,t,a),l=0,u=0;i.hasNext();){var c=i.next(),d=s(c);if(l+=d+w,u++,l>r)break}return u}function s(e){var t=0;switch(e.quotedMsg&&(t+=54),e.caption&&(t+=31),e.type){case v["default"].TYPE.NOTIFICATION:case v["default"].TYPE.GROUP_NOTIFICATION:case v["default"].TYPE.GP2:case v["default"].TYPE.BROADCAST_NOTIFICATION:case v["default"].TYPE.E2E_NOTIFICATION:case v["default"].TYPE.CALL_LOG:case v["default"].TYPE.CIPHERTEXT:case v["default"].TYPE.REVOKED:case v["default"].TYPE.CHAT:e.linkPreview&&(t+=53);var a=(0,y.graphemeLength)(e.body);return t+19*_.ceil(a/100)+13;case v["default"].TYPE.IMAGE:return t+e.fullWidth&&e.fullHeight?Math.floor(Math.min(330/e.fullWidth*e.fullHeight,330)):330;case v["default"].TYPE.VIDEO:case v["default"].TYPE.AUDIO:return e.isGif?t+137:t+166;case v["default"].TYPE.LOCATION:return t+b.PREVIEW_HEIGHT;case v["default"].TYPE.PTT:return t+67;case v["default"].TYPE.VCARD:return t+74;case v["default"].TYPE.DOCUMENT:return t+188;case v["default"].TYPE.UNKNOWN:default:return t}}function u(e){switch(e){case E.RENDOR_CURSOR.CONVERSATION:case E.RENDOR_CURSOR.GROUP_CONVERSATION:return E.RENDOR_CURSOR.RECENT_AT_BOTTOM;case E.RENDOR_CURSOR.STARRED_DRAWER:return E.RENDOR_CURSOR.RECENT_AT_TOP;default:return E.RENDOR_CURSOR.RECENT_AT_BOTTOM}}function c(e){switch(e){case E.RENDOR_CURSOR.CONVERSATION:return r;case E.RENDOR_CURSOR.GROUP_CONVERSATION:return i;case E.RENDOR_CURSOR.STARRED_DRAWER:return l;default:return r}}function d(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S.AFTER,o=T*N,r=n(e,t,a),i=0,l=!0,u=null;r.hasNext();){var c=r.next(),d=s(c),f=2*c.isNotification+c.isSentByMe,p=f&&f===u?C:M;if(i+=d+p,i>o){l=!1;break}u=f}return l}var f=a(2),p=o(f),h=a(4),m=o(h),g=a(53),v=o(g),b=a(7247),y=a(493),E=a(8),S={BEFORE:"before",AFTER:"after"},C=2,M=12,k=19,w=65,N=2,T=window.innerHeight,P=_.debounce(function(e){T=window.innerHeight},500);window.addEventListener("resize",P);var I=function(){function e(t,a,o){var n=this;(0,p["default"])(this,e);var r=c(o);this.msgCollection=t,this.type=o,this.dir=u(o),this.cursorSize=function(e,t){if(e===S.BEFORE)return r(n.msgCollection,n.start-1,e,t);if(e===S.AFTER)return r(n.msgCollection,n.end,e,t);throw new Error("RendorCursor:invalid direction")},this.init(a)}return(0,m["default"])(e,[{key:"init",value:function(e){return this.before=0,this.after=0,this.prevKey=void 0,this.msgKey=e,this.loadBefore(void 0,1),this.loadAfter(void 0,1),this}},{key:"setKey",value:function(e){var t=this.index;this.msgKey=e;var a=this.index;return e?(this.after=this.after-(a-t),this.before=this.before+(a-t)):(this.before+=this.after,this.after=0),this.updatePrev(),this}},{key:"onRemove",value:function(e){e.id===this.prevKey?this.updatePrev():e.id===this.msgKey&&this.focusBefore()}},{key:"updatePrev",value:function(){this.prevKey=this.index>0?this.msgCollection.models[this.index-1].id:void 0}},{key:"focusBefore",value:function(){this.msgKey=this.prevKey,this.updatePrev()}},{key:"hasBefore",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.index-this.before>0}},{key:"loadBefore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=e||this.cursorSize(S.BEFORE,t);return this.before+=a,this}},{key:"hasAfter",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.index+this.after<this.msgCollection.length-1}},{key:"loadAfter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,a=e||this.cursorSize(S.AFTER,t);return this.after+=a,this}},{key:"loadBeforeCapped",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return d(this.msgCollection,this.start,S.AFTER)?this.loadBefore(e,t):this}},{key:"resetBeforeCursor",value:function(){d(this.msgCollection,this.start,S.AFTER)||(this.before=Math.min(this.before,this.cursorSize(S.BEFORE,2)))}},{key:"index",get:function(){if(this.msgKey){var e=this.msgCollection.get(this.msgKey),t=this.msgCollection.indexOf(e);if(-1!==t)return t}return this.dir===E.RENDOR_CURSOR.RECENT_AT_TOP?0:this.msgCollection.length-1}},{key:"start",get:function(){return Math.max(this.index-this.before,0)}},{key:"end",get:function(){return Math.min(this.index+this.after+1,this.msgCollection.length)}}]),e}();e.exports=I},7283:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPickerChangeTypes=void 0;var n=a(24),r=o(n),i=a(182),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7510),p=o(f),h=a(34),m=o(h),g=(t.MediaPickerChangeTypes={mediaPickerCroppedRotated:"mediaPickerCroppedRotated",mediaPickerDrawing:"mediaPickerCroppedRotated",mediaPickerStickers:"mediaPickerCroppedRotated",mediaPickerText:"mediaPickerCroppedRotated"},function(){function e(){(0,u["default"])(this,e),this.mediaByTypeAndOrigin=new l["default"],this.mediaEventReverseIndex=new l["default"],this.chatRecipients=null}return(0,d["default"])(e,[{key:"pauseTimer",value:function(){this.mediaByTypeAndOrigin.forEach(function(e){e.onPause()})}},{key:"resumeTimer",value:function(){this.mediaByTypeAndOrigin.forEach(function(e){e.onResume()})}},{key:"_getKey",value:function(e,t){return e+"_"+t}},{key:"_commitLog",value:function(e){var t=new m["default"].MediaPicker((0,r["default"])({},e,{chatRecipients:this.chatRecipients}));t.commit()}},{key:"_processNewMedia",value:function(e,t,a){var o=this._getKey(t,a),n=this.mediaByTypeAndOrigin.get(o);if(n)n.onAdd(e),this.mediaEventReverseIndex.set(e,n);else{var r=new p["default"](e,t,a);this.mediaByTypeAndOrigin.set(o,r),this.mediaEventReverseIndex.set(e,r)}}},{key:"logChange",value:function(e,t){var a=this.mediaEventReverseIndex.get(e);a&&a.onChange(e,t)}},{key:"logDelete",value:function(e){var t=this.mediaEventReverseIndex.get(e);t&&t.onDelete(e)}},{key:"logSend",value:function(){var e=this;this.mediaByTypeAndOrigin.forEach(function(t){e._commitLog(t.onSend())})}},{key:"logCancel",value:function(){var e=this;this.mediaByTypeAndOrigin.forEach(function(t){e._commitLog(t.onCancel())})}},{key:"logAdd",value:function(e,t,a){this.mediaEventReverseIndex.get(e)||this._processNewMedia(e,t,a)}}]),e}());t["default"]=g},7284:function(e,t){t=e.exports={muted:"_3z69m","color-1":"_1EcWs","color-2":"_3FMve","color-3":"_2elAc","color-4":"eVJFg","color-5":"_2demA","color-6":"_1Nv5y","color-7":"SFNFL","color-8":"_1Y0Wb","color-9":"V82L7","color-10":"_1p-zT","color-11":"_20d1A","color-12":"_2Lx6p","color-13":"_28JB4","color-14":"_20-ot","color-15":"_13v6g","color-16":"_2YmOF","color-17":"_2GZrt","color-18":"N5yls","color-19":"_25VUc","color-20":"_2fldm","bg-color-1":"_2_sCZ","bg-color-2":"_1FQBC","bg-color-3":"_1sQvU","bg-color-4":"_2AxpR","bg-color-5":"_1YsYq","bg-color-6":"_2UV01","bg-color-7":"_2VP4g","bg-color-8":"hfKJu","bg-color-9":"_2R5yk","bg-color-10":"_3bMq-","bg-color-11":"_1n1Vy","bg-color-12":"_1btLP","bg-color-13":"_1_SM6","bg-color-14":"_1zgma","bg-color-15":"gORCe","bg-color-16":"_2xmPv","bg-color-17":"_9RpYI","bg-color-18":"_3SGxd","bg-color-19":"_2pgrl","bg-color-20":"_2-uw0",container:"_GrA7",control:"_1R8P6",label:"_10Dbq",buttons:"_2Km6k",button:"_1S3yi"}},7286:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7431),E=o(y),S=a(12),C=o(S),M=a(7439),k=o(M),w=a(7457),N=o(w),T=a(72),P=o(T),I=a(71),R=o(I);t["default"]=(0,R["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onMute=function(e,t){if(t){var a=function(t){e.pendingAction++,e.mute.mute(t,!0)["finally"](function(){e.pendingAction--})};C["default"].openModal(_["default"].createElement(N["default"],{chat:e,onMute:a}),"modal",o.context.uim)}else e.pendingAction++,e.mute.unmute(!0)["finally"](function(){e.pendingAction--})},o.onDeleteOrExit=function(e){var t=function(t){e.pendingAction++,t["finally"](function(){e.pendingAction--})};C["default"].openModal(_["default"].createElement(k["default"],{chat:e,onDeleteOrExit:t}),"modal",o.context.uim)},o.onPin=function(e,t){e.pendingAction++,e.setPin(t)["catch"](b["default"].noop)["finally"](function(){e.pendingAction--})},o.onClear=function(e){C["default"].openModal(_["default"].createElement(E["default"],{chat:e}),"modal",o.context.uim)},o.onArchive=function(e,t){e.pendingAction++,e.setArchive(t)["catch"](b["default"].noop)["finally"](function(){e.pendingAction--})},o.onMarkUnread=function(e,t){e.pendingAction++,e.markUnread(t)["finally"](function(){e.pendingAction--})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(C["default"],"mute_chat",this.onMute),this.props.listeners.add(C["default"],"delete_or_exit_chat",this.onDeleteOrExit),this.props.listeners.add(C["default"],"archive_chat",this.onArchive),this.props.listeners.add(C["default"],"clear_chat_msgs",this.onClear),this.props.listeners.add(C["default"],"mark_chat_unread",this.onMarkUnread),this.props.listeners.add(C["default"],"pin_chat",this.onPin)}},{key:"render",value:function(){return null}}]),t}(g.PureComponent),n.contextTypes={
uim:_["default"].PropTypes.instanceOf(P["default"])},r))},7287:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.mimeType,a=e.url;return i["default"].createElement("div",{className:s["default"].container,"data-animate-attach-media":!0},i["default"].createElement("div",{className:s["default"].media},i["default"].createElement("audio",{controls:!0,type:t,src:a})))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7521),s=o(l)},7288:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.fullPreview,a=e.fullPreviewSize,o=e.mimeType,n=e.filename;return t&&a?i["default"].createElement("div",{className:f["default"].container,"data-animate-attach-media":!0},i["default"].createElement("div",{className:f["default"].preview},i["default"].createElement(s["default"],{type:l.FIT_TYPE.SCALE_DOWN,size:a},i["default"].createElement("img",{src:t,className:f["default"].img})))):i["default"].createElement(c["default"],{mimeType:o,filename:n})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7132),s=o(l),u=a(7183),c=o(u),d=a(7522),f=o(d)},7289:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.mimeType,a=e.url,o=e.isGif,n=e.size,r=e.processing,l=e.preview,p=void 0;switch(y[t].msgType){case"image":p=s["default"].createElement("img",{src:a,className:v["default"].img});break;case"video":var h=o?{loop:!r,autoPlay:!r,muted:!1,controls:!1}:{},m=r?s["default"].createElement("div",{className:v["default"].spinner},s["default"].createElement(f["default"],{color:d.colorOptions.white,size:50,stroke:3})):null,_=l?s["default"].createElement("img",{className:v["default"].staticPreview,src:"data:image/jpeg;base64,"+l}):null;p=s["default"].createElement("div",{className:(0,g["default"])(v["default"].img,v["default"].videoContainer)},m,s["default"].createElement("video",(0,i["default"])({controls:!0,className:v["default"].video,type:t},h,{src:a})),_);break;case"audio":p=s["default"].createElement("audio",{controls:!0,className:v["default"].audio,type:t,src:a})}return s["default"].createElement("div",{className:v["default"].container,"data-animate-attach-media":!0},s["default"].createElement("div",{className:v["default"].media},s["default"].createElement(c["default"],{type:u.FIT_TYPE.SCALE_DOWN,size:n},p)))}Object.defineProperty(t,"__esModule",{value:!0});var r=a(24),i=o(r);t["default"]=n;var l=a(3),s=o(l),u=a(7132),c=o(u),d=a(175),f=o(d),p=a(10),h=o(p),m=a(23),g=o(m),_=a(7524),v=o(_),b=a(128),y=h["default"].pickBy(b.MIMETYPES,function(e){return"image"===e.msgType||"video"===e.msgType})},7290:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.fullPreview,a=e.fullPreviewSize,o=e.pdfPages,n=e.mimeType,r=e.filename;if(t&&a&&o){var u=l10n.t("attach_document_pdf_total_pages",{count:o,_plural:o});return i["default"].createElement("div",{className:f["default"].container,"data-js-attach-preview":!0},i["default"].createElement("div",{className:f["default"].preview},i["default"].createElement(s["default"],{type:l.FIT_TYPE.SCALE_DOWN,size:a},i["default"].createElement("img",{src:t,className:f["default"].img}))),i["default"].createElement("div",{className:f["default"].caption},u))}return i["default"].createElement(c["default"],{mimeType:n,filename:r})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(7132),s=o(l),u=a(7183),c=o(u),d=a(7525),f=o(d)},7291:function(e,t){"use strict";var a={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave"],doubleByte:[]};e.exports=a},7292:function(e,t,a){"use strict";function o(e){var t=new n(e);this.readByte=function(){return t.readUint8()},this.readInt16=function(){return t.readUint16()},this.readInt20=function(){var e=15&t.readUint8(),a=t.readUint8(),o=t.readUint8();return(e<<16)+(a<<8)+o},this.readString=function(e){return t.readString(e)},this.readBytes=function(e){return t.readBuffer(e)},this.debugInfo=function(){return"offset: "+t._readIndex+" byte: "+t._buffer[t._readIndex]}}var n=a(19);e.exports=o},7293:function(e,t,a){"use strict";function o(e,t){if(!e)return"undefined";var a=n(e[1],t),o=r(e[2],t);return"<"+e[0]+a+(o?">\n"+o+"\n</"+e[0]+">":"/>")}function n(e,t){if(e){var a="";for(var o in e){var n="string"==typeof e[o]?t?"...":'"'+e[o]+'"':e[o];a+=" "+o+"="+n}return a}return""}function r(e,t){return e instanceof ArrayBuffer?"<<bin:"+e.byteLength+">>":"string"==typeof e?t?"<<string:"+e.length+">>":e:_.isArray(e)?e.map(_.partial(o,_,t)).join("\n"):void 0}var i=a(19),l={tag:function(e){return e&&e[0]},attr:function(e,t){return t&&t[1]?t[1][e]:void 0},attrs:function(e){return e[1]},child:function s(e,t){var a=t[2];if(_.isArray(a))for(var o=a.length,n=0;o>n;n++){var s=a[n];if(_.isArray(s)&&s[0]===e)return s}},children:function(e){return e&&e[2]},dataStr:function(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:t instanceof ArrayBuffer?new i(t).readString(t.byteLength):void 0},toString:o};e.exports=l},7294:function(e,t,a){"use strict";function o(){var e=new n;this.pushInt16=function(t){e.writeUint16(t)},this.pushInt20=function(t){if("number"!=typeof t)throw new Error("invalid int20");e.writeUint8((983040&t)>>16),e.writeUint16(65535&t)},this.pushByte=function(t){e.writeUint8(t)},this.pushBytes=function(t){if(!(t instanceof ArrayBuffer))throw new Error("invalid byte buffer");e.writeBuffer(t)},this.pushString=function(t){if("string"!=typeof t)throw new Error("invalid string");e.writeString(t)},this.toBuffer=function(){return e.readBuffer()}}var n=a(19);e.exports=o},7295:function(e,t,a){"use strict";function o(e){var t=e.singleByte,a=e.doubleByte;this.readNode=function(e){var t=e.readByte(),a=this.readListSize(e,t);if(t=e.readByte(),t===n.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var o=this.readString(e,t);if(0===a||!o)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var r=a-2+a%2>>1,i=this.readAttributes(e,r);if(a%2===1)return[o,i,void 0];var l;if(t=e.readByte(),this.isListTag(t))l=this.readList(e,t);else if(t===n.BINARY_8){var s=e.readByte();l=e.readBytes(s)}else if(t===n.BINARY_20){var u=e.readInt20();l=e.readBytes(u)}else l=this.readString(t);return[o,i,l]},this.isListTag=function(e){return e===n.LIST_EMPTY||e===n.LIST_8||e===n.LIST_16},this.readListSize=function(e,t){if(t===n.LIST_EMPTY)return 0;if(t===n.LIST_8)return e.readByte();if(t===n.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var a=this.getToken(t);return"s.whatsapp.net"===a&&(a="c.us"),a}switch(t){case n.DICTIONARY_0:case n.DICTIONARY_1:case n.DICTIONARY_2:case n.DICTIONARY_3:var o=e.readByte();return this.getTokenDouble(t-n.DICTIONARY_0,o);case n.LIST_EMPTY:return;case n.BINARY_8:var r=e.readByte();return e.readString(r);case n.BINARY_20:var i=e.readInt20();return e.readString(i);case n.JID_PAIR:var l=this.readString(e,e.readByte()),s=this.readString(e,e.readByte());if("undefined"!=typeof l&&"undefined"!=typeof s)return l+"@"+s;if("undefined"!=typeof s)return s;throw new Error("invalid jid "+l+","+s+" "+e.debugInfo());default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var a;if(e>=0&&e<t.length&&(a=t[e]),"undefined"==typeof a)throw new Error("invalid token "+e);return a},this.getTokenDouble=function(e,t){var o,n=256*e+t;if(n>=0&&n<a.length&&(o=a[n]),"undefined"==typeof o)throw new Error("invalid double byte token "+e+" "+t);return o},this.readAttributes=function(e,t){for(var a,o,n=t?{}:void 0,r=0;t>r;r++)a=this.readString(e,e.readUint8()),o=this.readString(e,e.readUint8()),n[a]=o;return n},this.readList=function(e,t){for(var a=[],o=this.readListSize(e,t),n=0;o>n;n++)a.push(this.readNode(e));return a}}var n=a(7211);e.exports=o},7296:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a={};for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(a[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(a[e.doubleByte[t]]=t+s.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var a=t[1]?2*(0,i["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+a+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t){if("string"!=typeof t)throw new Error("invalid string");var o,n,r=a[t];if("undefined"==typeof r){var i=t.indexOf("@");if(1>i)this.writeStringRaw(e,t);else{var l=t.substring(0,i),u=t.substring(i+1);this.writeJid(e,l,u)}}else{if(r<s.SINGLE_BYTE_MAX)this.writeToken(e,r);else{var c=r-s.SINGLE_BYTE_MAX,d=c>>8;switch(n=c%256,d){case 0:o=s.DICTIONARY_0;break;case 1:o=s.DICTIONARY_1;break;case 2:o=s.DICTIONARY_2;break;case 3:o=s.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+r)}}this.writeToken(e,o),this.writeToken(e,n)}},this.writeStringRaw=function(e,t){var a=l.numUtf8Bytes(t);a>=256?(e.pushByte(s.BINARY_20),e.pushInt20(a)):(e.pushByte(s.BINARY_8),e.pushByte(a)),e.pushString(t)},this.writeJid=function(e,t,a){e.pushByte(s.JID_PAIR),t?this.writeString(e,t):this.writeToken(e,s.LIST_EMPTY),"c.us"===a&&(a="s.whatsapp.net"),this.writeString(e,a)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t)for(var a in t)t[a]&&(this.writeString(e,a),this.writeString(e,t[a]))},this.writeChildren=function(e,t){var a;if(t)if("string"==typeof t)this.writeString(e,t);else if(t instanceof ArrayBuffer)a=t.byteLength,a>=256?(e.pushByte(s.BINARY_20),e.pushInt20(a)):(e.pushByte(s.BINARY_8),e.pushByte(a)),e.pushBytes(t);else{if(!_.isArray(t))throw new Error("invalid children");a=t.length,this.writeListStart(e,a);for(var o=0;a>o;o++)this.writeNode(e,t[o])}},this.writeListStart=function(e,t){0===t?e.pushByte(s.LIST_EMPTY):256>t?(e.pushByte(s.LIST_8),e.pushByte(t)):(e.pushByte(s.LIST_16),e.pushInt16(t))}}var r=a(29),i=o(r),l=a(19),s=a(7211);e.exports=n},7297:function(e,t){"use strict";var a={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:"\x00"}};e.exports=a},7298:function(e,t,a){"use strict";function o(e){var t=new n(e);this.readByte=function(){return t.readUint8()},this.readInt16=function(){return t.readUint16()},this.readInt20=function(){var e=15&t.readUint8(),a=t.readUint8(),o=t.readUint8();return(e<<16)+(a<<8)+o},this.readInt32=function(){return t.readUint32()},this.readString=function(e){return t.readString(e)},this.readBytes=function(e){return t.readBuffer(e)},this.debugInfo=function(){return"offset: "+t._readIndex+" byte: "+t._buffer[t._readIndex]}}var n=a(19);e.exports=o},7299:function(e,t,a){"use strict";function o(e,t){if(!e)return"undefined";var a=n(e[1],t),o=r(e[2],t);return"<"+e[0]+a+(o?">\n"+o+"\n</"+e[0]+">":"/>")}function n(e,t){if(e){var a="";for(var o in e){var n="string"==typeof e[o]?t?"...":'"'+e[o]+'"':e[o];a+=" "+o+"="+n}return a}return""}function r(e,t){return e instanceof ArrayBuffer?"<<bin:"+e.byteLength+">>":"string"==typeof e?t?"<<string:"+e.length+">>":e:_.isArray(e)?e.map(_.partial(o,_,t)).join("\n"):void 0}var i=a(19),l={tag:function(e){return e&&e[0]},attr:function(e,t){return t&&t[1]?t[1][e]:void 0},attrs:function(e){return e[1]},child:function s(e,t){var a=t[2];if(_.isArray(a))for(var o=a.length,n=0;o>n;n++){var s=a[n];if(_.isArray(s)&&s[0]===e)return s}},children:function(e){return e&&e[2]},dataStr:function(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:t instanceof ArrayBuffer?new i(t).readString(t.byteLength):void 0},toString:o};e.exports=l},7300:function(e,t,a){"use strict";function o(){var e=new n;this.pushInt16=function(t){e.writeUint16(t)},this.pushInt20=function(t){if("number"!=typeof t)throw new Error("invalid int20");e.writeUint8((983040&t)>>16),e.writeUint16(65535&t)},this.pushInt32=function(t){e.writeUint32(t)},this.pushByte=function(t){e.writeUint8(t)},this.pushBytes=function(t){if(!(t instanceof ArrayBuffer))throw new Error("invalid byte buffer");e.writeBuffer(t)},this.pushUint8Array=function(t){if("[object Uint8Array]"!==Object.prototype.toString.call(t))throw new Error("invalid Uint8Array");e.writeByteArray(t)},this.pushString=function(t){if("string"!=typeof t)throw new Error("invalid string");e.writeString(t)},this.toBuffer=function(){return e.readBuffer()}}var n=a(19);e.exports=o},7301:function(e,t,a){"use strict";function o(e){var t=e.singleByte,a=e.doubleByte,o=e.nibbleDecode;this.readNode=function(e){var t=e.readByte(),a=this.readListSize(e,t);if(t=e.readByte(),t===n.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var o=this.readString(e,t);if(0===a||!o)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var r=a-2+a%2>>1,i=this.readAttributes(e,r);if(a%2===1)return[o,i,void 0];var l;if(t=e.readByte(),this.isListTag(t))l=this.readList(e,t);else if(t===n.BINARY_8){var s=e.readByte();l=e.readBytes(s)}else if(t===n.BINARY_20){var u=e.readInt20();l=e.readBytes(u)}else if(t===n.BINARY_32){var c=e.readInt32();l=e.readBytes(c)}else l=this.readString(e,t);return[o,i,l]},this.isListTag=function(e){return e===n.LIST_EMPTY||e===n.LIST_8||e===n.LIST_16},this.readListSize=function(e,t){if(t===n.LIST_EMPTY)return 0;if(t===n.LIST_8)return e.readByte();if(t===n.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var a=this.getToken(t);return"s.whatsapp.net"===a&&(a="c.us"),a}switch(t){case n.DICTIONARY_0:case n.DICTIONARY_1:case n.DICTIONARY_2:case n.DICTIONARY_3:var o=e.readByte();return this.getTokenDouble(t-n.DICTIONARY_0,o);case n.LIST_EMPTY:return;case n.BINARY_8:return e.readString(e.readByte());case n.BINARY_20:return e.readString(e.readInt20());case n.BINARY_32:return e.readString(e.readInt32());case n.JID_PAIR:var r=this.readString(e,e.readByte()),i=this.readString(e,e.readByte());if("undefined"!=typeof r&&"undefined"!=typeof i)return r+"@"+i;if("undefined"!=typeof i)return i;throw new Error("invalid jid "+r+","+i+" "+e.debugInfo());case n.NIBBLE_8:return this.nibblesToBytes(e);default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var a;if(e>=0&&e<t.length&&(a=t[e]),"undefined"==typeof a)throw new Error("invalid token "+e);return a},this.getTokenDouble=function(e,t){var o,n=256*e+t;if(n>=0&&n<a.length&&(o=a[n]),"undefined"==typeof o)throw new Error("invalid double byte token "+e+" "+t);return o},this.readAttributes=function(e,t){for(var a,o,n=t?{}:void 0,r=0;t>r;r++)a=this.readString(e,e.readByte()),o=this.readString(e,e.readByte()),n[a]=o;return n},this.readList=function(e,t){for(var a=[],o=this.readListSize(e,t),n=0;o>n;n++)a.push(this.readNode(e));return a},this.nibblesToBytes=function(e){for(var t=e.readByte(),a=t>>7,o=127&t,n="",r=0;o>r;r++){var i=e.readByte(),l=this.unpackBytePair(i);n+=l[0],n+=l[1]}return a&&(n=n.substring(0,n.length-1)),n},this.unpackBytePair=function(e){var t=(240&e)>>4,a=15&e;if(!o.hasOwnProperty(t))throw new Error("invalid nibble to unpack: "+t);if(!o.hasOwnProperty(a))throw new Error("invalid nibble to unpack: "+a);var n=o[t],r=o[a];return[n,r]},this.bytesToString=function(e){for(var t="",a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return t}}var n=a(7213);e.exports=o},7302:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a={},o=e.nibbleEncode;for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(a[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(a[e.doubleByte[t]]=t+u.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var a=t[1]?2*(0,i["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+a+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t,o){if("string"!=typeof t)throw new Error("invalid string");var n,r,i=a[t];if("c.us"!==t||o)if("undefined"==typeof i){var l=t.indexOf("@");if(1>l)this.writeStringRaw(e,t);else{var s=t.substring(0,l),c=t.substring(l+1);this.writeJid(e,s,c)}}else{if(i<u.SINGLE_BYTE_MAX)this.writeToken(e,i);else{var d=i-u.SINGLE_BYTE_MAX,f=d>>8;switch(r=d%256,f){case 0:n=u.DICTIONARY_0;break;case 1:n=u.DICTIONARY_1;break;case 2:n=u.DICTIONARY_2;break;case 3:n=u.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+i)}}this.writeToken(e,n),this.writeToken(e,r)}else this.writeToken(e,a["s.whatsapp.net"])},this.writeStringRaw=function(e,t){var a=s.numUtf8Bytes(t);if(a>=4294967296)throw new Error("string too large to encode (len = "+a+"): "+t);a>=1<<20?(e.pushByte(u.BINARY_32),e.pushInt32(a)):a>=256?(e.pushByte(u.BINARY_20),e.pushInt20(a)):(e.pushByte(u.BINARY_8),e.pushByte(a)),e.pushString(t)},this.writeJid=function(e,t,a){if(e.pushByte(u.JID_PAIR),t)try{this.writeNibbles(e,t)}catch(o){l.warnVerbose("writer:encode-fallback "+o.message,t)(),this.writeString(e,t)}else this.writeToken(e,u.LIST_EMPTY);this.writeString(e,a)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t)for(var a in t)t[a]&&(this.writeString(e,a),this.writeString(e,t[a]))},this.writeChildren=function(e,t){var a;if(t)if("string"==typeof t)this.writeString(e,t,!0);else if(t instanceof ArrayBuffer){if(a=t.byteLength,a>=4294967296)throw new Error("invalid children; too long (len = "+a);a>=1<<20?(e.pushByte(u.BINARY_32),e.pushInt32(a)):a>=256?(e.pushByte(u.BINARY_20),e.pushInt20(a)):(e.pushByte(u.BINARY_8),e.pushByte(a)),e.pushBytes(t)}else{if(!_.isArray(t))throw new Error("invalid children");a=t.length,this.writeListStart(e,a);for(var o=0;a>o;o++)this.writeNode(e,t[o])}},this.writeListStart=function(e,t){0===t?e.pushByte(u.LIST_EMPTY):256>t?(e.pushByte(u.LIST_8),e.pushByte(t)):(e.pushByte(u.LIST_16),e.pushInt16(t))},this.writeNibbles=function(e,t){var a=s.numUtf8Bytes(t);if(a>u.NIBBLE_MAX)throw new Error("too many bytes to nibble-encode: len = "+a);var o,n=Math.ceil(a/2),r=[],i=0;a%2>0&&(i=128);var l=i|n;r.push(u.NIBBLE_8),r.push(l);for(var c=Math.floor(a/2),d=0;c>d;d++)o=this.packBytePair(t[2*d],t[2*d+1]),r.push(o);i>0&&(o=this.packBytePair(t[a-1],"\x00"),r.push(o));var f=new Uint8Array(r);e.pushUint8Array(f)},this.packBytePair=function(e,t){if(!o.hasOwnProperty(e))throw new Error("invalid byte to nibble-pack: "+e);if(!o.hasOwnProperty(t))throw new Error("invalid byte to nibble-pack: "+t);var a=o[e],n=o[t];return a<<4|n}}var r=a(29),i=o(r),l=a(1),s=a(19),u=a(7213);e.exports=n},7303:function(e,t){"use strict";var a={singleByte:["checksum","epoch","block","previous","409","replaced","reason","spam","modify_tag"]};e.exports=a},7304:function(e,t){"use strict";var a={singleByte:["message_info","delivery","emoji"]};e.exports=a},7305:function(e,t,a){"use strict";function o(e){var t=e.singleByte,a=e.doubleByte,o=e.nibbleDecode;this.readNode=function(e){var t=e.readByte(),a=this.readListSize(e,t);if(t=e.readByte(),t===n.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var o=this.readString(e,t);if(0===a||!o)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var r=a-2+a%2>>1,i=this.readAttributes(e,r);if(a%2===1)return[o,i,void 0];var l;if(t=e.readByte(),this.isListTag(t))l=this.readList(e,t);else if(t===n.BINARY_8){var s=e.readByte();l=e.readBytes(s)}else if(t===n.BINARY_20){var u=e.readInt20();l=e.readBytes(u)}else if(t===n.BINARY_32){var c=e.readInt32();l=e.readBytes(c)}else l=this.readString(e,t);return[o,i,l]},this.isListTag=function(e){return e===n.LIST_EMPTY||e===n.LIST_8||e===n.LIST_16},this.readListSize=function(e,t){if(t===n.LIST_EMPTY)return 0;if(t===n.LIST_8)return e.readByte();if(t===n.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){var a=void 0;if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var o=this.getToken(t);return"s.whatsapp.net"===o&&(o="c.us"),o}switch(t){case n.DICTIONARY_0:case n.DICTIONARY_1:case n.DICTIONARY_2:case n.DICTIONARY_3:var r=e.readByte();return this.getTokenDouble(t-n.DICTIONARY_0,r);case n.LIST_EMPTY:return;case n.BINARY_8:return a=e.readString(e.readByte());case n.BINARY_20:return a=e.readString(e.readInt20());case n.BINARY_32:return a=e.readString(e.readInt32());case n.JID_PAIR:var i=this.readString(e,e.readByte()),l=this.readString(e,e.readByte());if("undefined"!=typeof i&&"undefined"!=typeof l)return i+"@"+l;if("undefined"!=typeof l)return l;throw new Error("invalid jid "+i+","+l+" "+e.debugInfo());case n.NIBBLE_8:case n.HEX_8:return this.readPacked8(t,e);default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var a;if(e>=0&&e<t.length&&(a=t[e]),"undefined"==typeof a)throw new Error("invalid token "+e);return a},this.getTokenDouble=function(e,t){var o,n=256*e+t;if(n>=0&&n<a.length&&(o=a[n]),"undefined"==typeof o)throw new Error("invalid double byte token "+e+" "+t);return o},this.readAttributes=function(e,t){this.isAttr=!0;for(var a,o,n=t?{}:void 0,r=0;t>r;r++)a=this.readString(e,e.readByte()),o=this.readString(e,e.readByte()),n[a]=o;return this.isAttr=!1,n},this.readList=function(e,t){for(var a=[],o=this.readListSize(e,t),n=0;o>n;n++)a.push(this.readNode(e));return a},this.readPacked8=function(e,t){for(var a=t.readByte(),o=a>>7,n=127&a,r="",i=0;n>i;i++){var l=t.readByte();r+=this.unpackByte(e,(240&l)>>4),r+=this.unpackByte(e,15&l)}return o&&(r=r.substring(0,r.length-1)),r},this.unpackByte=function(e,t){switch(e){case n.NIBBLE_8:return this.unpackNibble(t);case n.HEX_8:return this.unpackHex(t);default:throw new Error("unpack non-nibble/hex type: "+e)}},this.unpackNibble=function(e){if(!o.hasOwnProperty(e))throw new Error("invalid nibble to unpack: "+e);return o[e]},this.unpackHex=function(e){if(e>=0&&15>=e)return e.toString(16).toUpperCase();throw new Error("invalid hex to unpack: "+e)}}var n=a(7214);e.exports=o},7306:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a={},o=e.nibbleEncode;for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(a[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(a[e.doubleByte[t]]=t+s.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var a=t[1]?2*(0,i["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+a+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t,o){if("string"!=typeof t)throw u.error("writer:writeString passed non-string type: "+typeof t)(t),new Error("invalid string");var n,r,i=a[t];if("c.us"!==t||o)if("undefined"==typeof i){var l=t.indexOf("@");if(1>l)this.writeStringRaw(e,t);else{var c=t.substring(0,l),d=t.substring(l+1);this.writeJid(e,c,d)}}else{if(i<s.SINGLE_BYTE_MAX)this.writeToken(e,i);else{var f=i-s.SINGLE_BYTE_MAX,p=f>>8;switch(r=f%256,p){case 0:n=s.DICTIONARY_0;break;case 1:n=s.DICTIONARY_1;break;case 2:n=s.DICTIONARY_2;break;case 3:n=s.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+i)}}this.writeToken(e,n),this.writeToken(e,r)}else this.writeToken(e,a["s.whatsapp.net"])},this.writeStringRaw=function(e,t){var a=l.numUtf8Bytes(t);if(a>=4294967296)throw new Error("string too large to encode (len = "+a+"): "+t);a>=1<<20?(e.pushByte(s.BINARY_32),e.pushInt32(a)):a>=256?(e.pushByte(s.BINARY_20),e.pushInt20(a)):(e.pushByte(s.BINARY_8),e.pushByte(a)),e.pushString(t)},this.writeJid=function(e,t,a){if(e.pushByte(s.JID_PAIR),t)try{this.writePackedBytes(e,t)}catch(o){u.warnVerbose('writer:encode-fallback "'+o.message+'"')(t),this.writeString(e,t)}else this.writeToken(e,s.LIST_EMPTY);this.writeString(e,a)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t){this.isAttr=!0;for(var a in t)t[a]&&(this.writeString(e,a),this.writeString(e,t[a]));this.isAttr=!1}},this.writeChildren=function(e,t){var a;if(t)if("string"==typeof t)this.writeString(e,t,!0);else if(t instanceof ArrayBuffer){if(a=t.byteLength,a>=4294967296)throw new Error("invalid children; too long (len = "+a);a>=1<<20?(e.pushByte(s.BINARY_32),e.pushInt32(a)):a>=256?(e.pushByte(s.BINARY_20),e.pushInt20(a)):(e.pushByte(s.BINARY_8),e.pushByte(a)),e.pushBytes(t)}else{if(!_.isArray(t))throw new Error("invalid children");a=t.length,this.writeListStart(e,a);for(var o=0;a>o;o++)this.writeNode(e,t[o])}},this.writeListStart=function(e,t){0===t?e.pushByte(s.LIST_EMPTY):256>t?(e.pushByte(s.LIST_8),e.pushByte(t)):(e.pushByte(s.LIST_16),e.pushInt16(t))},this.writePackedBytes=function(e,t){try{this.writePackedBytesImpl(e,t,s.NIBBLE_8)}catch(a){u.warn('writer:enc nib fail, try hex "'+a.message+'"')(t),this.writePackedBytesImpl(e,t,s.HEX_8)}},this.writePackedBytesImpl=function(e,t,a){var o=l.numUtf8Bytes(t);if(o>s.PACKED_MAX)throw new Error("too many bytes to nibble-encode: len = "+o);var n,r=Math.ceil(o/2),i=[],u=0;o%2>0&&(u=128);var c=u|r;i.push(a),i.push(c);for(var d=Math.floor(o/2),f=0;d>f;f++)n=this.packBytePair(a,t[2*f],t[2*f+1]),i.push(n);u>0&&(n=this.packBytePair(a,t[o-1],"\x00"),i.push(n));var p=new Uint8Array(i);e.pushUint8Array(p)},this.packBytePair=function(e,t,a){var o,n;switch(e){case s.NIBBLE_8:o=this.packNibble(t),n=this.packNibble(a);break;case s.HEX_8:o=this.packHex(t),n=this.packHex(a);break;default:throw new Error("invalid byte pack type: "+e)}return o<<4|n},this.packNibble=function(e){if(!o.hasOwnProperty(e))throw new Error("invalid byte to nibble-pack: "+e);return o[e]},this.packHex=function(e){switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"A":case"B":case"C":case"D":case"E":case"F":return parseInt(e,16);case"\x00":return 15;default:throw new Error("packHex:invalid byte: "+e)}}}var r=a(29),i=o(r),l=a(19),s=a(7214),u=a(1);e.exports=n},7307:function(e,t){"use strict";var a={singleByte:["title","description","canonical-url","matched-text","star","unstar"]};e.exports=a},7308:function(e,t){"use strict";var a={singleByte:["media_key"]};e.exports=a},7309:function(e,t){"use strict";var a={singleByte:["filename","identity","unread","page","page_count","search","media_message","security","call_log","profile"]};e.exports=a},7310:function(e,t){"use strict";var a={singleByte:["ciphertext","invite"]};e.exports=a},7311:function(e,t){"use strict";var a={singleByte:["gif","vcard","frequent"]};e.exports=a},7312:function(e,t){"use strict";var a={singleByte:["privacy","blacklist","whitelist","verify"]};e.exports=a},7313:function(e,t){"use strict";var a={singleByte:["location","document","elapsed","revoke_invite","expiration","unsubscribe","disable"]};e.exports=a},7314:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t,a=e.action||null,o=(0,k["default"])(le["default"].butterbar,(t={},(0,d["default"])(t,le["default"].action,a),(0,d["default"])(t,le["default"].computer,"computer"===e.type),(0,d["default"])(t,le["default"].phone,"phone"===e.type),(0,d["default"])(t,le["default"].notification,"notification"===e.type),(0,d["default"])(t,le["default"].battery,"battery"===e.type),(0,d["default"])(t,le["default"].update,"update"===e.type),t)),n={computer:"alert-computer",phone:"alert-phone",notification:"alert-notification",battery:"alert-battery",update:"alert-update"},r=e.onDismiss?C["default"].createElement("div",{className:le["default"].controls},C["default"].createElement(re["default"],{name:"x-light",onClick:e.onDismiss})):null,i=e.text?C["default"].createElement("div",{className:le["default"].text},e.text):null;return C["default"].createElement("div",{className:le["default"].wrapper},C["default"].createElement("div",{className:o,onClick:a},C["default"].createElement("div",{className:le["default"].icon},C["default"].createElement(re["default"],{name:n[e.type]})),C["default"].createElement("div",{className:le["default"].body},C["default"].createElement("div",{className:le["default"].title},e.title),i),r))}function r(){N["default"].closeModal()}function i(){switch($["default"].browser){case R["default"].BROWSER_TYPE.CHROME:return window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080004","_blank");case R["default"].BROWSER_TYPE.FIREFOX:return window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080006","_blank");case R["default"].BROWSER_TYPE.SAFARI:return window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080008","_blank");case R["default"].BROWSER_TYPE.OPERA:return window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080007","_blank");default:return window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080004","_blank")}}function l(){window.open(R["default"].FAQ_BASE_URL+"/faq/web/28080002")}Object.defineProperty(t,"__esModule",{value:!0});var s,u,c=a(48),d=o(c),f=a(5),p=o(f),h=a(2),m=o(h),g=a(4),_=o(g),v=a(7),b=o(v),y=a(6),E=o(y),S=a(3),C=o(S),M=a(23),k=o(M),w=a(12),N=o(w),T=a(269),P=o(T),I=a(8),R=o(I),A=a(7152),x=o(A),O=a(71),D=o(O),L=a(34),U=o(L),F=a(54),j=o(F),B=a(35),G=o(B),V=a(126),Y=o(V),W=a(55),H=o(W),q=a(33),z=o(q),K=a(7118),Q=o(K),J=a(64),X=o(J),Z=a(28),$=o(Z),ee=a(281),te=o(ee),ae=a(188),oe=o(ae),ne=a(172),re=o(ne),ie=a(7526),le=o(ie),se=3e3,ue=function(e){function t(){var e,a,o,n;(0,m["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,b["default"])(this,(e=t.__proto__||(0,p["default"])(t)).call.apply(e,[this].concat(i))),o.state={allowReconnect:!0},o.reconnect=function(){var e=oe["default"].numSocketsAttempted+1;z["default"].poke(),G["default"].waitForBBEvent(X["default"],"change:displayInfo",function(){return X["default"].displayInfo===X["default"].INFO.NORMAL;
}).then(function(){new U["default"].WebcManualWebsocketAttempt({webcManualWebsocketAttemptSuccessful:oe["default"].numSocketsAttempted===e}).commit()}),o.setState({allowReconnect:!1}),o._reconnectTimeoutTimer.onOrAfter(se)},o._reconnectTimeoutTimer=new H["default"](function(){o.setState({allowReconnect:!0})}),n=a,(0,b["default"])(o,n)}return(0,E["default"])(t,e),(0,_["default"])(t,[{key:"componentWillUnmount",value:function(){this._reconnectTimeoutTimer.cancel()}},{key:"render",value:function(){var e=void 0,t=void 0;return this.state.allowReconnect?(e=C["default"].createElement("span",null,l10n.t("make_sure_computer_active_internet_connection")+" ",C["default"].createElement("span",{className:le["default"].actionLink,onClick:this.reconnect},l10n.t("reconnect"))),t=l10n.t("computer_not_connected")):(e=null,t=l10n.t("connecting_to_whatsapp_or_phone")),C["default"].createElement(n,{type:"computer",title:t,text:e})}}]),t}(S.PureComponent),ce=(0,D["default"])(function(e){function t(){var e,a,o,n;(0,m["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,b["default"])(this,(e=t.__proto__||(0,p["default"])(t)).call.apply(e,[this].concat(i))),o.state={takingTooLong:!1,didShowSubtitle:!1},o._timeoutTimer=new H["default"](function(){o.setState({takingTooLong:!0,didShowSubtitle:!0})}),o.onProgress=function(){o._rerenderTimer.cancel(),o._timeoutTimer.onOrBefore(3e3),o.setState({takingTooLong:!1})},o._rerenderTimer=new H["default"](function(){o.forceUpdate()}),o.retry=function(){z["default"].poke(),o.onProgress()},n=a,(0,b["default"])(o,n)}return(0,E["default"])(t,e),(0,_["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(z["default"],"change:state",this.onProgress),this.props.listeners.add(z["default"],"change:retryTimestamp",this.onProgress)}},{key:"componentDidMount",value:function(){this._timeoutTimer.onOrBefore(3e3)}},{key:"componentWillUnmount",value:function(){this._timeoutTimer.cancel(),this._rerenderTimer.cancel()}},{key:"render",value:function(){var e,t;if(X["default"].displayInfo===X["default"].INFO.OPENING)e=l10n.t("connecting_to_whatsapp");else{if(X["default"].displayInfo!==X["default"].INFO.CONNECTING)return null;e=l10n.t("connecting_to_whatsapp_or_phone")}if(this.state.takingTooLong){this._rerenderTimer.onOrAfter(1e3);var a=z["default"].retryTimestamp-Date.now();if(1>a)a=l10n.t("retrying"),setTimeout(function(){z["default"].poke()},0);else if(6e4>a){var o=Math.ceil(a/1e3);a=l10n.t("retrying_in_some_seconds",{number:o,_plural:o})}else a=l10n.t("retrying_in",{duration:j["default"].duration(a).humanize()});t=C["default"].createElement("span",null,a," ",C["default"].createElement("span",{className:le["default"].actionLink,onClick:this.retry},l10n.t("retry_now")))}else t=this.state.didShowSubtitle?C["default"].createElement("span",null,l10n.t("retrying")):null;return C["default"].createElement(n,{type:"computer",title:e,text:t})}}]),t}(S.Component)),de=(0,D["default"])((0,Q["default"])((u=s=function(e){function t(e){(0,m["default"])(this,t);var a=(0,b["default"])(this,(t.__proto__||(0,p["default"])(t)).call(this,e));a.onReload=function(){te["default"].restart()},a.onClickManualDownload=function(){},a._showBatteryTimer=new H["default"](function(){return a.batteryUpdate(!1)}),a.dismissLowBatteryWarning=function(){var e=a.state.lowBatteryWarning;e>0&&a.setState({lowBatteryWarning:-e})},a._showNotifyTimer=new H["default"](function(e){a.setState({showNotify:e})}),a.requestPermissions=function(){N["default"].openModal(C["default"].createElement(x["default"],{title:"guide_desktop_notifications_title",desc:"guide_desktop_notifications_description",onConfirm:r,onCancel:i,type:x["default"].TYPE.GUIDE_ALLOW})),window.Notification.requestPermission(function(e){N["default"].closeModal(),a.setState({notifyPermission:e})})};var o=P["default"].battery<R["default"].BATTERY_LOW_THRESHOLD_1?P["default"].battery<R["default"].BATTERY_LOW_THRESHOLD_2?2:1:0;a.state={lowBatteryWarning:P["default"].plugged?0:o,notifyPermission:window.Notification&&window.Notification.permission,showNotify:!1};var n=function(){a.batteryUpdate(!0)};return e.listeners.add(P["default"],"change:plugged",n),e.listeners.add(P["default"],"change:battery",n),a}return(0,E["default"])(t,e),(0,_["default"])(t,[{key:"componentWillUnmount",value:function(){this._showNotifyTimer.cancel(),this._showBatteryTimer.cancel()}},{key:"batteryUpdate",value:function(e){var t=this.state.lowBatteryWarning;P["default"].plugged||P["default"].battery>R["default"].BATTERY_LOW_THRESHOLD_1?0!==t&&this.setState({lowBatteryWarning:0}):P["default"].battery<=R["default"].BATTERY_LOW_THRESHOLD_2?-2!==t&&(e?this._showBatteryTimer.onOrBefore(R["default"].BATTERY_DELAY):2!==t&&this.setState({lowBatteryWarning:2})):t>-1&&P["default"].battery<=R["default"].BATTERY_LOW_THRESHOLD_1&&(e?this._showBatteryTimer.onOrBefore(R["default"].BATTERY_DELAY):1!==t&&this.setState({lowBatteryWarning:1}))}},{key:"render",value:function(){var e=null;switch(X["default"].displayInfo){case X["default"].INFO.OFFLINE:e=C["default"].createElement(ue,{key:"bbar"});break;case X["default"].INFO.OPENING:case X["default"].INFO.CONNECTING:e=C["default"].createElement(ce,{key:"bbar"});break;case X["default"].INFO.NORMAL:break;case X["default"].INFO.RESUMING:case X["default"].INFO.TIMEOUT:var t=C["default"].createElement("span",null,l10n.t("make_sure_phone_active_internet_connection"),"",C["default"].createElement("span",{className:le["default"].actionLink,onClick:l},l10n.t("learn_more")));e=C["default"].createElement(n,{type:"phone",key:"bbar",title:l10n.t("phone_not_connected"),text:t})}if(!e&&this.state.lowBatteryWarning>0&&(e=C["default"].createElement(n,{type:"battery",key:"bbar",title:l10n.t("phone_battery_low"),text:l10n.t("charge_phone_description"),dismissable:!0,onDismiss:this.dismissLowBatteryWarning})),!e&&X["default"].needsUpdate&&(e=C["default"].createElement(n,{type:"update",key:"bbar",title:l10n.t("update_available"),text:l10n.t("click_to_update_whatsapp_web"),action:this.onReload})),X["default"].needsManualDownload&&(e=C["default"].createElement(n,{type:"update",key:"bbar",title:l10n.t("desktop_client_update_available"),text:l10n.t("click_to_download_desktop_client"),action:this.onClickManualDownload})),e)this.state.showNotify&&this._showNotifyTimer.onOrBefore(0,!1);else if(this.state.showNotify){if(window.Notification&&this.state.notifyPermission===R["default"].PERMISSION_DEFAULT){var a=C["default"].createElement("span",{className:le["default"].actionLink,onClick:this.requestPermissions},l10n.t("enable_desktop_notifications"));e=C["default"].createElement(n,{type:"notification",key:"bbar",title:l10n.t("get_notified_of_new_messages"),text:a})}}else this._showNotifyTimer.onOrBefore(R["default"].NOTIFICATION_PROMPT_DELAY,!0);return C["default"].createElement("div",{className:le["default"].container},C["default"].createElement(Y["default"],{transitionName:"butterbar"},e))}}]),t}(S.PureComponent),s.CONCERNS={stream:["displayInfo","needsUpdate","needsManualDownload"]},u)));t["default"]=function(){return C["default"].createElement(de,{conn:P["default"],stream:X["default"]})}},7315:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(484),_=(o(g),a(7181)),v=(o(_),a(7118)),b=o(v),y=a(7184),E=o(y),S=a(7119),C=o(S),M=a(7527),k=o(M),w=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.presence;if(a.isActive()){var o=a.getFormattedString();if(o)return m["default"].createElement(C["default"],{className:k["default"].chatstateTyping,direction:"inherit",ellipsify:!0,titlify:!0,text:o})}var n=t.previewMessage;return n?m["default"].createElement(E["default"],{msg:n,msgType:"LastMessage"}):null}}]),t}(m["default"].PureComponent);w.displayName="ChatStateInfo",w.CONCERNS={chat:["previewMessage"],chatstate:["id","type"]},w.WEAK_CONCERNS={presence:["hasData","withholdDisplay"]};var N=(0,b["default"])(w);t["default"]=function(e){var t=e.chat;return m["default"].createElement(N,{chat:t,presence:t.presence,chatstate:t.presence.chatstate})}},7316:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=n(r),l=a(62),s=o(l);t["default"]=function(e){var t=e.title,a=e.icon,o=e.t,n=o?s.relativeDateAndTimeStr(o):"-",r={cursor:"auto"};return i["default"].createElement("div",{className:"contact chat contact-msg-info-cell",style:r},i["default"].createElement("div",{className:"chat-body"},i["default"].createElement("div",{className:"chat-main"},i["default"].createElement("div",{className:"chat-title"},i["default"].createElement("span",{className:"ellipsify",dir:"auto"},a,t))),i["default"].createElement("div",{className:"chat-secondary"},i["default"].createElement("div",{className:"chat-status ellipsify"},i["default"].createElement("span",{className:"ellipsify",dir:"auto"},n)))))}},7317:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(7146),y=n(b),E=a(7123),S=n(E),C=a(62),M=o(C),k=a(7118),w=n(k),N=a(486),T=(n(N),a(7166),a(7119)),P=n(T),I=a(7529),R=n(I);t["default"]=(0,w["default"])((i=r=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.contact,a=e.msgInfoParticipant,o={cursor:"auto"},n=v["default"].createElement(S["default"],{id:t.id}),r=M.relativeDateAndTimeStr(a.t),i=v["default"].createElement("span",{title:r},r),l=void 0;return!t.name&&t.notifyName&&(l=v["default"].createElement("span",{className:R["default"].secondaryDetailContainer},v["default"].createElement(P["default"],{direction:"auto",text:t.notifyName}))),v["default"].createElement(y["default"],{id:t.id,contextEnabled:function(){return!1},image:n,primary:t.formattedName,secondary:i,secondaryDetail:l,style:o,theme:"drawer-list",idle:!0})}}]),t}(v["default"].PureComponent),r.CONCERNS={msgInfoParticipant:["t"],contact:["id","name","formattedName","notifyName"]},i))},7318:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(484),_=(o(g),a(7118)),v=o(_),b=a(93),y=o(b),E=a(7218),S=o(E),C=a(172),M=o(C),k=a(7530),w=o(k),N=a(23),T=o(N),P=a(126),I=o(P),R=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.shouldAnimate=!1,n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillUpdate",value:function(e){this.shouldAnimate=this.props.chat.id===e.chat.id}},{key:"render",value:function(){var e=this.props,t=e.chat,a=e.mute,o=a.isMuted?m["default"].createElement("div",{className:w["default"].icon,key:"icon-muted"},m["default"].createElement(M["default"],{name:"muted"})):null,n=t.pin?m["default"].createElement("div",{className:w["default"].icon,key:"icon-pinned"},m["default"].createElement(M["default"],{name:"pinned"})):null,r=0!==t.unreadCount?m["default"].createElement("div",{className:w["default"].icon,key:"icon-unread"},m["default"].createElement(S["default"],{count:t.unreadCount,muted:a.isMuted})):null,i=t.archive?m["default"].createElement("span",{className:(0,T["default"])(w["default"].icon,w["default"].archived),key:"icon-archived"},y["default"].t("chat_archived")):null;return m["default"].createElement(I["default"],{transitionName:"pop",transitionEnter:this.shouldAnimate,transitionLeave:this.shouldAnimate},o,i,n,r)}}]),t}(m["default"].PureComponent);R.CONCERNS={chat:["id","unreadCount","archive","pin"],mute:["isMuted"]},t["default"]=(0,v["default"])(R)},7319:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(57),l=o(i),s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(7156),b=(o(v),a(264)),y=o(b),E=a(3),S=o(E),C=a(46),M=o(C),k=a(7146),w=o(k),N=a(23),T=o(N),P=a(7139),I=o(P),R=a(177),A=o(R),x=a(7185),O=o(x),D=a(53),L=o(D),U=a(173),F=o(U),j=a(7118),B=o(j),G=a(71),V=o(G),Y=a(7125),W=(o(Y),a(174)),H=a(7143),q=o(H),z=a(7184),K=o(z),Q=a(10),J=o(Q),X=function(e){function t(){var e,a,o,n;(0,d["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,m["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(i))),o.onSearch=function(){o.setState({searchText:o.props.searchQuery.trimmed})},o.onActiveChange=function(e,t,a){if("focus"===e){var n=M["default"].findDOMNode(o);A["default"].focus(n,a),I["default"].scrollIntoViewIfNeeded(n)}o.setState({active:!!e})},o.onClick=function(e){if(J["default"].isFunction(o.props.onClick)){var t=o.props,a=t.msg,n=t.chat,r=Store.Msg.get(a.id),i=n.getSearchContext(r);i.msg=r,o.props.onClick(e,Store.Chat.get(n.id),i)}},o.onMouseDown=function(e){0===e.button&&o.onClick(e)},o.onEnter=function(e){e.preventDefault(),e.stopPropagation(),(0,U.shouldIndicateFocus)(),o.onClick(e)},o.indicateFocus=function(e){e.stopPropagation(),e.preventDefault(),(0,U.indicateFocus)(o.cell,["#e9eaeb","#cbdde7"],{complete:o.onBlur})},o.onBlur=function(e){var t=M["default"].findDOMNode(o.cell);t&&((0,y["default"])(t,"stop"),t.style.backgroundColor="")},n=a,(0,m["default"])(o,n)}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"componentWillMount",value:function(){this.initListeners(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.initListeners(e,this.props)}},{key:"initListeners",value:function(e,t){var a=e.listeners,o=e.active,n=e.msg,r=e.searchQuery;t&&t.searchQuery&&t.searchQuery!==r&&a.remove(r,v.SEARCH_EVENT,this.onSearch),!r||t&&r===t.searchQuery||a.add(r,v.SEARCH_EVENT,this.onSearch);var i=t&&t.msg.id;n.id.equals(i)||(t&&t.active&&a.remove(t.active,t.msg.id.toString(),this.onActiveChange),o&&a.add(o,n.id.toString(),this.onActiveChange));var l=o&&o.value instanceof L["default"]&&o.value.id.equals(n.id);this.setState({searchText:r.trimmed,active:l})}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.chat,o=e.searchQuery,n=this.state.active,r=S["default"].createElement(O["default"],{msg:t}),i=S["default"].createElement(K["default"],{msg:t,msgType:"FTSMessage",searchQuery:o.highlighted}),l={enter:this.onEnter},s=(0,T["default"])("cell-message",{active:!!n}),u=this.props.mouseDownAsClick;return S["default"].createElement(F["default"],{handlers:l,onFocus:this.indicateFocus,onBlur:this.onBlur},S["default"].createElement(w["default"],{id:t.id.toString(),ref:(0,W.GetRef)("cell",this),contextEnabled:function(){return!1},className:s,primary:S["default"].createElement(q["default"],{chat:a,titlify:!0,ellipsify:!0}),primaryDetail:r,secondary:i,onClick:u?null:this.onClick,onMouseDown:u?this.onMouseDown:null}))}}]),t}(S["default"].PureComponent);X.CONCERNS={msg:["id","isSentByMe","isGroupMsg","isNotification","senderObj","dir","rtl","type"],chat:["id","isUser","contact","formattedTitle"]},X.defaultProps={mouseDownAsClick:!1};var Z=(0,V["default"])((0,B["default"])(X));t["default"]=function(e){var t=e.msg,a=(0,l["default"])(e,["msg"]);return S["default"].createElement(Z,(0,r["default"])({msg:t,chat:t.chat},a))}},7320:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(53),_=(o(g),a(7118)),v=o(_),b=a(172),y=o(b),E=a(7532),S=o(E),C=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg.ack,t=void 0;return t=1>e?"status-time":1===e?"status-check":2===e?"status-dblcheck":"status-dblcheck-ack",m["default"].createElement("div",{className:S["default"].ack},m["default"].createElement(y["default"],{name:t}))}}]),t}(m["default"].PureComponent);C.CONCERNS={msg:["ack"]},t["default"]=(0,v["default"])(C)},7321:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7118),b=o(v),y=a(7135),E=o(y);t["default"]=(0,b["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.contextEnabled=function(){var e=o.props,t=e.contextEnabled,a=e.contact;return t(a)},o.onContext=function(e){var t=o.props,a=t.onContext,n=t.contact;return a(e,n)},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.contact,a=e.participant,o=e.onClick,n=e.contextMenu;return _["default"].createElement(E["default"],{contact:t,admin:a.isAdmin,onClick:o,theme:"drawer-list",contextEnabled:this.contextEnabled,contextMenu:n,onContext:this.onContext,showNotifyName:!0,waitIdle:!0})}}]),t}(g.Component),n.CONCERNS={participant:["isAdmin"]},r))},7322:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SenderElement=void 0;var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(486),b=(o(v),a(7119)),y=o(b),E=a(7118),S=o(E),C=a(7534),M=o(C);t["default"]=(0,S["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props.contact;return _["default"].createElement(k,{text:e.formattedShortName,isNumber:!e.name})}}]),t}(_["default"].PureComponent),n.CONCERNS={contact:["formattedShortName","name"]},r));var k=t.SenderElement=function(e){var t=e.text,a=e.isNumber;return _["default"].createElement("span",{className:M["default"].sender},_["default"].createElement(y["default"],{text:t,direction:a?"ltr":"auto"}),":")}},7323:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(0),l=o(i),s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(3),b=o(v),y=a(10),E=o(y),S=a(7205),C=o(S),M=a(7411),k=o(M),w=a(484),N=o(w),T=a(7254),P=o(T),I=a(12),R=o(I),A=a(7437),x=o(A),O=a(14),D=o(O),L=a(7447),U=o(L),F=a(7251),j=o(F),B=a(93),G=o(B),V=a(71),Y=o(V),W=a(1),H=o(W),q=a(7134),z=o(q),K=a(7418),Q=o(K),J=a(53),X=(o(J),a(72)),Z=o(X),$=a(7469),ee=o($),te=a(179);t["default"]=(0,Y["default"])((r=n=function(e){function t(){var e,a,o,n;(0,d["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,m["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(i))),o.onChatInfoDrawer=function(e){R["default"].openDrawerRight(b["default"].createElement(j["default"],{chat:e,key:"info-"+e.id}),"slide-left",o.context.uim)},o.onVerificationDrawer=function(e){R["default"].openDrawerRight(b["default"].createElement(ee["default"],{contact:Store.Contact.get(e),isFirstLevel:!0}),"slide-left",o.context.uim)},o.onMsgInfoDrawer=function(e){e.chat.kind===N["default"].KIND.CHAT?R["default"].openDrawerRight(b["default"].createElement(x["default"],{msg:e}),"slide-left",o.context.uim):R["default"].openDrawerRight(b["default"].createElement(U["default"],{msg:e}),"slide-left",o.context.uim)},o.onAttachMediaDrawer=function(e){var t=e.chat,a=e.files,n=e.animationName,r=e.initCaption,i=e.onComplete,l=e.fileOrigin;R["default"].existsDrawerMid(function(e){if(!e){t.composeAttachMediaContents||t.setComposeAttachMediaContents(new C["default"]);var s=t.composeAttachMediaContents,u={noFocus:!0,onEnterAnimationComplete:function(){a&&s.processFiles(a,t,l)}};R["default"].openDrawerMid(b["default"].createElement(k["default"],{chat:t,files:a,onComplete:i,initCaption:r,mediaCollection:s}),n||"slide-up",o.context.uim,u)}})},o.onChatSearch=function(e){R["default"].openDrawerRight(b["default"].createElement(P["default"],{chat:e}),"slide-left",o.context.uim)},o.onMediaViewer=function(e,t,a){Store.Msg.get(e.id)?R["default"].openModalMedia(b["default"].createElement(Q["default"],{msg:e,startTime:a,getZoomNode:t}),"media-viewer",o.context.uim):R["default"].openModal(b["default"].createElement(z["default"],{msg:e}))},o.onSendStarMsgs=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"LEFT";if(!t)return l["default"].reject(new D["default"].ActionError);if(E["default"].some(t,function(e){return!e.id}))return l["default"].reject(new D["default"].ActionError);a=a||(0,te.genId)();var r=E["default"].size(t),i={count:r,_plural:r},s=new te.ActionType(G["default"].t("action_message_starring",i)),u=e.sendStarMsgs(t,!0).then(function(r){return 200===r.status?new te.ActionType(G["default"].t("action_message_starred",i),G["default"].t("action_undo"),o.onSendUnstarMsgs.bind(o,e,t,a,n)):r.status>=400?new te.ActionType(G["default"].t("action_message_star_failed",i)):void 0})["catch"](function(r){return H["default"].error("chatAction:sendStarMsgs dropped")(r),new te.ActionType(G["default"].t("action_message_star_failed",i),G["default"].t("action_try_again"),o.onSendStarMsgs.bind(o,e,t,a,n))});return R["default"].openToast(b["default"].createElement(te.ActionToast,{id:a,toastPosition:n,initialAction:s,pendingAction:u})),u},o.onSendUnstarMsgs=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"LEFT";if(!t)return l["default"].reject(new D["default"].ActionError);if(E["default"].some(t,function(e){return!e.id}))return l["default"].reject(new D["default"].ActionError);a=a||(0,te.genId)();var r=E["default"].size(t),i={count:r,_plural:r},s=new te.ActionType(G["default"].t("action_message_unstarring",i)),u=e.sendStarMsgs(t,!1).then(function(r){return 200===r.status?new te.ActionType(G["default"].t("action_message_unstarred",i),G["default"].t("action_undo"),o.onSendStarMsgs.bind(o,e,t,a,n)):r.status>=400?new te.ActionType(G["default"].t("action_message_unstar_failed",i)):void 0})["catch"](function(r){return H["default"].error("chatAction:sendUnstarMsgs dropped")(r),new te.ActionType(G["default"].t("action_message_unstar_failed",i),G["default"].t("action_try_again"),o.onSendUnstarMsgs.bind(o,e,t,a,n))});return R["default"].openToast(b["default"].createElement(te.ActionToast,{id:a,toastPosition:n,initialAction:s,pendingAction:u})),u},o.onSendDeleteMsgs=function(e,t,a,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"LEFT";if(!t)return l["default"].reject(new D["default"].ActionError);if(E["default"].some(t,function(e){return!e.id}))return l["default"].reject(new D["default"].ActionError);var i=E["default"].size(t);n=n||(0,te.genId)();var s={count:i,_plural:i},u=new te.ActionType(G["default"].t("action_message_deleting",s)),c=e.sendDeleteMsgs(t,a).then(function(e){return 200===e.status?new te.ActionType(G["default"].t("action_message_deleted",s)):e.status>=400?new te.ActionType(G["default"].t("action_message_delete_failed",s)):void 0})["catch"](function(a){return H["default"].error("chatAction:sendDeleteMsgs dropped")(a),new te.ActionType(G["default"].t("action_message_delete_failed",s),G["default"].t("action_try_again"),o.onSendDeleteMsgs.bind(o,e,t,!1,n,r))});return R["default"].openToast(b["default"].createElement(te.ActionToast,{id:n,toastPosition:r,initialAction:u,pendingAction:c})),c},o.onSendRevokeMsgs=function(e,t,a,o){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"LEFT";if(!t)return l["default"].reject(new D["default"].ActionError);if(E["default"].some(t,function(e){return!e.canRevoke()}))return l["default"].reject(new D["default"].ActionError);var r=E["default"].size(t);o=o||(0,te.genId)();var i={count:r,_plural:r},s=new te.ActionType(G["default"].t("action_message_deleting",i)),u=e.sendRevokeMsgs(t,a).then(function(e){return new te.ActionType(G["default"].t("action_message_deleted",i))})["catch"](function(e){return H["default"].error("chatAction:sendRevokeMsgs fail")(e),new te.ActionType(G["default"].t("action_message_delete_failed",i))});return R["default"].openToast(b["default"].createElement(te.ActionToast,{id:o,toastPosition:n,initialAction:s,pendingAction:u})),u},n=a,(0,m["default"])(o,n)}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.listeners;e.add(R["default"],"chat_info_drawer",this.onChatInfoDrawer),e.add(R["default"],"msg_info_drawer",this.onMsgInfoDrawer),e.add(R["default"],"chat_search",this.onChatSearch),e.add(R["default"],"attach_media_drawer",this.onAttachMediaDrawer),e.add(R["default"],"verification_drawer",this.onVerificationDrawer),e.add(R["default"],"media_viewer_modal",this.onMediaViewer),e.add(R["default"],"send_star_msgs",this.onSendStarMsgs),e.add(R["default"],"send_unstar_msgs",this.onSendUnstarMsgs),e.add(R["default"],"send_delete_msgs",this.onSendDeleteMsgs),e.add(R["default"],"send_revoke_msgs",this.onSendRevokeMsgs)}},{key:"render",value:function(){return null}}]),t}(b["default"].Component),n.contextTypes={uim:b["default"].PropTypes.instanceOf(Z["default"])},r))},7324:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(7119),b=o(v),y=a(93),E=o(y),S=a(71),C=o(S),M=a(7128),k=(o(M),a(126)),w=o(k),N=a(7144),T=o(N),P=a(172),I=o(P),R=a(7538),A=o(R);t["default"]=(0,C["default"])(function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(this.props.selections,"all"),this.firstRenderActive=this.props.startActive}},{key:"render",value:function(){var e=void 0;return _["default"].size(this.props.selections.getSelected())>0?e=m["default"].createElement("div",{className:A["default"].controlsSummary},m["default"].createElement(x,{chats:this.props.selections.getSelected()}),m["default"].createElement("div",{"data-animate-btn":!0,className:this.firstRenderActive?A["default"].btnActive:A["default"].btnAction},m["default"].createElement(T["default"],{large:!0,onClick:this.props.onForward},m["default"].createElement(I["default"],{name:"send-light",directional:!0})))):this.firstRenderActive=!1,m["default"].createElement(w["default"],{transitionName:"slide-up-down-footer",className:A["default"].container},e)}}]),t}(m["default"].Component));var x=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.state={chats:a.props.chats},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=this.state.chats,a=e.chats;t=_["default"].size(a)>_["default"].size(t)?t.concat(_["default"].difference(a,t)):_["default"].intersection(t,a),this.setState({chats:t})}},{key:"render",value:function(){var e=_["default"].map(this.state.chats,function(e){return e.isGroup?e.formattedTitle:e.formattedShortNameWithNonBreakingSpaces});return E["default"].isRTL()||e.reverse(),m["default"].createElement(w["default"],{transitionName:"pop",className:A["default"].summaryText},m["default"].createElement(b["default"],{text:e.join(E["default"].t("enumeration_comma"))}))}}]),t}(m["default"].Component)},7325:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var n=a(96),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(8),b=o(v),y=a(7155),E=o(y),S=a(484),C=o(S),M=a(486),k=(o(M),a(12)),w=o(k),N=a(7135),T=o(N),P=a(47),I=o(P),R=a(173),A=o(R),x=a(7156),O=(o(x),a(7136)),D=o(O),L=a(71),U=o(L),F=a(7319),j=o(F),B=a(3),G=o(B),V=a(46),Y=o(V),W=a(7160),H=o(W),q=a(7125),z=(o(q),a(127)),K=o(z),Q=a(261),J=o(Q),X=a(177),Z=o(X),$=a(7170),ee=o($),te=a(1),ae=o(te),oe=0,ne=1,re=2,ie=3,le=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));se.call(a),a._listPointerEvents=!0,a.ftsStarred=a.getFTSStarred(e),a.ftsMessages=a.getFTSMessages(e),a.debouncedOpenSelected=a.props.debounce(function(){a.openSelected(a.focusComposer),a.focusComposer=!1},200);var o=void 0;return o=0,a.state={textsize:o},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.props.selection.init(this.getSelection())}},{key:"componentWillReceiveProps",value:function(e){this.ftsStarred=this.getFTSStarred(e),this.ftsMessages=this.getFTSMessages(e)}},{key:"componentWillUnmount",value:function(){var e=this.getSelection(),t=this.props.selection.getVal();t&&t.isState&&!this.props.isSearching&&!e.length&&w["default"].clearChat(t)}},{key:"componentDidMount",value:function(){var e=this;this.props.listeners.add(w["default"],"focus_chat_list",this.restoreFocus),this.props.listeners.add(w["default"],"focus_next_chat",function(t){e.onNextChat(null,!0,t)}),this.props.listeners.add(w["default"],"focus_prev_chat",function(t){e.onPrevChat(null,!0,t)}),this.props.listeners.add(w["default"],"update_chatlist_selection",this.updateSelected),this.props.listeners.add(w["default"],"textsize_change",function(t){e.setState({textsize:t})})}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.selection.getVal();this.props.selection.init(this.getSelection(),!e.isSearching&&!this.props.isSearching),a!==this.props.selection.getVal()&&(this.focusComposer=!0,this.debouncedOpenSelected())}},{key:"openSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,t=this.props.selection.getVal();t&&(t instanceof C["default"]&&t!==this.getActiveChat()?w["default"].openChatFromUnread(t).then(function(a){a&&e&&w["default"].focusChatTextInput(t)}):e&&w["default"].focusChatTextInput(t))}},{key:"getSelection",value:function(){return[].concat((0,r["default"])(this.props.chats),(0,r["default"])(this.props.contacts),(0,r["default"])(this.ftsStarred),(0,r["default"])(this.ftsMessages))}},{key:"getSection",value:function(e){var t=this.props,a=t.chats,o=t.contacts,n=t.isSearching,r=[];return a.length>0&&r.push(oe),n&&o.length>0&&r.push(ne),this.ftsStarred.length>0&&r.push(re),this.ftsMessages.length>0&&r.push(ie),r[e]}},{key:"scrollListIntoFocusedItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;this.list&&this.list.getComponent().scrollIntoViewIfNeeded(this.getIndexPathForActiveIndex(),e)}},{key:"focusFirst",value:function(){var e=this.uie;e&&e.activate(),this.props.selection.setFirst(),this.scrollListIntoFocusedItem(0),this.debouncedOpenSelected()}},{key:"onNextChat",
value:function(e,t,a){e&&(e.preventDefault(),e.stopPropagation());var o=this.props.selection.next();this.props.selection.index!==o&&(this.props.selection.setNext(!0,e),this.focusComposer=a,this.scrollListIntoFocusedItem(),this.debouncedOpenSelected())}},{key:"onPrevChat",value:function(e,t,a){e&&(e.stopPropagation(),e.preventDefault());var o=this.props.selection.prev();o>-1?(this.props.selection.setPrev(!0,e),this.focusComposer=a,this.scrollListIntoFocusedItem(),this.debouncedOpenSelected()):t||(this.debouncedOpenSelected.cancel(),this.openSelected(),this.props.onFocusSearch())}},{key:"getIndexPathForActiveIndex",value:function(){for(var e=this.props,t=e.chats,a=e.contacts,o=this.props.selection.index,n=[t,a,this.ftsStarred,this.ftsMessages],r=0,i=0;i<n.length;i++){if(o<n[i].length)return new ee["default"](o,r);n[i].length>0&&r++,o-=n[i].length}return ae["default"].warn("index out of bounds of data in chatlist getIndexPathForActiveIndex")(),new ee["default"](0,0)}},{key:"render",value:function(){var e=this,t={down:function(t){return e.onNextChat(t)},j:function(t){return e.onNextChat(t)},up:function(t){return e.onPrevChat(t)},k:function(t){return e.onPrevChat(t)}},a=72,o=_["default"].find(b["default"].LIST_HEIGHT_TEXTSIZE_MAP,function(t){return t.scale===e.state.textsize});return o&&(a=o.height),G["default"].createElement(J["default"],{displayName:"Chatlist",ref:this.setUIERef,state:J["default"].State.PASSIVE,requestFocus:this.requestFocus},G["default"].createElement(A["default"],{handlers:t,onFocus:this.onFocusGain,"data-tab":3},G["default"].createElement(D["default"],{itemForRowAtIndexPath:this.itemForRowAtIndexPath,keyForRowAtIndexPath:this.keyForRowAtIndexPath,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,numberOfSections:this.numberOfSections,heightForItem:a,extraItems:10,ref:this.listRef,onPointerEventsOff:this.onListPointerEventsOff,onPointerEventsOn:this.onListPointerEventsOn})))}},{key:"getActiveChat",value:function(){return _["default"].find(Store.Chat.toArray(),{active:!0})}}]),t}(G["default"].Component);le.defaultProps={chats:[]};var se=function(){var e=this;this.onListPointerEventsOff=function(){e._listPointerEvents=!1},this.onListPointerEventsOn=function(){e._listPointerEvents=!0},this.updateSelected=function(t){e.debouncedOpenSelected.cancel(),e.props.selection.setVal(t,!1)},this.onClick=function(t,a,o){t.preventDefault(),t.stopPropagation(),Store.Chat.find(a.id).then(function(t){e.props.isSearching&&e.props.onClick&&e.props.onClick(),o?w["default"].openChatAt(t,o).then(function(e){e&&w["default"].focusChatTextInput(t)}):t!==e.getActiveChat()?w["default"].openChatFromUnread(t).then(function(e){e&&w["default"].focusChatTextInput(t)}):w["default"].focusChatTextInput(t)})},this.getFTSStarred=function(e){return _["default"].filter(e.ftsResult,{star:!0})},this.getFTSMessages=function(e){return _["default"].filter(e.ftsResult,{star:!1})},this.numberOfSections=function(){var t=e.props,a=t.contacts,o=t.chats,n=t.isSearching,r=o.length>0?1:0;return n?(a.length>0&&r++,I["default"].supportsFeature(I["default"].F.FULL_TEXT_SEARCH)?(e.ftsStarred.length>0&&r++,e.ftsMessages.length>0&&r++,r):r):r},this.numberOfRowsInSection=function(t){var a=e.props,o=a.contacts,n=a.chats;switch(e.getSection(t)){case oe:return n.length;case ne:return o.length;case re:return e.ftsStarred.length;case ie:return e.ftsMessages.length;default:return 0}},this.sectionForSection=function(t){var a=e.props.isSearching;if(a)switch(e.getSection(t)){case oe:return G["default"].createElement(H["default"],{key:"chat-header",header:l10n.t("web_chats")});case ne:return G["default"].createElement(H["default"],{key:"contact-header",header:l10n.t("web_contacts")});case re:return G["default"].createElement(H["default"],{key:"fts-header-starred",header:l10n.t("web_starred_messages")});case ie:return G["default"].createElement(H["default"],{key:"fts-header-messages",header:l10n.t("web_messages")})}},this.keyForRowAtIndexPath=function(t){var a=e.props,o=a.chats,n=a.contacts,r=t.row,i=t.section;switch(e.getSection(i)){case oe:return o[r].id;case ne:return n[r].id;case re:return e.ftsStarred[r].id.toString();case ie:return e.ftsMessages[r].id.toString()}},this.itemForRowAtIndexPath=function(t){var a=e.props,o=a.chats,n=a.contacts,r=a.searchQuery,i=t.row,l=t.section;switch(e.getSection(l)){case oe:var s=o[i];return G["default"].createElement(E["default"],{chat:s,contact:s.contact,mode:y.Mode.LAST,searchQuery:r,onClick:e.onClick,mouseDownAsClick:!0,active:e.props.selection});case ne:var u=n[i];return G["default"].createElement(T["default"],{contact:u,active:e.props.selection,searchQuery:r,onClick:e.onClick,mouseDownAsClick:!0});case re:var c=e.ftsStarred[i];return G["default"].createElement(j["default"],{msg:c,searchQuery:r,onClick:e.onClick,active:e.props.selection});case ie:var d=e.ftsMessages[i];return G["default"].createElement(j["default"],{msg:d,searchQuery:r,onClick:e.onClick,active:e.props.selection})}},this.restoreFocus=function(t){e.props.selection.reset(!0,t)},this.onFocusGain=function(t){if(t.target===Y["default"].findDOMNode(e)&&e._listPointerEvents)if(e.props.selection.index<0)e.focusFirst();else{var a=e.uie;a&&a.activate(),e.props.selection.reset(!0,t)}},this.setUIERef=function(t){e.uie=t,e.uie&&(e.hotKey=e.uie.refs.uiElement)},this.onFocusList=function(){e.list&&Z["default"].focus(Y["default"].findDOMNode(e.hotKey))},this.requestFocus=function(){e.props.selection.reset(!1),e.props.selection.index>-1&&document.activeElement===document.body&&e.onFocusList()},this.listRef=function(t){e.list=t}};t.Component=le;t["default"]=(0,U["default"])((0,K["default"])(le))},7326:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(33),_=o(g),v=a(7265),b=o(v),y=a(94),E=o(y),S=a(7419),C=o(S),M=a(7420),k=o(M),w=a(7424),N=o(w),T=a(7252),P=o(T),I=a(7266),R=o(I),A=a(21),x=o(A),O=a(489),D=o(O),L=a(7127),U=o(L),F=a(7123),j=o(F),B=a(12),G=o(B),V=a(7497),Y=o(V),W=a(7149),H=a(47),q=o(H),z=a(263),K=o(z),Q=a(23),J=o(Q),X=a(7118),Z=o(X),$=a(127),ee=o($),te=a(71),ae=o(te),oe=a(126),ne=o(oe),re=a(172),ie=o(re),le=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.onWindowFocus=function(){e.setState({newlyFocused:!0}),e.props.setTimeout(function(){return e.setState({newlyFocused:!1})},100)},e.onMouseDown=function(){},e.onDrag=function(t){e.didDrag=!0},e.onClickCapture=function(e){},e.onNewChat=function(e){e.preventDefault(),G["default"].openDrawerLeft(m["default"].createElement(C["default"],null))},e.onProfile=function(){var e=Store.Status.get(Store.Conn.me),t=Store.ProfilePicThumb.get(Store.Conn.me);G["default"].openDrawerLeft(m["default"].createElement(b["default"],{status:e,profilePicThumb:t,conn:Store.Conn}))},e.onUnmute=function(){Store.Mute.globalMute().unmute(),G["default"].openToast(m["default"].createElement(K["default"],{msg:l10n.t("global_unmuted"),id:(0,z.genId)()}))},e.state={},e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e=null;this.props.mute.isMuted&&(e=m["default"].createElement(W.MenuBarItem,{a8n:"menu-bar-unmute",icon:m["default"].createElement(ie["default"],{name:"dnd"}),title:l10n.t("global_unmute"),onClick:this.onUnmute,key:"btn-dnd"}));var t=null;q["default"].supportsFeature(q["default"].F.STATUS_V3_UI_VIEWING)&&Store.ServerProps.statusV3&&(t=m["default"].createElement(Y["default"],null));var a=(0,J["default"])("pane-list-user",{}),o=(0,J["default"])("pane-list-controls",{});return m["default"].createElement("header",{className:"pane-header pane-list-header",onMouseDown:this.onMouseDown,onClickCapture:this.onClickCapture},m["default"].createElement("div",{className:a},m["default"].createElement(j["default"],{id:Store.Conn.me,size:40,onClick:this.onProfile})),m["default"].createElement("div",{className:o},m["default"].createElement(W.MenuBar,{key:"chatlist-header"},m["default"].createElement(ne["default"],{transitionName:"btn"},e,t,m["default"].createElement(W.MenuBarItem,{a8n:"menu-bar-chat",icon:m["default"].createElement(ie["default"],{name:"chat",directional:!0}),title:l10n.t("web_menuitem_new"),onClick:this.onNewChat}),m["default"].createElement(W.MenuBarItem,{a8n:"menu-bar-menu",icon:m["default"].createElement(ie["default"],{name:"menu"}),title:l10n.t("menutitle_menu")},m["default"].createElement(se,null))))))}}]),t}(m["default"].Component);le.CONCERNS={mute:["isMuted"]},e.exports=(0,ee["default"])((0,ae["default"])((0,Z["default"])(le)));var se=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.onCreateGroup=function(){G["default"].openDrawerLeft(m["default"].createElement(k["default"],null))},e.onProfile=function(){var e=Store.Status.get(Store.Conn.me),t=Store.ProfilePicThumb.get(Store.Conn.me);G["default"].openDrawerLeft(m["default"].createElement(b["default"],{status:e,profilePicThumb:t,conn:Store.Conn}))},e.onDisconnect=function(){var e=Store.Msg.some(function(e){return 0===e.ack&&e.local&&e.isSentByMe});return e?void G["default"].openModal(m["default"].createElement(E["default"],{title:l10n.t("confirm_logout"),onOK:function(){return _["default"].logout()},okText:l10n.t("menuitem_logout"),onCancel:function(){return G["default"].closeModal()},cancelText:l10n.t("web_cancel")},l10n.t("some_of_your_messages_are_still_sending"))):_["default"].logout()},e.onArchived=function(){G["default"].openDrawerLeft(m["default"].createElement(P["default"],null))},e.onSettings=function(){G["default"].openDrawerLeft(m["default"].createElement(N["default"],null))},e.onStarred=function(){G["default"].openDrawerLeft(m["default"].createElement(R["default"],{starredMsgs:Store.AllStarredMsgs}))},e.state={rememberMe:x["default"].getRememberMe()},e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=q["default"].supportsFeature(q["default"].F.GROUP_CREATE)?m["default"].createElement(U["default"],{a8n:"mi-new-group menu-item",action:this.onCreateGroup,shortcut:"g"},l10n.t("web_menuitem_groupchat")):null,t=q["default"].supportsFeature(q["default"].F.STARRED)&&q["default"].supportsFeature(q["default"].F.FULL_TEXT_SEARCH)?m["default"].createElement(U["default"],{a8n:"mi-starred menu-item",action:this.onStarred},l10n.t("menuitem_starred")):null,a=l10n.t("menuitem_profile_status"),o=l10n.t("menuitem_profile");return m["default"].createElement(D["default"],{type:"dropdown_menu",flipOnRTL:!0,key:"ChatlistHeader",dirX:"left"},e,m["default"].createElement(U["default"],{a8n:"mi-profile-status menu-item",action:this.onProfile},Store.ServerProps.statusV2?a:o),m["default"].createElement(U["default"],{a8n:"mi-archived menu-item",action:this.onArchived},l10n.t("menuitem_archived")),t,m["default"].createElement(U["default"],{a8n:"mi-setting menu-item",action:this.onSettings},l10n.t("menuitem_settings")),m["default"].createElement(U["default"],{a8n:"mi-logout menu-item",action:this.onDisconnect,shortcut:"q"},l10n.t("menuitem_logout")))}}]),t}(m["default"].Component)},7327:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(7135),b=o(v),y=a(173),E=o(y),S=a(7125),C=o(S),M=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.focusLast=function(e){_["default"].size(o.props.contacts)&&o.selection.setLast(!0,e)},o.focusPrev=function(e){e.preventDefault(),e.stopPropagation();var t=o.selection.prev();t>-1&&o.selection.setPrev(!0,e)},o.focusNext=function(e){e.preventDefault(),e.stopPropagation();var t=o.selection.next();o.selection.index===t?(o.selection.unset(),o.props.onFocusSearch(e)):o.selection.setNext(!0,e)},o.deleteContact=function(e){e.preventDefault(),e.stopPropagation();var t=_["default"].find(o.props.contacts,o.selection.getVal());o.props.onDelete(e,t)},o.onParticipantClick=function(e,t){o.selection.setVal(t)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.selection=new C["default"](this.props.contacts,function(e){return e.id})}},{key:"componentWillReceiveProps",value:function(e){this.selection.init(e.contacts,!0)}},{key:"render",value:function(){var e=this,t=this.props.contacts;if(!t)return null;var a=_["default"].size(t)?_["default"].map(t,function(t){return m["default"].createElement(b["default"],{contact:t,active:e.selection,onDelete:e.props.onDelete,onClick:e.onParticipantClick,type:v.Type.SMALL,key:t.id})}):null,o={up:this.focusPrev,down:this.focusNext,backspace:this.deleteContact};o[l10n.LR("left","right")]=this.focusPrev,o[l10n.LR("right","left")]=this.focusNext;var n=m["default"].createElement("ul",{ref:"list"},a);return m["default"].createElement(E["default"],{handlers:o},n)}}]),t}(m["default"].PureComponent);t["default"]=M},7328:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(23),E=o(y),S=a(10),C=o(S),M=a(93),k=o(M),w=a(7326),N=o(w),T=a(7140),P=o(T),I=a(7325),R=o(I),A=a(7126),x=a(175),O=o(x),D=a(7314),L=o(D),U=a(12),F=o(U),j=a(47),B=o(j),G=a(7182),V=a(14),Y=o(V),W=a(7125),H=o(W),q=a(8),z=o(q),K=a(177),Q=o(K),J=a(7272),X=o(J),Z=a(173),$=o(Z),ee=a(55),te=o(ee),ae=a(265),oe=o(ae),ne=a(484),re=(o(ne),a(486)),ie=(o(re),a(7156)),le=o(ie),se=a(264),ue=o(se),ce=a(174),de=a(71),fe=o(de),pe=a(485),he=o(pe),me=a(127),ge=o(me),_e=z["default"].MIN_CHARS_FOR_FTS,ve={THROTTLE:450},be=50,ye=75,Ee=1e3,Se=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));a._batchState={},a.setSearch=function(e){return a.search=e},a.debounceSetState=function(e,t,o){C["default"].assign(a._batchState,e),C["default"].isUndefined(t)&&C["default"].isUndefined(o)?a._debounceSetState.forceRunNow():C["default"].isUndefined(o)?a._debounceSetState.debounce(t):a._debounceSetState.debounceAndCap(t,o)},a.getFilteredContacts=function(e){if(e=C["default"].trim(e),!e)return[];e=k["default"].accentFold(e);var t=oe["default"].numberSearch(e),a=Store.Contact.getFilteredContacts();return a.filter(function(a){if(!a.searchMatch(e,t))return!1;var o=Store.Chat.get(a.id);return!o||!o.isVisible})},a.getFilteredChats=function(e){if(e=C["default"].trim(e),!e)return Store.Chat.filter(function(e){return!e.archive&&e.isVisible});var t=function(){e=k["default"].accentFold(e);var t=oe["default"].numberSearch(e);return{v:Store.Chat.filter(function(a){return a.contact.searchMatch(e,t)&&a.isVisible})}}();return"object"==typeof t?t.v:void 0},a.fullTextSearch=function(e){if(B["default"].supportsFeature(B["default"].F.FULL_TEXT_SEARCH)){var t=C["default"].trim(e||a.searchQuery.query);(0,G.numCodepoints)(t)>=_e?a._fts():a.isFTSSearching()?a.cancelSearch():a.ftsMsgs.reset()}},a.shouldFTSSearch=function(e){return!a.ftsMsgs.hasMoreMsgs||a.isFTSSearching()||!B["default"].supportsFeature(B["default"].F.FULL_TEXT_SEARCH)||(0,G.numCodepoints)(a.searchQuery.query||"")<_e?!1:e.scrollTop+z["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight},a.onSearch=function(e){if(!e)return void a.onStopSearch();var t=a.searchQuery.query;e!==t&&(a.fullTextSearch(e),a.throttledFilteredChats(e),a.throttledFilteredContacts(e),a.searchQuery.updateQuery(e))},a.hasSearchText=function(){return!!a.searchQuery.query},a.isFTSSearching=function(){var e=a._batchState;return"searching"in e?e.searching:a.state.searching},a.cancelSearch=function(){a._fts.cancel(),a.ftsMsgs.resetSearch(),a.ftsMsgs.reset(),a._ftsPromise&&a._ftsPromise.cancel(),a.isFTSSearching()&&a.debounceSetState({searching:!1},ye)},a.cancelThrottled=function(){a.throttledFilteredChats.cancel(),a.throttledFilteredContacts.cancel(),a.throttledOnScroll.cancel()},a.onStopSearch=function(){a.cancelSearch(),a.searchQuery.clear(),a.cancelThrottled(),a.search&&a.search.setState({searchText:a.searchQuery.query}),a.debounceSetState({chats:a.getFilteredChats(),contacts:a.getFilteredContacts(),searching:!1})},a.onFocusList=function(e){e.repeat||a.chatlist&&a.search.isAtEnd()&&(e.preventDefault(),e.stopPropagation(),(0,Z.shouldIndicateFocus)(),a.chatlist.focusFirst())},a.onOpenFirst=function(e){e.preventDefault();var t=a.searchQuery.query,o=C["default"].head(a.getFilteredChats(t))||C["default"].head(a.getFilteredContacts(t));o&&Store.Chat.find(o.id).then(function(e){a.onStopSearch(),(0,Z.shouldIndicateFocus)(),F["default"].openChatFromUnread(e).then(function(t){t&&F["default"].focusChatTextInput(e)})})},a.onFocusSearch=function(e){F["default"].existsDrawerLeft(function(e){e||((0,Z.shouldIndicateFocus)(),Q["default"].focus(a.search))})},a.indicateFocus=function(){(0,Z.indicateFocus)(a.refs.input_hotkey,["#FBFBFB","#D9F3FF"])},a.onScroll=function(e){a.throttledOnScroll(e.target)},a.getEmptyChatlistState=function(e,t,o){return e&&e.length||t&&t.length||o&&o.length?null:a.searchQuery.query?a.state.searching?_["default"].createElement(A.Searching,null):_["default"].createElement(A.Search,null):Store.Chat.some(function(e){return e.isVisible})?_["default"].createElement(A.AllArchived,null):_["default"].createElement(A.ListChats,null)},a.disableResort=function(){Store.Chat.disableSortListener(),a.enableResortDebounced()},a.setRefPanel=function(e){a.panel=e},a._debounceSetState=new te["default"](function(){a.setState(a._batchState),a._batchState={}}),a.ftsMsgs=new X["default"],a.selection=new H["default"]([],function(e){return e.id.toString()}),a.searchQuery=new le["default"],a._fts=a.props.debounce(function(){var e=a.searchQuery.trimmed;a._ftsPromise&&a._ftsPromise.cancel(),a._ftsPromise=r["default"].resolve().then(function(){a.isFTSSearching()||a.debounceSetState({searching:!0},ye)}).then(function(){return a.ftsMsgs.search(e)}).checkpoint(a.props.rejectOnUnmount()).then(function(e){a.debounceSetState({searching:!1},ye)})["catch"](Y["default"].Unmount,C["default"].noop)["catch"](r["default"].CancellationError,C["default"].noop)["finally"](function(){a._ftsPromise=void 0})["catch"](function(){a.isFTSSearching()&&a.debounceSetState({searching:!1},ye)})},750),a.throttledFilteredChats=a.props.throttle(function(e){var t=a.getFilteredChats(e);a.debounceSetState({chats:t},ye,be)},ve.THROTTLE,{leading:!1,trailing:!0}),a.throttledFilteredContacts=a.props.throttle(function(e){var t=a.getFilteredContacts(e);a.debounceSetState({contacts:t},ye,be)},ve.THROTTLE,{leading:!1,trailing:!0}),a.throttledOnScroll=a.props.throttle(function(e){a.shouldFTSSearch(e)&&a.fullTextSearch()},100);var o;return o=0,a.enableResortDebounced=a.props.debounce(function(){return a.enableResort()},Ee),a.handleUserInteraction=a.disableResort,a.handleMouseOut=a.enableResort,a.state={searching:!1,chats:a.getFilteredChats(),contacts:a.getFilteredContacts(),textsize:o},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.props.listeners.add(Store.Chat,"remove",function(t){if(e.searchQuery.query){var a=C["default"].without(e.state.chats,t);e.state.chats&&a.length!==e.state.chats.length&&e.debounceSetState({chats:a})}else e.throttledFilteredChats.cancel(),e.debounceSetState({chats:e.getFilteredChats()})}),this.props.listeners.add(Store.Contact,"remove",function(t){if(e.searchQuery.query){var a=C["default"].without(e.state.contacts,t);e.state.contacts&&a.length!==e.state.contacts.length&&e.debounceSetState({contacts:a})}else e.throttledFilteredContacts.cancel(),e.debounceSetState({contacts:e.getFilteredContacts()})}),this.props.listeners.add(Store.Chat,"sort change:archive",function(){e.searchQuery.query||(e.throttledFilteredChats.cancel(),e.debounceSetState({chats:e.getFilteredChats()}))}),this.props.listeners.add(Store.Contact,"sort",function(){e.searchQuery.query||(e.throttledFilteredContacts.cancel(),e.debounceSetState({contacts:e.getFilteredContacts()}))}),this.props.listeners.add(this.ftsMsgs,"bulk_remove reset"),this.props.listeners.add(F["default"],"focus_chat_search",this.onFocusSearch),this.props.listeners.add(F["default"],"textsize_change",function(t){e.debounceSetState({textsize:t})}),this.props.listeners.add(Store.Msg,"new_msg_sent",function(){var t=b["default"].findDOMNode(e.panel);if(t){var a=t.scrollTop;0!==t.scrollTop&&(a<t.clientHeight?(0,ue["default"])(t,"scroll",{duration:300,container:t,offset:-(t.scrollTop+t.getBoundingClientRect().top)}):t.scrollTop=0)}})}},{key:"componentWillUnmount",value:function(){this.cancelSearch(),this.cancelThrottled(),this._debounceSetState.cancel(),this.enableResort()}},{key:"enableResort",value:function(){Store.Chat.enableSortListener(!0)}},{key:"render",value:function(){var e=this,t=this.state,a=t.chats,o=t.contacts,n=this.ftsMsgs.models,r=this.getEmptyChatlistState(a,o,n);r||(r=_["default"].createElement(R["default"],{ref:(0,ce.GetRef)("chatlist",this),chats:a,contacts:o,isSearching:!!this.hasSearchText(),searchQuery:this.searchQuery,ftsResult:n,selection:this.selection,onFocusSearch:this.onFocusSearch,onClick:this.onStopSearch}));var i,l={down:this.onFocusList,enter:this.onOpenFirst},s=this.state.searching&&this.ftsMsgs.length?_["default"].createElement("div",{key:"spinner",className:"chatlist-panel-spinner"},_["default"].createElement(O["default"],{stroke:6,size:24})):null,u=C["default"].find(z["default"].TEXTSIZE_CLASS_MAP,function(t){return t.scale===e.state.textsize});u&&(i=u.classname);var c=(0,E["default"])("chatlist-panel",i,this.props.className),d=this.ftsMsgs.hasMoreMsgs&&n.length?this.onScroll:void 0;return _["default"].createElement("div",{id:"side",className:c,onMouseMove:this.handleUserInteraction,onScroll:this.handleUserInteraction,onMouseLeave:this.handleMouseOut},_["default"].createElement(N["default"],{key:"ChatHeader",mute:Store.Mute.globalMute()}),_["default"].createElement(L["default"],{key:"ButterBar"}),_["default"].createElement($["default"],{handlers:l,onFocus:this.indicateFocus,ref:"input_hotkey",className:"chatlist-panel-search"},_["default"].createElement(P["default"],{ref:this.setSearch,onSearch:this.onSearch,loading:this.state.searching})),_["default"].createElement("div",{ref:this.setRefPanel,className:"chatlist-panel-body",onScroll:d,id:"pane-side","data-list-scroll-container":!0},r,s))}}]),t}(_["default"].Component);t["default"]=(0,he["default"])((0,ge["default"])((0,fe["default"])(Se)))},7329:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,a){for(var o=[],n=0,r=0;n<e.length||r<t.length;)a(e[n],t[r])?o.push(e[n++]):o.push(t[r++]);return n<e.length?o.concat(e.slice(n)):r<t.length?o.concat(t.slice(r)):o}var r=a(96),i=o(r),l=a(0),s=o(l),u=a(5),c=o(u),d=a(2),f=o(d),p=a(4),h=o(p),m=a(7),g=o(m),_=a(6),v=o(_),b=a(17),y=o(b),E=a(12),S=o(E),C=a(3),M=o(C),k=a(46),w=o(k),N=a(264),T=o(N),P=a(496),I=o(P),R={duration:300,easing:[.1,.82,.25,1]},A=function(e,t){return e.map(function(e,a){return[t[a]===e,a]}).filter(function(e){var t=(0,y["default"])(e,1),a=t[0];return!a}).map(function(e){var t=(0,y["default"])(e,2),a=t[1];return a})},x=function(e,t){return A(e,t).filter(function(a){return e[a]&&!t[a]})},O=function(e,t,a){var o=A(e,t).filter(function(a){return!e[a]&&t[a]}),r=a.filter(function(e){return!!t[e]});return r.length?n(o,r,function(e,t){return t>e}):o},D=function(e){function t(){var e,a,o,n;(0,f["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,g["default"])(this,(e=t.__proto__||(0,c["default"])(t)).call.apply(e,[this].concat(i))),o.containerHeight=0,o.childAnimations=[],o.didCancel=!1,o.state={children:o.props.children||[]},o.pendingRemoval=[],n=a,(0,g["default"])(o,n)}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"getHeightChange",value:function(e,t){var a=this;return e.reduce(function(e,o){if(t>o)return e;var n=a.refs["animation-child-"+o];if(!n)return e;var r=w["default"].findDOMNode(n);return r?e+r.clientHeight:e},0)}},{key:"animateElement",value:function(e,t,a,o){var n=this;this.childAnimations[e]||(this.childAnimations[e]=s["default"].resolve()),this.childAnimations[e]&&(this.didCancel=!0,this.childAnimations[e].cancel());var r=a>0?[0,a]:[-a,0];return this.childAnimations[e]=(this.childAnimations[e]||s["default"].resolve()).then(function(){return(0,T["default"])(t,{translateY:r},R)}).cancellable().then(function(){return 0>a&&(-1===o.indexOf(e)?t.style.transform="":t.style.opacity="0"),e})["catch"](s["default"].CancellationError,function(){return(0,T["default"])(t,"stop",!0),t.style.transform="",!1})["finally"](function(){n.didCancel?n.didCancel=!1:(delete n.childAnimations[e],S["default"].setUiBusy(!1,"animation_group"))}),this.childAnimations[e]}},{key:"transitionAffected",value:function(e,t){if(!e)return s["default"].resolve();for(var a=[],o=e.slice(-1),n=(0,y["default"])(o,1),r=n[0],i=0;r>=i;++i){var l=this.refs["animation-child-"+i];l&&a.push(this.animateElement(i,w["default"].findDOMNode(l),(t?1:-1)*this.getHeightChange(e,i),e))}return s["default"].all(a).then(function(e){return e.filter(function(e){return e!==!1})})}},{key:"notifyHeightChange",value:function(e,t){e.length&&this.props.onHeightChange&&this.props.onHeightChange((t?1:-1)*this.getHeightChange(e,0))}},{key:"componentWillReceiveProps",value:function(e){var t,a=this,o=e.children,n=void 0===o?[]:o,r=x(this.state.children,n);this.added=O(this.state.children,n,this.pendingRemoval);for(var l=0;l<this.added.length;++l)this.busyId=I["default"].setBusy(this.busyId),S["default"].setUiBusy(!0,"animation_group");if(!r.length)return this.setState({children:n});var s=r.filter(function(e){return-1===a.pendingRemoval.indexOf(e)});if(s.length){for(var u=0;u<s.length;++u)this.busyId=I["default"].setBusy(this.busyId),S["default"].setUiBusy(!0,"animation_group");(t=this.pendingRemoval).push.apply(t,(0,i["default"])(s)),this.notifyHeightChange(s,!1),this.transitionAffected(s,!1).then(function(e){a.pendingRemoval=a.pendingRemoval.filter(function(e){return-1===s.indexOf(e)}),e.length>0&&a.setState({children:n},function(){I["default"].decBusy(a.busyId)})})}}},{key:"componentDidUpdate",value:function(e,t){var a=this;t.children;this.added.length&&(this.notifyHeightChange(this.added,!0),this.transitionAffected(this.added,!0).then(function(){I["default"].decBusy(a.busyId)}))}},{key:"componentDidMount",value:function(){var e=this,t=this.state.children.reduce(function(t,a,o){var n=e.refs["animation-child-"+o];if(!n)return t;var r=w["default"].findDOMNode(n);return r?(r.style.transform="translateY(0)",t+r.clientHeight):t},0);this.props.onHeightChange(t,!0)}},{key:"render",value:function(){var e=this.state.children,t=M["default"].Children.map(e,function(e,t){return e?M["default"].cloneElement(e,{ref:"animation-child-"+t}):e});return M["default"].createElement("div",null,t)}}]),t}(M["default"].Component);e.exports=D},7330:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(484),b=(o(v),a(7127)),y=o(b),E=a(7118),S=o(E);t["default"]=(0,S["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.disabled,o=this.props.onArchive.bind(null,!t.archive);return _["default"].createElement(y["default"],{a8n:"mi-archive",action:o,shortcut:"a",key:"ArchiveMenuItem",disabled:a},t.archive?l10n.t("unarchive_chat"):l10n.t("archive_chat"))}}]),t}(_["default"].PureComponent),n.CONCERNS={chat:["archive"]},r))},7331:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(172),E=o(y),S=a(126),C=o(S),M=a(7545),k=o(M),w=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onToggle=function(e){e&&e.stopPropagation(),o.props.onChange()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e,t=void 0,a=void 0;this.props.checked?(a="checkbox-round-checked",t="checked"):(t="unchecked",a=this.props.hover?"checkbox-round-unchecked":"checkbox-round-passive");var o=(0,b["default"])(k["default"].roundIcon,(e={},(0,r["default"])(e,k["default"].unchecked,!this.props.checked&&this.props.hover),(0,r["default"])(e,k["default"].passive,!this.props.checked&&!this.props.hover),e));return _["default"].createElement(C["default"],{className:k["default"].container,transitionName:"pop"},_["default"].createElement("div",{className:o,key:t,onClick:this.onToggle},_["default"].createElement(E["default"],{name:a})))}}]),t}(_["default"].Component);t["default"]=w},7332:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(71),m=o(h),g=a(484),_=(o(g),a(53)),v=(o(_),a(511)),b=(o(v),a(7175)),y=o(b),E=a(175),S=o(E),C=a(7126),M=a(7546),k=o(M),w=a(3),N=a(8),T=a(10),P=a(12),I=(a(7128),function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onScroll=function(e){o.handleScroll(e.target)},o.handleScroll=T.throttle(function(e){var t=o.props.docMsgs;t.hasDocBefore&&e.scrollTop+N.SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&o.queryDocs(t.head())},100),o.onClickMsg=function(e,t){o.props.selectable&&void 0!==t?o.props.onMessageSelect(e,t):P.openChatAt(e.chat,e.chat.getSearchContext(e))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.docMsgs.hasDocBefore&&this.queryDocs()}},{key:"componentDidMount",value:function(){this.props.listeners.add(this.props.docMsgs,"add remove reset"),this.props.listeners.add(this.props.docMsgs,"query_doc_before")}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel()}},{key:"queryDocs",value:function(e){var t=this,a=this.props.docMsgs;a.hasDocBefore&&this.props.listeners.uiIdle(function(){a.queryDocs(t.props.chat,e)})}},{key:"render",value:function(){var e=this,t=this.props.docMsgs,a=this.props.selectedMessages,o=t.map(function(t){return w.createElement(y["default"],{key:t.id,ref:t.id.toString(),msg:t,displayType:N.DISP_TYPE.GALLERY,selectable:e.props.selectable,selectedMessages:a,onMessageSelect:e.props.onMessageSelect,onClickMsg:e.onClickMsg})});if(o.reverse(),t.queryDocBefore){if(0===o.length)return w.createElement(C.Loading,null);o.push(w.createElement("div",{className:k["default"].spinner,key:"spinner"},w.createElement(S["default"],{stroke:6,size:24})))}return 0!==t.length||t.queryDocBefore||t.hasDocBefore?w.createElement("div",{onScroll:this.onScroll,className:k["default"].docGallery},o):w.createElement(C.DocMsgs,null)}}]),t}(w.Component));e.exports=(0,m["default"])(I)},7333:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(24),r=o(n),i=a(175),l=o(i),s=a(172),u=o(s),c=a(7547),d=o(c),f=a(3),p=function(e){var t=e.children,a=e.onClick,o=a?{
onClick:a}:{};return f.createElement("div",(0,r["default"])({className:d["default"].docState},o),t)},h=function(e){var t=e.onClick;return f.createElement(p,{onClick:t||_.noop},f.createElement(u["default"],{name:"audio-download"}))},m=function(e){var t=e.outgoingMsg;return f.createElement(p,null,f.createElement("div",{className:d["default"].spinner},f.createElement(l["default"],{stroke:3,size:32,outgoingMsg:t})))},g=function(e){var t=e.outgoingMsg;return f.createElement(p,null,f.createElement("div",{className:d["default"].spinner},f.createElement(l["default"],{stroke:3,size:32,outgoingMsg:t})),f.createElement(u["default"],{name:"audio-cancel-noborder"}))},v=function(){return f.createElement(p,null,f.createElement(u["default"],{name:"audio-upload"}))};e.exports={Download:h,Pending:m,PendingCancel:g,Upload:v}},7334:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i,l=a(48),s=o(l),u=a(5),c=o(u),d=a(2),f=o(d),p=a(4),h=o(p),m=a(7),g=o(m),_=a(6),v=o(_),b=a(3),y=o(b),E=a(46),S=o(E),C=a(273),M=o(C),k=a(23),w=o(k),N=a(71),T=o(N),P=a(7548),I=o(P);t["default"]=(0,T["default"])((r=n=function(e){function t(e){(0,f["default"])(this,t);var a=(0,g["default"])(this,(t.__proto__||(0,c["default"])(t)).call(this,e));i.call(a);var o=a.props.start?a.props.start.x:0,n=a.props.start?a.props.start.y:0;return a.state={height:0,width:0,dragging:!1,x:o,y:n,scaledPadding:a.props.scale*a.props.padding,offsetX:0,offsetY:0,center:void 0},a}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"componentDidMount",value:function(){this.updateContainer()}},{key:"componentWillReceiveProps",value:function(e){e.scale!==this.props.scale||e.container.width!==this.props.container.width||e.container.height!==this.props.container.height?this.updateContainer(e,!0):this.updateContainer(e)}},{key:"render",value:function(){var e,t=this.props.scale?" scale("+this.props.scale+")":"",a=(e={},(0,s["default"])(e,M["default"].prefix("transform"),"translate("+this.state.x+"px, "+this.state.y+"px)"+t),(0,s["default"])(e,"padding",this.props.padding+"px"),e);this.state.dragging||(a[M["default"].prefix("transition")]="transform 200ms");var o=(0,w["default"])(I["default"].draggable,(0,s["default"])({},I["default"].dragging,this.state.dragging));return y["default"].cloneElement(y["default"].Children.only(this.props.children),{style:a,draggable:!0,ref:"draggable",className:o,onMouseDown:this.handleMouseDown})}}]),t}(y["default"].Component),i=function(){var e=this;this.updateContainer=function(t,a){t=t||e.props;var o=t.container;if(o&&e.refs.draggable){var n=S["default"].findDOMNode(e.refs.draggable),r=n&&0===n.width&&t.childSize?t.childSize.width:n.width,i=n&&0===n.height&&t.childSize?t.childSize.height:n.height,l=o.x?o.x:0,s=o.y?o.y:0,u=e.state.x,c=e.state.y,d=r*t.scale,f=i*t.scale,p=t.padding*t.scale,h=void 0;e.props.scale!==t.scale&&e.state.center?(h=e.state.center,u=o.width/2+l-h.x*d,c=o.height/2+s-h.y*f):h={x:(o.width/2+l-u)/d,y:(o.height/2+s-c)/f},u+p>l?u=l-p:u+d+p<l+o.width&&(u=l+o.width-d-p),c+p>s?c=s-p:c+f+p<s+o.height&&(c=s+o.height-f-p),e.setState({width:d,height:f,x:u,y:c,scaledPadding:p,center:h}),e.props.onStop&&a&&t.onStop(u,c)}},this.handleMouseDown=function(t){t.preventDefault(),e.setState({dragging:!0,offsetX:t.clientX-e.state.x,offsetY:t.clientY-e.state.y}),e.props.listeners.add(window,"mousemove",e.handleMouseMove),e.props.listeners.add(window,"mouseup",e.handleMouseUp),e.props.onStart&&e.props.onStart()},this.handleMouseUp=function(t){e.props.listeners.remove(window,"mousemove",e.handleMouseMove),e.props.listeners.remove(window,"mouseup",e.handleMouseUp),e.setState({dragging:!1}),e.props.onStop&&e.props.onStop(e.state.x,e.state.y)},this.handleMouseMove=function(t){if(e.state.dragging){var a=t.clientX-e.state.offsetX,o=t.clientY-e.state.offsetY,n=e.props.container,r=n.x?n.x:0,i=n.y?n.y:0,l=e.state.scaledPadding;n&&((a+l>r||a+e.state.width+l<r+n.width)&&(a=e.state.x),(o+l>i||o+e.state.height+l<i+n.height)&&(o=e.state.y)),e.setState({x:a,y:o}),e.props.onDrag&&e.props.onDrag(a,o)}}},r))},7335:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(7551),l=o(i),s=function(e){var t=e.children;return r["default"].createElement("div",{className:l["default"].tooltip},t)};t["default"]=s},7336:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(8),b=o(v),y=a(7139),E=o(y),S=a(177),C=o(S),M=a(173),k=o(M),w=a(1),N=o(w),T=a(3),P=o(T),I=a(7125),R=o(I),A=a(175),x=o(A),O=a(127),D=o(O),L=a(23),U=o(L),F=a(7552),j=o(F),B=3,G=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={},o.selection=new R["default"](o.props.thumbnails,function(e){return e.id}),o.handleMouseDown=function(e){e.preventDefault(),e.stopPropagation()},o.handleClick=function(e){var t=e.target;o.props.onImageClick&&1===t.nodeType&&"IMG"===t.tagName&&o.props.onImageClick(t.src)},o.handleEnter=function(e){var t=o.selection.getVal();N["default"].assert(t,"No value selected, but enter clicked")(),o.props.onImageClick&&o.props.onImageClick(t.thumbUrl)},o._requestMoreImagesIfNeeded=function(){var e=o.refs.body;o.props.isLoadingMore||o.props.canLoadMore&&o.props.onRequestMoreImages&&e.scrollTop+b["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&o.props.onRequestMoreImages()},o.handleScroll=o.props.throttle(o._requestMoreImagesIfNeeded,100),o.selectPrev=function(e){e.preventDefault(),e.stopPropagation(),o.selection.setPrev(!1,e),o._updateSelected(!0,!0)},o.selectNext=function(e){e.preventDefault(),e.stopPropagation(),o.selection.setNext(!1,e),o._updateSelected(!0,!0)},o.selectPrevRow=function(e){if(e.preventDefault(),e.stopPropagation(),0===o.selection.index&&o.props.onFocusPrev)o.props.onFocusPrev();else{var t=Math.max(o.selection.index-B,0);o.selection.set(t,!1,!1,e),o._updateSelected(!0,!0)}},o.selectNextRow=function(e){e.preventDefault(),e.stopPropagation(),o.selection.set(o.selection.index+B,!1,!1,e),o._updateSelected(!0,!0)},o.handleFocus=function(e){e.stopPropagation(),e.preventDefault(),(_["default"].isNil(o.selection.index)||o.selection.index<0)&&o.selection.setFirst(!1,e),o._updateSelected(!0,!1);var t=_["default"].head(o.refs[""+o.selection.index].getElementsByClassName(j["default"].imageGalleryItemOverlay));(0,M.indicateFocus)(t,void 0,void 0,{backgroundColorAlpha:[0,.5]})},o.handleRequestDismiss=function(){o.selection.unset(),o.setState({selectedImage:void 0})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this._updateSelected()}},{key:"componentDidUpdate",value:function(){this._requestMoreImagesIfNeeded(),this.selection.init(this.props.thumbnails,!1,!1),this._updateSelected()}},{key:"_updateSelected",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1);if(this.state.selectedImage!==this.selection.getVal()&&(this.setState({selectedImage:this.selection.getVal()}),this.selection.index>-1)){var t=this.refs[""+this.selection.index];C["default"].focus(t),e&&E["default"].scrollIntoViewIfNeeded(t,!1)}}},{key:"render",value:function(){var e=this,t={down:this.selectNextRow,enter:this.handleEnter,left:this.selectPrev,right:this.selectNext,up:this.selectPrevRow},a=_["default"].map(this.props.thumbnails,function(t,a){var o=t.id,n=t.thumbUrl,i=e.state.selectedImage?e.state.selectedImage.id===o:!1,l=(0,U["default"])(j["default"].imageGalleryItem,(0,r["default"])({},j["default"].selected,i)),s=P["default"].createElement("div",{className:j["default"].imageGalleryItemOverlay});return P["default"].createElement("div",{key:o,ref:a,className:l,tabIndex:-1},s,P["default"].createElement("img",{onClick:e.handleClick,className:j["default"].imageGalleryItemImage,src:n}))}),o=this.props.isLoadingMore?P["default"].createElement("div",{tabIndex:-1,className:j["default"].imageGalleryFooter},P["default"].createElement(x["default"],{stroke:6,size:24})):null;return P["default"].createElement(k["default"],{className:j["default"].imageGallery,"data-tab":3,handlers:t,onFocus:this.handleFocus,onMouseDown:this.handleMouseDown},P["default"].createElement("div",{ref:"body",className:j["default"].imageGalleryList,onScroll:this.handleScroll},a,P["default"].createElement("div",{tabIndex:-1,className:j["default"].imageGalleryItemSpacer}),P["default"].createElement("div",{tabIndex:-1,className:j["default"].imageGalleryItemSpacer}),P["default"].createElement("div",{tabIndex:-1,className:j["default"].imageGalleryItemSpacer}),o))}}]),t}(P["default"].PureComponent);G.defaultProps={thumbnails:[]};t.Component=G;t["default"]=(0,D["default"])(G)},7337:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(10),m=o(h),g=a(484),_=(o(g),a(512)),v=(o(_),a(12)),b=o(v),y=a(8),E=o(y),S=a(7126),C=a(7338),M=o(C),k=a(71),w=o(k),N=a(53),T=(o(N),a(7128)),P=(o(T),a(175)),I=o(P),R=a(7175),A=o(R),x=a(7553),O=o(x),D=a(3),L=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onScroll=function(e){o.handleScroll(e.target)},o.handleScroll=m["default"].throttle(function(e){var t=o.props.linkMsgs;t.hasLinkBefore&&e.scrollTop+E["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight&&o.queryLinks(t.head())},100),o.onClickMsg=function(e,t){o.props.selectable&&void 0!==t?o.props.onMessageSelect(e,t):b["default"].openChatAt(e.chat,e.chat.getSearchContext(e))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.linkMsgs.hasLinkBefore&&this.queryLinks()}},{key:"componentDidMount",value:function(){this.props.listeners.add(this.props.linkMsgs,"add remove reset"),this.props.listeners.add(this.props.linkMsgs,"query_link_before")}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel()}},{key:"queryLinks",value:function(e){var t=this,a=this.props.linkMsgs;a.hasLinkBefore&&this.props.listeners.uiIdle(function(){a.queryLinks(t.props.chat,e)})}},{key:"render",value:function(){var e=this,t=this.props.linkMsgs,a=this.props.selectedMessages,o=[];if(t.forEach(function(t){t.links.forEach(function(n,r){o.push(D.createElement(M["default"],{key:t.id+"-"+r,msg:t,link:n,selectable:e.props.selectable,selectedMessages:a,onMessageSelect:e.props.onMessageSelect,onClickMsg:e.onClickMsg}))}),t.isLink&&o.push(D.createElement(A["default"],{key:t.id,ref:t.id.toString(),msg:t,selectable:e.props.selectable,selectedMessages:a,onMessageSelect:e.props.onMessageSelect,displayType:E["default"].DISP_TYPE.GALLERY,onClickMsg:e.onClickMsg}))}),o.reverse(),t.queryLinkBefore){if(0===o.length)return D.createElement(S.Loading,null);o.push(D.createElement("div",{className:O["default"].spinner,key:"spinner"},D.createElement(I["default"],{stroke:6,size:24})))}return 0!==t.length||t.queryLinkBefore||t.hasLinkBefore?D.createElement("div",{onScroll:this.onScroll,className:O["default"].wrapper},o):D.createElement(S.LinkMsgs,null)}}]),t}(D.Component);e.exports=(0,w["default"])(L)},7338:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(71),_=o(g),v=a(7197),b=o(v),y=a(7142),E=o(y),S=a(7119),C=o(S),M=a(23),k=o(M),w=a(7128),N=(o(w),a(126)),T=o(N),P=a(93),I=o(P),R=a(488);t["default"]=(0,_["default"])(function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));a.mouseOver=function(){a.state.hover||a.setState({hover:!0})},a.mouseEnter=function(){a.state.hover||a.setState({hover:!0})},a.mouseLeave=function(){a.state.hover&&a.setState({hover:!1})},a.onSelectChange=function(e){a.state.selected!==e&&a.setState({selected:e})},a.onSelectClick=function(e){e&&e.stopPropagation(),a.props.onMessageSelect(a.props.msg,!a.state.selected)},a.onClick=function(){a.props.onClickMsg(a.props.msg,!a.state.selected)};var o=e.msg,n=e.selectedMessages;return a.state={hover:!1,selected:n?n.isSelected(o):!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.selectedMessages&&this.props.listeners.add(this.props.selectedMessages,this.props.msg.id.toString(),this.onSelectChange)}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.link,o=this.props.selectable||this.state.hover?m["default"].createElement("div",{className:"msg-select",onClick:this.onSelectClick},m["default"].createElement(E["default"],{onChange:this.onSelectClick,checked:this.state.selected})):null,n={wrapper:(0,k["default"])("starred-msg-wrapper",{hover:this.state.hover}),linkContainer:(0,k["default"])("message tail-override-left link-message",{"message-out":t.isSentByMe,"message-in":!t.isSentByMe})},r=!0,i=t.isTrusted?R.Configuration.TrustedConversation:R.Configuration.UntrustedConversation,l=i({mentions:t.mentionMap(),selectable:r});return m["default"].createElement("div",{className:n.wrapper,onClick:this.onClick,onMouseEnter:this.state.hover?null:this.mouseEnter,onMouseOver:this.state.hover?null:this.mouseOver,onMouseLeave:this.state.hover?this.mouseLeave:null},m["default"].createElement("div",{className:"msg"},m["default"].createElement(T["default"],{transitionName:"delay-leave"},o),m["default"].createElement("div",{className:n.linkContainer},m["default"].createElement("span",{className:"tail-container"}),m["default"].createElement("div",{className:"bubble message-text"},m["default"].createElement(b["default"],{title:a.url,canonicalUrl:a.domain}),m["default"].createElement(C["default"],{text:t.body,selectable:r,className:"link-msg-text",dirMismatch:t.rtl!==I["default"].isRTL(),direction:t.dir,formatters:l})))))}}]),t}(m["default"].Component))},7339:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={shouldAnimate:!0}},7340:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(273),E=o(y),S=a(264),C=o(S),M=a(7555),k=o(M),w=200,N=E["default"].prefix("transform"),T=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.dirtyShadowDOM=!1,o.isAnimating=!1,n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"shouldComponentUpdate",value:function(e){var t=this.props.dataKey!==e.dataKey||this.props.rowHeight!==e.rowHeight;return t||this.props.rowOffset===e.rowOffset?t&&this.isAnimating&&(0,C["default"])(b["default"].findDOMNode(this),"stop"):e.animate?this.animate(e):t=!0,t&&(this.dirtyShadowDOM=!this.dirtyShadowDOM),t}},{key:"componentDidUpdate",value:function(e){this.props.animate&&this.animate(this.props)}},{key:"animate",value:function(e){var t=this,a=e.rowOffset,o=e.prevRowOffset,n=e.zIndex;return"number"!=typeof o?!1:(this.isAnimating=!0,(0,C["default"])(b["default"].findDOMNode(this),{translateY:[a,o],zIndex:[n,n]},{easing:"easeInOut",duration:w}).then(function(){t.isAnimating=!1}),!0)}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.rowHeight,o=e.rowOffset,n=e.zIndex,i=this.dirtyShadowDOM?"translateY("+o+"px)":"translate3d(0, "+o+"px, 0)",l=(0,r["default"])({zIndex:n,height:a},N,i);return _["default"].createElement("div",{className:k["default"].item,style:l},t)}}]),t}(_["default"].Component);t["default"]=T},7341:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(273),E=o(y),S=a(176),C=o(S),M=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.state={rendered:!1},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.setState({rendered:!0})}},{key:"render",value:function(){var e=this.props,t=e.children,a=e.rowNumber,o=e.rowHeight,n=e.zIndex,i=e.className,l=(0,r["default"])({zIndex:n,height:o},E["default"].prefix("transform"),"translate3d(0, "+o*a+"px, 0)");return i=(0,b["default"])(i,{"infinite-list-item":!0,"infinite-list-item-keyframe":!this.state.rendered,"infinite-list-item-transition":!0}),_["default"].createElement("div",{"data-a8n":C["default"].key("infinite-list-item"),className:i,style:l},t)}}]),t}(_["default"].Component);e.exports=M},7342:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(484),b=(o(v),a(7127)),y=o(b),E=a(7118),S=o(E);t["default"]=(0,S["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.disabled,o=this.props.onMarkUnread.bind(null,!t.unreadCount);return _["default"].createElement(y["default"],{a8n:"mi-mark-as",action:o,shortcut:"r",key:"MarkUnreadMenuItem",disabled:a},t.unreadCount?l10n.t("mark_read_chat"):l10n.t("mark_unread_chat"))}}]),t}(_["default"].PureComponent),n.CONCERNS={chat:["unreadCount"]},r))},7343:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(23),m=o(h),g=a(484),_=(o(g),a(12)),v=o(_),b=a(94),y=o(b),E=a(7353),S=o(E),C=a(7177),M=o(C),k=a(493),w=a(173),N=o(w),T=a(3),P=o(T),I=a(126),R=o(I),A=a(261),x=o(A),O=a(7137),D=o(O),L=a(489),U=a(7168),F=(o(U),a(172)),j=o(F),B=a(7193),G=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={active:!1,emojiPicker:null},o.onEmojiPicker=function(e){e&&(e.preventDefault(),e.stopPropagation());var t=P["default"].createElement(M["default"],{onEmoji:o.onEmoji,onFocusRelease:o.restoreFocus});o.setState({emojiPicker:{menu:t,dirY:L.DirY.TOP,type:"emoji_picker",anchor:e.target}}),o.restoreFocus()},o.onEmojiPickerClose=function(){o.setState({emojiPicker:null})},o.onRestoreEmojiPickerFocus=function(){o.refs.emojiPickerUIE&&o.refs.emojiPickerUIE.getRef()&&o.refs.emojiPickerUIE.getRef().getElement()&&o.refs.emojiPickerUIE.getRef().getElement().component.restoreFocus()},o.onEmoji=function(e){var t=o.refInput;t&&(t.focus(!1),t.replaceSelection(e)),o.onEmojiPickerClose()},o.setRefInput=function(e){o.refInput=e},o.onSelectionChange=function(e){o.selection=e},o.onMaxPasteExceeded=function(){v["default"].openModal(P["default"].createElement(y["default"],{title:l10n.t("caption_too_large_title"),onOK:function(){v["default"].closeModal()},okText:l10n.t("web_ok")},l10n.t("caption_too_large_text")))},o.restoreFocus=function(){o.refInput&&o.refInput.focus()},o.onBlur=function(e){o.state.active&&o.setState({active:!1}),o.props.onBlur&&o.props.onBlur(e)},o.onFocus=function(e){e.stopPropagation(),o.state.active||o.setState({active:!0}),o.props.onFocus&&o.props.onFocus(e)},o.onReset=function(){o.refInput&&o.refInput.reset()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.focusOnMount&&this.restoreFocus()}},{key:"render",value:function(){var e=this.props.maxLength,t=(0,k.graphemeLength)(this.props.value||""),a=50>e-t,o=(0,m["default"])("text-input","active",this.props.className,{"no-placeholder":!this.props.placeholder,active:!0}),n=(0,m["default"])("label-text",{"label-text-float":!!this.props.value}),r=(0,m["default"])("input-wrapper",{"input-text-active":this.state.active}),i=this.props.showRemaining?P["default"].createElement("div",{className:"control-button-container char-counter"},P["default"].createElement("div",{className:"char-counter"},a?l10n.n(e-t):null)):null,l=this.props.supportsEmoji?P["default"].createElement("button",{className:"media-caption-input-emoji",onClick:this.onEmojiPicker},P["default"].createElement(j["default"],{name:"emoji-input"})):void 0,s=null,u=void 0;return this.state.emojiPicker&&(u=P["default"].createElement(x["default"],{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.onEmojiPickerClose,requestFocus:this.onRestoreEmojiPickerFocus},P["default"].createElement(D["default"],{contextMenu:this.state.emojiPicker}))),P["default"].createElement(N["default"],{className:o,onFocus:this.restoreFocus},P["default"].createElement("span",{className:n},this.props.placeholder),P["default"].createElement("div",{className:"input-spacer"}),P["default"].createElement("div",{className:"media-caption-suggestions-positioner"},P["default"].createElement("div",{className:"media-caption-suggestions-container"},P["default"].createElement(S["default"].Suggestions,{chat:this.props.chat,theme:B.ThemeOptions.MEDIA_CAPTION}))),P["default"].createElement("div",{className:r,"data-trump-dominateparent":"click"},P["default"].createElement(S["default"],{ref:this.setRefInput,initialValue:this.props.value,initialSelection:this.selection,readOnly:!1,spellCheck:this.props.spellCheck,multiline:this.props.multiline,maxLength:this.props.maxLength,onEnter:this.props.onEnter,onMaxPasteExceeded:this.onMaxPasteExceeded,onFiles:this.props.onFiles,onChange:this.props.onChange,onSelect:this.onSelectionChange,theme:"default"}),P["default"].createElement("div",{className:"textinput-controls"},P["default"].createElement(R["default"],{transitionName:"pop",component:"div",className:"control-button-container"},s,l),i)),u)}}]),t}(T.Component);G.defaultProps={maxLength:25},t["default"]=G},7344:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(10),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(7559),E=o(y),S=0,C=1,M=2,k=3,w=4,N=5,T=6,P=7,I=0,R=1,A=2,x=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.getResizerCallback=function(e){return function(t){a.setState({resizeDirection:e,currentAction:R,previousMousePosition:{x:t.clientX,y:t.clientY}})}},a.onMoveStart=function(e){a.setState({currentAction:A,previousMousePosition:{x:e.clientX,y:e.clientY}})},a.handleResize=m["default"].debounce(function(){var e=window.innerHeight-2*a.props.margin.y,t=window.innerWidth-2*a.props.margin.x,o=a.state.width,n=o/a.props.aspectRatio,r=a.state.bottom,i=a.state.left;n>e&&(n=e,o=e*a.props.aspectRatio),o>t&&(n=t/a.props.aspectRatio,o=t),r+n>e+a.props.margin.y&&(r=e+a.props.margin.y-n),i+o>t+a.props.margin.x&&(i=t+a.props.margin.x-o),a.setState({bottom:Math.max(a.props.margin.y,r),left:Math.max(a.props.margin.x,i),width:Math.max(a.props.minWidth,o)})},500),a.validateMoveResize=function(e,t,o){var n=e/a.props.aspectRatio,r=window.innerHeight,i=window.innerWidth,l=a.state.width+e,s=l/a.props.aspectRatio,u=a.state.bottom+o,c=a.state.left+t,d=a.props.margin.y,f=r-s-a.props.margin.y,p=a.props.margin.x,h=i-l-a.props.margin.x,m=a.props.minWidth;return(d>u||u>f)&&(o=0),(p>c||c>h)&&(t=0),e&&u+s+a.props.margin.y>r&&(o=-n),e&&c+l+a.props.margin.x>i&&(t=-e),(m>l||s+2*a.props.margin.y>r||l+2*a.props.margin.x>i)&&(o=0,t=0,e=0),{deltaWidth:e,deltaBottom:o,deltaLeft:t}},a.onMouseMove=function(e){var t=0,o=0,n=0,r=0,i=void 0;switch(a.state.currentAction){case I:return;case R:switch(a.state.resizeDirection){case S:o=a.state.previousMousePosition.y-e.clientY,t=o*a.props.aspectRatio;break;case C:o=e.clientY-a.state.previousMousePosition.y,t=o*a.props.aspectRatio,r=-o;break;case k:t=e.clientX-a.state.previousMousePosition.x,o=t/a.props.aspectRatio,r=-o;break;case M:t=a.state.previousMousePosition.x-e.clientX,o=t/a.props.aspectRatio,r=-o,n=-t;break;case w:t=Math.max(e.clientX-a.state.previousMousePosition.x,a.props.aspectRatio*(a.state.previousMousePosition.y-e.clientY)),o=t/a.props.aspectRatio;break;case N:t=Math.max(a.state.previousMousePosition.x-e.clientX,a.props.aspectRatio*(a.state.previousMousePosition.y-e.clientY)),o=t/a.props.aspectRatio,n=-t;break;case T:t=Math.max(e.clientX-a.state.previousMousePosition.x,a.props.aspectRatio*(e.clientY-a.state.previousMousePosition.y)),o=t/a.props.aspectRatio,r=-o;break;case P:t=Math.max(a.state.previousMousePosition.x-e.clientX,a.props.aspectRatio*(e.clientY-a.state.previousMousePosition.y)),o=t/a.props.aspectRatio,r=-o,n=-t}i=a.validateMoveResize(t,n,r);var l=a.state.width+i.deltaWidth,s=a.state.left+i.deltaLeft,u=a.state.bottom+i.deltaBottom;a.setState({width:l,left:s,bottom:u,previousMousePosition:{x:e.clientX,y:e.clientY}}),a.props.onResize&&a.props.onResize(l,s,u);break;case A:n=e.clientX-a.state.previousMousePosition.x,r=a.state.previousMousePosition.y-e.clientY,i=a.validateMoveResize(t,n,r);var c=a.state.left+i.deltaLeft,d=a.state.bottom+i.deltaBottom;a.setState({left:c,bottom:d,previousMousePosition:{x:e.clientX,y:e.clientY}}),a.props.onMove&&a.props.onMove(c,d)}},a.onMouseUp=function(e){a.setState({currentAction:I})},a.state={width:a.props.width?a.props.width:a.props.minWidth,bottom:a.props.bottom?a.props.bottom:a.props.margin.y,left:a.props.left?a.props.left:a.props.margin.x,resizeDirection:S,currentAction:I,previousMousePosition:{x:0,y:0}},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("resize",this.handleResize)}},{key:"componentDidMount",value:function(){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("resize",this.handleResize),this.handleResize()}},{key:"getDimensions",value:function(){return{width:this.state.width,height:this.state.width/this.props.aspectRatio}}},{key:"render",value:function(){var e=this.getDimensions(),t={width:e.width,height:e.height,bottom:this.state.bottom+"px",left:this.state.left+"px"};return _["default"].createElement("div",{className:(0,b["default"])(this.props.className,E["default"].moveResizeComponentContainer),style:t},_["default"].createElement("div",{className:(0,b["default"])(E["default"].topResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(S)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].bottomResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(C)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].leftResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(M)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].rightResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(k)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].topRightResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(w)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].topLeftResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(N)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].bottomRightResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(T)}),_["default"].createElement("div",{className:(0,b["default"])(E["default"].bottomLeftResizer,E["default"].resizer),onMouseDown:this.getResizerCallback(P)}),_["default"].createElement("div",{className:E["default"].moveable,onMouseDown:this.onMoveStart},this.props.children))}}]),t}(g.Component);t["default"]=x},7345:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(8),_=o(g),v=a(7334),b=o(v),y=a(180),E=o(y),S=a(280),C=o(S),M=a(1),k=o(M),w=a(3),N=o(w),T=a(126),P=o(T),I=a(172),R=o(I),A=a(7562),x=o(A),O=336,D=1.1,L=2,U=82,F=12.5,j=350,B=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={img:o.props.img,left:U,minScale:1,scale:1,top:F},o.handleZoomIn=function(){var e=o.state.scale*D;e>=L||o.setState({scale:e})},o.handleZoomOut=function(){var e=o.state.scale/D;o.state.minScale>=e&&(e=o.state.minScale),o.setState({scale:e})},o.handleMouseWheel=function(e){e.deltaY<-4?o.handleZoomOut():e.deltaY>4&&o.handleZoomIn()},o.handleStop=function(e,t){e+=o.state.scale*j,t+=o.state.scale*j,o.setState({left:e,top:t})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.setImage(this.props.img)}},{key:"componentWillReceiveProps",value:function(e){return!this.props.doneEditing&&e.doneEditing?void this.onCrop():void(this.props.img!==e.img&&this.setImage(e.img))}},{key:"setImage",value:function(e){var t=this;E["default"].rotateAndResize(e,3*Store.ServerProps.imageMaxEdge,E["default"].DATA_URL|E["default"].CANVAS).then(function(e){var a=e.width,o=e.height,n=e.images;C["default"].loadImage(n.dataUrl).then(function(e){var n=O/Math.min(a,o),r=t.getInitialPadding(n,a,o),i=0>L-(n+r)?L:n+r,l=t.getStart(i,e.width,e.height),s=l.x+i*j,u=l.y+i*j;t.setState({scale:i,minScale:n,start:l,left:s,top:u,img:e.src,imageSize:{width:e.width,height:e.height}})})["catch"](function(e){k["default"].error("PhotoEditor:loadImage failed to load image: "+e)()})})["catch"](function(e){k["default"].error("PhotoEditor:setImage failed to load image: "+e)()})}},{key:"getInitialPadding",value:function(e,t,a){var o=(O+2*U)/t,n=(O+2*F)/a;return Math.max(o,n)-e}},{key:"cropImage",value:function(){var e=this;if(!this.state.img)return r["default"].reject("Image missing from state");var t=this.state.img,a=this.getOffset(),o=this.state.scale,n=Math.abs((this.state.left-a.x)/o),i=Math.abs((this.state.top-a.y)/o),l=O/o,s=l;l>_["default"].MAX_PIC_SIDE?s=_["default"].MAX_PIC_SIDE:l<_["default"].MIN_PIC_SIDE&&(s=_["default"].MIN_PIC_SIDE);var u=void 0;return this.promise=new r["default"](function(a,o){E["default"].crop(t,n,i,l,l,s,s,E["default"].DATA_URL|E["default"].CANVAS).then(function(e){var t=e.images;return u=t.dataUrl,E["default"].crop(t.canvas,0,0,_["default"].PROF_PIC_THUMB_SIDE,_["default"].PROF_PIC_THUMB_SIDE,E["default"].DATA_URL)}).then(function(e){var t=e.images;a({thumb:t.dataUrl,full:u})})["catch"](o)["finally"](function(){e.promise=null})}),this.promise}},{key:"onCrop",value:function(){var e=this;this.promise||this.cropImage().then(function(t){e.props.onImageSet(t.thumb,t.full)})["catch"](function(){e.setState({img:e.props.img})})}},{key:"getStart",value:function(e,t,a){var o=this.getOffset(),n=(t*e-O)/2,r=(a*e-O)/2,i=o.x-j*e-n,l=o.y-j*e-r;return{x:i,y:l}}},{key:"getOffset",value:function(){var e=U,t=F;return this.props.size&&(e=this.props.size.width/2-O/2,
t=this.props.size.height/2-O/2),{x:e,y:t}}},{key:"render",value:function(){var e=this.getOffset(),t={width:O,height:O,x:e.x,y:e.y},a=void 0;this.state.img&&this.state.imageSize&&this.state.start&&(a=N["default"].createElement(b["default"],{container:t,onStop:this.handleStop,start:this.state.start,scale:this.state.scale,padding:j,childSize:this.state.imageSize},N["default"].createElement("img",{className:x["default"].original,src:this.state.img})));var o=N["default"].createElement("div",{className:x["default"].controls,key:"zoom-controls"},N["default"].createElement(R["default"],{name:"plus",onClick:this.handleZoomIn}),N["default"].createElement(R["default"],{name:"minus",onClick:this.handleZoomOut}));return N["default"].createElement("div",{className:x["default"].container,onWheel:this.handleMouseWheel},N["default"].createElement("div",{className:x["default"].editor,dir:"ltr"},N["default"].createElement("div",{className:x["default"].editorBody},a)),N["default"].createElement("svg",{className:x["default"].svgOverlay},N["default"].createElement("defs",null,N["default"].createElement("mask",{id:"mask",x:0,y:0,width:this.props.size.width,height:this.props.size.height,style:{position:"absolute"}},N["default"].createElement("rect",{x:0,y:0,width:this.props.size.width,height:this.props.size.height,fill:"rgba(255, 255, 255, 0.7)"}),N["default"].createElement("circle",{cx:this.props.size.width/2,cy:this.props.size.height/2,r:O/2,style:{position:"absolute"}}))),N["default"].createElement("rect",{x:0,y:0,width:this.props.size.width,height:this.props.size.height,mask:"url(#mask)",fillOpacity:.7,style:{position:"absolute"}})),N["default"].createElement(P["default"],{transitionName:"fade",style:{left:this.state.left,top:this.state.top}},o))}}]),t}(N["default"].Component);t["default"]=B},7346:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(484),_=(o(g),a(7118)),v=o(_),b=a(7127),y=o(b),E=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.pin=function(){var e=o.props,t=e.chat,a=e.onPinOrUnpin;a(!t.pin)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.disabled;return m["default"].createElement(y["default"],{a8n:"mi-pin",action:this.pin,shortcut:"p",key:"PinChat",disabled:a},t.pin?l10n.t("unpin_chat"):l10n.t("pin_chat"))}}]),t}(m["default"].PureComponent);E.CONCERNS={chat:["pin"]},t["default"]=(0,v["default"])(E)},7347:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(7),u=o(s),c=a(6),d=o(c),f=a(7192),p=o(f),h=a(7236),m=o(h),g=a(7191),_=o(g),v=a(7364),b=o(v),y=a(7193),E=o(y),S=a(7355),C=o(S),M=a(7194),k=o(M),w=a(7354),N=o(w),T=a(7233),P=o(T),I=new m["default"],R=function(e){function t(){return(0,l["default"])(this,t),(0,u["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,d["default"])(t,e),t}((0,_["default"])([p["default"],C["default"],k["default"],I,b["default"]]));R.Suggestions=(0,P["default"])(E["default"],{plugin:I}),R.EmojiSuggestions=(0,P["default"])(N["default"],{plugin:C["default"]}),t["default"]=R},7348:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return function(a){e.some(function(e){var o=(0,i["default"])(e,2),n=o[0],r=o[1],l=r.call(n,a,t);return a.defaultPrevented?!0:l===!0?(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!0):!1})}}var r=a(17),i=o(r),l=a(29),s=o(l);e.exports=function(e,t){var a=e.reduce(function(e,t){var a=t.handlers;return a?((0,s["default"])(a).forEach(function(o){e[o]||(e[o]=[]),e[o].push([t,a[o]])}),e):e},{});return(0,s["default"])(a).reduce(function(e,o){return e[o]=n(a[o],t),e},{})}},7349:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return function(){for(var a=arguments.length,o=Array(a),n=0;a>n;n++)o[n]=arguments[n];e.forEach(function(e){var a=(0,i["default"])(e,2),n=a[0],r=a[1];return r.call.apply(r,[n].concat(o,[t]))})}}var r=a(17),i=o(r),l=a(29),s=o(l);e.exports=function(e,t){var a=e.reduce(function(e,t){var a=t.hooks;return a?((0,s["default"])(a).forEach(function(o){e[o]||(e[o]=[]),e[o].push([t,a[o]])}),e):e},{});return(0,s["default"])(a).reduce(function(e,o){return e[o]=n(a[o],t),e},{})}},7350:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return function(a){e.some(function(e){var o=(0,i["default"])(e,2),n=o[0],r=o[1],l=r.call(n,a,t);return a.defaultPrevented?!0:l===!0?(a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!0):!1})}}var r=a(17),i=o(r),l=a(29),s=o(l);e.exports=function(e,t){var a=e.reduce(function(e,t){var a=t.hotkeys;return a?((0,s["default"])(a).forEach(function(o){e[o]||(e[o]=[]),e[o].push([t,a[o]])}),e):e},{});return(0,s["default"])(a).reduce(function(e,o){return e[o]=n(a[o],t),e},{})}},7351:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(7232),r=o(n),i=a(1),l=o(i),s=function(e,t){l["default"].assert(t.focusNode,"serializeTextBeforeCursor requires selection.focusNode")();var a=document.createRange();a.setStart(e,0),a.setEnd(t.focusNode,t.focusOffset);var o=a.cloneContents();return(0,r["default"])(o,[])};t["default"]=s},7352:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return t.reduce(function(e,t){var a=t.parsers;return a?a.reduce(function(e,t){return t(e)},e):e},i["default"].escape(e))}var r=a(10),i=o(r);e.exports=n},7353:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(7),u=o(s),c=a(6),d=o(c),f=a(7192),p=o(f),h=a(7236),m=o(h),g=a(7191),_=o(g),v=a(7194),b=o(v),y=a(7193),E=o(y),S=a(7233),C=o(S),M=new m["default"],k=function(e){function t(){return(0,l["default"])(this,t),(0,u["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,d["default"])(t,e),t}((0,_["default"])([p["default"],M,b["default"]]));k.Suggestions=(0,C["default"])(E["default"],{plugin:M}),t["default"]=k},7354:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(7234),E=o(y),S=a(7279),C=o(S),M=a(7404),k=o(M),w=a(7231),N=o(w),T=a(127),P=o(T),I=a(261),R=o(I),A=a(126),x=o(A),O=a(174),D={omitted:"",query:"",emojiList:null},L=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state=D,o.onEmoji=function(e){Store.RecentEmoji.increment(e),o.props.plugin.handleSelect(e)},o.onSearch=function(e){e=e?e.trim():e;var t=o.state.omitted;if(o.props.chat.isGroup&&e&&e.indexOf("@")>-1)return void o.setState({emojiList:null,query:""});if(!t||!_["default"].startsWith(e,t))if(e.length<2){if(!o.state.emojiList)return;o.setState({emojiList:""===e?null:(0,C["default"])(e),query:e})}else{var a=(0,C["default"])(e);a.length?o.setState({omitted:null,emojiList:a,query:e}):o.setState({emojiList:null,query:e})}},o.onInactive=function(){o.setState(D)},o.onEscape=function(){o.setState({emojiList:null,query:"",omitted:o.state.query})},o.onKeyPress=function(e){e.preventDefault(),b["default"].pasteChatTextInput(o.props.chat,String.fromCharCode(e.charCode))},o.onKeyDown=function(e){return"Backspace"===e.key&&(e.preventDefault(),document.execCommand("delete"),o.props.plugin.ctx.focus()),!1},o.onEnter=function(e){if(!(0,N["default"])(e)){var t=o.emojiSuggestionsPanel;return t?(e.preventDefault(),e.stopPropagation(),t.pickSelectedEmoji(),!1):void 0}},o.onLeft=function(e){if(!(0,N["default"])(e)){var t=o.emojiSuggestionsPanel;t&&(e.preventDefault(),t.moveSelectionLeft())}},o.onRight=function(e){if(!(0,N["default"])(e)){var t=o.emojiSuggestionsPanel;t&&(e.preventDefault(),t.moveSelectionRight())}},o.releaseFocus=function(){o.props.plugin.ctx.focus()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.plugin;e.registerHandler(this,E["default"].EMOJI_SEARCH,this.onSearch),e.registerHandler(this,E["default"].EMOJI_INACTIVE,this.onInactive),e.registerHandler(this,E["default"].EMOJI_ENTER,this.onEnter),e.registerHandler(this,E["default"].EMOJI_LEFT,this.onLeft),e.registerHandler(this,E["default"].EMOJI_RIGHT,this.onRight),e.registerHandler(this,E["default"].EMOJI_TAB,this.onEnter)}},{key:"componentWillUnmount",value:function(){var e=this.props.plugin;e.unregisterHandler(this,E["default"].EMOJI_SEARCH),e.unregisterHandler(this,E["default"].EMOJI_INACTIVE),e.unregisterHandler(this,E["default"].EMOJI_ENTER),e.unregisterHandler(this,E["default"].EMOJI_LEFT),e.unregisterHandler(this,E["default"].EMOJI_RIGHT),e.unregisterHandler(this,E["default"].EMOJI_TAB)}},{key:"renderTab",value:function(e){return m["default"].createElement("div",{className:"emoji-search-body",key:"RECENT"},m["default"].createElement(k["default"],{ref:(0,O.GetRef)("emojiSuggestionsPanel",this),key:this.state.query,onEmoji:this.onEmoji,onFocusRelease:this.onInactive,emojiList:e}))}},{key:"render",value:function(){var e=this.state.emojiList,t=e?m["default"].createElement(R["default"],{displayName:"EmojiSuggestions",escapable:!0,requestDismiss:this.onEscape,requestFocus:this.releaseFocus},m["default"].createElement("div",{className:"emoji-overlay-container"},m["default"].createElement("div",{className:"emoji-results-container","data-list-scroll-container":"false",ref:"overflow"},m["default"].createElement("div",{className:"emoji-search k",onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown},this.renderTab(e))))):null;return m["default"].createElement(x["default"],{component:"div",className:"emoji-positioning-container",transitionName:"slide-up"},t)}}]),t}(m["default"].Component);t.Component=L;t["default"]=(0,P["default"])(L)},7355:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!e.rangeCount)return null;if(!e.anchorNode)return null;if(!e.modify)return null;for(var a=e.getRangeAt(0),o=0;5>o;o++)e.modify("extend","backward","word");var n=e.getRangeAt(0).cloneContents(),i=t.serializeNode(n),l=g.exec(i);if(!l)return r(e,a);r(e,a);var s=0,u=e.anchorNode?e.anchorNode.nodeValue:null;if(u)for(var c=Math.max(e.anchorOffset,e.focusOffset);c<u.length&&" "!==u[c];)e.modify("move","forward","character"),++c,++s;var d=l[0].length;for(d+=s;a.collapsed&&d--;)e.modify("extend","backward","character");return{original:a,range:e.getRangeAt(0),match:l}}function r(e,t){e.removeAllRanges(),e.addRange(t)}var i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=/\B:((?:[^ :@]+ ?){1,4})$/,_=a(7158),v=a(7234),b={ArrowLeft:v.EMOJI_LEFT,ArrowRight:v.EMOJI_RIGHT,Enter:v.EMOJI_ENTER,Tab:v.EMOJI_TAB},y=function(e){function t(){var e,a,o,i;(0,u["default"])(this,t);for(var s=arguments.length,c=Array(s),d=0;s>d;d++)c[d]=arguments[d];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(c))),o.handlers={onKeyDown:function(e,t){var a=b[e.key];return a?this.handle(a,[e,t]):!1},onSelect:function(e,t){if(this.ctx.isComposing)return!1;if(t.value.indexOf(":")<0)return this.handle(v.EMOJI_INACTIVE);var a=window.getSelection(),o=n(a,t);if(!o)return this.handle(v.EMOJI_INACTIVE);var i=o.original,l=o.match;return this.handle(v.EMOJI_SEARCH,[l[1]||""]),r(a,i),!1}},i=a,(0,p["default"])(o,i)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"handleSelect",value:function(e){this.ctx.forceFocus(),n(window.getSelection(),this.ctx)&&(this.ctx.replaceSelection(e),this.handle(v.EMOJI_INACTIVE))}}]),t}(_);e.exports=new y},7356:function(e,t,a){"use strict";var o=a(7172),n=a(7150),r=a(7159),i=n.Direction;e.exports=function(e,t){if(!r(e))return!1;var a=n(t,i.BACKWARD);if(!a||!a.getAttribute("data-mention-jid"))return!1;var l=o(t,a),s=window.getSelection();s.removeAllRanges();var u=document.createRange();return u.setStart(t,l),u.setEnd(t,l),s.addRange(u),!0}},7357:function(e,t,a){"use strict";var o=a(7172),n=a(7150),r=a(7159),i=n.Direction;e.exports=function(e,t){if(!r(e))return!1;var a=n(t,i.FORWARD);if(!a||!a.getAttribute("data-mention-jid"))return!1;var l=o(t,a),s=window.getSelection();s.removeAllRanges();var u=document.createRange();return u.setStart(t,l+1),u.setEnd(t,l+1),s.addRange(u),!0}},7358:function(e,t,a){"use strict";var o=a(7172),n=a(7150),r=a(7159),i=n.Direction,l=a(28),s=l.isGecko;e.exports=function(e,t){if(!s||!r(e))return!1;var a=n(t,i.BACKWARD);if(!a||!a.getAttribute("data-mention-jid"))return!1;var l=o(t,a),u=window.getSelection();u.removeAllRanges();var c=document.createRange();return c.setStart(t,l),c.setEnd(t,l+1),u.addRange(c),!0}},7359:function(e,t,a){"use strict";var o=a(7172),n=a(7150),r=a(7159),i=n.Direction;e.exports=function(e,t){if(!r(e))return!1;var a=n(t,i.FORWARD);if(!a||!a.getAttribute("data-mention-jid"))return!1;var l=o(t,a),s=window.getSelection();s.removeAllRanges();var u=document.createRange();return u.setStart(t,l),u.setEnd(t,l+1),s.addRange(u),!0}},7360:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(7123),_=o(g),v=a(7119),b=o(v),y=a(7564),E=o(y),S=a(23),C=o(S),M=a(3),k=o(M),w=a(488),N=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e,t=this.props,a=t.theme,o=t.contact,n=o.id,i=o.formattedName,l=o.isMyContact,s=o.notifyName,u=t.onMouseDown,c=t.onMouseOver,d=t.onMouseUp,f=t.term,p=t.selected,h=w.Configuration.Search({terms:f?[f]:[],boundary:!0});return k["default"].createElement("div",{className:(0,C["default"])(E["default"].mentionsResult,(e={},(0,r["default"])(e,E["default"].mediaCaption,"mediaCaption"===a),(0,r["default"])(e,E["default"].selected,p===!0),e)),onMouseDown:u,onMouseUp:d,onMouseOver:c},k["default"].createElement("div",{className:E["default"].resultImage},k["default"].createElement(_["default"],{id:n,size:32})),k["default"].createElement("div",{className:E["default"].textContact,dir:"auto"},k["default"].createElement(b["default"],{text:i,formatters:h})),k["default"].createElement("div",{className:E["default"].textPushname,dir:"auto"},!l&&s?k["default"].createElement(b["default"],{text:"~"+s,formatters:h}):null))}}]),t}(k["default"].PureComponent);e.exports=N},7361:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(t.isComposing)return!1;var a=window.getSelection();return r(e,a,t)}function r(e,t,a){if(!t.modify)return!1;if(1!==t.rangeCount)return!1;var o=d.backwardsEmojiTextsTrie,n=e.data||"";if(o=o.get(n.toLowerCase()),!o)return!1;var r=t.getRangeAt(0);if(!r.collapsed)return!1;for(var s=n,h=0;o.hasChildren();){if(n=l(t,h),o=o.get(n.toLowerCase()),s=n+s,!o)return!1;h++}var m=a.serializeTextBeforeCursor();if((0,c.isInsideCodeBlock)(m))return!1;var g=(0,f["default"])(s);i(t,s.length-1),a.replaceSelection(g);var _=a.refs.input,v=(0,u["default"])(_,p.BACKWARD);return v?(v.dataset.replacedEmojiText=s,!0):!0}function i(e,t){for(;t;)e.modify("extend","backward","character"),t--}function l(e,t){for(var a=e.anchorNode,o=e.anchorOffset;a&&a.nodeType===Node.TEXT_NODE;){if(o>t)return a.textContent.charAt(o-1-t);if(t-=o,a=a.previousSibling,!a)return"";o=a.textContent.length}return""}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var s=a(7150),u=o(s),c=a(495),d=a(7363),f=o(d),p=u["default"].Direction},7362:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){return e.keyCode===c?r(e,t):!1}function r(e,t){if(t.isComposing)return!1;var a=window.getSelection();return i(e,a,t)}function i(e,t,a){if(!t.modify)return!1;var o=a.refs.input,n=(0,u["default"])(o,d.BACKWARD);if(!n)return!1;if(!l(n))return!1;t.modify("extend","backward","character"),t.modify("move","backward","character");var r=n.dataset.replacedEmojiText,i=n.parentNode;if(!i)return!1;i.replaceChild(document.createTextNode(r+" "),n);for(var s=r.length,c=0;s+1>c;c++)t.modify("extend","forward","character"),t.modify("move","forward","character");return!1}function l(e){return Boolean(e&&e.dataset&&e.dataset.replacedEmojiText)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var s=a(7150),u=o(s),c=8,d=u["default"].Direction},7363:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=d[e.toLowerCase()],a=s["default"].skinToneEmojis[t]&&Store.EmojiVariant.getVariant(t);return a||t}Object.defineProperty(t,"__esModule",{value:!0}),t.backwardsEmojiTextsTrie=void 0;var r=a(29),i=o(r);t["default"]=n;var l=a(95),s=o(l),u=a(7501),c=o(u),d={"(y)":"","(n)":"",":-)":"",":-(":"",":-p":"",":-|":"",":-\\":"",":-d":"",":-*":"","<3":"","^_^":"",">_<":"",";-)":""},f=(0,i["default"])(d);t.backwardsEmojiTextsTrie=c["default"].fromBackwardsStrings(f)},7364:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(7),u=o(s),c=a(6),d=o(c),f=a(7158),p=o(f),h=a(12),m=o(h),g=a(7159),_=o(g),v=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,u["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.handlers={onKeyDown:function(e){return this.ctx.isComposing?!1:" "===e.key&&(0,_["default"])(e)?this.ctx.value.length?!1:(m["default"].scrollMessages(),!0):!1}},n=a,(0,u["default"])(o,n)}return(0,d["default"])(t,e),t}(p["default"]);t["default"]=new v},7365:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(12),E=o(y),S=a(14),C=o(S),M=a(7414),k=o(M),w=a(7152),N=o(w),T=a(7127),P=o(T),I=a(178),R=o(I),A=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(s))),o.onCapture=function(){var e=o,t=new r["default"](function(a,o){navigator.getUserMedia({video:!0},function(o){E["default"].closeModal(),a(o),t.isPending()||E["default"].openModal(_["default"].createElement(R["default"],{type:I.BoxModalType},_["default"].createElement(k["default"],{stream:o,onFinished:e.props.onImageTake,handleStreamClose:!1})))},function(e){var a=b["default"].isString(e)?e:e.name,n=C["default"].GUM[a]||C["default"].GUM.GUMError;o(new n),t&&!t.isPending()&&E["default"].closeModal()})}).timeout(1500,"waitForGUMTakePhotoTimeout").then(function(t){E["default"].openModal(_["default"].createElement(R["default"],{type:I.BoxModalType},_["default"].createElement(k["default"],{stream:t,onFinished:e.props.onImageTake,handleStreamClose:!1})))})["catch"](r["default"].TimeoutError,function(e){E["default"].openModal(_["default"].createElement(N["default"],{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_description",type:N["default"].TYPE.GUIDE_ALLOW}))})["catch"](C["default"].GUM.PermissionDeniedError,function(){E["default"].openModal(_["default"].createElement(N["default"],{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:N["default"].TYPE.GUIDE_UNBLOCK}))})["catch"](C["default"].GUM.GUMError,function(){E["default"].openModal(_["default"].createElement(N["default"],{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:N["default"].TYPE.GUIDE_NONE}))})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){return _["default"].createElement(P["default"],{action:this.onCapture,a8n:"mi-take-photo",disabled:this.props.disabled},l10n.t("take_photo"))}}]),t}(_["default"].Component);t["default"]=A},7366:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(7572),l=o(i),s=function(e){var t=e.children;return r["default"].createElement("div",{className:l["default"].tooltip},t)};t["default"]=s},7367:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(10),b=o(v),y=a(7370),E=o(y),S=a(7426),C=o(S),M=a(14),k=o(M),w=a(8),N=o(w),T=a(64),P=o(T),I=a(12),R=o(I),A=a(484),x=(o(A),a(268)),O=(o(x),a(71)),D=o(O),L=a(127),U=o(L),F=void 0,j=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.windowResized=function(){F=_["default"].findDOMNode(e).clientHeight},e.msgCollectionChanged=function(t,a,o){var n=e.state.msgCollection;n!==t&&n!==a||e.setState({msgCollection:o})},e.windowGainedFocus=function(){P["default"].markAvailable();var t=e.state.chat;t&&t.isUser&&t.presence.subscribe()["catch"](k["default"].WapDrop,b["default"].noop)},e.windowLostFocus=function(){P["default"].markUnavailable(N["default"].SEND_UNAVAILABLE_WAIT)},e.handleClearChat=function(t){e.state.chat===t&&e.setState({chat:void 0,msgCollection:void 0,focusCtx:void 0})},e.handleOpenChat=function(t,a,o){R["default"].updateChatlistSelection(t);var n=e.openedChatInfo,r={},i=function(e){b["default"].assign(r,e)};e.state.chat!==t?e.setState({chat:t,msgCollection:a?a.collection:t.msgs,focusCtx:a,notifyChatRendered:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return o(e.newChatScrollInfo(n,a))}),updateOpenedChatInfo:i}):e.setState({msgCollection:a?a.collection:t.msgs,focusCtx:a,notifyChatRendered:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){return o(e.newChatScrollInfo(n,a))}),updateOpenedChatInfo:i}),e.openedChatInfo=r},e.newChatScrollInfo=function(e,t){var a=t?t.msg||Store.Msg.get(t.key):void 0;if(t&&a&&e&&e.chat&&e.renderedMsgsInfo&&e.visibleMsgOrder&&!b["default"].isEmpty(e.renderedMsgsInfo)&&!b["default"].isEmpty(e.visibleMsgOrder)){var o=e.renderedMsgsInfo[b["default"].head(e.visibleMsgOrder)],n=b["default"].find(e.renderedMsgsInfo,function(e,t){return t===a.id.toString()});return n?{wasVisible:!0,offset:n.offset}:e.chat===a.chat?a.t<o.t?{wasVisible:!1,alignAt:"top"}:{wasVisible:!1,alignAt:"bottom"}:{wasVisible:!1,alignAt:"center"}}return{wasVisible:!1,alignAt:"center"}},e.state={chat:void 0,msgCollection:void 0,focusCtx:void 0},e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(R["default"],"open_chat",this.handleOpenChat),this.props.listeners.add(R["default"],"clear_chat",this.handleClearChat),this.props.listeners.add(window,"focus",this.windowGainedFocus),this.props.listeners.add(window,"blur",this.windowLostFocus)}},{key:"componentDidMount",value:function(){var e=this.props.debounce(this.windowResized,100);this.props.listeners.add(window,"resize",e),e()}},{key:"shouldComponentUpdate",value:function(e,t){return t!==this.state||e.animate!==this.props.animate}},{key:"componentDidUpdate",value:function(e,t){var a=this.state.chat,o=t.chat;a&&o!==a&&(this.props.listeners.add(a,"change:cmc:merge",this.msgCollectionChanged),o&&this.props.listeners.remove(o,"change:cmc:merge"))}},{key:"render",value:function(){var e=this.state,t=e.chat,a=e.msgCollection,o=e.focusCtx;return t?m["default"].createElement(E["default"],{key:t.id,chat:t,msgCollection:a,height:F,focusCtx:o,notifyChatRendered:this.state.notifyChatRendered,updateOpenedChatInfo:this.state.updateOpenedChatInfo,chatPreference:Store.ChatPreference.get("defaultPreference")}):m["default"].createElement("div",{className:"pane pane-two"},m["default"].createElement(C["default"],{animate:this.props.animate}))}}]),t}(m["default"].Component);e.exports=(0,D["default"])((0,U["default"])(j))},7368:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(8),y=n(b),E=a(128),S=n(E),C=a(7243),M=n(C),k=a(10),w=n(k),N=a(484),T=(n(N),a(7225)),P=n(T),I=a(7195),R=n(I),A=a(7123),x=n(A),O=a(7119),D=n(O),L=a(7413),U=n(L),F=a(7251),j=n(F),B=a(7412),G=n(B),V=a(7254),Y=n(V),W=a(12),H=n(W),q=a(7152),z=n(q),K=a(94),Q=n(K),J=a(14),X=n(J),Z=a(47),$=n(Z),ee=a(7143),te=n(ee),ae=a(23),oe=n(ae),ne=a(7149),re=a(489),ie=n(re),le=a(7127),se=n(le),ue=a(7366),ce=n(ue),de=a(7169),fe=o(de),pe=a(72),he=n(pe),me=a(127),ge=n(me),_e=a(71),ve=n(_e),be=a(485),ye=n(be),Ee=a(7118),Se=n(Ee),Ce=a(487),Me=a(7241),ke=n(Me),we=a(172),Ne=n(we),Te=a(34),Pe=function(e){function t(){(0,c["default"])(this,t);var e=(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments));return e.isListeningForMove=!1,e.didDrag=!1,e.onWindowFocus=function(){e.setState({newlyFocused:!0}),e.props.setTimeout(function(){return e.setState({newlyFocused:!1})},100)},e.onMouseDown=function(e){},e.onDrag=function(t){e.didDrag=!0},e.onClickCapture=function(e){},e.onInfoPanel=function(){var t=e.props.chat;!t.isPSA&&(t.isUser||t.isBroadcast||t.isGroup)&&H["default"].openDrawerRight(v["default"].createElement(j["default"],{chat:(0,Ce.unproxy)(t),key:"info-"+t.id}),"slide-left",e.context.uim)},e.checkForDrawerMid=function(e){H["default"].existsDrawerMid(function(t){t&&e.preventDefault()})},e.onChatSearch=function(t){t.preventDefault();var a=e.props.chat;H["default"].openDrawerRight(v["default"].createElement(Y["default"],{chat:(0,Ce.unproxy)(a),key:"chat-search-"+a.id}),"slide-left",e.context.uim)},e.onCaptureClick=function(){var t=e.props.chat,a=fe.start("camera");i["default"].race([a,e.props.rejectOnUnmount()]).checkpoint(e.props.rejectOnUnmount()).then(function(a){H["default"].openDrawerMid(v["default"].createElement(U["default"],{chat:(0,Ce.unproxy)(t),stream:a}),"slide-up",e.context.uim,{noFocus:!0})})["catch"](X["default"].Unmount,function(){a.then(function(e){return fe.stop(e)})["catch"](w["default"].noop)})["catch"](X["default"].GUM.PermissionDeniedError,function(){H["default"].openModal(v["default"].createElement(z["default"],{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:z["default"].TYPE.GUIDE_UNBLOCK}))})["catch"](X["default"].GUM.GUMError,function(){H["default"].openModal(v["default"].createElement(z["default"],{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:z["default"].TYPE.GUIDE_NONE}))})},e.state={},e}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){}},{key:"render",value:function(){var e,t,o=this.props.chat;o.isUser?(e=v["default"].createElement(ke["default"],{chat:o,contact:o.contact,onSelectMessages:this.props.onSelectMessages}),t=v["default"].createElement(R["default"],{presence:o.presence,chatstate:o.presence.chatstate,placeholder:l10n.t("click_here_for_user_info"),location:"title"})):o.isBroadcast?(e=v["default"].createElement(Ae,{chat:(0,Ce.unproxy)(o),onSelectMessages:this.props.onSelectMessages}),t=null):o.isGroup&&(e=v["default"].createElement(Re,{chat:(0,Ce.unproxy)(o),onSelectMessages:this.props.onSelectMessages}),t=v["default"].createElement(P["default"],{chatstate:o.presence.chatstate,groupMetadata:o.groupMetadata,presence:o.presence,placeholder:l10n.t("click_here_for_group_info"),location:"title"}));var n=a(47),r=n.supportsFeature(n.F.FTS_IN_CONV)?v["default"].createElement(ne.MenuBarItem,{a8n:"search-button",icon:v["default"].createElement(Ne["default"],{name:"search-alt",directional:!0}),title:l10n.t("search"),onClick:this.onChatSearch}):null,i=this.props.canAttach?v["default"].createElement(ne.MenuBarItem,{a8n:"conversation-clip",icon:v["default"].createElement(Ne["default"],{name:"clip",directional:!0}),title:l10n.t("menutitle_attach"),transitionName:"menu",onClick:this.checkForDrawerMid},v["default"].createElement(Ie,{chat:(0,Ce.unproxy)(o),onCaptureClick:this.onCaptureClick})):null,l=(0,oe["default"])("chat-avatar",{"chat-psa":o.isPSA}),s=(0,oe["default"])("chat-body",{"chat-psa":o.isPSA});return o.isPSA&&(t=null),v["default"].createElement("header",{className:"pane-header pane-chat-header",onClickCapture:this.onClickCapture,onMouseDown:this.onMouseDown},v["default"].createElement("div",{className:l,onClick:this.onInfoPanel},v["default"].createElement(x["default"],{id:o.id,size:40})),v["default"].createElement("div",{className:s,onClick:this.onInfoPanel},v["default"].createElement("div",{className:"chat-main"},v["default"].createElement("div",{className:"chat-title"},v["default"].createElement(te["default"],{chat:o,titlify:!0,ellipsify:!0}))),t),v["default"].createElement("div",{className:"pane-chat-controls"},v["default"].createElement(ne.MenuBar,{key:"conversation-header"},r,i,v["default"].createElement(ne.MenuBarItem,{a8n:"conversation-menu",icon:v["default"].createElement(Ne["default"],{name:"menu"}),title:l10n.t("menutitle_menu"),onClick:this.checkForDrawerMid},e))))}}]),t}(v["default"].Component);Pe.contextTypes={uim:v["default"].PropTypes.instanceOf(he["default"])},Pe.CONCERNS={chat:["id","formattedTitle","presence","isUser","isGroup","isBroadcast","groupMetadata","isPSA","contact"]};var Ie=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.setDocPicker=function(e){return o.docPicker=e},o.setMediaPicker=function(e){return o.mediaPicker=e},o.onDocumentPick=function(e){if(e){e.stopPropagation();var t=w["default"].toArray(e.target.files);t.length&&(e.target.value="",o.canSendDocument()?H["default"].attachMediaDrawer({chat:o.props.chat,files:t,fileOrigin:Te.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY}):o.showCantSendDocument())}},o.onMediaPick=function(e){if(e){e.stopPropagation();var t=w["default"].toArray(e.target.files);t.length&&(e.target.value="",H["default"].attachMediaDrawer({chat:o.props.chat,files:t,fileOrigin:Te.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY}))}},o.onMediaClick=function(e){e.preventDefault(),o.mediaPicker.triggerInput()},o.onDocumentClick=function(e){e.preventDefault(),o.canSendDocument()?o.docPicker.triggerInput():o.showCantSendDocument()},o.onContactClick=function(e){e.preventDefault(),H["default"].openModal(v["default"].createElement(G["default"],{chat:o.props.chat}))},o.showCantSendDocument=function(e){var t=void 0;if(e instanceof X["default"].InvalidMediaFileType)t=l10n.t("cannot_send_document_type_unsupported");else if(e instanceof X["default"].MediaFileTooLarge)t=l10n.t("document_too_big",{maxSize:l10n.filesize(Store.ServerProps.media)});else{var a=o.props.chat;
t=a.isUser?l10n.t("cannot_send_document_to_contact_unsupported",{contact:a.title()}):l10n.t("cannot_send_document_to_group_unsupported",{group:a.title()})}H["default"].openModal(v["default"].createElement(Q["default"],{key:"doc_cant_send",onOK:H["default"].closeModal.bind(H["default"])},v["default"].createElement(D["default"],{text:t})))},o.onCaptureClick=function(){o.props.onCaptureClick()},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"canSendDocument",value:function(){return $["default"].supportsFeature($["default"].F.ENC_DOC)}},{key:"render",value:function(){var e=v["default"].createElement(ce["default"],null,l10n.t("attach_capture")),t=v["default"].createElement(se["default"],{type:"icon",tooltip:e,a8n:"mi-attach-camera",action:this.onCaptureClick,disabled:!navigator.getUserMedia},v["default"].createElement("button",{className:"menu-icons-item"},v["default"].createElement(Ne["default"],{name:"camera"}))),a=void 0;if($["default"].supportsFeature($["default"].F.ENC_DOC)){var o=v["default"].createElement(ce["default"],null,l10n.t("attach_document"));a=v["default"].createElement(se["default"],{type:"icon",tooltip:o,ref:this.setDocPicker,a8n:"mi-attach-document",action:this.onDocumentClick,mimes:S["default"].DOC_MIMES,onFilePick:this.onDocumentPick},v["default"].createElement("button",{className:"menu-icons-item"},v["default"].createElement(Ne["default"],{name:"document"})))}var n=v["default"].createElement(ce["default"],null,l10n.t("attach_media")),r=v["default"].createElement(ce["default"],null,l10n.t("attach_vcard"));return v["default"].createElement("div",{className:"attach-menu-container"},v["default"].createElement(ie["default"],{type:"menu",key:"AttachMenuDropdown"},v["default"].createElement(se["default"],{type:"icon",tooltip:n,ref:this.setMediaPicker,a8n:"mi-attach-media",action:this.onMediaClick,mimes:[y["default"].IMAGE_MIMES,y["default"].VIDEO_MIMES].join(","),onFilePick:this.onMediaPick},v["default"].createElement("button",{className:"menu-icons-item"},v["default"].createElement(Ne["default"],{name:"image"}))),t,a,v["default"].createElement(se["default"],{type:"icon",tooltip:r,a8n:"mi-attach-contact",action:this.onContactClick},v["default"].createElement("button",{className:"menu-icons-item"},v["default"].createElement(Ne["default"],{name:"contact"})))))}}]),t}(v["default"].Component),Re=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.onSelectMessages;return v["default"].createElement(ie["default"],{type:"dropdown_menu",key:"GroupMenuDropdown",flipOnRTL:!0,dirX:"left"},M["default"].group(t,a))}}]),t}(v["default"].Component),Ae=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.chat,a=e.onSelectMessages;return v["default"].createElement(ie["default"],{type:"dropdown_menu",key:"BroadcastMenuDropdown",flipOnRTL:!0,dirX:"left"},M["default"].broadcast(t,a))}}]),t}(v["default"].Component);t["default"]=(0,ge["default"])((0,ve["default"])((0,ye["default"])((0,Se["default"])(Pe))))},7369:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(29),i=n(r),l=a(182),s=n(l),u=a(5),c=n(u),d=a(2),f=n(d),p=a(4),h=n(p),m=a(7),g=n(m),_=a(6),v=n(_),b=a(3),y=n(b),E=a(46),S=n(E),C=a(7168),M=n(C),k=a(8),w=n(k),N=a(7400),T=n(N),P=a(7371),I=n(P),R=a(12),A=n(R),x=a(264),O=n(x),D=a(484),L=(n(D),a(75)),U=a(23),F=n(U),j=a(7243),B=n(j),G=a(7241),V=n(G),Y=a(55),W=n(Y),H=a(7282),q=n(H),z=a(7394),K=n(z),Q=a(126),J=n(Q),X=a(1),Z=n(X),$=a(62),ee=o($),te=a(7137),ae=n(te),oe=a(261),ne=n(oe),re=a(93),ie=n(re),le=a(177),se=n(le),ue=a(263),ce=n(ue),de=a(7218),fe=n(de),pe=a(270),he=(n(pe),a(268)),me=(n(he),a(7128)),ge=(n(me),a(53)),_e=(n(ge),a(14)),ve=n(_e),be=a(10),ye=n(be),Ee=a(71),Se=n(Ee),Ce=a(485),Me=n(Ce),ke=a(275),we=n(ke),Ne=a(172),Te=n(Ne),Pe=a(174),Ie=3e3,Re=8.5,Ae=300,xe=function(e){function t(){var e,a,o,n;(0,f["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,g["default"])(this,(e=t.__proto__||(0,c["default"])(t)).call.apply(e,[this].concat(i))),o.state=o.initialState(o.props),o.hideStickyDateMarkerTimer=new W["default"](function(){o.stickyDateMarker.hideStickyDateMarker(!0)}),o.renderedMsgCache=new s["default"],o.setScrollContainer=function(e){return o.scrollContainer=e},o.onPanesWillChange=function(e){var t=ye["default"].last(o.visibleMsgOrder);if(t){var a=t.toString(),n=o.messageList;if(a&&n){var r=n.getMsgWrapperRef(a);if(r){var i=o.scrollContainer,l=S["default"].findDOMNode(r),s=o.getMsgBottom(i,l);o.panesChanging={msg:l,container:i,msgBottom:s}}}}},o.onPanesDidChange=function(e){if(o.panesChanging){var t=o.panesChanging,a=t.msg,n=t.container,r=t.msgBottom;o.setMsgBottom(n,a,r),o.panesChanging=void 0}},o.onRerender=(0,be.debounce)(function(){o._onRerender()},100),o._onRerender=function(){var e=o.scrollContainer,t=e.scrollTop;o.setState({msgListKey:o.state.msgListKey+1},function(){o.setScrollTop(e,t)})},o.handleScroll=(0,be.throttle)(function(e,t,a){o.updateRenderedMsgCache(),e.scrollTop<Ae&&Date.now()-(o.chatOpenScrollTimestamp||0)>w["default"].MSG_FOCUS_SCROLL_ANIMATION_DURATION+50&&o.loadEarlierMsgs();var n=o.state,r=n.isNearBottom,i=n.cursor,l=a(e);l?(o.maybeSendSeen(!0),o.isMostRecentCMC()&&r!==l&&(o.setUpdateType(N.UpdateTypes.NONE),o.setState({isNearBottom:l,newUnread:0})),(i.end<o.props.msgCollection.length||!o.isMostRecentCMC())&&o.loadRecentMsgs()):r!==l&&(o.setUpdateType(N.UpdateTypes.NONE),o.setState({isNearBottom:l}))},100),o.onResizeThrottle=(0,be.throttle)(function(){o.updateRenderedMsgCache()},100),o.onMsgKeyChange=function(e){var t=e.newKey,a=e.oldKey,n=a.toString(),r=t.toString(),i=o.renderedMsgCache.get(n);i&&(o.renderedMsgCache.set(r,i),o.renderedMsgCache["delete"](n));for(var l=0;l<o.visibleMsgOrder.length;++l)if(o.visibleMsgOrder[l]===a){o.visibleMsgOrder[l]=t;break}},o.onResizeDebounce=(0,be.debounce)(function(){var e=o.nearBottom();o.nearBottom!==e&&(o.setUpdateType(N.UpdateTypes.NONE),o.setState({isNearBottom:e}))},100),o.loadEarlierMsgs=function(){var e=o.props,t=e.chat,a=e.msgCollection,n=o.state.cursor;if(n.start>0)n.hasBefore()&&(o.setUpdateType(N.UpdateTypes.KEEP_SCROLL_BOTTOM),o.setState({cursor:n.loadBefore()}));else{if(a.msgLoadState.noEarlierMsgs||a.msgLoadState.isLoadingEarlierMsgs||a.msgLoadState.isLoadingAroundMsgs)return;t.loadEarlierMsgs(a).checkpoint(o.props.rejectOnUnmount()).then(function(){var e={};o.state.focusCtx||(e.focusCtx=o.getUnreadFocusCtx(o.props)),n.hasBefore()?(o.setUpdateType(N.UpdateTypes.KEEP_SCROLL_BOTTOM),e.cursor=n.loadBefore(),o.setState(e)):o.setState(e)})["catch"](ve["default"].Unmount,ye["default"].noop)["catch"](function(e){Z["default"].log("ConversationMsgs:loadEarlierMsgs failed")(),Z["default"].log(e)()})}},o.loadRecentMsgs=function(){var e=o.props,t=e.chat,a=e.msgCollection,n=o.state.cursor;if(n.end<a.length)o.setUpdateType(N.UpdateTypes.KEEP_SCROLL_TOP),o.setState({cursor:n.loadAfter()});else{if(a.msgLoadState.isLoadingRecentMsgs||a.msgLoadState.isLoadingAroundMsgs)return;t.loadRecentMsgs(a).checkpoint(o.props.rejectOnUnmount()).then(function(){n.hasAfter()?(o.setUpdateType(N.UpdateTypes.KEEP_SCROLL_TOP),o.setState({cursor:n.loadAfter()})):o.state.cursor.end>=a.length&&o.isMostRecentCMC()&&o.setState({})})["catch"](ve["default"].Unmount,ye["default"].noop)["catch"](function(e){Z["default"].log("ConversationMsgs:loadRecentMsgs failed")(),Z["default"].log(e)()})}},o.onComposeHeightChange=function(e){var t=o.scrollContainer;if(e){if(0>e&&t.scrollTop===t.scrollHeight-t.clientHeight)return;o.setScrollTop(t,t.scrollTop+e)}else!function(){var e=t.scrollHeight-(t.scrollTop+t.clientHeight);(0,O["default"])(t,{tween:18},{progress:function(){o.setScrollTop(t,t.scrollHeight-e-t.clientHeight)},duration:300},[.1,.82,.25,1])}()},o.getScrollBottom=function(){var e=o.scrollContainer;return e?e.scrollHeight-(e.scrollTop+e.clientHeight):0},o.isMsgVisible=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=e.toString();return o.renderedMsgCache.has(a)&&(t?!0:o.getMsgComponent(a))},o.onScroll=function(e){o.handleScroll(e.target,o.props.chat,o.nearBottom,o)},o.onWindowGainedFocus=function(){var e=o.props.chat;!o.clearUnreadTimer&&e.isDirty()&&(o.clearUnreadTimer=setTimeout(function(){delete o.clearUnreadTimer,o.maybeSendSeen()},w["default"].CLEAR_CHAT_DIRTY_WAIT))},o.onWindowLostFocus=function(){if(o.state.unreadCount&&o.isMostRecentCMC()){var e=o.props.chat;0===e.unreadCount&&(o.setUpdateType(N.UpdateTypes.KEEP_SCROLL_BOTTOM),o.setState({unreadCount:0})),e.markedUnread=!1}},o.jumpToBottom=function(){o.isMostRecentCMC()&&o.state.cursor.end>=o.props.msgCollection.length?o.scrollToBottom():A["default"].openChatBottom(o.props.chat).then(function(e){e&&A["default"].focusChatTextInput(o.props.chat)})},o.scrollToBottom=function(e){var t=o.scrollContainer;o.setScrollTop(t,t.scrollHeight),o.state.cursor.resetBeforeCursor(),o.setState({}),e&&e()},o.onLastMsgChanged=function(e,t){var a=o.props.msgCollection,n=o.state,r=n.cursor,i=n.focusCtx,l=a.last();if(!o.isMostRecentCMC())return void(t&&e&&e.isSentByMe&&o.jumpToBottom());var s={},u=document.hasFocus(),c=o.nearBottom();o.setUpdateType(c?N.UpdateTypes.SCROLL_BOTTOM:N.UpdateTypes.KEEP_SCROLL_TOP),u&&c?(o.setUpdateType(N.UpdateTypes.SCROLL_BOTTOM),s.unreadCount=0,s.focusCtx=void 0,s.cursor=r.setKey()):l&&l.isSentByMe&&t&&(o.setUpdateType(N.UpdateTypes.SCROLL_BOTTOM),o.state.unreadCount&&(s.unreadCount=0,s.focusCtx=void 0,s.cursor=r.setKey()),o.jumpToBottom()),i&&!s.hasOwnProperty("focusCtx")?s.cursor=r.loadAfter(1):s.cursor=r.loadBeforeCapped(1),ye["default"].isEmpty(s)||o.setState(s)},o.onUnreadCount=function(){var e=o.props.chat,t=o.nearBottom(),a=document.hasFocus();o.maybeSendSeen(t,a);var n={};if(e.unreadCount&&!e.pendingSeenCount&&o.isMostRecentCMC()){n.unreadCount=e.unreadCount;var r=o.getUnreadFocusCtx();r&&(n.focusCtx=r,n.cursor=o.state.cursor.setKey(r.msg.key))}t&&n.unreadCount-o.state.unreadCount===1&&o.setUpdateType(N.UpdateTypes.SCROLL_BOTTOM),(!t&&o.isMostRecentCMC()||!e.pendingSeenCount&&o.state.newUnread!==e.unreadCount)&&(n.newUnread=e.unreadCount),ye["default"].isEmpty(n)||o.setState(n)},o.onMsgsDelete=function(e,t,a){e.forEach(function(e){o.state.cursor.onRemove(e)}),o.setState({})},o.onPageUpDown=function(e){se["default"].focus(o.scrollContainer)},o.scrollMessages=function(){var e=ye["default"].last(o.visibleMsgOrder);if(e){var t=o.messageList;if(t){var a=t.getMsgWrapperRef(e);if(a){var n=S["default"].findDOMNode(a);if(n){var r=1===o.visibleMsgOrder.length?n.clientHeight:0,i=o.scrollContainer;(0,O["default"])(n,"stop"),(0,O["default"])(i,"stop"),(0,O["default"])(n,"scroll",{duration:300,container:i,offset:r})}}}}},o.onKeyPress=function(e){e.metaKey||e.ctrlKey||(e.preventDefault(),"Enter"!==e.key||e.shiftKey?A["default"].pasteChatTextInput(o.props.chat,String.fromCharCode(e.charCode)):A["default"].enterChatTextInput(o.props.chat))},o.onContextMenu=function(e){var t,a=o.props.chat,n=o.props.onSelectMessages;if(a.isUser)t=y["default"].createElement(V["default"],{chat:a,toContextMenuManager:!0,contact:a.contact,onSelectMessages:n});else if(a.isGroup)t=B["default"].group(a,n);else{if(!a.isBroadcast)return;t=B["default"].broadcast(a,n)}e.preventDefault(),e.stopPropagation(),e.persist(),o.setState({contextMenu:{menu:t,event:e}})},o.onContextClose=function(){o.setState({contextMenu:null})},o.onPaste=function(e){e.preventDefault();var t=new M["default"](e.clipboardData);if(!t.hasFiles()&&t.hasType("text/plain"))return e.persist(),void A["default"].sendPasteToCompose(o.props.chat,e);var a=ye["default"].filter(t.getFiles(),function(e){var t=(0,L.typeFromMimetype)(e.type);return"image"===t||"video"===t});a.length&&A["default"].attachMediaDrawer({chat:o.props.chat,files:a})},n=a,(0,g["default"])(o,n)}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"componentWillUnmount",value:function(){this.onRerender.cancel(),this.handleScroll.cancel(),this.onResizeThrottle.cancel(),this.onResizeDebounce.cancel(),this.hideStickyDateMarkerTimer.cancel(),this.clearUnreadTimer&&clearTimeout(this.clearUnreadTimer),this.maybeSendSeen()&&(this.props.chat.markedUnread=!1)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.chat,o=t.msgCollection,n=t.listeners;n.add(A["default"],"scroll_chat_to_bottom",this.scrollToBottom),n.add(A["default"],"scroll_messages",this.scrollMessages),n.add(A["default"],"textsize_change",function(t){return e.setState({textSize:t})}),n.add(A["default"],"panes_will_change",this.onPanesWillChange),n.add(A["default"],"panes_did_change",this.onPanesDidChange),n.add(A["default"],"scroll_to_focused_msg",function(){e.chatOpenScrollTimestamp=Date.now()}),n.add(window,"focus",this.onWindowGainedFocus),n.add(window,"blur",this.onWindowLostFocus),n.add(window,"resize",this.onResizeThrottle),n.add(window,"resize",this.onResizeDebounce),n.add(a,"change:trusted",this._onRerender),n.add(Store.Msg,"change:msgKey",this.onMsgKeyChange),a.isGroup?n.add(a.groupMetadata.participants,"change:contact.name change:contact.isMyContact change:contact.notifyName",this.onRerender):a.isUser&&n.add(a.contact,"change:isMyContact",this.onRerender),n.add(o,"change:star",this.onRerender);var r=this.scrollContainer,i=void 0;this.messageList&&(i=S["default"].findDOMNode(this.messageList)),i&&i.clientHeight<r.clientHeight&&(this.loadEarlierMsgs(),this.loadRecentMsgs()),this.attachMsgCollectionObservers(this.props),this.updateRenderedMsgCache(),this.props.updateOpenedChatInfo({chat:a}),a.sendSeen()}},{key:"componentWillReceiveProps",value:function(e){this.attachMsgCollectionObservers(e),this.switchMsgCollection(e)}},{key:"switchMsgCollection",value:function(e){var t=e.focusCtx,a=e.chat,o=e.msgCollection,n=t||this.getUnreadFocusCtx(e),r=n&&n.msg,i=r&&r.id;this.setState({cursor:new q["default"](o,i,a.isGroup?w["default"].RENDOR_CURSOR.GROUP_CONVERSATION:w["default"].RENDOR_CURSOR.CONVERSATION),focusCtx:n})}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.chat;this.updateType=N.UpdateTypes.DEFAULT,this.updateRenderedMsgCache(e.chat===a),t.msgListKey===this.state.msgListKey&&this.props.updateOpenedChatInfo({chat:a})}},{key:"getMsgBottom",value:function(e,t){var a=e.scrollTop,o=e.scrollHeight,n=e.clientHeight,r=o-(a+n);return o-(t.offsetTop+t.clientHeight+r)}},{key:"setMsgBottom",value:function(e,t,a){var o=t.offsetTop,n=t.clientHeight,r=o+n+a-e.clientHeight;this.setScrollTop(e,r)}},{key:"initialState",value:function(e){var t=e.focusCtx,a=e.chat,o=e.msgCollection;this.updateType=N.UpdateTypes.DEFAULT;var n=t||this.getUnreadFocusCtx(e),r=n&&n.msg,i=r&&r.id,l=void 0;return l=0,{msgListKey:0,cursor:new q["default"](o,i,a.isGroup?w["default"].RENDOR_CURSOR.GROUP_CONVERSATION:w["default"].RENDOR_CURSOR.CONVERSATION),unreadCount:a.pendingSeenCount?0:a.unreadCount,isNearBottom:!0,newUnread:0,focusCtx:n,contextMenu:null,textSize:l}}},{key:"attachMsgCollectionObservers",value:function(e){var t=this,a=this.props,o=a.listeners,n=a.chat,r=a.msgCollection;r&&(n.msgs===r&&o.remove(n,"change:unreadCount",this.onUnreadCount),o.remove(r,"remove_msgs",this.onMsgsDelete),o.remove(n.msgs,"change:last",this.onLastMsgChanged)),e.msgCollection===e.chat.msgs&&o.add(e.chat,"change:unreadCount",this.onUnreadCount),o.add(e.chat.msgs,"change:last",this.onLastMsgChanged),o.add(e.msgCollection,"remove_msgs",this.onMsgsDelete),this.state.cursor.msgCollection=e.msgCollection;var i=e.focusCtx,l=function(){i.key&&(i.msg=Store.Msg.get(i.key)),i.msg&&(t.setUpdateType(N.UpdateTypes.KEEP_SCROLL_BOTTOM),t.setState({cursor:t.state.cursor.init(i.msg.id)}))};i&&e.msgCollection.loadAroundPromise?e.msgCollection.loadAroundPromise.checkpoint(this.props.rejectOnUnmount()).then(l)["catch"](ve["default"].Unmount,ye["default"].noop)["catch"](ve["default"].E404,function(){A["default"].openToast(y["default"].createElement(ce["default"],{msg:ie["default"].t("message_query_404"),id:(0,ue.genId)()})),l()})["catch"](l):i&&l()}},{key:"isMostRecentCMC",value:function(){return this.props.chat.msgs===this.props.msgCollection}},{key:"setScrollBottom",value:function(e){var t=this.scrollContainer;t&&this.setScrollTop(t,t.scrollHeight-e-t.clientHeight)}},{key:"setScrollTop",value:function(e,t){this.programmaticScroll=Date.now(),e.scrollTop=t}},{key:"updateStickyDateMarker",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=this.messageList;if(a&&"number"==typeof e){var o=t||Date.now()-(this.programmaticScroll||0)<200;o||(this.hideStickyDateMarkerTimer.debounce(Ie),this.stickyDateMarker&&this.stickyDateMarker.hideStickyDateMarker(!1));var n=a.getDateMarkerRef(e);if(-1===e)this.stickyDateMarker.updateDateMarkerText();else if(n){var r=n.getTimestamp(),i=ee.relativeDateStr(r).toUpperCase();this.stickyDateMarker.updateDateMarkerText(i)}if(this.dateMarkerIdx!==e){var l=a.getDateMarkerRef(this.dateMarkerIdx);l&&l.hide(!1),n&&n.hide(!0)}}}},{key:"setUpdateType",value:function(e){N.UpdateTypePriority[e]>=N.UpdateTypePriority[this.updateType]&&(this.updateType=e)}},{key:"nearBottom",value:function(e){return e=e||this.scrollContainer,e.scrollTop+w["default"].SCROLL_FUDGE>e.scrollHeight-e.clientHeight}},{key:"getUnreadFocusCtx",value:function(e){var t=e||this.props,a=t.chat,o=t.msgCollection,n=t.focusCtx,r=void 0;if(a.unreadCount?r=a.unreadCount:this.state&&this.state.unreadCount&&(r=this.state.unreadCount),(!n||this.isMostRecentCMC())&&r){var i=(0,ye["default"])(o.toArray()).filter(function(e){return e.isUnreadType}).reverse().take(r).value();if(i.length===r)return i=ye["default"].last(i),{msg:i,isUnreadDivider:!0,highlightMsg:!1}}}},{key:"getMsgs",value:function(){var e=this.props.msgCollection,t=this.state.cursor;return e.toArray().slice(t.start,t.end)}},{key:"updateRenderedMsgCache",value:function(e){var t=this.messageList;if(!t)return this.renderedMsgCache.clear();for(var a=[],o=t.props.msgs,n=new s["default"],r={},l=0,u=o.length-1;u>l;){var c=Math.floor((l+u)/2),d=o[c].id.toString(),f=t.getMsgWrapperRef(d);t.getMsgVisibility(f).visibility===w["default"].VISIBILITY.ABOVE?l=c+1:u=c}for(var p=l;p<o.length;p++){var h=o[p].id.toString(),m=t.getMsgWrapperRef(h);if(!m)throw new Error("msgRef not found!");var g=t.getMsgVisibility(m);if(g.visibility!==w["default"].VISIBILITY.VISIBLE)break;r[h]={offset:g.offset,t:o[p].t},n.set(h,m),a.push(o[p].id)}var _=this.scrollContainer.scrollTop;l=0,u=ye["default"].size(t.renderedDateMarkers)-1;var v=t.getDateMarkerRef(0),b=v&&S["default"].findDOMNode(v);if(b&&b.offsetTop<=_+Re)for(;u>l;){var y=Math.ceil((l+u)/2),E=t.getDateMarkerRef(y);if(!E)throw new Error("DateMarkerRef: "+y+" not found. "+(0,i["default"])(t.renderedDateMarkers).toString()+"}");var C=S["default"].findDOMNode(E);C.offsetTop>_+Re?u=y-1:l=y}else l=-1;this.updateStickyDateMarker(l,e),this.dateMarkerIdx=l,this.pauseHiddenGifs(this.renderedMsgCache,n),this.renderedMsgCache=n,this.visibleMsgOrder=a,this.props.updateOpenedChatInfo({renderedMsgsInfo:r,visibleMsgOrder:a,clientHeight:this.scrollContainer.clientHeight})}},{key:"getMsgComponent",value:function(e){var t=this.messageList;return t?t.getMsgComponentRef(e.toString()):void 0}},{key:"pauseHiddenGifs",value:function(e,t){var a=this;e.forEach(function(e,o){if(!t.has(o)){var n=a.props.msgCollection.get(o);n&&n.isGif&&"function"==typeof e.pause&&e.pause()}})}},{key:"maybeSendSeen",value:function(e,t){var a=this.props,o=a.chat,n=a.msgCollection,r=this.state.cursor;return o.isDirty()&&this.isMostRecentCMC()&&r.end>=n.length&&(ye["default"].isUndefined(t)&&(t=document.hasFocus()),t&&(ye["default"].isUndefined(e)&&(e=this.nearBottom()),e))?(o.sendSeen(),!0):void 0}},{key:"render",value:function(){var e=this,t=this.props,a=t.chat,o=t.msgCollection,n=t.selectable,r=t.onMessageSelect,i=this.state.focusCtx,l=(0,F["default"])("pane-chat-msgs pane-chat-body lastTabIndex",{selectable:n}),s=this.isMostRecentCMC(),u=!!i,c=void 0,d=ye["default"].find(w["default"].TEXTSIZE_CLASS_MAP,function(t){return t.scale===e.state.textSize});d&&(c=d.classname);var f=y["default"].createElement(T["default"],{key:"ml-"+a.id+"-"+this.state.msgListKey,ref:(0,Pe.GetRef)("messageList",this),updateType:this.updateType,unreadCount:this.state.unreadCount,selectable:n,onMessageSelect:r,msgs:this.getMsgs(),focusedMsgCtx:i,selectedMessages:this.props.selectedMessages,isMsgVisible:this.isMsgVisible,notifyChatRendered:this.props.notifyChatRendered}),p=o.msgLoadState,h=y["default"].createElement(I["default"],{direction:"around",isMostRecentCMC:s,loadMoreMsgs:ye["default"].noop,msgLoad:p}),m=void 0;(this.state.cursor.start>0||!p.noEarlierMsgs)&&(m=y["default"].createElement(I["default"],{direction:"earlier",isMostRecentCMC:s,loadMoreMsgs:this.loadEarlierMsgs,msgLoad:p}));var g=void 0;(this.state.cursor.end<o.length||!s)&&(g=y["default"].createElement(I["default"],{direction:"recent",isMostRecentCMC:s,loadMoreMsgs:this.loadRecentMsgs,msgLoad:p})),u&&o.msgLoadState.isLoadingAroundMsgs?(g=void 0,m=void 0,f=void 0):h=void 0;var _=void 0,v=void 0,b=this.state,E=b.isNearBottom,S=b.newUnread;E&&(o.msgLoadState.isLoadingAroundMsgs||s)||(S&&a.unreadCount&&(v=y["default"].createElement(fe["default"],{count:this.state.newUnread,muted:a.mute.isMuted,key:"icon-unread"})),_=y["default"].createElement("div",{className:"incoming-msgs",onClick:this.jumpToBottom},y["default"].createElement(J["default"],{transitionName:"pop",className:"badge-unread"},v),y["default"].createElement(Te["default"],{name:"down"})));var C=void 0;return this.state.contextMenu&&(C=y["default"].createElement(ne["default"],{displayName:"ConversationContextMenu",escapable:!0,popable:!0,requestDismiss:this.onContextClose},y["default"].createElement(ae["default"],{contextMenu:this.state.contextMenu}))),y["default"].createElement(we["default"],{className:c},y["default"].createElement(K["default"],{ref:(0,Pe.GetRef)("stickyDateMarker",this)}),y["default"].createElement(J["default"],{transitionName:"pop"},_),y["default"].createElement("div",{className:l,ref:this.setScrollContainer,onScroll:this.onScroll,onKeyPress:this.onKeyPress,onContextMenu:n?null:this.onContextMenu,onPaste:this.onPaste,tabIndex:"0"},y["default"].createElement("div",{className:"pane-chat-empty"}),h,m,f,g),C)}}]),t}(b.Component);t["default"]=(0,Me["default"])((0,Se["default"])(xe))},7370:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(10),E=o(y),S=a(176),C=o(S),M=a(264),k=o(M),w=a(484),N=(o(w),a(53)),T=(o(N),a(7164)),P=(o(T),a(268)),I=(o(P),a(7242)),R=o(I),A=a(7368),x=o(A),O=a(7369),D=o(O),L=a(7240),U=o(L),F=a(7276),j=o(F),B=a(12),G=o(B),V=a(34),Y=o(V),W=a(126),H=o(W),q=a(7128),z=o(q),K=a(7323),Q=o(K),J=a(174),X=a(14),Z=o(X),$=a(7118),ee=o($),te=a(71),ae=o(te),oe=a(261),ne=o(oe),re=function(e){function t(){(0,u["default"])(this,t);var e=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments));e.editLastMsg=function(e){},e.onComposeState=function(){var t=e.props.chat.canSend;e.state.canCompose!==t&&e.setState({canCompose:t})},e.onComposeHeightChange=function(t,a){var o=t.input,n=t.overlay,i=void 0===n?0:n,l=b["default"].findDOMNode(e.refs.msgPanel);if(l&&e.msgs){var s=e.msgs,u=s.getScrollBottom();if(void 0!==o)return void e.msgs.onComposeHeightChange(o);if(a)return e.fillerHeight=i,void(e.refs.filler&&(e.refs.filler.style.height=e.fillerHeight+"px",e.msgs.setScrollBottom(u)));e.fillerHeight+=i,0>i&&(e.refs.filler&&(e.refs.filler.style.height=e.fillerHeight+"px"),e.msgs&&e.msgs.setScrollBottom(u)),e.msgPanelAnimation&&(e.didCancel=!0,e.msgPanelAnimation.cancel()),e.msgPanelAnimation=(e.msgPanelAnimation||r["default"].resolve()).then(function(){return(0,k["default"])(l,{translateY:i>0?[-i,0]:[0,i]},{duration:300,easing:[.1,.82,.25,1]})}).cancellable()["catch"](Z["default"].Unmount,E["default"].noop).then(function(){i>0&&e.refs.filler&&(e.refs.filler.style.height=e.fillerHeight+"px"),l.style.transform="",e.msgs&&i>0&&e.msgs.setScrollBottom(u)})["catch"](r["default"].CancellationError,function(){(0,k["default"])(l,"finish",!0)}).then(function(){e.didCancel?e.didCancel=!1:e.msgPanelAnimation=void 0})}},e.onWallpaperColorPreview=function(t){t?e.state.wallpaperColor!==t&&e.setState({wallpaperColor:t}):e.setState({wallpaperColor:Store.ChatPreference.get("defaultPreference").wallpaperColor})},e.onSelectMessages=function(){e.state.selectable||e.setState({selectable:!0})},e.onCancelSelection=function(){e.state.selectable&&(e.selectedMessages.unsetAll(),e.setState({selectable:!1}))},e.onMessageSelect=function(t,a){e.onSelectMessages(),e.selectedMessages.setVal(t,a)},e.onPageUpDown=function(t){e.msgs.onPageUpDown(t)},e.onDragStart=function(t){e.state.canCompose&&(e.blockDrop=!0)},e.onDragEnd=function(t){e.state.canCompose&&(e.blockDrop=!1)},e.onDragEnter=function(t){e.state.canCompose&&!e.blockDrop&&(E["default"].includes(t.dataTransfer.types,"Files")||E["default"].includes(t.dataTransfer.types,"text/uri-list")||E["default"].includes(t.dataTransfer.types,"text/html"))&&(e.ComposeBoxRef.saveComposeContentDebounced.flush(),G["default"].attachMediaDrawer({chat:e.props.chat,initCaption:e.ComposeBoxRef.getCurrentComposeContent(),onComplete:e.ComposeBoxRef.updateTextAfterMediaDrawerClose}),t.stopPropagation(),t.preventDefault())},e.getMsgs=(0,J.GetRef)("msgs",e);var a=e.props.chat;return e.fillerHeight=a.fillerHeight||0,e.selectedMessages=new z["default"]([],function(e){return e.id.toString()}),e.state={canCompose:a.canSend,selectable:!1,wallpaperColor:e.props.chatPreference.wallpaperColor},e}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.chat;e.fillerHeight=null,this.props.listeners.add(e,"change:canSend",this.onComposeState),this.openEvent=new Y["default"].WebcChatOpen({webcUnreadCount:e.unreadCount}),this.uiActionEvent=new Y["default"].UiAction({uiActionType:Y["default"].UI_ACTION_TYPE.CHAT_OPEN,uiActionPreloaded:!0});var t=e.getReceivedVCardMsgs();t&&!t.isSynced&&t.sync(e)}},{key:"componentDidMount",value:function(){var e=this.props.chat;e.set({active:!0,viewed:!0});var t=this.openEvent;t&&(t.markWebcChatOpenT(),t.commit(),this.openEvent=void 0);var a=this.uiActionEvent;a&&(a.markUiActionT(),a.commit(),this.uiActionEvent=void 0),this.props.listeners.add(Store.ChatPreference,"wallpaper_color_preview",this.onWallpaperColorPreview),e.composeAttachMediaContents&&G["default"].attachMediaDrawer({chat:e,animationName:"noop"})}},{key:"componentWillUnmount",value:function(){this.props.chat.set("active",!1)}},{key:"render",value:function(){var e,t,a,o=this.props,n=o.chat,r=o.msgCollection,i=o.focusCtx;if(this.state.selectable)t=_["default"].createElement(ne["default"],{displayName:"MultiSelect",escapable:!0,requestDismiss:this.onCancelSelection},_["default"].createElement(j["default"],{chat:n,className:"multi-controls-conversation",selectedMessages:this.selectedMessages,disableRevoke:!1,noSortOnForward:!1,onCancel:this.onCancelSelection})),e=_["default"].createElement("footer",{className:"pane-footer pane-chat-footer"}),a=_["default"].createElement("div",{ref:"filler",className:"compose-filler"});else if(this.state.canCompose)e=_["default"].createElement(U["default"],{chat:n,ref:(0,J.GetRef)("ComposeBoxRef",this),className:"pane-footer pane-chat-footer",onComposeHeightChange:this.onComposeHeightChange,onPageUpDown:this.onPageUpDown}),a=_["default"].createElement("div",{ref:"filler",style:{height:this.fillerHeight+"px"},className:"compose-filler"});else{var l;l=n.isGroup?l10n.t("web_cannot_send_not_a_group_participant"):n.isPSA?l10n.t("web_psa_title"):l10n.t("web_cannot_send_to_blocked_contact_1",{contact:n.contact.formattedName}),e=_["default"].createElement("footer",{className:"pane-footer pane-chat-footer"},_["default"].createElement("div",{"data-a8n":C["default"].key("block-message"),className:"block-message"},l))}return _["default"].createElement(ne["default"],{displayName:"ConversationPanel",state:ne["default"].State.INACTIVE},_["default"].createElement("div",{id:"main",onKeyDownCapture:this.editLastMsg,className:"pane pane-chat pane-two"},_["default"].createElement(R["default"],{wallpaperColor:this.state.wallpaperColor}),_["default"].createElement(x["default"],{chat:n,canAttach:this.state.canCompose,onSelectMessages:this.onSelectMessages}),_["default"].createElement("div",{className:"pane-body pane-chat-tile-container",ref:"msgPanel",onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragEnter:this.onDragEnter},_["default"].createElement(D["default"],{ref:this.getMsgs,chat:n,selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,msgCollection:r,onSelectMessages:this.onSelectMessages,focusCtx:i,selectedMessages:this.selectedMessages,notifyChatRendered:this.props.notifyChatRendered,updateOpenedChatInfo:this.props.updateOpenedChatInfo})),a,e,_["default"].createElement(H["default"],{transitionName:"slide-up"},t),_["default"].createElement(Q["default"],null)))}}]),t}(_["default"].Component);re.CONCERNS={chatPreference:["wallpaperColor"]},e.exports=(0,ae["default"])((0,ee["default"])(re))},7371:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(175),_=o(g),v=(a(268),a(7118)),b=o(v),y=a(172),E=o(y),S=a(7574),C=o(S),M=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.direction,t=this.props.msgLoad,a=void 0,o=void 0,n=void 0;if("earlier"===e&&t.isLoadingEarlierMsgs||"recent"===e&&t.isLoadingRecentMsgs||"around"===e&&t.isLoadingAroundMsgs)a=m["default"].createElement(_["default"],{stroke:6,size:24,color:"highlight"}),o=l10n.t("loading_messages");else{switch(e){case"earlier":o=l10n.t("load_earlier_messages");break;case"recent":o=l10n.t("load_recent_messages");break;default:o=l10n.t("loading_messages")}a=m["default"].createElement("div",{className:C["default"].icon},m["default"].createElement(E["default"],{name:"refresh"})),n=this.props.loadMoreMsgs}return m["default"].createElement("div",{className:C["default"].wrapper},m["default"].createElement("div",{className:C["default"].button,title:o,onClick:n},a))}}]),t}(m["default"].PureComponent);M.CONCERNS={msgLoad:["isLoadingEarlierMsgs","isLoadingRecentMsgs","isLoadingAroundMsgs"]},t["default"]=(0,b["default"])(M)},7372:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7118),_=o(g),v=a(487),b=a(7129),y=o(b),E=a(7249),S=o(E),C=a(12),M=o(C),k=a(7134),w=o(k),N=a(7179),T=o(N),P=a(7138),I=o(P),R=a(47),A=o(R),x=a(53),O=(o(x),a(262)),D=o(O),L=a(7244),U=o(L),F=a(7245),j=o(F),B=a(172),G=o(B),V=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.showMediaMissing=function(){M["default"].openModal(m["default"].createElement(w["default"],{msg:a.props.msg}))},a.downloadMedia=function(){a.props.msg.forceDownloadMedia()},a.cancelDownload=function(){a.props.msg.cancelDownload()},a.cancelUpload=function(){a.props.msg.cancelUpload()},a.resumeUpload=function(){
a.props.msg.resumeUpload()},a.resumeRemoteUpload=function(){A["default"].supportsFeature(A["default"].F.MEDIA_RETRY)?a.props.msg.resumeRemoteUpload():M["default"].openModal(m["default"].createElement(I["default"],{msg:a.props.msg}))},a.downloadUnsupportedToDesktop=function(e){e&&e.stopPropagation(),M["default"].openModal(m["default"].createElement(T["default"],{msg:(0,v.unproxy)(a.props.msg)}))},a.handleTimeUpdate=function(e){a.setState({currentTime:e})},a.handlePlayingUpdate=function(e){a.setState({autoPlay:!1,playing:e})},a.state={currentTime:0,playing:!1,autoPlay:!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.msg.downloadMedia()}},{key:"render",value:function(){var e=this.props.msg,t=this.props.mediaData,a=void 0,o=this.state.playing?this.state.currentTime:t.duration;switch(t.mediaStage){case D["default"].STAGE.RESOLVED:a=m["default"].createElement(S["default"],{url:t.renderableUrl,duration:o,playing:this.state.playing,autoPlay:!1,onPlayingUpdate:this.handlePlayingUpdate,onTimeUpdate:this.handleTimeUpdate});break;case D["default"].STAGE.NEED_POKE:a=m["default"].createElement(j["default"],{icon:m["default"].createElement(G["default"],{name:"audio-download"}),outgoingMsg:e.isSentByMe,action:this.downloadMedia});break;case D["default"].STAGE.NEED_UPLOAD:a=m["default"].createElement(j["default"],{icon:m["default"].createElement(G["default"],{name:"audio-upload"}),outgoingMsg:e.isSentByMe,action:this.resumeUpload});break;case D["default"].STAGE.REMOTE_NEED_UPLOAD:a=m["default"].createElement(j["default"],{icon:m["default"].createElement(G["default"],{name:"audio-upload"}),outgoingMsg:e.isSentByMe,action:this.resumeRemoteUpload});break;case D["default"].STAGE.ERROR_MISSING:a=m["default"].createElement(j["default"],{icon:m["default"].createElement(G["default"],{name:"audio-play",directional:!0}),outgoingMsg:e.isSentByMe,action:this.showMediaMissing});break;default:a=m["default"].createElement(j["default"],{outgoingMsg:e.isSentByMe,spinner:!0})}var n=m["default"].createElement("div",{className:"audio-icon"},m["default"].createElement(G["default"],{name:"audio-file"})),r=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?m["default"].createElement(y["default"],{msg:e,contact:e.senderObj}):null;return m["default"].createElement(U["default"],{msg:e,quotedMsg:this.props.quotedMsg,author:r,player:a,avatar:n})}}]),t}(m["default"].PureComponent);V.CONCERNS={msg:["ack","isSentByMe","isGroupMsg","senderObj"],mediaData:["duration","type","mediaStage","renderableUrl"]},t["default"]=(0,_["default"])(V)},7373:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){var e=k["default"].build(R["default"].FAQ_BASE_URL+"/faq/general/26000015/",{lg:l10n.getLocale()});window.open(e,"_blank")}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(3),v=o(_),b=a(53),y=(o(b),a(7130)),E=o(y),S=a(7129),C=o(S),M=a(73),k=o(M),w=a(7118),N=o(w),T=a(23),P=o(T),I=a(8),R=o(I),A=a(172),x=o(A);t["default"]=(0,N["default"])((i=r=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg,a=t?v["default"].createElement(C["default"],{msg:e,contact:e.senderObj}):null,o=(0,P["default"])("bubble bubble-placeholder",{"has-author":t}),r="message-text";return v["default"].createElement("div",{className:o},a,v["default"].createElement("div",{className:"ciphertext-icon"},v["default"].createElement(x["default"],{name:"ciphertext"})),v["default"].createElement("div",{className:r},v["default"].createElement("span",null,v["default"].createElement("span",{className:"placeholder-msg"},l10n.t("placeholder_msg")),v["default"].createElement("span",{className:"placeholder-msg-action",onClick:n},l10n.t("learn_more")))),v["default"].createElement("div",{className:"bubble-placeholder-meta"},v["default"].createElement(E["default"],{msg:e})))}}]),t}(v["default"].PureComponent),r.CONCERNS={msg:["isSentByMe","isGroupMsg","senderObj"]},i))},7374:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(181),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(62),y=o(b),E=a(54),S=n(E),C=a(12),M=n(C),k=a(71),w=n(k),N=a(7375),T=n(N),P=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.state={hide:!1},o.rerender=function(){o.forceUpdate()},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentDidMount",value:function(){this.maybeRegMidnight()}},{key:"componentDidUpdate",value:function(){this.maybeRegMidnight()}},{key:"getTimestamp",value:function(){return this.props.timestamp}},{key:"hide",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){this.state.hide!==e&&this.setState({hide:e})})},{key:"maybeRegMidnight",value:function(){this.props.listeners.remove(M["default"],"midnight",this.rerender);var e=(0,S["default"])().startOf("day").subtract(7,"day");this.props.timestamp>=e.unix()&&this.props.listeners.add(M["default"],"midnight",this.rerender)}},{key:"render",value:function(){var e=y.relativeDateStr(this.props.timestamp);return v["default"].createElement(T["default"],{hide:this.state.hide,label:e})}}]),t}(v["default"].PureComponent),I=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"getTimestamp",value:function(){return(0,i["default"])(t.prototype.__proto__||(0,s["default"])(t.prototype),"getComponent",this).call(this).getTimestamp()}},{key:"hide",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return(0,i["default"])(t.prototype.__proto__||(0,s["default"])(t.prototype),"getComponent",this).call(this).hide(e)})}]),t}((0,w["default"])(P));t["default"]=I},7375:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=(0,s["default"])("message message-system",{"date-marker-floating":e.hide});return i["default"].createElement("div",{className:"msg msg-system"},i["default"].createElement("div",{className:t},i["default"].createElement("span",{className:"message-system-body"},i["default"].createElement(c["default"],{direction:"auto",text:e.label.toUpperCase()}))))}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var r=a(3),i=o(r),l=a(23),s=o(l),u=a(7119),c=o(u)},7376:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){e&&(e.stopPropagation(),e.preventDefault())}Object.defineProperty(t,"__esModule",{value:!0});var r=a(24),i=o(r),l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(3),v=o(_),b=a(7129),y=o(b),E=a(7118),S=o(E),C=a(487),M=a(7130),k=o(M),w=a(53),N=(o(w),a(262)),T=o(N),P=a(7119),I=o(P),R=a(23),A=o(R),x=a(7134),O=o(x),D=a(7138),L=o(D),U=a(7333),F=o(U),j=a(47),B=o(j),G=a(12),V=o(G),Y=a(128),W=a(491),H=o(W),q=a(10),z=o(q),K=a(94),Q=o(K),J=a(8),X=o(J),Z=a(263),$=o(Z),ee=z["default"].pickBy(Y.MIMETYPES,function(e){return"document"===e.msgType}),te=function(e){function t(){var e,a,o,r;(0,c["default"])(this,t);for(var i=arguments.length,l=Array(i),u=0;i>u;u++)l[u]=arguments[u];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(l))),o.showMediaMissing=function(e){n(e),V["default"].openModal(v["default"].createElement(O["default"],{msg:o.props.msg}))},o.downloadMedia=function(e){if(n(e),!Modernizr.adownload){var t=l10n.t("whatsapp_safari_limited").replace("__chrome_homepage__",X["default"].BROWSER_LINK.CHROME).replace("__firefox_homepage__",X["default"].BROWSER_LINK.FIREFOX).replace("__opera_homepage__",X["default"].BROWSER_LINK.OPERA);return void V["default"].openModal(v["default"].createElement(Q["default"],{onOK:V["default"].closeModal.bind(V["default"]),okText:l10n.t("web_ok")},v["default"].createElement("div",{dangerouslySetInnerHTML:{__html:t}})))}o.props.msg.forceDownloadMedia()["catch"](z["default"].noop).then(function(){switch(o.props.mediaData.mediaStage){case T["default"].STAGE.RESOLVED:case T["default"].STAGE.ERROR_UNSUPPORTED:o.displayToast(),H["default"].initDownload((0,C.unproxy)(o.props.msg));break;case T["default"].STAGE.ERROR_MISSING:o.showMediaMissing()}})},o.cancelDownload=function(e){n(e),o.props.msg.cancelDownload()},o.cancelUpload=function(e){n(e),o.props.msg.cancelUpload()},o.resumeUpload=function(e){n(e),o.props.msg.resumeUpload()},o.resumeRemoteUpload=function(e){n(e),B["default"].supportsFeature(B["default"].F.MEDIA_RETRY)?o.props.msg.resumeRemoteUpload():V["default"].openModal(v["default"].createElement(L["default"],{msg:o.props.msg}))},r=a,(0,h["default"])(o,r)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"displayToast",value:function(){var e=this.props,t=e.msg,a=e.mediaData,o=t.caption||a.filename||l10n.t("untitled_document");V["default"].openToast(v["default"].createElement($["default"],{msg:l10n.t("document_downloaded",{name:o}),id:(0,Z.genId)()}))}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.mediaData,o=e.displayAuthor,n=e.displayType,r=(0,A["default"])("bubble","bubble-doc",{"bubble-broadcast":t.broadcast,"bubble-star":t.star}),l=o&&!t.isSentByMe&&t.isGroupMsg?v["default"].createElement("div",{className:"bubble-doc-author"},v["default"].createElement(y["default"],{msg:t,contact:t.senderObj})):null,s=void 0;a.pageCount>0&&(s=v["default"].createElement("span",{className:"document-meta-value"},l10n.t("web_conversations_most_recent_document",{count:a.pageCount,_plural:a.pageCount})));var u=a.size>0?v["default"].createElement("span",{className:"document-meta-value"},l10n.filesize(a.size)):null,c=void 0,d="icon-doc",f=void 0;if(z["default"].has(ee,a.mimetype))f=ee[a.mimetype].ext,d=(0,A["default"])(d,ee[a.mimetype].icon);else if(a.filename){var p=a.filename.split(".");p.length>1&&(f=z["default"].upperCase(z["default"].last(p)))}f&&(c=v["default"].createElement("span",{className:"document-meta-value"},f));var h=a.preview&&this.props.trusted?v["default"].createElement("div",{className:"document-thumb",style:{backgroundImage:'url("'+a.preview.url()+'")'}}):null,m=t.caption||a.filename||l10n.t("untitled_document"),g=null,_={href:"#",onClick:null};switch(a.mediaStage){case T["default"].STAGE.RESOLVED:case T["default"].STAGE.ERROR_UNSUPPORTED:_.onClick=this.downloadMedia,g=v["default"].createElement(F["default"].Download,{onClick:_.onClick});break;case T["default"].STAGE.FETCHING:g=v["default"].createElement(F["default"].PendingCancel,null),_.onClick=this.cancelDownload;break;case T["default"].STAGE.NEED_POKE:case T["default"].STAGE.INIT:_.onClick=this.downloadMedia,g=v["default"].createElement(F["default"].Download,{onClick:_.onClick});break;case T["default"].STAGE.UPLOADING:g=v["default"].createElement(F["default"].PendingCancel,{outgoingMsg:t.isSentByMe}),_.onClick=this.cancelUpload;break;case T["default"].STAGE.NEED_UPLOAD:g=v["default"].createElement(F["default"].Upload,null),_.onClick=this.resumeUpload;break;case T["default"].STAGE.REMOTE_NEED_UPLOAD:g=v["default"].createElement(F["default"].Upload,null),_.onClick=this.resumeRemoteUpload;break;case T["default"].STAGE.ERROR_TOO_LARGE:_.onClick=null;break;case T["default"].STAGE.ERROR_MISSING:_.onClick=this.showMediaMissing;break;default:g=v["default"].createElement(F["default"].Pending,{outgoingMsg:t.isSentByMe})}var b=n!==X["default"].DISP_TYPE.GALLERY?v["default"].createElement("div",{className:"bubble-doc-meta"},v["default"].createElement(k["default"],{msg:t})):null;return v["default"].createElement("div",{className:r},l,this.props.quotedMsg,v["default"].createElement("a",(0,i["default"])({className:"document-container",title:l10n.t("web_download_document",{name:m})},_),h,v["default"].createElement("div",{className:"document-body"},v["default"].createElement("div",{className:"document-icon"},v["default"].createElement("div",{className:d})),v["default"].createElement("div",{className:"document-text"},v["default"].createElement(I["default"],{text:m,ellipsify:!0,dirMismatch:t.rtl!==l10n.isRTL(),direction:"auto"})),g)),v["default"].createElement("div",{className:"document-meta"},s,c,u),b)}}]),t}(v["default"].PureComponent);te.CONCERNS={msg:["broadcast","star","caption","rtl","ack","isSentByMe","isGroupMsg","senderObj"],mediaData:["mediaStage","filename","pageCount","size","mimetype","preview"]},t["default"]=(0,S["default"])(te)},7377:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.displayType,a=e.msg;return a.mediaData?i["default"].createElement(c["default"],{displayType:t,mediaData:a.mediaData,msg:a}):null}Object.defineProperty(t,"__esModule",{value:!0});var r=a(3),i=o(r),l=a(8),s=(o(l),a(53)),u=(o(s),a(7378)),c=o(u),d=a(7118),f=o(d);n.CONCERNS={msg:["mediaData"]},t["default"]=(0,f["default"])(n)},7378:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=e.displayType,a=e.mediaData,o=e.msg,n=t===d["default"].DISP_TYPE.CONVERSATION,i=a.mediaStage;if(i===b["default"].STAGE.ERROR_TOO_LARGE)return l["default"].createElement(C["default"],{mediaType:a.type});if(o.isUnsentMedia&&(i===b["default"].STAGE.ERROR_MISSING||i===b["default"].STAGE.ERROR_UNSUPPORTED))return l["default"].createElement(p["default"],{tooltip:l10n.t("send_failed")});if(o.isFailed){if(i===b["default"].STAGE.ERROR_MISSING)return l["default"].createElement(p["default"],{tooltip:l10n.t("unsent_media_not_on_phone")});if(o.type===E["default"].TYPE.PTT&&i===b["default"].STAGE.PREPARING)return l["default"].createElement(p["default"],{tooltip:l10n.t("ptt_failed")});if(m["default"].supportsFeature(m["default"].F.RESEND_ICON)&&n&&i!==b["default"].STAGE.REMOTE_UPLOADING)return l["default"].createElement(p["default"],{onClick:r.bind(null,o),tooltip:l10n.t("resend_message")})}return null}function r(e){e.isMMS&&!m["default"].supportsFeature(m["default"].F.MEDIA_RETRY)?u["default"].openModal(l["default"].createElement(k["default"],{msg:e})):e.resend()["catch"](function(e){_["default"].log("msg_media_fail_icon:resend failure: "+e)()})}Object.defineProperty(t,"__esModule",{value:!0});var i=a(3),l=o(i),s=a(12),u=o(s),c=a(8),d=o(c),f=a(7246),p=o(f),h=a(47),m=o(h),g=a(1),_=o(g),v=a(262),b=o(v),y=a(53),E=o(y),S=a(7379),C=o(S),M=a(7138),k=o(M),w=a(7118),N=o(w);n.CONCERNS={msg:["isFailed","isMMS","type","isUnsentMedia"],mediaData:["mediaStage","type"]},t["default"]=(0,N["default"])(n)},7379:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){var t=r(e.mediaType);return s["default"].createElement(f["default"],{onClick:i.bind(null,t),tooltip:t})}function r(e){var t={maxSize:l10n.filesize(Store.ServerProps.media)},a={maxSize:l10n.filesize(Store.ServerProps.maxFileSize)};switch(e){case m.OUTWARD_TYPES.AUDIO:case m.OUTWARD_TYPES.PTT:return l10n.t("message_audio_too_big",t);case m.OUTWARD_TYPES.IMAGE:return l10n.t("message_image_too_big",t);case m.OUTWARD_TYPES.VIDEO:return l10n.t("message_video_too_big",t);case m.OUTWARD_TYPES.DOCUMENT:return l10n.t("message_document_too_big",a);case m.OUTWARD_TYPES.UNKNOWN:default:return l10n.t("message_file_too_big",a)}}function i(e){c["default"].openModal(s["default"].createElement(h["default"],{onOK:function(){return c["default"].closeModal()}},e))}Object.defineProperty(t,"__esModule",{value:!0});var l=a(3),s=o(l),u=a(12),c=o(u),d=a(7246),f=o(d),p=a(94),h=o(p),m=a(109);t["default"]=n},7380:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),l=n(i),s=a(2),u=n(s),c=a(4),d=n(c),f=a(7),p=n(f),h=a(6),m=n(h),g=a(3),_=n(g),v=a(7129),b=n(v),y=a(7199),E=n(y),S=a(23),C=n(S),M=a(12),k=n(M),w=a(8),N=n(w),T=a(47),P=n(T),I=a(262),R=n(I),A=a(7134),x=n(A),O=a(7157),D=o(O),L=a(7130),U=n(L),F=a(53),j=n(F),B=a(7138),G=n(B),V=a(7118),Y=n(V),W=a(487),H=a(7173),q=n(H),z=a(174),K=a(172),Q=n(K),J=2.4,X=330,Z=X/J,$=3,ee=6,te=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={playing:!1},o.playerRef=null,o.playCount=0,o.pause=function(){o.playCount=0,o._pause()},o.play=function(e){if(o.props.mediaData.mediaStage===R["default"].STAGE.RESOLVED&&o.playerRef){e&&e.stopPropagation();var t=o.props.mediaData.duration;if(t){var a=Math.ceil(ee/parseInt(t,10));o.playCount=Math.max(a,$)}else o.playCount=$;o._play()}},o._pause=function(){o.setState({playing:!1}),o.playerRef&&o.playerRef.pauseAndReset()},o._play=function(){if(o.playerRef){if(o.playCount<=0)return void o.pause();o.playCount-=1,o.state.playing||o.setState({playing:!0}),o.playerRef.play()}},o.showMediaMissing=function(){k["default"].openModal(_["default"].createElement(x["default"],{msg:o.props.msg}))},o.getZoomNode=function(e){var t=o.props.isMsgVisible;if(!t)return null;var a=t(e);return a?a.getImgNode&&a.getImgNode():null},o.launchMediaViewer=function(e){e&&e.stopPropagation(),k["default"].mediaViewerModal((0,W.unproxy)(o.props.msg),o.getZoomNode)},o.downloadMedia=function(){o.props.msg.forceDownloadMedia()},o.cancelDownload=function(){o.props.msg.cancelDownload()},o.cancelUpload=function(){o.props.msg.cancelUpload()},o.resumeUpload=function(){o.props.msg.resumeUpload()},o.resumeRemoteUpload=function(){P["default"].supportsFeature(P["default"].F.MEDIA_RETRY)?o.props.msg.resumeRemoteUpload():k["default"].openModal(_["default"].createElement(G["default"],{msg:o.props.msg}))},o.onDragStart=function(e){e.nativeEvent.dataTransfer.setData(N["default"].DRAG_TYPE_LOCAL_IMAGE,!0)},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.props.msg.downloadMedia()}},{key:"getStyle",value:function(){var e=this.props.mediaData,t=e.aspectRatio;if(!t)return{bubbleWidth:X,bubbleHeight:"100%",contentWidth:X,contentHeight:"100%"};var a=void 0,o=void 0;1/J>t?(o=X,a=Z):1>t?(o=X,a=X*t):J>t?(a=X,o=X/t):(a=X,o=Z);var n=e.renderableUrl?e.fullWidth||a:a,r=e.renderableUrl?e.fullHeight||o:o;return n/r>a/o?(n=n*o/r,r=o):(r=r*a/n,n=a),{bubbleWidth:a,bubbleHeight:o,contentWidth:n,contentHeight:r}}},{key:"getImgNode",value:function(){return this.playerRef?this.playerRef.underlyingVideo():void 0}},{key:"render",value:function(){var e=this.props.msg,t=this.props.mediaData,a=e.caption?_["default"].createElement(E["default"],{msg:e,contact:e.senderObj,trusted:this.props.trusted}):null,o=a?null:_["default"].createElement("div",{className:"shade"}),n=t.preview?t.preview.url():void 0,i=null,l=null,s=null,u=this.getStyle(),c=u.bubbleWidth,d=u.bubbleHeight,f=u.contentWidth,p=u.contentHeight,h={width:c,height:d};switch(t.mediaStage){case R["default"].STAGE.RESOLVED:this.state.playing||(i=_["default"].createElement("span",{className:"image-gif-control",onClick:this.play},_["default"].createElement(Q["default"],{name:"media-gif"}))),s=_["default"].createElement("div",{className:"image-thumb-body image-thumb-gif-video"},_["default"].createElement(q["default"],{ref:(0,z.GetRef)("playerRef",this),src:t.renderableUrl,width:f,height:p,onEnded:this._play,muted:!0},l10n.t("video_playback_not_supported"))),l=this.launchMediaViewer;break;case R["default"].STAGE.INIT:l=this.launchMediaViewer;break;case R["default"].STAGE.FETCHING:i=_["default"].createElement(D.PendingCancel,null),l=this.cancelDownload;break;case R["default"].STAGE.NEED_POKE:i=_["default"].createElement(D.Download,{filesize:t.size}),l=this.downloadMedia;break;case R["default"].STAGE.UPLOADING:i=_["default"].createElement(D.PendingCancel,null),l=this.cancelUpload;break;case R["default"].STAGE.NEED_UPLOAD:i=_["default"].createElement(D.Upload,{filesize:t.size}),l=this.resumeUpload;break;case R["default"].STAGE.REMOTE_NEED_UPLOAD:i=_["default"].createElement(D.Upload,{filesize:t.size}),l=this.resumeRemoteUpload;break;case R["default"].STAGE.ERROR_MISSING:l=this.showMediaMissing;break;default:i=_["default"].createElement(D.Pending,null)}var m=n?_["default"].createElement("div",{className:"image-thumb-body image-thumb-gif",style:{backgroundImage:"url("+n+")"}}):null,g=(0,C["default"])("bubble-image bubble-gif",{"bubble-image-caption":e.caption,"bubble-broadcast":e.caption&&e.broadcast,"bubble-star":e.caption&&e.star}),v=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?_["default"].createElement("div",{className:"bubble-gif-author"},_["default"].createElement(b["default"],{msg:e,contact:e.senderObj})):null,y=void 0;switch(e.gifAttribution){case j["default"].GIF_ATTRIBUTION.GIPHY:y=_["default"].createElement("div",{className:"icon-gif-vendor"},_["default"].createElement(Q["default"],{name:"giphy"}));break;case j["default"].GIF_ATTRIBUTION.TENOR:y=_["default"].createElement("div",{className:"icon-gif-vendor"},_["default"].createElement(Q["default"],{name:"tenor"}));break;default:y=null}return _["default"].createElement("div",{className:g,onClick:r,style:{width:h.width}},v,this.props.quotedMsg,_["default"].createElement("div",{className:"image-thumb",onClick:l,style:h},i,m,s,o,y),a,_["default"].createElement("div",{className:"bubble-gif-meta"},_["default"].createElement(U["default"],{msg:this.props.msg})))}}]),t}(_["default"].PureComponent);te.CONCERNS={msg:["id","ack","caption","broadcast","star","isSentByMe","isGroupMsg","gifAttribution","senderObj"],mediaData:["aspectRatio","preview","duration","type","mediaStage","renderableUrl","fullWidth","fullHeight","size"]},t["default"]=(0,Y["default"])(te)},7381:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(96),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(12),E=o(y),S=a(7119),C=o(S),M=a(7260),k=o(M),w=a(7147),N=o(w),T=a(1),P=o(T),I=a(7118),R=o(I),A=a(32),x=o(A),O=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"stopEvent",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"openInfoDrawer",value:function(){var e=this;return function(t){e.stopEvent(t),E["default"].chatInfoDrawer(e.props.msg.chat)}}},{key:"openGroupInviteLinkDrawer",value:function(){var e=this;return function(t){e.stopEvent(t);var a=e.props.msg.chat;E["default"].openDrawerRight(_["default"].createElement(k["default"],{chat:a,groupMetadata:a?a.groupMetadata:void 0,onBack:function(){return E["default"].closeDrawerRight()}}),"slide-left")}}},{key:"openChat",value:function(e){var t=this;return function(a){t.stopEvent(a),Store.Chat.find(e).then(function(e){E["default"].openChatFromUnread(e).then(function(t){t&&E["default"].focusChatTextInput(e)})})}}},{key:"getFormattedText",value:function(e,t){return _["default"].createElement(C["default"],{direction:"auto",onClick:t,text:e})}},{key:"getClickableName",value:function(e,t){return this.getFormattedText(t,this.openChat(e))}},{key:"getClickableNames",value:function(e){var t=this;return e.map(function(e){var a=Store.Contact.get(e),o=a?a.get("formattedName"):x["default"].formattedUser(e);return t.getClickableName(e,o)}).reduce(function(e,t){return e?[].concat((0,r["default"])(e),[l10n.t("enumeration_comma"),t]):[t]},"")}},{key:"isMe",value:function(e){return e===Store.Conn.me}},{key:"handleGroupNotification",value:function(e,t,a,o){var n={},r=void 0,i=void 0,l=void 0,s=this.getClickableName(t,a);switch(e){case"add":this.isMe(t)?r="web_group_participant_added_you":(r="web_group_participant_added_name",n.name=s);break;case"remove":this.isMe(t)?r="web_group_participant_removed_you":(r="web_group_participant_removed_name",n.name=s);break;case"leave":this.isMe(t)?r="web_group_participant_left_you":(r="web_group_participant_left_name",n.name=s);break;case"picture":"remove"===o?this.isMe(t)?r="web_photo_removed_by_you":(r="web_photo_removed_by",n.name=s):this.isMe(t)?r="web_photo_changed_by_you":(r="web_photo_changed_by",n.name=s),l=this.openInfoDrawer();break;case"subject":this.isMe(t)?r="web_group_subject_changed_by_you":(r="web_group_subject_changed_by_name",n.name=s),n.subject=this.getFormattedText(o),l=this.openInfoDrawer();break;case"modify":var u=x["default"].formattedUser(t),c=x["default"].formattedUser(o);this.isMe(u)?r="web_group_participant_changed_number_unknown_name":(r="web_group_participant_changed_number",n.old_number=u),n.name=s,n.new_number=c;break;default:P["default"].log("wa:groupNotification:unknown message subtype: "+e)()}return{l10nId:r,params:n,plural:i,onClick:l}}},{key:"handleGP2",value:function(e,t,a,o,n){var r={},i=void 0,l=void 0,s=void 0,u=void 0,c=n?b["default"].head(n):"",d=Store.Contact.get(c),f="";d?f=d.get("formattedName"):c&&(f=x["default"].formattedUser(c));var p=this.getClickableName(t,a),h=this.getClickableName(c,f),m=this.getClickableNames(n);switch(e){case"add":t?this.isMe(t)?(i="web_group_participants_you_added_names",r.participants=m):(this.isMe(c)?i="web_group_participants_name_added_you":(i="web_group_participants_name_added_names",r.participants=m),r.name=p):this.isMe(c)?i="web_group_participant_added_you":(i="web_group_participant_added_name",r.name=h);break;case"remove":t?this.isMe(t)?(i="web_group_participants_you_removed_names",r.participants=m):(this.isMe(c)?i="web_group_participants_name_removed_you":(i="web_group_participants_name_removed_names",r.participants=m),r.name=p):this.isMe(c)?i="web_group_participant_removed_you":(i="web_group_participant_removed_name",r.name=h);break;case"leave":this.isMe(c)?i="web_group_participant_left_you":(i="web_group_participant_left_name",r.name=m);break;case"picture":"remove"===o?this.isMe(t)?i="web_photo_removed_by_you":(i="web_photo_removed_by",r.name=p):this.isMe(t)?i="web_photo_changed_by_you":(i="web_photo_changed_by",r.name=p),s=this.openInfoDrawer();break;case"subject":this.isMe(t)?i="web_group_subject_changed_by_you":(i="web_group_subject_changed_by_name",r.name=p),r.subject=this.getFormattedText(o),s=this.openInfoDrawer();break;case"modify":var g=x["default"].formattedUser(t),_=x["default"].formattedUser(c);g===a?i="web_group_participant_changed_number_unknown_name":(i="web_group_participant_changed_number",r.old_number=g),r.name=a,r.new_number=_;break;case"create":this.isMe(t)?o?(i="web_group_created_by_you",r.subject=this.getFormattedText(o)):i="web_group_created_by_you_no_subject":(o?(i="web_group_created_by_name",r.subject=this.getFormattedText(o)):i="web_group_created_by_name_no_subject",r.name=p);break;case"delete":this.isMe(t)?i="web_group_ended_you":(i="web_group_ended_name",r.name=p);break;case"promote":u=n.length,1===u&&this.isMe(c)?i="web_group_participant_promoted_you":(i="web_group_participant_promoted_names",r.count=u,r.participants=m,l=u);break;case"demote":u=n.length,1===u&&this.isMe(c)?i="web_group_participant_demoted_you":(i="web_group_participant_demoted_names",r.count=u,r.participants=m,l=u);break;case"invite":this.isMe(c)?i="web_group_participant_join_via_invite_you":(i="web_group_participant_join_via_invite_name",r.name=h);break;case"revoke_invite":this.isMe(t)?i="web_group_invite_revoked_you":(i="web_group_invite_revoked_name",r.name=p),s=this.openGroupInviteLinkDrawer();break;case"description":this.isMe(t)?i="web_group_description_change_you":(i="web_group_description_change_name",r.name=p);break;default:P["default"].log("wa:groupNotification:unknown message subtype: "+e)()}return{l10nId:i,params:r,plural:l,onClick:s}}},{key:"render",value:function(){var e=this.props.msg,t=e.type,a=e.subtype,o=e.author,n=e.body,r=e.recipients,i=e.displayName();if("group_notification"!==t&&"gp2"!==t)return null;var l="gp2"===t?this.handleGP2(a,o,i,n,r):this.handleGroupNotification(a,o,i,n),s=l.l10nId,u=l.params,c=l.plural,d=l.onClick;return _["default"].createElement(N["default"],{id:s,params:u,plural:c,wrapInHiddenToken:!0,onClick:d})}}]),t}(g.PureComponent);O.CONCERNS={msg:["type","subtype","author","body","recipients","chat"]},t["default"]=(0,R["default"])(O)},7382:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(53),_=(o(g),a(525)),v=o(_),b=a(7118),y=o(b),E=a(73),S=o(E),C=a(7197),M=o(C),k=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onClick=function(e){var t=document.createElement("a");t.href=o.props.msg.matchedText,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.msg,a=e.invite,o=null;if(!a){o=S["default"].hostname(t.canonicalUrl||t.matchedText);try{o=v["default"].toUnicode(o)}catch(n){}}return m["default"].createElement(M["default"],{onClick:this.onClick,title:t.title,description:t.description,canonicalUrl:o,invite:a,thumbnail:t.thumbnail})}}]),t}(m["default"].PureComponent);k.CONCERNS={msg:["thumbnail","title","description","canonicalUrl","matchedText"]},t["default"]=(0,y["default"])(k)},7383:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7130),_=o(g),v=a(7129),b=o(v),y=a(7386),E=o(y),S=a(53),C=(o(S),a(93)),M=o(C),k=a(7119),w=o(k),N=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?m["default"].createElement(b["default"],{msg:e,contact:e.senderObj}):null,a=e.comment?m["default"].createElement("div",{className:"message-text"},m["default"].createElement(w["default"],{text:e.comment,selectable:!0,dirMismatch:e.rtl!==M["default"].isRTL(),direction:e.dir})):null;return m["default"].createElement("div",{className:"bubble bubble-placeholder"},t,m["default"].createElement("div",{className:a?"live-location-with-caption":"live-location-no-caption"},m["default"].createElement(E["default"],{hasCaption:!!a,outgoingMsg:this.props.msg.isSentByMe,text:M["default"].t("check_phone_for_live_location"),type:y.TYPE.LIVE_LOCATION})),a,m["default"].createElement("div",{className:"bubble-live-meta"},m["default"].createElement(_["default"],{msg:this.props.msg})))}}]),t}(m["default"].Component);t["default"]=N},7384:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(262),b=(o(v),a(53)),y=o(b),E=a(7118),S=o(E);
t["default"]=(0,S["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.mediaData,a=e.className,o=t.type===y["default"].TYPE.IMAGE&&t.renderableUrl?t.renderableUrl:t.preview&&t.preview.url();return o?_["default"].createElement("div",{style:{backgroundImage:"url("+o+")"},className:a}):null}}]),t}(_["default"].PureComponent),n.CONCERNS={mediaData:["type","preview","renderableUrl"]},r))},7385:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7118),b=o(v),y=a(53),E=o(y),S=a(23),C=o(S),M=a(172),k=o(M),w=a(7576),N=o(w),T={FRONT:"FRONT",MID:"MID",END:"END",SINGLE:"SINGLE"},P=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"click",value:function(){this.refs.context.click()}},{key:"onMouseDown",value:function(e){e.stopPropagation()}},{key:"render",value:function(){var e,t=this.props,a=t.msg,o=t.position,n=t.onClick,i=a.isSentByMe,l=a.isGroupMsg,s=a.type,u=!!a.quotedMsg,c=i?N["default"].contextOut:N["default"].contextIn,d=a.type===E["default"].TYPE.DOCUMENT&&!a.body,f=a.type===E["default"].TYPE.DOCUMENT&&a.body,p=s===E["default"].TYPE.LOCATION,h=a.isMedia&&s!==E["default"].TYPE.AUDIO||f||p&&!a.isLive||u,m=!1;l&&(m=!i&&(o===T.FRONT||o===T.SINGLE||u||h),h=h&&!m);var g=s===E["default"].TYPE.CHAT&&a.matchedText&&a.matchedText.length&&a.body.indexOf(a.matchedText)>-1&&!m&&a.isTrusted(),v=(0,C["default"])(h?N["default"].contextIconMedia:N["default"].contextIcon),b=s===E["default"].TYPE.PTT||s===E["default"].TYPE.AUDIO,y=a.type===E["default"].TYPE.MULTI_VCARD&&!u&&!m,S=(0,C["default"])(c,h?l10n.isRTL()?N["default"].contextMediaRtr:N["default"].contextMediaLtr:null,(e={},(0,r["default"])(e,N["default"].context,!(h||g)),(0,r["default"])(e,N["default"].contextMedia,h),(0,r["default"])(e,N["default"].contextPtt,b&&!u),(0,r["default"])(e,N["default"].contextPttAuthor,b&&m&&!u),(0,r["default"])(e,N["default"].contextSpecial,(g||d)&&!m&&!u),(0,r["default"])(e,N["default"].contextDoc,d&&!m&&!u),(0,r["default"])(e,N["default"].contextMediaDocument,f),(0,r["default"])(e,N["default"].contextMultiVcard,y),(0,r["default"])(e,N["default"].contextInverse,s===E["default"].TYPE.CHAT&&!u&&!!a.dir&&a.rtl!==l10n.isRTL()),e));return _["default"].createElement("div",{className:S},_["default"].createElement("div",{"data-js-context-icon":!0,className:v,ref:"context",onMouseDown:this.onMouseDown,onClick:n},_["default"].createElement(k["default"],{name:"down-context",color:h?"white":null})))}}]),t}(_["default"].PureComponent);P.CONCERNS={msg:["matchedText","dir","rtl","isMedia","isLive","isSentByMe","isGroupMsg","type","quotedMsg","body"]},t["default"]=(0,b["default"])(P)},7386:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.TYPE=void 0;var n=a(3),r=o(n),i=a(172),l=o(i),s=a(269),u=o(s),c=a(7578),d=o(c),f=t.TYPE={LIVE_LOCATION:"LIVE_LOCATION"},p=function(e){var t=void 0;switch(e.type){case f.LIVE_LOCATION:var a=void 0;switch(Store.Conn.platform){case u["default"].PLATFORMS.IPHONE:a=r["default"].createElement(l["default"],{name:"live-location-iphone"});break;case u["default"].PLATFORMS.WP7:a=r["default"].createElement(l["default"],{name:"live-location-wp"});break;default:a=r["default"].createElement(l["default"],{name:"live-location-android"})}t=r["default"].createElement("div",{className:d["default"].descIcon},a);break;default:throw new Error("Unrecognized type")}var o=e.hasCaption?null:d["default"].message;return r["default"].createElement("div",{className:d["default"].desc},t,r["default"].createElement("div",{className:o},e.text))};t["default"]=p},7387:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(508),_=o(g),v=a(7008),b=o(v),y=a(7579),E=o(y),S=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this,t=this.props.emojis,a=(0,b["default"])(t);if(0===a)return null;var o=void 0;switch(a){default:case 3:o=g.SIZE.MEDIUM;break;case 2:o=g.SIZE.LARGE;break;case 1:o=g.SIZE.XLARGE}var n=t.map(function(t,a){return m["default"].createElement(_["default"],{animation:e.props.animation,size:o,emoji:t,key:t+a,selectable:!0})});return m["default"].createElement("div",{className:E["default"].wrapper},n)}}]),t}(m["default"].Component);t["default"]=S},7388:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(10),m=o(h),g=a(7129),_=o(g),v=a(12),b=o(v),y=a(23),E=o(y),S=a(7119),C=o(S),M=a(7130),k=o(M),w=a(53),N=(o(w),a(7456)),T=o(N),P=a(519),I=o(P),R=a(7174),A=o(R),x=a(3),O=o(x),D=a(7118),L=o(D),U=a(266),F=o(U),j=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o._showContactsModal=function(){if(o.props.msg.vcardList){var e=o.props.msg.vcardList.map(function(e){return e.vcard});b["default"].openModal(O["default"].createElement(T["default"],{vcardList:e}))}},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"_renderProfilePics",value:function(){for(var e=(0,m["default"])(this.props.msg.vcardList).map(function(e,t){var a=F["default"].thumbnailWAid(F["default"].vcardWAids(F["default"].parse(e.vcard))),o=F["default"].thumbnail(e.vcard);return a||o?O["default"].createElement(A["default"],{key:t,waid:a,thumb:o,size:39,border:!0,className:"preview-vcard-multi preview-vcard"}):void 0}).filter().take(3).value(),t=Math.min(3-e.length,this.props.msg.vcardList.length-e.length),a=0;t>a;a++)e.push(O["default"].createElement(A["default"],{key:"default-"+a,size:39,border:!0,className:"preview-vcard-multi preview-vcard"}));return e}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.quotedMsg,o=(0,E["default"])(["bubble","bubble-vcard"],{"bubble-vcard-quoted":!!a}),n=(0,E["default"])("vcard-avatar",{"quoted-msg-bubble-vcard":!!a}),r=this.props.displayAuthor&&!t.isSentByMe&&t.isGroupMsg?O["default"].createElement("div",{className:"bubble-mvcard-author"},O["default"].createElement(_["default"],{msg:t,contact:t.senderObj})):null,i=null,l=I["default"].getNameString(t.vcardList),s=a?O["default"].createElement(A["default"],{className:"preview-vcard",border:!0,size:39}):this._renderProfilePics(),u=t.vcardList||t.chat.isTrusted(),c=(0,E["default"])("vcard",{"vcard-clickable":u});return O["default"].createElement("div",{className:o},r,a,O["default"].createElement("div",{className:"wrapper wrapper-vcard wrapper-vcard-multi",title:l,onClick:this._showContactsModal},O["default"].createElement("div",{className:c},O["default"].createElement("div",{className:n},s),O["default"].createElement("div",{className:"vcard-body"},O["default"].createElement(C["default"],{text:l,element:"div",className:"vcard-name vcard-name-multi",dirMismatch:t.rtl!==l10n.isRTL(),direction:t.dir,wbr:15}))),O["default"].createElement("div",{className:"bubble-mvcard-meta"},O["default"].createElement(k["default"],{msg:t}))),i)}}]),t}(O["default"].PureComponent);j.CONCERNS={msg:["rtl","dir","senderObj","vcardList","isSentByMe","isGroupMsg"]},t["default"]=(0,L["default"])(j)},7389:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,a){E["default"].openModal(b["default"].createElement(N["default"],{e2eSubtype:e,jid:t,chatId:a}))}function r(e,t){var a=null;if(t){var o=B["default"].build(k["default"].FAQ_BASE_URL+"/en/general/"+t,{lg:l10n.getLocale()});a=b["default"].createElement("a",{target:"_blank",href:o,key:"learn-more"},l10n.t("learn_more"))}var n=b["default"].createElement(C["default"],{onOK:E["default"].closeModal.bind(E["default"]),okText:l10n.t("web_ok")},[e,a]);E["default"].openModal(n)}Object.defineProperty(t,"__esModule",{value:!0});var i,l,s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(3),b=o(v),y=a(12),E=o(y),S=a(94),C=o(S),M=a(8),k=o(M),w=a(7442),N=o(w),T=a(7119),P=o(T),I=a(265),R=o(I),A=a(7381),x=o(A),O=a(53),D=o(O),L=a(7118),U=o(L),F=a(487),j=a(73),B=o(j),G=a(172),V=o(G),Y=a(7580),W=o(Y);t["default"]=(0,U["default"])((l=i=function(e){function t(){return(0,d["default"])(this,t),(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).apply(this,arguments))}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=void 0,a=void 0,o=void 0,i=void 0,l=function(){switch(e.type){case D["default"].TYPE.NOTIFICATION:a=e.body;break;case D["default"].TYPE.GP2:case D["default"].TYPE.GROUP_NOTIFICATION:return{v:b["default"].createElement(x["default"],{msg:e})};case D["default"].TYPE.BROADCAST_NOTIFICATION:a=R["default"].formatBroadcastNotification(e.subtype,e.body);break;case D["default"].TYPE.E2E_NOTIFICATION:a=R["default"].formatE2ENotification((0,F.unproxy)(e));var l=e.subtype,s=e.body,u=e.id.remote;i=function(){n(l,s,u)};break;case D["default"].TYPE.CALL_LOG:t="miss_video"===e.subtype?b["default"].createElement(V["default"],{name:"miss_video"}):b["default"].createElement(V["default"],{name:"miss"}),t=b["default"].createElement("div",{className:W["default"].icon},t),a=R["default"].formatCallLog((0,F.unproxy)(e),!0);break;case D["default"].TYPE.NOTIFICATION_TEMPLATE:a=R["default"].formatNotificationTemplateText(e.subtype,e.templateParams),o=R["default"].formatNotificationTemplateOnClickText(e.subtype,e.templateParams),o&&!function(){var t=R["default"].notificationTemplateFAQ(e.subtype);i=function(){r(o,t)}}()}}();if("object"==typeof l)return l.v;var s=b["default"].createElement("span",null,t,b["default"].createElement(P["default"],{direction:l10n.isRTL()?"rtl":"ltr",text:a}));return i?b["default"].createElement("div",{role:"button",onClick:i},s):b["default"].createElement("span",null,s)}}]),t}(b["default"].PureComponent),i.CONCERNS={msg:["id","body","chat","type","subtype","templateParams"]},l))},7390:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(!e)return Q;var t=void 0;return t=1>=e?Q:2.4>=e?K/e:K/2.4,Math.round(t)}function i(e,t,a,o){return e&&t&&a&&o?t/e>o/a?{height:"100%"}:{width:"100%"}:{height:"100%",width:"100%"}}function l(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var s=a(5),u=n(s),c=a(2),d=n(c),f=a(4),p=n(f),h=a(7),m=n(h),g=a(6),_=n(g),v=a(3),b=n(v),y=a(7129),E=n(y),S=a(7198),C=n(S),M=a(7118),k=n(M),w=a(487),N=a(7199),T=n(N),P=a(23),I=n(P),R=a(12),A=n(R),x=a(7134),O=n(x),D=a(7138),L=n(D),U=a(262),F=n(U),j=a(7157),B=o(j),G=a(7130),V=n(G),Y=a(53),W=(n(Y),a(47)),H=n(W),q=a(8),z=n(q),K=330,Q=330,J=function(e){function t(){var e,a,o,n;(0,d["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,m["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(i))),o.showMediaMissing=function(){A["default"].openModal(b["default"].createElement(O["default"],{msg:o.props.msg}))},o.getZoomNode=function(e){var t=o.props.isMsgVisible;if(!t)return null;var a=t(e);return a?a.getImgNode&&a.getImgNode():null},o.launchMediaViewer=function(e){e&&e.stopPropagation(),A["default"].mediaViewerModal((0,w.unproxy)(o.props.msg),o.getZoomNode)},o.downloadMedia=function(){o.props.msg.forceDownloadMedia()},o.cancelDownload=function(){o.props.msg.cancelDownload()},o.cancelUpload=function(){o.props.msg.cancelUpload()},o.resumeUpload=function(){o.props.msg.resumeUpload()},o.resumeRemoteUpload=function(){H["default"].supportsFeature(H["default"].F.MEDIA_RETRY)?o.props.msg.resumeRemoteUpload():A["default"].openModal(b["default"].createElement(L["default"],{msg:o.props.msg}))},n=a,(0,m["default"])(o,n)}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"componentDidMount",value:function(){this.props.msg.downloadMedia()}},{key:"onDragStart",value:function(e){e.nativeEvent.dataTransfer.setData(z["default"].DRAG_TYPE_LOCAL_IMAGE,!0)}},{key:"getImgNode",value:function(){return this.refs.img}},{key:"render",value:function(){var e=this.props.msg,t=this.props.mediaData,a=e.caption?null:b["default"].createElement("div",{className:"shade"}),o=e.caption?b["default"].createElement(T["default"],{msg:e,contact:e.senderObj,trusted:this.props.trusted}):null,n=t.renderableUrl||t.preview&&t.preview.url(),s=null,u=null;switch(t.mediaStage){case F["default"].STAGE.RESOLVED:u=this.launchMediaViewer;break;case F["default"].STAGE.FETCHING:s=b["default"].createElement(B.PendingCancel,null),u=this.cancelDownload;break;case F["default"].STAGE.NEED_POKE:s=b["default"].createElement(B.Download,{filesize:t.size}),u=this.downloadMedia;break;case F["default"].STAGE.UPLOADING:s=b["default"].createElement(B.PendingCancel,null),u=this.cancelUpload;break;case F["default"].STAGE.NEED_UPLOAD:s=b["default"].createElement(B.Upload,{filesize:t.size}),u=this.resumeUpload;break;case F["default"].STAGE.REMOTE_NEED_UPLOAD:s=b["default"].createElement(B.Upload,{filesize:t.size}),u=this.resumeRemoteUpload;break;case F["default"].STAGE.ERROR_MISSING:u=this.showMediaMissing;break;case F["default"].STAGE.ERROR_UNSUPPORTED:s=b["default"].createElement(B.Download,{filesize:t.size}),u=this.launchMediaViewer;break;default:s=b["default"].createElement(B.Pending,null)}var c=(0,I["default"])("bubble-image",{"bubble-image-caption":e.caption,"bubble-broadcast":e.caption&&e.broadcast,"bubble-star":e.caption&&e.star}),d=(0,I["default"])("image-thumb-body",{"image-thumb-lores":!t.renderableUrl}),f=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?b["default"].createElement("div",{className:"bubble-image-author"},b["default"].createElement(E["default"],{msg:e,contact:e.senderObj})):null,p=K,h=r(t.aspectRatio),m={width:p,height:h},g=t.fullHeight||h,_=t.fullWidth||p,v=i(g,_,h,p),y=b["default"].createElement("div",null,f,this.props.quotedMsg,b["default"].createElement("div",{className:"image-thumb",onClick:u,style:m},s,b["default"].createElement("img",{src:n,onDragStart:this.onDragStart,className:d,style:v,ref:"img"}),a),o,b["default"].createElement("div",{className:"bubble-image-meta"},b["default"].createElement(V["default"],{msg:e})));return o?b["default"].createElement(C["default"],{contact:e.senderObj,msg:e,className:c,onClick:l},y):b["default"].createElement("div",{className:c,onClick:l},y)}}]),t}(b["default"].PureComponent);J.CONCERNS={msg:["id","ack","caption","broadcast","star","isSentByMe","isGroupMsg","senderObj"],mediaData:["aspectRatio","preview","mediaStage","renderableUrl","fullWidth","fullHeight","size"]},t["default"]=(0,k["default"])(J)},7391:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(8),_=o(g),v=a(7118),b=o(v),y=a(7129),E=o(y),S=a(7249),C=o(S),M=a(7138),k=o(M),w=a(12),N=o(w),T=a(47),P=o(T),I=a(53),R=(o(I),a(262)),A=o(R),x=a(7134),O=o(x),D=a(7123),L=o(D),U=a(7244),F=o(U),j=a(7245),B=o(j),G=a(172),V=o(G),Y=a(7581),W=o(Y),H=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.showMediaMissing=function(){N["default"].openModal(m["default"].createElement(O["default"],{msg:a.props.msg}))},a.downloadMedia=function(){a.props.msg.forceDownloadMedia()},a.cancelDownload=function(){a.props.msg.cancelDownload()},a.cancelUpload=function(){a.props.msg.cancelUpload()},a.resumeUpload=function(){a.props.msg.resumeUpload()},a.resumeRemoteUpload=function(){P["default"].supportsFeature(P["default"].F.MEDIA_RETRY)?a.props.msg.resumeRemoteUpload():N["default"].openModal(m["default"].createElement(k["default"],{msg:a.props.msg}))},a.handleTimeUpdate=function(e){a.setState({currentTime:e})},a.handlePlayingUpdate=function(e){e&&a.props.msg.canSendPlayed()&&a.props.msg.sendPlayed(),a.setState({autoPlay:!1,playing:e})},a.state={currentTime:0,playing:!1,autoPlay:!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.msg.downloadMedia()}},{key:"render",value:function(){var e=this.props.msg,t=this.props.mediaData,a=e.ack===_["default"].ACK_PLAYED?e.isSentByMe?"ptt-out-blue":"ptt-in-blue":e.isSentByMe?"ptt-out-gray":"ptt-in-green",o=m["default"].createElement("div",{className:W["default"].icon,key:"status"},m["default"].createElement(V["default"],{name:a})),n=void 0,r=this.state.playing?this.state.currentTime:t.duration;switch(t.mediaStage){case A["default"].STAGE.RESOLVED:n=m["default"].createElement(C["default"],{url:t.renderableUrl,playing:this.state.playing,duration:r,autoPlay:this.state.autoPlay,onPlayingUpdate:this.handlePlayingUpdate,onTimeUpdate:this.handleTimeUpdate});break;case A["default"].STAGE.NEED_POKE:n=m["default"].createElement(B["default"],{icon:m["default"].createElement(V["default"],{name:"audio-download"}),outgoingMsg:e.isSentByMe,action:this.downloadMedia});break;case A["default"].STAGE.NEED_UPLOAD:n=m["default"].createElement(B["default"],{icon:m["default"].createElement(V["default"],{name:"audio-upload"}),outgoingMsg:e.isSentByMe,action:this.resumeUpload});break;case A["default"].STAGE.REMOTE_NEED_UPLOAD:n=m["default"].createElement(B["default"],{icon:m["default"].createElement(V["default"],{name:"audio-upload"}),outgoingMsg:e.isSentByMe,action:this.resumeRemoteUpload});break;case A["default"].STAGE.ERROR_MISSING:n=m["default"].createElement(B["default"],{icon:m["default"].createElement(V["default"],{name:"audio-play",directional:!0}),outgoingMsg:e.isSentByMe,action:this.showMediaMissing});break;default:n=m["default"].createElement(B["default"],{spinner:!0,outgoingMsg:e.isSentByMe})}var i=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?m["default"].createElement("div",{className:W["default"].author},m["default"].createElement(E["default"],{msg:e,contact:e.senderObj})):null,l=m["default"].createElement(L["default"],{id:e.senderObj.id,size:55});return m["default"].createElement(F["default"],{msg:e,quotedMsg:this.props.quotedMsg,author:i,status:o,player:n,avatar:l})}}]),t}(m["default"].PureComponent);H.CONCERNS={msg:["ack","isSentByMe","isGroupMsg","senderObj"],mediaData:["duration","type","mediaStage","renderableUrl"]},t["default"]=(0,b["default"])(H)},7392:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(53),m=(o(h),a(3)),g=o(m),_=a(7130),v=o(_),b=a(7129),y=o(b),E=a(23),S=o(E),C=a(172),M=o(C),k=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=!e.isSentByMe&&e.isGroupMsg?g["default"].createElement("div",{className:"bubble-placeholder-author"},g["default"].createElement(y["default"],{msg:e,contact:e.senderObj})):null,a=(0,S["default"])("bubble bubble-placeholder bubble-revoked",{"has-author":!!t,"revoked-outgoing":e.isSentByMe,"revoked-incoming":!e.isSentByMe}),o=e.isSentByMe?l10n.t("revoke_outgoing"):l10n.t("revoke_incoming"),n=e.isSentByMe?"recalled-out":"recalled-in";return g["default"].createElement("div",{className:a},t,g["default"].createElement("div",{className:"message-text"},g["default"].createElement("div",{className:"revoked-icon"},g["default"].createElement(M["default"],{name:n})),g["default"].createElement("span",{className:"placeholder-msg"},o)),g["default"].createElement("div",{className:"bubble-placeholder-meta"},g["default"].createElement(v["default"],{msg:e})))}}]),t}(g["default"].Component);t["default"]=k},7393:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(53),_=o(g),v=a(7118),b=o(v),y=a(172),E=o(y),S=_["default"].TYPE,C=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=e.ack,a=e.isMedia&&!e.caption&&e.type!==S.AUDIO||e.type===S.LOCATION&&!e.loc&&!e.isLive,o=void 0;return o=1>t?a?"msg-time-light":"msg-time":1===t?a?"msg-check-light":"msg-check":2===t?a?"msg-dblcheck-light":"msg-dblcheck":a?"msg-dblcheck-ack-light":"msg-dblcheck-ack",m["default"].createElement("div",{className:"status-icon"},m["default"].createElement(E["default"],{name:o}))}}]),t}(m["default"].PureComponent);C.CONCERNS={msg:["ack","isMedia","caption","type","loc","isLive"]},t["default"]=(0,b["default"])(C)},7394:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7119),_=o(g),v=a(126),b=o(v),y=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={date:void 0,hide:!1},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"updateDateMarkerText",value:function(e){this.setState({date:e})}},{key:"hideStickyDateMarker",value:function(e){this.setState({hide:e})}},{key:"render",value:function(){var e=void 0;return this.state.date&&!this.state.hide&&(e=m["default"].createElement("div",{className:"msg msg-system sticky-date-marker"},m["default"].createElement("div",{className:"sticky-date-marker-wrapper message-system"},m["default"].createElement("span",{className:"message-system-body"},m["default"].createElement(_["default"],{direction:"auto",text:this.state.date}))))),m["default"].createElement(b["default"],{transitionName:"slide-down-date"},e)}}]),t}(h.PureComponent);t["default"]=y},7395:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7129),b=o(v),y=a(7198),E=o(y),S=a(486),C=(o(S),a(8)),M=o(C),k=a(23),w=o(k),N=a(7119),T=o(N),P=a(7130),I=o(P),R=a(53),A=(o(R),a(7382)),x=o(A),O=a(93),D=o(O),L=a(278),U=a(7387),F=o(U),j=a(95),B=o(j),G=a(488),V=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.state={folded:a.props.msg.body.length>=M["default"].MSG_TRUNC_LENGTH},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.msg,o=t.displayAuthor,n=t.trusted,i=t.displayType,l=o&&!a.isSentByMe&&a.isGroupMsg?_["default"].createElement(b["default"],{msg:a,contact:a.senderObj}):null,s=(0,w["default"])("bubble","bubble-text",{"bubble-broadcast":a.broadcast,"bubble-star":a.star,"has-author":!!l}),u=void 0,c=void 0;if(n&&a.linkPreview){var d=(0,L.parseCmd)(a.matchedText),f=(0,r["default"])(d,1),p=f[0];if(p===L.Cmd.GROUP_INVITE){if(u=_["default"].createElement(x["default"],{msg:a,invite:!0}),i!==M["default"].DISP_TYPE.GALLERY){var h=function(e){var t=document.createElement("a");t.href=a.matchedText,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)},m=a.isSentByMe?D["default"].t("group_invite_view"):D["default"].t("group_invite_join");c=_["default"].createElement("div",{className:"bubble-actions"},_["default"].createElement("div",{className:"bubble-btn",onClick:h,title:m},m))}}else u=_["default"].createElement(x["default"],{msg:a})}var g=void 0,v=void 0,y=B["default"].getMatchedEmojis(a.body);if(y){v="message-text-emoji";var S=1===y.length&&""===y[0];g=_["default"].createElement(F["default"],{animation:S,emojis:y})}else{var C=!0,k=n?G.Configuration.TrustedConversation:G.Configuration.UntrustedConversation,N=k({mentions:a.mentionMap(),selectable:C});g=_["default"].createElement(T["default"],{text:a.body,className:i===M["default"].DISP_TYPE.GALLERY?"message-text-link":"",dirMismatch:a.rtl!==D["default"].isRTL(),direction:a.dir,formatters:N,selectable:C,textLimit:this.state.folded?M["default"].MSG_TRUNC_LENGTH:1/0})}var P=this.state.folded?_["default"].createElement("span",{className:(0,w["default"])("read-more"),onClick:function(){e.setState({folded:!1})}}," "+D["default"].t("read_more")):null,R=i!==M["default"].DISP_TYPE.GALLERY?_["default"].createElement("div",{className:"bubble-text-meta"},_["default"].createElement(I["default"],{msg:a})):null;return _["default"].createElement(E["default"],{className:s,contact:a.senderObj,msg:a},l,this.props.quotedMsg,u,_["default"].createElement("div",{className:(0,w["default"])("message-text",v),"data-id":a.id},g,P),c,R)}}]),t}(_["default"].PureComponent);t["default"]=V},7396:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(93),l=o(i),s=a(7582),u=o(s);t["default"]=function(e){var t=e.count,a=l["default"].t("unread_message_count",{count:l["default"].n(t),_plural:t});return r["default"].createElement("div",{className:u["default"].msgUnread},r["default"].createElement("span",{className:u["default"].msgUnreadBody},a))}},7397:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(23),l=o(i),s=a(7130),u=o(s),c=a(7129),d=o(c),f=a(265),p=o(f),h=a(281),m=o(h),g=a(53),_=(o(g),a(93)),v=o(_),b=a(172),y=o(b);t["default"]=function(e){var t=e.msg,a=e.displayAuthor,o=a&&!t.isSentByMe&&t.isGroupMsg?r["default"].createElement("div",{className:"bubble-placeholder-author"},r["default"].createElement(d["default"],{msg:t,contact:t.senderObj})):null,n=(0,l["default"])("bubble bubble-placeholder",{"has-author":!!o}),i="message-text",s=t.isSentByMe||!t.subtype?r["default"].createElement("a",{className:"text-clickable placeholder-msg-action",onClick:m["default"].restart.bind(m["default"])},v["default"].t("unsupported_msg_web_click_to_update")):null;return r["default"].createElement("div",{className:n},o,r["default"].createElement("div",{className:"unsupported-message-icon"},r["default"].createElement(y["default"],{name:"unknown"})),r["default"].createElement("div",{className:i},r["default"].createElement("span",null,r["default"].createElement("span",{className:"placeholder-msg"},p["default"].msgText(t)),s)),r["default"].createElement("div",{className:"bubble-placeholder-meta"},r["default"].createElement(u["default"],{msg:t})))}},7398:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(488),b=a(7409),y=o(b),E=a(7129),S=o(E),C=a(7198),M=o(C),k=a(12),w=o(k),N=a(94),T=o(N),P=a(7438),I=o(P),R=a(23),A=o(R),x=a(491),O=o(x),D=a(7119),L=o(D),U=a(7130),F=o(U),j=a(53),B=(o(j),a(7174)),G=o(B),V=a(3),Y=o(V),W=a(7118),H=o(W),q=a(487),z=a(266),K=o(z),Q=a(7468),J=o(Q),X=a(172),Z=o(X);t["default"]=(0,H["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onMessageClick=function(){var e=o.props.msg.getWAids();e.length>1?w["default"].openModal(Y["default"].createElement(J["default"],{vCard:o.props.msg.vcard,onCancel:w["default"].closeModal.bind(w["default"]),icon:Y["default"].createElement(Z["default"],{name:"chat",directional:!0}),onSelect:o.openContactChat})):o.openContactChat(_["default"].first(e))},o.onViewContact=function(){o.props.msg.vcard?w["default"].openModal(Y["default"].createElement(I["default"],{vcard:o.props.msg.body})):w["default"].openModal(Y["default"].createElement(T["default"],{onCancel:w["default"].closeModal.bind(w["default"]),onOK:function(){w["default"].closeModal(),O["default"].initDownload((0,q.unproxy)(o.props.msg))},okText:l10n.t("web_button_download"),cancelText:l10n.t("web_cancel"),title:l10n.t("download_contact_title")},l10n.t("download_contact_prompt")))},o.onAddToGroupClick=function(){var e=o.props.msg.getWAids();e.length>1?w["default"].openModal(Y["default"].createElement(J["default"],{vCard:o.props.msg.vcard,onCancel:w["default"].closeModal.bind(w["default"]),onSelect:o.addContactToGroup,icon:Y["default"].createElement(Z["default"],{name:"add-user",directional:!0})})):o.addContactToGroup(_["default"].first(e))},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"openContactChat",value:function(e){Store.Chat.find(e).then(function(e){w["default"].closeModal(),w["default"].openChatFromUnread(e).then(function(t){t&&w["default"].focusChatTextInput(e)})})}},{key:"addContactToGroup",value:function(e){Store.Contact.find(e).then(function(e){w["default"].openModal(Y["default"].createElement(y["default"],{contact:e,pushTransition:"none",popTransition:"none"}),"modal-flow")})}},{key:"render",value:function(){var e=this.props.msg,t=e.getWAids(),a="vcard-avatar vcard-avatar-single",o=(0,A["default"])(["bubble","bubble-vcard"],{"bubble-vcard-quoted":e.isQuoted()}),n=_["default"].truncate(e.subtype||l10n.t("attach_vcard"),{length:120,omission:l10n.t("punctuation_ellipsis")}),r=void 0;t.length>0&&(r=Y["default"].createElement("div",{className:"bubble-actions"},Y["default"].createElement("div",{className:"bubble-btn",onClick:this.onMessageClick,title:l10n.t("message_author",{author:n})},l10n.t("message")),Y["default"].createElement("div",{className:"bubble-btn",onClick:this.onAddToGroupClick,title:l10n.t("add_contact_to_group")},l10n.t("add_contact_to_group"))));var i=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg?Y["default"].createElement("div",{className:"bubble-vcard-author"},Y["default"].createElement(S["default"],{msg:e,contact:e.senderObj})):null,l=this.props.msg.vcard||this.props.msg.chat.isTrusted(),s=(0,A["default"])({vcard:!0,"vcard-clickable":l}),u=l?this.onViewContact:_["default"].noop,c=!0,d=v.Configuration.Compatibility({selectable:c});return Y["default"].createElement(M["default"],{className:o,contact:e.senderObj,msg:e},i,this.props.quotedMsg,Y["default"].createElement("div",{className:"wrapper wrapper-vcard",onClick:u},Y["default"].createElement("div",{className:s},Y["default"].createElement(G["default"],{className:a,thumb:K["default"].thumbnail(e.body),waid:e.getVCardThumbnailWAid()}),Y["default"].createElement("div",{className:"vcard-body"},Y["default"].createElement(L["default"],{text:n,element:"div",className:"vcard-name vcard-name-single",selectable:c,dirMismatch:e.rtl!==l10n.isRTL(),direction:e.dir,formatters:d}))),Y["default"].createElement("div",{className:"bubble-vcard-meta"},Y["default"].createElement(F["default"],{msg:e}))),r)}}]),t}(V.Component),n.CONCERNS={msg:["vcard","isQuoted","body","subtype","rtl","dir","isSentByMe","isGroupMsg","senderObj","chat"]
},r))},7399:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){e.stopPropagation()}Object.defineProperty(t,"__esModule",{value:!0});var i=a(5),l=n(i),s=a(2),u=n(s),c=a(4),d=n(c),f=a(7),p=n(f),h=a(6),m=n(h),g=a(3),_=n(g),v=a(53),b=(n(v),a(7118)),y=n(b),E=a(487),S=a(262),C=n(S),M=a(7157),k=o(M),w=a(7199),N=n(w),T=a(7130),P=n(T),I=a(7129),R=n(I),A=a(12),x=n(A),O=a(7134),D=n(O),L=a(7179),U=n(L),F=a(7138),j=n(F),B=a(47),G=n(B),V=a(62),Y=o(V),W=a(1),H=n(W),q=a(73),z=n(q),K=a(172),Q=n(K),J=a(23),X=n(J),Z=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.showMediaMissing=function(){x["default"].openModal(_["default"].createElement(D["default"],{msg:o.props.msg}))},o.downloadMedia=function(){o.props.msg.forceDownloadMedia()},o.cancelDownload=function(){o.props.msg.cancelDownload()},o.cancelUpload=function(){o.props.msg.cancelUpload()},o.resumeUpload=function(){o.props.msg.resumeUpload()},o.resumeRemoteUpload=function(){G["default"].supportsFeature(G["default"].F.MEDIA_RETRY)?o.props.msg.resumeRemoteUpload():x["default"].openModal(_["default"].createElement(j["default"],{msg:o.props.msg}))},o.getZoomNode=function(e){var t=o.props.isMsgVisible;if(!t)return null;var a=t(e);return a?a.getImgNode&&a.getImgNode():null},o.downloadUnsupportedToDesktop=function(e){e&&e.stopPropagation(),x["default"].openModal(_["default"].createElement(U["default"],{msg:(0,E.unproxy)(o.props.msg)}))},o.launchMediaViewer=function(e){e&&e.stopPropagation(),x["default"].mediaViewerModal((0,E.unproxy)(o.props.msg),o.getZoomNode)},o.launchVideoFloater=function(e){e&&e.stopPropagation(),x["default"].videoPlayerFloater((0,E.unproxy)(o.props.msg),o.getZoomNode)},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=this.props.mediaData,a=null,o=null,n=this.launchVideoFloater;switch(t.mediaStage){case C["default"].STAGE.RESOLVED:case C["default"].STAGE.INIT:a=_["default"].createElement(k.Play,null),o=this.launchMediaViewer;break;case C["default"].STAGE.NEED_POKE:a=_["default"].createElement(k.Download,{filesize:t.size}),o=this.downloadMedia;break;case C["default"].STAGE.UPLOADING:a=_["default"].createElement(k.PendingCancel,null),o=this.cancelUpload;break;case C["default"].STAGE.NEED_UPLOAD:a=_["default"].createElement(k.Upload,{filesize:t.size}),o=this.resumeUpload;break;case C["default"].STAGE.REMOTE_NEED_UPLOAD:a=_["default"].createElement(k.Upload,{filesize:t.size}),o=this.resumeRemoteUpload;break;case C["default"].STAGE.ERROR_MISSING:o=this.showMediaMissing,n=this.showMediaMissing;break;case C["default"].STAGE.ERROR_UNSUPPORTED:e.isUnsentMedia||(a=_["default"].createElement(k.Download,{filesize:t.size}),o=this.downloadUnsupportedToDesktop,n=this.downloadUnsupportedToDesktop);break;default:a=_["default"].createElement(k.Pending,null)}var i=Y.durationStr(t.duration),l=i?_["default"].createElement("span",{className:"message-duration"},_["default"].createElement("div",{className:"video-type-icon"},_["default"].createElement(Q["default"],{name:"msg-video-light"})),i):null,s=t.preview?z["default"].thumbAsBackgroundImage(t.preview.url()):void 0,u=_["default"].createElement("div",{className:"image-thumb-body",style:s});t.preview||void 0===t.preview||H["default"].assert(!1,"media-preview-invalid","Invalid preview: "+t.preview)();var c=this.props.displayAuthor&&!e.isSentByMe&&e.isGroupMsg,d=c?_["default"].createElement("div",{className:"bubble-video-author"},_["default"].createElement(R["default"],{msg:e,contact:e.senderObj})):null,f=_["default"].createElement("div",{className:"shade"}),p=e.caption?_["default"].createElement(N["default"],{msg:e,contact:e.senderObj,trusted:this.props.trusted}):null,h=(0,X["default"])("bubble-image bubble-video",{"bubble-image-caption":p,"bubble-has-author":c}),m=null;return G["default"].supportsFeature(G["default"].F.PIP)&&(m=_["default"].createElement("button",{className:"launch-video-floater",onClick:n},_["default"].createElement(Q["default"],{name:"picture-in-picture"}))),_["default"].createElement("div",{onClick:r},_["default"].createElement("div",{className:h},d,this.props.quotedMsg,_["default"].createElement("div",{className:"image-thumb",onClick:o},m,a,u,f,l),p,_["default"].createElement("div",{className:"bubble-video-meta"},_["default"].createElement(P["default"],{msg:this.props.msg}))))}}]),t}(_["default"].PureComponent);Z.CONCERNS={msg:["id","ack","caption","broadcast","star","isSentByMe","isGroupMsg","gifAttribution","senderObj","isUnsentMedia"],mediaData:["aspectRatio","preview","duration","type","mediaStage","renderableUrl","fullWidth","fullHeight","size"]},t["default"]=(0,y["default"])(Z)},7400:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateTypePriority=t.UpdateTypes=void 0;var n,r=a(5),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7),f=o(d),p=a(6),h=o(p),m=a(48),g=o(m),_=a(3),v=o(_),b=a(10),y=o(b),E=a(8),S=o(E),C=a(23),M=o(C),k=a(7374),w=o(k),N=a(7505),T=o(N),P=a(71),I=o(P),R=a(1),A=o(R),x=a(53),O=o(x),D=a(7128),L=(o(D),a(46)),U=o(L),F=a(7396),j=o(F),B=a(7176),G=o(B),V=a(174),Y=a(7583),W=o(Y),H=t.UpdateTypes={KEEP_SCROLL_BOTTOM:"KEEP_SCROLL_BOTTOM",KEEP_SCROLL_TOP:"KEEP_SCROLL_TOP",SCROLL_BOTTOM:"SCROLL_BOTTOM",NONE:"NONE",DEFAULT:"DEFAULT"},q=(t.UpdateTypePriority=(n={},(0,g["default"])(n,H.KEEP_SCROLL_BOTTOM,2),(0,g["default"])(n,H.KEEP_SCROLL_TOP,2),(0,g["default"])(n,H.SCROLL_BOTTOM,2),(0,g["default"])(n,H.NONE,1),(0,g["default"])(n,H.DEFAULT,0),n),function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.renderedMsgs={},o.renderedDateMarkers={},o.onMsgKeyChange=function(e){var t=e.newKey,a=e.oldKey,n=t.toString(),r=a.toString();if(o.renderedMsgs[r]){var i=o.renderedMsgs[r];o.renderedMsgs[n]=i,delete o.renderedMsgs[r]}},o.onMsgRendered=function(e,t){e?o.renderedMsgs[t]=e:delete o.renderedMsgs[t]},o.rowRenderers={msg:function(e){function t(t,a,o,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t,a,n){var r=o.props,i=void 0;i=n&&!a?B.MsgPosition.FRONT:n&&a?B.MsgPosition.MID:!n&&a?B.MsgPosition.END:B.MsgPosition.SINGLE;var l=e.type===O["default"].TYPE.IMAGE||e.type===O["default"].TYPE.VIDEO||e.type===O["default"].TYPE.AUDIO;return v["default"].createElement(G["default"],{key:"msg-"+e.id,ref:(0,V.refWrapper)(o.onMsgRendered,e.id.toString()),msg:e,displayType:S["default"].DISP_TYPE.CONVERSATION,isMsgVisible:l?r.isMsgVisible:y["default"].noop,selectable:r.selectable,selectedMessages:r.selectedMessages,onMessageSelect:r.onMessageSelect,position:i,isFocusedMsg:t})}),date:function(e,t){return v["default"].createElement(w["default"],{ref:o.onDateMarkerRendered.bind(o,t),key:"msg-"+e.id+"-date",timestamp:e.t})},unread:function(){return v["default"].createElement(j["default"],{key:"msg-unread",count:o.props.unreadCount})}},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"shouldComponentUpdate",value:function(e){return e.updateType!==H.NONE}},{key:"componentWillUpdate",value:function(e){var t=U["default"].findDOMNode(this).parentNode,a=e.updateType;a===H.KEEP_SCROLL_BOTTOM?this.shouldRestoreScroll=t.scrollHeight-t.scrollTop-t.clientHeight:a===H.KEEP_SCROLL_TOP&&(this.shouldRestoreScroll=t.scrollTop)}},{key:"componentDidMount",value:function(){this.maybeNotifyChatRendered(),this.props.listeners.add(Store.Msg,"change:msgKey",this.onMsgKeyChange)}},{key:"componentDidUpdate",value:function(e){var t=U["default"].findDOMNode(this).parentNode;this.props.updateType===H.SCROLL_BOTTOM?t.scrollTop=t.scrollHeight:void 0!==this.shouldRestoreScroll&&(this.props.updateType===H.KEEP_SCROLL_BOTTOM?t.scrollTop=t.scrollHeight-this.shouldRestoreScroll-t.clientHeight:t.scrollTop=this.shouldRestoreScroll,this.shouldRestoreScroll=void 0),this.maybeNotifyChatRendered()}},{key:"maybeNotifyChatRendered",value:function(){this.props.notifyChatRendered&&(this.props.focusedMsgCtx&&this.props.focusedMsgCtx.msg&&!y["default"].includes(this.props.msgs,this.props.focusedMsgCtx.msg)||this.props.notifyChatRendered())}},{key:"getMsgVisibility",value:function(e){var t=U["default"].findDOMNode(this).parentNode,a=t.scrollTop,o=a+t.clientHeight,n=U["default"].findDOMNode(e);return n?n.offsetTop+n.clientHeight<=a?{visibility:S["default"].VISIBILITY.ABOVE,offset:n.offsetTop-a}:n.offsetTop>=o?{visibility:S["default"].VISIBILITY.BELOW,offset:n.offsetTop-a}:{visibility:S["default"].VISIBILITY.VISIBLE,offset:n.offsetTop-a}:(A["default"].error("getMsgVisibility on invalid ref: "+e)(),{visibility:S["default"].VISIBILITY.VISIBLE,offset:0})}},{key:"getMsgWrapperRef",value:function(e){return this.renderedMsgs[e]}},{key:"getMsgComponentRef",value:function(e){return this.renderedMsgs[e]&&this.renderedMsgs[e].refMsgComponent&&this.renderedMsgs[e].refMsgComponent.ref}},{key:"getDateMarkerRef",value:function(e){return this.renderedDateMarkers[e]}},{key:"onDateMarkerRendered",value:function(e,t){t?this.renderedDateMarkers[e]=t:delete this.renderedDateMarkers[e]}},{key:"render",value:function(){var e=this.props,t=e.msgs,a=e.focusedMsgCtx,o=e.unreadCount,n=void 0,r=void 0;a&&(n=a.msg,a.isUnreadDivider&&o>0&&(r=a.msg));var i=(0,M["default"])(W["default"].messageList,(0,g["default"])({},W["default"].messageListSelectable,this.props.selectable));return v["default"].createElement("div",{className:i},(0,T["default"])(this.rowRenderers,t,n,r,o))}}]),t}(v["default"].Component));t["default"]=(0,I["default"])(q)},7401:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=n(r),l=a(0),s=n(l),u=a(5),c=n(u),d=a(2),f=n(d),p=a(4),h=n(p),m=a(7),g=n(m),_=a(6),v=n(_),b=a(3),y=n(b),E=a(1),S=n(E),C=a(12),M=n(C),k=a(484),w=(n(k),a(14)),N=n(w),T=a(7152),P=n(T),I=a(7169),R=o(I),A=a(7507),x=n(A),O=a(54),D=n(O),L=a(35),U=n(L),F=a(76),j=n(F),B=a(23),G=n(B),V=a(127),Y=n(V),W=a(71),H=n(W),q=a(485),z=n(q),K=a(172),Q=n(K),J=a(7584),X=n(J),Z=a(10),$=n(Z),ee=a(272),te=a(261),ae=n(te),oe=a(126),ne=n(oe),re=function(e){function t(e){(0,f["default"])(this,t);var a=(0,g["default"])(this,(t.__proto__||(0,c["default"])(t)).call(this,e));return a.cancelRecording=function(){"ready"!==a.state.state&&(a.recorder&&a.recorder.stop(),a.clearInterval(),a.props.chat.markPaused(),a.setState({state:"ready",active:void 0,elapsed:0}),a.props.onRecState(!1))},a._incElapsed=function(){a.setState({elapsed:a.state.elapsed+1})},a.onPTTReady=function(){a.cancelPTTTimer(),"delay"===a.state.state&&a.setState({state:"recording"})},a.onMouseOverSend=function(){a.setState({active:"send"})},a.onMouseOutSend=function(){a.setState({active:void 0})},a.onMouseOverCancel=function(){a.setState({active:"cancel"})},a.onMouseOutCancel=function(){a.setState({active:void 0})},a.onMouseUpCancel=function(){a.state.elapsed<1||(a.cancelPTTTimer(),a.cancelRecording())},a.onMouseUpSend=function(){if(!(a.state.elapsed<1)){if(a.cancelPTTTimer(),"recording"!==a.state.state)return void a.cancelRecording();var e=a.props.chat;a.setState({state:"processing"}),a.props.onRecState(!1);var t=e.regCancellablePromise(U["default"].waitForEvent(a.recorder,"dataAvailable").then(function(e){return j["default"].createFromData(e.detail,e.detail.type)}));(0,ee.prepRawMedia)(t,{isPtt:!0,precomputedDuration:~~a.recorder.duration}).sendToChat(e,{quotedMsg:e.composeQuotedMsg||void 0,addEvenWhilePreparing:!0}),e.composeQuotedMsg=null,t["catch"](s["default"].CancellationError,$["default"].noop)["finally"](function(){a.cancelRecording()}),a.recorder.stop()}},a.onMouseDown=function(){if("ready"===a.state.state){var e=R.start("microphone");s["default"].race([e,a.props.rejectOnUnmount()]).checkpoint(a.props.rejectOnUnmount()).then(function(e){a.recorder=new x["default"]({bitRate:16e3,encoderSampleRate:16e3,encoderApplication:2048}),a.recorder.initStream(e),a.recorder.start(),a.props.chat.presence.update()["catch"](N["default"].WapDrop,$["default"].noop),a.props.chat.markRecording(),a.setState({state:"delay"}),a.props.onRecState(!0),a.pttTimer=a.props.setTimeout(a.onPTTReady,1500),a.startInterval()})["catch"](N["default"].Unmount,function(){e.then(function(e){return R.stop(e)})["catch"]($["default"].noop)})["catch"](N["default"].GUM.PermissionDeniedError,function(){M["default"].openModal(y["default"].createElement(P["default"],{title:"guide_desktop_mic_title",desc:"guide_desktop_mic_fail_description",type:P["default"].TYPE.GUIDE_UNBLOCK}))})["catch"](N["default"].GUM.GUMError,function(){M["default"].openModal(y["default"].createElement(P["default"],{title:"guide_desktop_mic_missing_title",desc:"guide_desktop_mic_missing_description",type:P["default"].TYPE.GUIDE_NONE}))})["catch"](function(e){a.recorder&&a.recorder.stop(),S["default"].error("PTT Recording Error")(e)})}},a.state={state:"ready",active:null,elapsed:0},a}return(0,v["default"])(t,e),(0,h["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(window,"blur",this.cancelRecording)}},{key:"componentWillUnmount",value:function(){}},{key:"startInterval",value:function(){this.clearInterval(),this.elapsedInterval=this.props.setInterval(this._incElapsed,1e3)}},{key:"clearInterval",value:function(){this.elapsedInterval&&(this.props.clearInterval(this.elapsedInterval),this.elapsedInterval=null),this.setState({elapsed:0})}},{key:"cancelPTTTimer",value:function(){this.pttTimer&&(this.props.clearTimeout(this.pttTimer),this.pttTimer=null)}},{key:"render",value:function(){var e=this.state.state,t=(0,G["default"])(X["default"].btnBorder,(0,i["default"])({},X["default"].isHover,"cancel"===this.state.active)),a=(0,G["default"])(X["default"].btnBorder,(0,i["default"])({},X["default"].isHover,"send"===this.state.active)),o="delay"===e||"recording"===e?y["default"].createElement(ae["default"],{displayName:"PTT",popable:!0,escapable:!0,requestDismiss:this.cancelRecording},y["default"].createElement("div",{className:X["default"].recording,key:"recording"},y["default"].createElement("button",{className:t,onMouseOver:this.onMouseOverCancel,onMouseOut:this.onMouseOutCancel,onMouseUp:this.onMouseUpCancel,"data-animate-btn-border":!0},y["default"].createElement("div",{className:(0,G["default"])(X["default"].btnBorderIcon,X["default"].btnStateDefault)},y["default"].createElement(Q["default"],{name:"round-x"})),y["default"].createElement("div",{className:(0,G["default"])(X["default"].btnBorderIcon,X["default"].btnStateHover)},y["default"].createElement(Q["default"],{name:"round-x-inv"}))),y["default"].createElement("div",{className:X["default"].pttCounter,"data-animate-ptt-counter":!0},D["default"].unix(this.state.elapsed).format("m:ss")),y["default"].createElement("button",{className:a,onMouseOver:this.onMouseOverSend,onMouseOut:this.onMouseOutSend,onMouseUp:this.onMouseUpSend,"data-animate-btn-border":!0},y["default"].createElement("div",{className:(0,G["default"])(X["default"].btnBorderIcon,X["default"].btnStateDefault)},y["default"].createElement(Q["default"],{name:"round-send"})),y["default"].createElement("div",{className:(0,G["default"])(X["default"].btnBorderIcon,X["default"].btnStateHover)},y["default"].createElement(Q["default"],{name:"round-send-inv"}))))):null,n="ready"===e||"processing"===e?y["default"].createElement("button",{className:X["default"].btnPtt,onMouseDown:this.onMouseDown,disabled:"processing"===e,key:"button"},y["default"].createElement(Q["default"],{name:"ptt"})):null,r=(0,G["default"])(X["default"].container,(0,i["default"])({},X["default"].active,!!o));return y["default"].createElement("div",{className:r},y["default"].createElement(ne["default"],{transitionName:"ptt"},o||n))}}]),t}(y["default"].PureComponent);t["default"]=(0,z["default"])((0,Y["default"])((0,H["default"])(re)))},7402:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(484),b=(o(v),a(94)),y=o(b),E=a(12),S=o(E),C=a(71),M=o(C),k=a(7118),w=o(k),N=a(487),T=a(72),P=o(T),I=a(7255),R=o(I),A=a(47),x=o(A),O=a(492),D=o(O),L=a(7585),U=o(L),F=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.confirmReportGroupSpam=function(){S["default"].openModal(m["default"].createElement(y["default"],{onOK:o.reportSpam,okText:l10n.t("report_group_spam"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},l10n.t("report_group_spam_ack")))},o.confirmReportSpam=function(){S["default"].openModal(m["default"].createElement(y["default"],{onOK:o.reportSpam,okText:l10n.t("report_spam"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},l10n.t("report_spam_ack")))},o.reportSpam=function(){var e=(0,N.unproxy)(o.props.chat);e.reportSpam(),S["default"].closeModal()},o.notSpam=function(){o.props.chat.sendNotSpam(!0)["catch"](_["default"].noop)},o.confirmBlock=function(){S["default"].openModal(m["default"].createElement(y["default"],{onOK:o.block,okText:l10n.t("block"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},l10n.t("block_ack")))},o.block=function(){o.props.contact.setBlock(!0)["catch"](_["default"].noop),S["default"].closeModal()},o.confirmUnblock=function(){S["default"].openModal(m["default"].createElement(y["default"],{okText:l10n.t("unblock_button"),onOK:o.unblock,cancelText:l10n.t("web_cancel"),onCancel:S["default"].closeModal.bind(S["default"])},l10n.t("unblock_confirmation",{contact:o.props.contact.formattedName})))},o.unblock=function(){o.props.contact.setBlock(!1)["catch"](_["default"].noop),S["default"].closeModal()},o.dismissVCardPanel=function(){(0,N.unproxy)(o.props.chat).dismissVCard(),o.forceUpdate()},o.getNotSpamButton=function(){return m["default"].createElement("div",{key:"not_spam",className:U["default"].button},m["default"].createElement(D["default"],{onClick:o.notSpam,type:"plain-white"},l10n.t("not_spam")))},o.onViewContact=function(){S["default"].openDrawerRight(m["default"].createElement(R["default"],{chat:o.props.chat}),"slide-left",o.context.uim)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){if(this.props.listeners.add(Store.Blocklist,"add remove reset"),x["default"].supportsFeature(x["default"].F.INDEX_RECEIVED_VCARD)){var e=this.props.chat.getReceivedVCardMsgs();e&&this.props.listeners.add(e,"add remove reset")}}},{key:"render",value:function(){var e=this.props,t=e.chat,a=e.contact;if(t.isPSA||!t.isVisible||t.trusted)return null;var o=Store.Blocklist.get(t.id),n=t.getReceivedVCardMsgs(),r=!o&&n&&n.length&&!t.vcardDismissed,i=void 0,l=[];return t.isGroup?(i=l10n.t("group_admin_not_a_contact"),l.push(m["default"].createElement("div",{key:"report_spam",className:U["default"].button},m["default"].createElement(D["default"],{type:"plain-white",onClick:this.confirmReportGroupSpam},l10n.t("report_spam")))),l.push(this.getNotSpamButton())):r?(i=l10n.t("found_contact_card_text",{_plural:n.length}),l.push(m["default"].createElement("div",{key:"view_contact",className:U["default"].button},m["default"].createElement(D["default"],{onClick:this.onViewContact,type:"plain-white"},l10n.t("view_contact_card",{_plural:n.length})))),l.push(m["default"].createElement("div",{key:"no_thanks",className:U["default"].button},m["default"].createElement(D["default"],{onClick:this.dismissVCardPanel,type:"plain-white"},l10n.t("no_thanks"))))):(i=a.isVerified?l10n.t("business_not_a_contact"):l10n.t("sender_not_a_contact"),l.push(m["default"].createElement("div",{key:"report_spam",className:U["default"].button},m["default"].createElement(D["default"],{type:"plain-white",onClick:this.confirmReportSpam},l10n.t("report_spam")))),o?l.push(m["default"].createElement("div",{key:"unblock",className:U["default"].button},m["default"].createElement(D["default"],{onClick:this.confirmUnblock,type:"plain-white"},l10n.t("unblock_button")))):l.push(m["default"].createElement("div",{key:"block",className:U["default"].button},m["default"].createElement(D["default"],{onClick:this.confirmBlock,type:"plain-white"},l10n.t("block")))),l.push(this.getNotSpamButton())),m["default"].createElement("div",{className:U["default"].spam},m["default"].createElement("div",{className:U["default"].text},i),m["default"].createElement("div",{className:U["default"].controls},l))}}]),t}(m["default"].PureComponent);F.CONCERNS={chat:["id","isPSA","isVisible","trusted","isGroup","vcardDismissed"],contact:["isVerified"]},F.contextTypes={uim:m["default"].PropTypes.instanceOf(P["default"])},t["default"]=(0,M["default"])((0,w["default"])(F))},7403:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Dir=t.Transition=void 0;var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(23),E=o(y),S=a(177),C=o(S),M=a(71),k=o(M),w=a(3),N=o(w),T=a(126),P=o(T),I=a(46),R=o(I),A=a(507),x=o(A),O=a(261),D=o(O),L=a(72),U=o(L),F=t.Transition={LEFT:"drawer-left",MID:"slide-up",NONE:"none",RIGHT:"slide-left"},j=t.Dir={LEFT:"left",MID:"mid",RIGHT:"right"},B=function(e){return F[e.toUpperCase()]};t["default"]=(0,k["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={drawer:void 0,drawerId:null,transition:B(o.props.direction),uim:void 0,option:void 0},o.blockTransition=null,o.flowDismissPending=!1,o.openFlow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:B(o.props.direction),a=arguments[2],n=arguments[3],r=_["default"].uniqueId("DrawerManager"+o.props.direction);if(!o.flowDismissPending&&o.state.drawer){if(e.key&&_["default"].isEqual(o.state.drawer.key,e.key))return;o.blockTransition=F.NONE,o.setState({drawer:e,drawerId:r,transition:t,uim:a,option:n},function(){o.blockTransition=t})}else o.props.onDrawerIn&&o.props.onDrawerIn(),o.setState({drawer:e,drawerId:r,transition:t,uim:a,option:n})},o.existsFlow=function(e){e(o.flowDismissPending===!0?!1:!!o.state.drawer)},o.closeFlow=function(e){e&&o.state.drawerId!==e||o.state.drawer&&(o.props.onDrawerOut&&o.props.onDrawerOut(),o.flowDismissPending=!0,o.setState({drawer:void 0},function(){o.flowDismissPending=!1}))},o.requestFocus=function(){var e=R["default"].findDOMNode(o.refs.UIE);e&&!e.contains(document.activeElement)&&C["default"].focus(e)},o.onAnimationComplete=function(){var e=o.props.onDrawerAnimationComplete;e&&e();var t=o.state,a=t.option,n=t.drawer;a&&(n&&_["default"].isFunction(a.onEnterAnimationComplete)&&a.onEnterAnimationComplete(),!n&&_["default"].isFunction(a.onLeaveAnimationComplete)&&a.onLeaveAnimationComplete())},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"getChildContext",value:function(){var e=this.state.uim||this.context.uim;return{uim:e}}},{key:"componentWillMount",value:function(){this.props.listeners.add(b["default"],"open_drawer_"+this.props.direction,this.openFlow),this.props.listeners.add(b["default"],"exists_drawer_"+this.props.direction,this.existsFlow),this.props.listeners.add(b["default"],"close_drawer_"+this.props.direction,this.closeFlow)}},{key:"componentWillReceiveProps",value:function(e){e.direction!==this.props.direction&&(this.props.listeners.remove(b["default"],"open_drawer_"+this.props.direction,this.openFlow),this.props.listeners.remove(b["default"],"exists_drawer_"+this.props.direction,this.existsFlow),this.props.listeners.remove(b["default"],"close_drawer_"+this.props.direction,this.closeFlow),e.listeners.add(b["default"],"open_drawer_"+e.direction,this.openFlow),e.listeners.add(b["default"],"exists_drawer_"+e.direction,this.existsFlow),e.listeners.add(b["default"],"close_drawer_"+e.direction,this.closeFlow))}},{key:"render",value:function(){var e=this.props.direction,t=this.state,a=t.drawer,o=t.drawerId,n=t.transition,r=t.option,i=this.blockTransition||n,l=r&&r.noFocus?null:this.requestFocus;a&&(a=N["default"].createElement(D["default"],{displayName:"Drawer"+_["default"].upperFirst(e),escapable:!0,key:o,ref:"UIE",requestFocus:l,requestDismiss:this.closeFlow.bind(null,o)},N["default"].createElement(x["default"],{style:{height:"100%"}},a)));var s=(0,E["default"])("pane",{"pane-one":e===j.LEFT,"pane-two":e===j.MID,"pane-three":e===j.RIGHT});return N["default"].createElement(P["default"],{transitionName:i,className:s,onAnimationComplete:this.onAnimationComplete},a)}}]),t}(w.PureComponent),n.contextTypes={uim:N["default"].PropTypes.instanceOf(U["default"])},n.childContextTypes={uim:N["default"].PropTypes.instanceOf(U["default"])},r))},7404:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){e&&(e.preventDefault(),e.stopPropagation())}Object.defineProperty(t,"__esModule",{value:!0}),t.EmojiSuggestionsPanelComponent=void 0;var r=a(5),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7),f=o(d),p=a(6),h=o(p),m=a(10),g=o(m),_=a(12),v=o(_),b=a(95),y=o(b),E=a(7119),S=o(E),C=a(276),M=o(C),k=a(173),w=o(k),N=a(71),T=o(N),P=a(7127),I=o(P),R=a(3),A=o(R),x=a(46),O=o(x),D=a(127),L=o(D),U=a(261),F=o(U),j=a(7239),B=o(j),G=a(72),V=o(G),Y=a(488),W=a(489),H=a(7178),q=a(174),z=function(e){function t(){var e,a,o,r;(0,s["default"])(this,t);for(var l=arguments.length,u=Array(l),c=0;l>c;c++)u[c]=arguments[c];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(u))),o.state={selectedIndex:0,skinTonePicker:null},o.emojiList=null,o.rowLength=0,o.windowResized=function(){var e=o.getEmojiRowLength();if(o.rowLength!==e){o.rowLength=e;var t=o.state.selectedIndex>=e?e-1:o.state.selectedIndex;o.setState({selectedIndex:t})}},o.onEmojiClick=function(e){if(n(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;if(t)if(y["default"].skinToneEmojis[t]){var a=o.getEmojiVariant(t);a?o.onEmoji(a):o.onContextMenu(e)}else o.onEmoji(t)}},o.onEmojiMouseDown=function(e){if(n(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;t&&y["default"].skinToneEmojis[t]&&o.startPickerTimer(e)}},o.onEmoji=function(e){o.props.onEmoji(e),o.releaseFocus()},o.releaseFocus=function(){o.props.onFocusRelease&&o.props.onFocusRelease()},o.getEmojiVariant=function(e){return y["default"].skinToneEmojis[e]?Store.EmojiVariant.getVariant(e):null},o.setEmojiVariant=function(e,t,a){return n(e),o.onEmoji(a),Store.EmojiVariant.setVariant(t,a),!1},o.onContextMenu=function(e){if(n(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;t&&y["default"].skinToneEmojis[t]&&o._onContextMenu(t,e.target)}},o._onContextMenu=function(e,t,a){o.clearPickerTimer();var n=y["default"].skinToneEmojis[e],r=H.SKIN_TONE_VARIATIONS.map(function(t){var a=y["default"].variantToUnicode(n,t);return A["default"].createElement(I["default"],{type:"emoji",key:a,a8n:"mi-emoji-variant",action:function(t){return o.setEmojiVariant(t,e,a)}},A["default"].createElement(S["default"],{text:a,formatters:Y.Configuration.LargeEmojiOnly(),tabIndex:"-1"}))});o.setState({skinTonePicker:{menu:r,anchor:t,type:"picker",dirX:W.DirX.RIGHT,dirY:W.DirY.TOP,horizontal:!0,autoFocus:a}})},o.closeSkinTonePicker=function(){o.setState({skinTonePicker:null})},o.clearPickerTimer=function(){o.pickerTimer&&(o.props.clearTimeout(o.pickerTimer),o.pickerTimer=null)},o.startPickerTimer=function(e){n(e),o.clearPickerTimer();var t=e.target;if(t instanceof HTMLElement){var a=t.dataset.unicode;o.pickerTimer=o.props.setTimeout(function(){o.props.listeners.addOnce(v["default"],"window_click",n),o._onContextMenu(a,t)},250),o.props.listeners.addOnce(window,"mouseup",o.clearPickerTimer,!0)}},o.getEmojiRowLength=function(){var e=o.emojiPanel&&o.emojiPanel.offsetWidth;return e?Math.floor(e/H.EMOJI_WIDTH):8},o.onEmojiArrowLeft=function(e){o.onEmojiArrow(e,"left")},o.onEmojiArrowRight=function(e){o.onEmojiArrow(e,"right")},o.onEmojiArrow=function(e,t){if(n(e),e.target instanceof HTMLElement){var a=e.target.dataset.emojiIndex;if(a){a=Number(a);var r=o.props.emojiList,i=a;switch(t){case"left":a>0&&(i=a-1);break;case"right":if(a+1>=r.length)return;i=a+1}o.setState({selectedIndex:i})}}},o.renderEmojiList=function(e){var t=o.getEmojiRowLength();e&&e.length>t&&(e=e.slice(0,t));var a=g["default"].map(e,function(e,t){var a=y["default"].codeToEmoji[e],n=o.getEmojiVariant(a),r=o.state.selectedIndex===t&&!o.state.skinTonePicker;return A["default"].createElement(M["default"],{element:"span",emoji:n||a,size:"large",key:a,"data-unicode":a,"data-variant":n,tabIndex:"-1","data-emoji-index":t,selected:r})});return A["default"].createElement(w["default"],{ref:(0,q.GetRef)("emojis",o),onMouseDown:o.onEmojiMouseDown,onClick:o.onEmojiClick,onContextMenu:o.onContextMenu},a)},o.onEmojiEnter=function(e){if(n(e),e.target instanceof HTMLElement){var t=e.target.dataset.emojiIndex;if(t&&o.props.emojiList){var a=o.props.emojiList[Number(t)],r=y["default"].codeToEmoji[a];o.keyboardSelectEmoji(e,r)}}},o.keyboardSelectEmoji=function(e,t){if(y["default"].skinToneEmojis[t]){var a=o.getEmojiVariant(t);if(a)o.onEmoji(a);else{if(n(e),!(e.target instanceof HTMLElement))return;o._onContextMenu(t,e.target,!0)}}else o.onEmoji(t)},r=a,(0,f["default"])(o,r)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillReceiveProps",value:function(e){var t=Math.min(this.state.selectedIndex,e.emojiList.length-1);this.setState({selectedIndex:t}),this.state.skinTonePicker&&this.closeSkinTonePicker()}},{key:"componentDidMount",value:function(){var e=this;this.props.listeners.add(Store.EmojiVariant,"add remove change:variant",function(){return e.forceUpdate()});var t=this.props.debounce(this.windowResized,100);this.props.listeners.add(window,"resize",t),this.windowResized()}},{key:"getEmojiAtIndex",value:function(e){return e>=0&&e<this.props.emojiList.length?y["default"].codeToEmoji[this.props.emojiList[e]]:null}},{key:"getEmojiElement",value:function(e){if(!(0>e)&&this.emojis){var t=O["default"].findDOMNode(this.emojis).children;if(!(e>=t.length))return t[e]}}},{key:"render",value:function(){var e=void 0;return this.state.skinTonePicker&&(e=A["default"].createElement(F["default"],{displayName:"SkinTonePicker",popable:!0,escapable:!0,requestDismiss:this.closeSkinTonePicker},A["default"].createElement(B["default"],{tooltip:this.state.skinTonePicker}))),A["default"].createElement("div",{ref:(0,q.GetRef)("emojiPanel",this)},this.renderEmojiList(this.props.emojiList),e)}},{key:"moveSelectionLeft",value:function(){this.setState({selectedIndex:Math.max(this.state.selectedIndex-1,0)})}},{key:"moveSelectionRight",value:function(){this.setState({selectedIndex:Math.min(this.state.selectedIndex+1,this.getEmojiRowLength()-1,this.props.emojiList.length-1)})}},{key:"pickSelectedEmoji",value:function(){var e=this.getEmojiAtIndex(this.state.selectedIndex);if(!e)return null;if(y["default"].skinToneEmojis[e]){var t=this.getEmojiVariant(e);if(t)this.onEmoji(t);else{var a=this.getEmojiElement(this.state.selectedIndex);a&&this._onContextMenu(e,a,!0)}}else this.onEmoji(e);
}}]),t}(A["default"].Component);z.contextTypes={uim:A["default"].PropTypes.instanceOf(V["default"])};t.EmojiSuggestionsPanelComponent=z;t["default"]=(0,T["default"])((0,L["default"])(z))},7405:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.EmojiTabComponent=void 0;var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(10),b=o(v),y=a(95),E=o(y),S=a(276),C=o(S),M=a(7119),k=o(M),w=a(177),N=a(173),T=o(N),P=a(7239),I=o(P),R=a(7127),A=o(R),x=a(489),O=a(12),D=o(O),L=a(174),U=a(488),F=a(72),j=o(F),B=a(261),G=o(B),V=a(7178),Y=a(71),W=o(Y),H=a(127),q=o(H),z=a(7587),K=o(z),Q=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={skinTonePicker:null},o.emojiList=null,o.lastFocusedElement=null,o.rowLength=0,o.onEmojiClick=function(e){if(o.stopEvent(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;if(t)if(E["default"].skinToneEmojis[t]){var a=o.getEmojiVariant(t);o.props.tab===V.Tab.RECENT?o.onEmoji(a||t):a?o.onEmoji(a):o.onContextMenu(e)}else o.onEmoji(t)}},o.onEmojiMouseDown=function(e){if(o.stopEvent(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;t&&E["default"].skinToneEmojis[t]&&o.startPickerTimer(e)}},o.onEmoji=function(e){o.props.onEmoji(e),o.releaseFocus()},o.releaseFocus=function(){o.props.onFocusRelease&&o.props.onFocusRelease()},o.getEmojiVariant=function(e){return E["default"].skinToneEmojis[e]?Store.EmojiVariant.getVariant(e):null},o.setEmojiVariant=function(e,t,a){return o.stopEvent(e),o.onEmoji(a),Store.EmojiVariant.setVariant(t,a),!1},o.stopEvent=function(e){e&&(e.preventDefault(),e.stopPropagation())},o.onContextMenu=function(e){if(o.stopEvent(e),e.target instanceof HTMLElement){var t=e.target.dataset.unicode;t&&E["default"].skinToneEmojis[t]&&o._onContextMenu(t,e.target)}},o._onContextMenu=function(e,t,a){a||(o.lastFocusedElement=null),o.clearPickerTimer();var n=E["default"].skinToneEmojis[e],r=V.SKIN_TONE_VARIATIONS.map(function(t){var a=E["default"].variantToUnicode(n,t);return m["default"].createElement(A["default"],{type:"emoji",key:a,a8n:"mi-emoji-variant",action:function(t){return o.setEmojiVariant(t,e,a)}},m["default"].createElement(k["default"],{text:a,formatters:U.Configuration.LargeEmojiOnly(),tabIndex:"-1"}))});o.setState({skinTonePicker:{menu:r,anchor:t,type:"picker",dirX:x.DirX.RIGHT,dirY:x.DirY.TOP,horizontal:!0,autoFocus:a}})},o.closeSkinTonePicker=function(){o.setState({skinTonePicker:null})},o.clearPickerTimer=function(){o.pickerTimer&&(o.props.clearTimeout(o.pickerTimer),o.pickerTimer=null)},o.startPickerTimer=function(e){o.stopEvent(e),o.clearPickerTimer();var t=e.target;if(t instanceof HTMLElement){var a=t.dataset.unicode;o.pickerTimer=o.props.setTimeout(function(){o.props.listeners.addOnce(D["default"],"window_click",o.stopEvent),o._onContextMenu(a,t)},250),o.props.listeners.addOnce(window,"mouseup",o.clearPickerTimer,!0)}},o.getEmojiRowLength=function(){var e=o.emojiPanel&&o.emojiPanel.offsetWidth;return e?Math.floor(e/V.EMOJI_WIDTH):8},o.focusPrevSection=function(e){o.props.focusPrevSection&&(o.props.focusPrevSection(o.props.tab,e),o.lastFocusedElement=null)},o.focusNextSection=function(e){o.props.focusNextSection&&(o.props.focusNextSection(o.props.tab,e),o.lastFocusedElement=null)},o.onEmojiArrowUp=function(e){o.onEmojiArrow(e,"up")},o.onEmojiArrowDown=function(e){o.onEmojiArrow(e,"down")},o.onEmojiArrowLeft=function(e){o.onEmojiArrow(e,"left")},o.onEmojiArrowRight=function(e){o.onEmojiArrow(e,"right")},o.onEmojiArrow=function(e,t){if(o.stopEvent(e),e.target instanceof HTMLElement){var a=e.target.dataset.emojiIndex;if(a){a=Number(a);var n=o.props.emojiList,r=o.getEmojiRowLength(),i=a;switch(t){case"up":if(r>a)return void o.focusPrevSection(a%r);i=a-r;break;case"down":if(Math.floor(a/r)>=Math.floor((n.length-1)/r))return void o.focusNextSection(a%r);i=Math.min(a+r,n.length-1);break;case"left":if(!(a>0))return void o.focusPrevSection(r-1);i=a-1;break;case"right":if(a+1>=n.length)return void o.focusNextSection(0);i=a+1}o.focusEmoji(i,e)}}},o.getEmoji=function(e){var t=b["default"].map(e,function(e,t){var a=E["default"].codeToEmoji[e],n=o.getEmojiVariant(a);return m["default"].createElement(C["default"],{element:"span",emoji:n||a,size:"large",key:a,"data-unicode":a,"data-variant":n,tabIndex:"-1","data-emoji-index":t})}),a={up:o.onEmojiArrowUp,down:o.onEmojiArrowDown,left:o.onEmojiArrowLeft,right:o.onEmojiArrowRight,enter:o.onEmojiEnter};return m["default"].createElement(T["default"],{ref:(0,L.GetRef)("emojis",o),onMouseDown:o.onEmojiMouseDown,onClick:o.onEmojiClick,onContextMenu:o.onContextMenu,handlers:a},t)},o.onEmojiEnter=function(e){if(o.stopEvent(e),e.target instanceof HTMLElement){var t=e.target.dataset.emojiIndex;if(t){var a=o.props.emojiList,n=a[t],r=E["default"].codeToEmoji[n];o.keyboardSelectEmoji(e,r)}}},o.keyboardSelectRow=function(e,t){var a=o.getEmojiRowLength(),n=o.props.emojiList,r=n.length,i=0;i=t*a>=r?r-r%a:a*t;var l=n[i];if(l){o.stopEvent(e);var s=E["default"].codeToEmoji[l];o.keyboardSelectEmoji(e,s)}},o.keyboardSelectEmoji=function(e,t){if(E["default"].skinToneEmojis[t]){var a=o.getEmojiVariant(t);if(o.props.tab===V.Tab.RECENT)o.onEmoji(a||t);else if(a)o.onEmoji(a);else{if(o.stopEvent(e),!(e.target instanceof HTMLElement))return;o._onContextMenu(t,e.target,!0)}}else o.onEmoji(t)},o.focusElement=function(e,t){(0,w.focus)(e,t),o.lastFocusedElement=e},o.focusEmoji=function(e,t){if(!(0>e)&&o.emojis){var a=_["default"].findDOMNode(o.emojis).children;if(!(e>=a.length)){var n=a[e];o.focusElement(n,t),o.props.scrollEmojiIntoViewIfNeeded&&o.props.scrollEmojiIntoViewIfNeeded(n)}}},o.focusRow=function(e,t){var a=o.getEmojiRowLength();e*a>=o.props.emojiList.length?o.focusLastRow(0):o.focusEmoji(a*e,t)},o.focusFirstRow=function(e){var t=o.getEmojiRowLength();o.focusEmoji(Math.min(t-1,e))},o.focusLastRow=function(e){var t=o.getEmojiRowLength(),a=o.props.emojiList.length,n=a-a%t+e;n=Math.min(n,a-1),o.focusEmoji(n)},o.restoreFocus=function(){o.lastFocusedElement&&o.focusElement(o.lastFocusedElement)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.skinTonePicker!==t.skinTonePicker}},{key:"componentWillReceiveProps",value:function(e){this.state.skinTonePicker&&this.closeSkinTonePicker()}},{key:"componentDidMount",value:function(){var e=this;this.props.listeners.add(Store.EmojiVariant,"add remove change:variant",function(){return e.forceUpdate()})}},{key:"render",value:function(){var e=void 0;this.state.skinTonePicker&&(e=m["default"].createElement(G["default"],{displayName:"SkinTonePicker",popable:!0,escapable:!0,requestDismiss:this.closeSkinTonePicker},m["default"].createElement(I["default"],{tooltip:this.state.skinTonePicker})));var t=this.props.emojiList,a=void 0;return this.props.tab!==V.Tab.SEARCH_RESULT&&(a=m["default"].createElement("div",{className:K["default"].title},this.props.tab.title())),m["default"].createElement("div",{ref:(0,L.GetRef)("emojiPanel",this)},a,this.getEmoji(t),e)}}]),t}(m["default"].Component);Q.contextTypes={uim:m["default"].PropTypes.instanceOf(j["default"])};t.EmojiTabComponent=Q;t["default"]=(0,W["default"])((0,q["default"])(Q))},7406:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){switch((0,K.gifProvider)()){case"giphy":return r(e);case"tenor":return l(e);default:throw new Error("Unrecognized provider "+(0,K.gifProvider)())}}function r(e){var t=!e,a=void 0;if(t)a=z["default"].request("https://api.giphy.com/v1/gifs/trending","GET",{api_key:te,limit:100,rating:"pg-13"},"json");else{var o=l10n.getLocale(),n=void 0;P["default"].indexOf(K.GIPHY_LOCALES,o)>=0&&(n=o),a=z["default"].request("https://api.giphy.com/v1/gifs/search","GET",{q:e,api_key:te,limit:100,rating:"pg-13",lang:n},"json")}return a["catch"](function(){return null}).then(function(e){return e&&e.status<300&&i(e.response,t)})}function i(e,t){if(!e||!P["default"].isArray(e.data))return[];for(var a=e.data,o=[],n=0;n<a.length;n++){var r=a[n];if(r&&r.images){var i=r.images,l=i.downsized_small,s=i.preview_mp4,u=i.preview_webp,c=i.preview_gif;if(l){var d=l.mp4,f=parseInt(l.width,10),p=parseInt(l.height,10);d&&f&&p&&o.push(new K.GifInfo(o.length,d,s&&s.mp4||void 0,u&&u.url||c&&c.url||void 0,Math.round(f*K.TARGET_GIF_HEIGHT/p),K.GIPHY,t))}}}return o}function l(e){var t=!e,a=l10n.lng().replace("-","_"),o=void 0;return o=t?z["default"].request("https://api.tenor.co/v1/trending","GET",{key:ae,limit:50,safesearch:"moderate",locale:a},"json"):z["default"].request("https://api.tenor.co/v1/search","GET",{tag:e,key:ae,limit:50,safesearch:"moderate",locale:a},"json"),o["catch"](function(){return null}).then(function(e){return e&&e.status<300&&s(e.response)})}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;if(!e||!P["default"].isArray(e.results))return[];for(var a=e.results,o=[],n=0;n<a.length;n++){var r=a[n];if(r&&r.media&&r.media[0]){var i=r.media[0],l=i.tinymp4,s=i.previewmp4,u=i.previewgif;if(l){var c=(0,d["default"])(l.dims,2),f=c[0],p=c[1];o.push(new K.GifInfo(o.length,l.url,s&&s.url||void 0,u&&u.url||void 0,Math.round(f*K.TARGET_GIF_HEIGHT/p),K.TENOR,t))}}}return o}function u(e,t){for(var a=[],o=.9*t,n=e,r=null,i=.05;1>i&&n.length;i+=.05){n.sort(function(e,t){var a=e.rank-t.rank;return Math.abs(a)>8?a:t.width-e.width});for(var l=(1+i)*t,s=[],u=[],c=0;c<n.length;c++){for(var d=n[c],f=!1,p=Math.min(l-d.width,o),h=0;!f&&h<s.length;h++)s[h]<p&&(s[h]+=d.width+K.GAP_SIZE,u[h].push(d),f=!0);f||(s.push(d.width),u.push([d]))}if(1===u.length){n=[];var m=t-s[0]-K.GAP_SIZE;r={gifs:u[0],blankStr:m>0?m+"px":void 0}}else{n=[];for(var g=0;g<u.length;g++)s[g]>o?a.push(u[g]):n.push.apply(n,u[g])}}a.forEach(function(e){return e.sort(function(e,t){return e.rank-t.rank})}),a.sort(function(e,t){return e[0].rank-t[0].rank});var _=a.map(function(e){return{gifs:e,blankStr:void 0}});return r&&_.push(r),_}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var c=a(17),d=o(c),f=a(0),p=o(f),h=a(5),m=o(h),g=a(2),_=o(g),v=a(4),b=o(v),y=a(7),E=o(y),S=a(6),C=o(S),M=a(3),k=o(M),w=a(46),N=o(w),T=a(10),P=o(T),I=a(14),R=o(I),A=a(34),x=o(A),O=a(53),D=o(O),L=a(65),U=o(L),F=a(55),j=o(F),B=a(35),G=o(B),V=a(7508),Y=o(V),W=a(485),H=o(W),q=a(97),z=o(q),K=a(7162),Q=a(7408),J=o(Q),X=a(7250),Z=o(X),$=a(7589),ee=o($),te=void 0;te="3o85xmWDYKgihhIKSA";var ae="DLAQBEYLJJIM",oe={giphy:x["default"].GIF_SEARCH_PROVIDER.GIPHY,tenor:x["default"].GIF_SEARCH_PROVIDER.TENOR},ne={giphy:D["default"].GIF_ATTRIBUTION.GIPHY,tenor:D["default"].GIF_ATTRIBUTION.TENOR},re=new Y["default"](n,{maxCached:6,maxAge:36e4,shouldCache:function(e){return!(!e||!e.length)}}),ie=function(e){function t(e){(0,_["default"])(this,t);var a=(0,E["default"])(this,(t.__proto__||(0,m["default"])(t)).call(this,e));return a._scrollTop=0,a._didSendGif=!1,a._onlineRestarter=null,a._pendingQuery=null,a._gifRefs={},a.onSend=function(e){var t=oe[e.attribution];new x["default"].GifFromProviderSent({gifSearchProvider:t}).commit(),e.trending||new x["default"].GifSearchResultTapped({gifSearchProvider:t,rank:e.rank}).commit(),a._didSendGif=!0,a.props.onGif(e.url,ne[e.attribution])},a.animateGif=function(){var e=a._animatingRow,t=a._scrollTop+K.GAP_SIZE;a._starredGifsDom&&(t-=a._starredGifsDom.clientHeight);var o=Math.round(t/(K.TARGET_GIF_HEIGHT+K.GAP_SIZE)),n=a.state.gifRows[o];if(n&&n.gifs.length&&n!==e){if(a._animatingRow=n,e)for(var r=0;r<e.gifs.length;r++)a.setGifAnimating(e.gifs[r].gifId,!1);for(var i=0;i<n.gifs.length;i++)a.setGifAnimating(n.gifs[i].gifId,!0)}[o+1,o-1].forEach(function(e){if(a.state.gifRows[e])for(var t=a.state.gifRows[e].gifs,o=0;o<t.length;o++)a.setGifAnimating(t[o].gifId,!1)})},a.searchForAndSetGifs=function(){var e=oe[(0,K.gifProvider)()],t=a.props.searchText,o=re.getOrRun(t);o=o.then(),a._pendingQuery=o,o.checkpoint(a.props.rejectOnUnmount()).then(function(n){if(n&&0===n.length&&new x["default"].GifSearchNoResults({gifSearchProvider:e}).commit(),o===a._pendingQuery&&(a._pendingQuery=null,n)){t||new x["default"].GifTrendingViewed({gifSearchProvider:e}).commit();var r=a._containerDom.clientWidth;r-=2*K.GAP_SIZE,a._resetScroll=!0,a._animateTimer.debounce(0),a.setState({gifRows:u(n,r),width:r})}})["catch"](R["default"].Unmount,p["default"].CancellationError,P["default"].noop),t&&setTimeout(function(){a.props.rejectOnUnmount().isPending()&&t===a.props.searchText&&new x["default"].GifSearchPerformed({gifSearchProvider:e}).commit()},500)},a.onStarredGifsMount=function(e){a._starredGifsDom=N["default"].findDOMNode(e)},a.onContainerMount=function(e){a._containerDom=e,null!==e&&a._resetScroll&&(e.scrollTop=0)},a._scrollTop=0,a._animatingRow=null,a._containerDom=null,a._didSendGif=!1,a.state={gifRows:[],width:0},a}return(0,C["default"])(t,e),(0,b["default"])(t,[{key:"componentWillReceiveProps",value:function(e){e.searchText!==this.props.searchText&&this.scheduleQuery()}},{key:"shouldComponentUpdate",value:function(e,t){return e.onGif!==this.props.onGif||t.gifRows!==this.state.gifRows}},{key:"componentWillMount",value:function(){var e=this;this._searchTimer=new j["default"](this.searchForAndSetGifs),this._animateTimer=new j["default"](this.animateGif),this._onlineRestarter=p["default"].loop(function(){return G["default"].waitForBBEvent(U["default"],"change:online",function(){return U["default"].online}).then(function(){return e.scheduleQuery()})}).cancellable(),this._onlineRestarter["catch"](p["default"].CancellationError,P["default"].noop),this.searchForAndSetGifs(),new x["default"].GifSearchSessionStarted({gifSearchProvider:oe[(0,K.gifProvider)()]}).commit()}},{key:"componentWillUnmount",value:function(){this._animateTimer.cancel(),this._searchTimer.cancel(),this._onlineRestarter&&this._onlineRestarter.cancel(),this._didSendGif||new x["default"].GifSearchCancelled({gifSearchProvider:oe[(0,K.gifProvider)()]}).commit()}},{key:"scheduleQuery",value:function(){this._searchTimer.debounceAndCap(200,2e3)}},{key:"animateOnScroll",value:function(e){this._scrollTop=e.scrollTop,this._animateTimer.debounce(200)}},{key:"setGifAnimating",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,a=this._gifRefs[e];a&&a.setShouldAnimate(t)}},{key:"render",value:function(){var e=this,t=this.state.gifRows,a=t.map(function(t,a){var o=t.gifs.map(function(t,a){return k["default"].createElement(Z["default"],{key:t.gifId,ref:function(a){return e._gifRefs[t.gifId]=a},gif:t,display:!0,onSend:e.onSend})}),n=null;return t.blankStr&&(n=k["default"].createElement("div",{className:ee["default"].blank,style:{flexBasis:t.blankStr}})),k["default"].createElement("div",{key:a,className:ee["default"].row},o,n)}),o=void 0;a.length&&!this.props.searchText&&(o=k["default"].createElement("div",{className:ee["default"].sectionTitle},l10n.t("gif_trending_title")));var n=void 0;return this.props.searchText||(n=k["default"].createElement(J["default"],{onSend:this.onSend,ref:this.onStarredGifsMount})),k["default"].createElement("div",{className:ee["default"].searchContainer,ref:this.onContainerMount},n,k["default"].createElement("div",{className:ee["default"].section},o,a))}}]),t}(k["default"].Component);t.Component=ie;t["default"]=(0,H["default"])(ie)},7407:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(48),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(23),y=n(b),E=a(7250),S=n(E),C=a(7162),M=a(53),k=n(M),w=a(262),N=n(w),T=a(7157),P=o(T),I=a(12),R=n(I),A=a(94),x=n(A),O=a(172),D=n(O),L=a(71),U=n(L),F=a(7590),j=n(F);t["default"]=(0,U["default"])(function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.setGifRef=function(e){o._gifRef=e},o.getGifProvider=function(){var e=o.props.msg.gifAttribution;switch(e){case k["default"].GIF_ATTRIBUTION.GIPHY:return C.GIPHY;case k["default"].GIF_ATTRIBUTION.TENOR:return C.TENOR;default:return""}},o.handleClick=function(e){e.stopPropagation();var t=o.props.msg.mediaData;switch(t.mediaStage){case N["default"].STAGE.NEED_POKE:o.props.msg.downloadMedia(!0);break;case N["default"].STAGE.FETCHING:o.props.msg.cancelDownload();break;case N["default"].STAGE.UPLOADING:o.props.msg.cancelUpload();break;case N["default"].STAGE.ERROR_MISSING:R["default"].openModal(v["default"].createElement(x["default"],{title:l10n.t("missing_photo_title"),onOK:R["default"].closeModal.bind(R["default"]),okText:l10n.t("web_ok")},l10n.t("missing_photo_text")))}},o.onUnstarMsg=function(){var e=o.props.msg;R["default"].sendUnstarMsgs(e.chat,[e])},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"animateGif",value:function(){var e=this;this.props.listeners.uiIdle(function(){e._gifRef&&e._gifRef.setShouldAnimate(!0)})}},{key:"componentDidMount",value:function(){this.animateGif()}},{key:"componentDidUpdate",value:function(){this.animateGif()}},{key:"componentWillMount",value:function(){var e=this,t=this.props.msg;this.props.listeners.add(t,"change:mediaData.mediaStage",function(){e.forceUpdate()}),this.props.listeners.uiIdle(function(){t.downloadMedia()})}},{key:"render",value:function(){var e=this.props.msg,t=e.mediaData,a=new C.GifInfo(void 0,t.renderableUrl,void 0,void 0,Math.round(t.aspectRatio*C.TARGET_GIF_HEIGHT),this.getGifProvider(),!1);if(t.mediaStage===N["default"].STAGE.RESOLVED)return v["default"].createElement(S["default"],{key:e.filehash,ref:this.setGifRef,gif:a,display:!0,onSend:this.props.onSend,isStarred:!0,onUnstarMsg:this.onUnstarMsg});if(t.preview){var o=t.preview.url(),n=void 0;switch(t.mediaStage){case N["default"].STAGE.ERROR_MISSING:break;case N["default"].STAGE.NEED_POKE:n=v["default"].createElement(P.Download,null);break;case N["default"].STAGE.FETCHING:case N["default"].STAGE.UPLOADING:n=v["default"].createElement(P.PendingCancel,null);break;default:n=v["default"].createElement(P.Pending,null)}var r=(0,y["default"])(j["default"].thumb,(0,i["default"])({},j["default"].blur,t.mediaStage===N["default"].STAGE.ERROR_MISSING)),l=v["default"].createElement("div",{className:r,style:{backgroundImage:"url("+o+")",height:C.TARGET_GIF_HEIGHT+"px"}});return v["default"].createElement("div",{className:j["default"].container,style:{flexBasis:a.widthStr},key:e.filehash},v["default"].createElement("div",{className:j["default"].wrapper,style:{width:a.widthStr},onClick:this.handleClick},v["default"].createElement("div",{className:j["default"].innerWrapper,style:{paddingBottom:a.ratioStr}},n,l)),v["default"].createElement("button",{className:j["default"].starIcon,onClick:this.onUnstarMsg},v["default"].createElement(D["default"],{name:"star-light"})))}return null}}]),t}(v["default"].Component))},7408:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(23),b=o(v),y=a(7407),E=o(y),S=a(7162),C=a(172),M=o(C),k=a(71),w=o(k),N=a(7591),T=o(N),P=a(10),I=o(P),R={RIGHT:"RIGHT",LEFT:"LEFT"},A=4;t["default"]=(0,w["default"])(function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={curIndex:0,direction:R.RIGHT},o.onSlideLeft=function(){o.setState({curIndex:o.state.curIndex-1,direction:R.LEFT})},o.onSlideRight=function(){o.setState({curIndex:o.state.curIndex+1,direction:R.RIGHT})},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this,t=Store.StarredGifMsgs;this.props.listeners.add(t,"add remove reset",function(){e.forceUpdate()}),t.isSynced||t.sync()}},{key:"render",value:function(){var e=this,t=I["default"].uniqBy(Store.StarredGifMsgs.models,"filehash");if(0===t.length)return _["default"].createElement("div",null);if(t.length<=A){var a=0,o=t.map(function(t){return a+=Math.round(t.mediaData.aspectRatio*S.TARGET_GIF_HEIGHT),_["default"].createElement(E["default"],{key:t.filehash,msg:t,onSend:e.props.onSend})});return a+=(o.length-1)*S.GAP_SIZE,_["default"].createElement("div",{className:T["default"].section},_["default"].createElement("div",{className:T["default"].sectionTitle},l10n.t("gif_starred_title")),_["default"].createElement("div",{className:T["default"].searchRow,style:{maxWidth:a+"px"}},o))}var n=void 0,i=void 0,l=this.state.curIndex>0,s=this.state.curIndex+A<t.length,u=l?this.onSlideLeft:null,c=s?this.onSlideRight:null,d=(0,b["default"])(T["default"].pager,T["default"].pagerLeft,(0,r["default"])({},T["default"].pagerDisabled,!l)),f=(0,b["default"])(T["default"].pager,T["default"].pagerRight,(0,r["default"])({},T["default"].pagerDisabled,!s));n=_["default"].createElement("div",{className:d,onClick:u},_["default"].createElement(M["default"],{name:"chevron-left-alt"})),i=_["default"].createElement("div",{className:f,onClick:c},_["default"].createElement(M["default"],{name:"chevron-right-alt"}));var p=t.slice(this.state.curIndex,this.state.curIndex+A).map(function(t){return _["default"].createElement(E["default"],{key:t.filehash,msg:t,onSend:e.props.onSend})});return _["default"].createElement("div",{className:T["default"].section},_["default"].createElement("div",{className:T["default"].sectionTitle},l10n.t("gif_starred_title")),_["default"].createElement("div",{className:T["default"].searchRow},n,_["default"].createElement("div",{className:T["default"].body},p),i))}}]),t}(_["default"].Component))},7409:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(94),E=o(y),S=a(7119),C=o(S),M=a(7124),k=o(M),w=a(7448),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.filter=function(e){var t=e.groupMetadata;return!e.isGroup||e.isGroup&&!t.participants.iAmMember()?!1:t.participants.get(o.props.contact.id)?l10n.t("already_added_to_group"):t.participants.iAmAdmin()?!0:l10n.t("chat_not_an_admin")},o.confirmAddToGroup=function(e){o.push(m["default"].createElement(E["default"],{onOK:o.addToGroup.bind(null,e),okText:l10n.t("add_group_participant"),onCancel:o._pop,cancelText:l10n.t("web_cancel")},m["default"].createElement(C["default"],{text:l10n.t("confirm_add_group_participant",{participant:o.props.contact.formattedName,subject:e.contact.name})})))},o.addToGroup=function(e){e.groupMetadata.participants.addParticipant(o.props.contact).then(function(){b["default"].openChatFromUnread(e).then(function(t){t&&b["default"].focusChatTextInput(e)})})["catch"](_["default"].noop),o.end()},o._pop=function(){o.pop()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(N["default"],{chats:Store.Chat.filter(function(e){return e.isGroup}),filter:this.filter,onCancel:this._pop,onGroup:this.confirmAddToGroup}))}}]),t}(k["default"]);t["default"]=T},7410:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(94),E=o(y),S=a(7257),C=o(S),M=a(7119),k=o(M),w=a(7124),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.contactFilter=function(e){var t=o.props.chat.groupMetadata;return Store.Contact.isFilteredContact(e)?t.participants.get(e.id)?l10n.t("already_added_to_group"):!0:!1},o.confirmAddParticipant=function(e){var t=o.onAddParticipant.bind(o,e),a=l10n.t("confirm_add_group_participant",{participant:e.formattedName,subject:o.props.chat.contact.name});o.push(m["default"].createElement(E["default"],{onOK:t,okText:l10n.t("add_group_participant"),onCancel:o._pop,cancelText:l10n.t("web_cancel")},m["default"].createElement(k["default"],{text:a})))},o.onAddParticipant=function(e){o.props.chat.groupMetadata.participants.addParticipant(e)["catch"](_["default"].noop),b["default"].closeModal()},o._pop=function(){o.pop()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(C["default"],{title:l10n.t("add_group_participant"),filter:this.contactFilter,onCancel:this._pop,onSelect:this.confirmAddParticipant}))}}]),t}(N["default"]);t["default"]=T},7411:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(181),p=o(f),h=a(6),m=o(h),g=a(10),_=o(g),v=a(7163),b=o(v),y=a(7205),E=(o(y),a(7427)),S=o(E),C=a(12),M=o(C),k=a(7124),w=o(k),N=a(3),T=o(N),P=a(28),I=o(P),R=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.onCancel=function(){e.props.onComplete&&e.props.onComplete(!1),e.clearComposeAttachMedia(),e.props.mediaCollection.mediaPickerStatsLogger.logCancel(),e.end()},e.sendMediaWithMentions=function(t,a){var o=e.props.chat;M["default"].once("ui_idle",function(){t.forEach(function(e,t){var a=e.media,n={};0===t&&(n.quotedMsg=o.composeQuotedMsg,o.composeQuotedMsg=null),n.mentionedJidList=e.mentionedJidList,n.caption=a.caption,n.addEvenWhilePreparing=a.previewable&&a.state===b["default"].STATE.PROCESSING,a.sendToChat(o,n)}),e.clearComposeAttachMedia()}),e.props.onComplete&&e.props.onComplete(!0,a),e.props.mediaCollection.mediaPickerStatsLogger.logSend(),e.end()},e.setText=function(t){M["default"].once("ui_idle",function(){M["default"].pasteChatTextInput(e.props.chat,t)}),e.end()},e.clearComposeAttachMedia=function(){e.props.chat&&e.props.chat.setComposeAttachMediaContents(null)},e.handleRequestDismiss=e.handleRequestDismiss.bind(e),e}return(0,m["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){M["default"].closeContextMenu(),M["default"].closeTooltip(),this.push(T["default"].createElement(S["default"],{chat:this.props.chat,files:this.props.files,onBack:this.onCancel,initCaption:this.props.initCaption,onSendMedia:_["default"].once(this.sendMediaWithMentions),onDropText:_["default"].once(this.setText),mediaCollection:this.props.mediaCollection}))}},{key:"componentWillUnmount",value:function(){var e=this;I["default"].isGecko?_["default"].defer(function(){return M["default"].focusChatTextInput(e.props.chat)}):M["default"].focusChatTextInput(this.props.chat)}},{key:"handleRequestDismiss",value:function(e){e===!1&&(this.clearComposeAttachMedia(),this.props.mediaCollection.mediaPickerStatsLogger.logCancel()),(0,p["default"])(t.prototype.__proto__||(0,r["default"])(t.prototype),"handleRequestDismiss",this).call(this)}}]),t}(w["default"]);t["default"]=R},7412:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7124),_=o(g),v=a(7180),b=o(v),y=a(484),E=(o(y),a(486)),S=(o(E),a(7467)),C=o(S),M=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.confirmSendContacts=function(e){o.push(m["default"].createElement(C["default"],{contactList:e,onSend:function(){return o.sendContacts(e)},onBack:o._popNone,chat:o.props.chat}),"none"),o.contacts=e},o.sendContacts=function(e){1===e.length?o.props.chat.sendContact(e[0]):o.props.chat.sendContactList(e),o.end()},o._getContacts=function(){return o.contacts},o._pop=function(){o.pop()},o._popNone=function(){o.pop("none")},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.contacts=[],this.push(m["default"].createElement(b["default"],{title:l10n.t("send_contacts"),onCancel:this._pop,onChat:this.confirmSendContacts,getInitialItems:this._getContacts,listType:v.ListType.CONTACT_SELECT_MODAL}))}}]),t}(_["default"]);t["default"]=M},7413:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(7169),v=o(_),b=a(7253),y=n(b),E=a(7124),S=n(E),C=a(7132),M=a(272),k=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.sendMedia=function(e){var t=e.getImg,a=e.caption,n=o.props.chat,r=n.composeQuotedMsg;n.composeQuotedMsg=null,(0,M.prepRawMedia)(t,{}).sendToChat(n,{caption:a||void 0,quotedMsg:r||void 0}),o.end()},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.push(g["default"].createElement(y["default"],{onBack:function(){e.end()},chat:this.props.chat,caption:!0,layoutType:C.FIT_TYPE.CONTAIN,onSend:this.sendMedia,stream:this.props.stream}))}},{key:"componentWillUnmount",value:function(){v.stop(this.props.stream)}}]),t}(S["default"]);t["default"]=k},7414:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(7169),v=o(_),b=a(7253),y=n(b),E=a(7202),S=n(E),C=a(7124),M=n(C),k=a(7132),w=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.pushCaptureDrawer=function(){o.push(g["default"].createElement(y["default"],{onBack:o.cleanUp,onCaptured:o.onCaptured,onSend:null,layoutType:k.FIT_TYPE.COVER,stream:o.props.stream}))},o.closeStream=function(){o.props.stream&&v.stop(o.props.stream)},o.onFinished=function(e,t){o.props.onFinished(e,t),o.cleanUp()},o.cleanUp=function(){o.closeStream(),o.end()},o._pop=function(){o.pop()},o.onCaptured=function(e){o.push(g["default"].createElement(S["default"],{onCancel:o.cleanUp,onRetake:o._pop,retryText:E.RETRY_OPTIONS.RETAKE,onFinished:o.onFinished,img:e}))},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){this.pushCaptureDrawer()}},{key:"componentWillUnmount",
value:function(){this.closeStream()}}]),t}(M["default"]);t["default"]=w},7415:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7202),_=o(g),v=a(7124),b=o(v),y=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onFinished=function(e,t){o.props.onFinished(e,t),o.end()},o._pop=function(){o.pop()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(_["default"],{onCancel:this._pop,onFinished:this.onFinished,onRetake:this.props.onRetake,retryText:g.RETRY_OPTIONS.RESTART,img:this.props.img}))}}]),t}(b["default"]);t["default"]=y},7416:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7446),_=o(g),v=a(7124),b=o(v),y=a(484),E=(o(y),function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(_["default"],{chat:this.props.chat,onConfirm:this.props.onConfirm}))}}]),t}(b["default"]));t["default"]=E},7417:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(7202),m=o(h),g=a(7124),_=o(g),v=a(7450),b=o(v),y=a(3),E=o(y),S=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onImageSelected=function(e,t){o.push(E["default"].createElement(m["default"],{attributionUrl:t,onCancel:o._pop,onFinished:o.onFinished,img:e}))},o._pop=function(){o.pop()},o.onFinished=function(e,t){o.props.onFinished(e,t),o.end()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(E["default"].createElement(b["default"],{onCancel:this._pop,onImageSelected:this.onImageSelected}))}}]),t}(_["default"]);t["default"]=S},7418:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(498),b=(o(v),a(12)),y=o(b),E=a(8),S=o(E),C=a(23),M=o(C),k=a(14),w=o(k),N=a(47),T=o(N),P=a(71),I=o(P),R=a(1),A=o(R),x=a(262),O=o(x),D=a(7227),L=o(D),U=a(7453),F=o(U),j=a(34),B=o(j),G=a(53),V=o(G),Y=a(108),W=(o(Y),a(485)),H=o(W),q=a(126),z=o(q),K=a(46),Q=o(K),J=a(175),X=o(J),Z=a(264),$=o(Z),ee=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));a.onKeyDown=function(e){37===e.keyCode?a.onPrev():39===e.keyCode&&a.onNext()},a.onImageLoad=function(){a.uiActionEvent&&(a.uiActionEvent.markUiActionT(),a.uiActionEvent.commit(),delete a.uiActionEvent)},a.onScroll=function(e){a.handleScroll(e.target)},a._handleScroll=function(e){0!==a.mediaMsgs.length&&(a.mediaMsgs.hasMediaBefore&&e.scrollLeft<e.clientWidth&&!function(){var e=a.mediaMsgs.head();a.props.listeners.uiIdle(function(){a.mediaMsgs.queryMedia(e.chat,e),a.forceUpdate()})}(),a.mediaMsgs.hasMediaAfter&&e.scrollLeft+S["default"].SCROLL_FUDGE>e.scrollWidth-2*e.clientWidth&&!function(){var e=a.mediaMsgs.last();a.props.listeners.uiIdle(function(){a.mediaMsgs.queryMedia(e.chat,e,"after"),a.forceUpdate()})}())},a.onNext=function(e){if(e&&e.stopPropagation(),!a.state.imgZoomed){var t=a.state.activeMsg,o=a.mediaMsgs.getAfter(t);return o?void a.onSelectThumb(o):void(T["default"].supportsFeature(T["default"].F.MEDIA_GALLERY)&&a.mediaMsgs.hasMediaAfter&&(a._queryMediaAfter||(a._queryMediaAfter=a.mediaMsgs.queryMedia(t.chat,t,"after").checkpoint(a.props.rejectOnUnmount()).then(function(e){e.length>0&&a.state.activeMsg===t&&a.onNext()})["catch"](w["default"].Unmount,_["default"].noop)["catch"](function(e){A["default"].error("query media msgs error: ",e)})["finally"](function(){a._queryMediaAfter=null}))))}},a.onPrev=function(e){if(e&&e.stopPropagation(),!a.state.imgZoomed){var t=a.state.activeMsg,o=a.mediaMsgs.getBefore(t);return o?void a.onSelectThumb(o):void(T["default"].supportsFeature(T["default"].F.MEDIA_GALLERY)&&a.mediaMsgs.hasMediaBefore&&(a._queryMediaBefore||(a._queryMediaBefore=a.mediaMsgs.queryMedia(t.chat,t,"before").checkpoint(a.props.rejectOnUnmount()).then(function(e){e.length>0&&a.state.activeMsg===t&&a.onPrev()})["catch"](w["default"].Unmount,_["default"].noop)["catch"](function(e){A["default"].error("query media msgs error: ",e)})["finally"](function(){a._queryMediaBefore=null}))))}},a.onImgZoomIn=function(e){a.setState({imgZoomed:e})},a.endFlow=function(){y["default"].closeModalMedia()},a.willEndFlow=function(){(0,$["default"])(a.refs.thumbsContainer,{opacity:[0,1],translateY:["100%","0%"]},{duration:300,easing:[.1,.82,.25,1]})},a.onSelectThumb=function(e){T["default"].supportsFeature(T["default"].F.MEDIA_GALLERY)&&a.props.listeners.uiIdle(function(){a.mediaMsgs.loadMoreAroundIfNeeded(e)}),a.setState({activeMsg:e})},a.scrollToActive=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!1,t=a.refs.thumbsContainer,o=Q["default"].findDOMNode(a.refs.thumbs),n=Q["default"].findDOMNode(a.refs.activeThumb);if(t&&o&&n){var r=n.clientWidth/2-t.clientWidth/2;(0,$["default"])(o,"stop");var i=0;e&&(i=300),(0,$["default"])(n,"scroll",{duration:i,container:o,offset:r,axis:"x",easing:[.1,.82,.25,1]})}},a.getThumbs=function(){var e=a.mediaMsgs.map(function(e){var t=(0,M["default"])("media-thumb",{active:e===a.state.activeMsg});return m["default"].createElement(L["default"],{classes:t,msg:e,ref:e===a.state.activeMsg?"activeThumb":null,key:"media-"+e.id.id,onClick:a.onSelectThumb.bind(a,e)})});return e.push(m["default"].createElement("div",{className:"media-thumb-spinner media-thumb",key:"spinner-right"},a.mediaMsgs.queryMediaAfter?m["default"].createElement(X["default"],{stroke:6,size:24}):null)),e.unshift(m["default"].createElement("div",{className:"media-thumb-spinner media-thumb",key:"spinner-left"},a.mediaMsgs.queryMediaBefore?m["default"].createElement(X["default"],{stroke:6,size:24}):null)),e.push(m["default"].createElement("div",{className:"media-thumb-padding",key:"padding-right"})),e.unshift(m["default"].createElement("div",{className:"media-thumb-padding",key:"padding-left"})),e},a.zoomIn=!0,a.prevScrollWidth=null;var o=a.props.msg;return a.mediaMsgs=o.chat.constructMediaMsgs(o),a.handleScroll=_["default"].throttle(a._handleScroll,100),o.type===V["default"].TYPE.IMAGE&&(a.uiActionEvent=new B["default"].UiAction({uiActionType:B["default"].UI_ACTION_TYPE.IMAGE_OPEN,uiActionPreloaded:o.mediaData.mediaStage===O["default"].STAGE.RESOLVED})),a.state={activeMsg:o,imgZoomed:!1},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(window,"keydown",this.onKeyDown)}},{key:"componentDidMount",value:function(){var e=this;this.zoomIn=!1;var t=this.props.listeners;T["default"].supportsFeature(T["default"].F.MEDIA_GALLERY)&&t.uiIdle(function(){e.mediaMsgs.loadMoreAroundIfNeeded(e.state.activeMsg)}),t.add(this.mediaMsgs,"remove reset",function(t,a,o){if(e.mediaMsgs.indexOf(t)>-1||e.state.activeMsg!==t)return void e.forceUpdate();var n=o.index;0===e.mediaMsgs.length?e.endFlow():e.mediaMsgs.length===n?e.onSelectThumb(e.mediaMsgs.at(n-1)):e.onSelectThumb(e.mediaMsgs.at(n))}),t.add(this.mediaMsgs,"query_media_after"),t.add(this.mediaMsgs,"query_media_before",function(){var t=Q["default"].findDOMNode(e.refs.thumbs);t&&(e.prevScrollWidth=t.scrollWidth,e.forceUpdate())}),this.scrollToActive(),(0,$["default"])(this.refs.thumbsContainer,{opacity:[1,0],translateY:["0%","100%"]},{duration:300,delay:100,easing:[.1,.82,.25,1]})}},{key:"componentWillUnmount",value:function(){this.handleScroll.cancel()}},{key:"componentDidUpdate",value:function(e,t){if(t.activeMsg!==this.state.activeMsg)this.scrollToActive(!0);else{var a=Q["default"].findDOMNode(this.refs.thumbs);if(!a||!this.prevScrollWidth)return;a.scrollLeft+=a.scrollWidth-this.prevScrollWidth,this.prevScrollWidth=null}}},{key:"render",value:function(){var e=this.mediaMsgs.last(),t=this.mediaMsgs.hasMediaAfter||this.state.activeMsg!==e?this.onNext:null,a=this.mediaMsgs.head(),o=this.mediaMsgs.hasMediaBefore||this.state.activeMsg!==a?this.onPrev:null,n=this.getThumbs(),r=T["default"].supportsFeature(T["default"].F.MEDIA_GALLERY)?this.onScroll:null;return m["default"].createElement("div",{className:this.state.imgZoomed?"img-zoomed-in":null},m["default"].createElement("div",{className:"media-collection media-viewer-thumbs-container",ref:"thumbsContainer"},m["default"].createElement("div",{onScroll:r,style:{width:"100%"},dir:"ltr"},m["default"].createElement(z["default"],{className:"media-viewer-thumbs",ref:"thumbs",transitionName:"thumb-scale"},n))),m["default"].createElement(F["default"],{msg:this.state.activeMsg,mediaData:this.state.activeMsg.mediaData,onBack:this.endFlow,onExitAnimation:this.willEndFlow,onNext:t,onPrev:o,onImgZoomIn:this.onImgZoomIn,getZoomNode:this.props.getZoomNode,startTime:this.props.startTime,zoomIn:this.zoomIn,onImageLoad:this.uiActionEvent?this.onImageLoad:null}))}}]),t}(m["default"].Component);t["default"]=(0,H["default"])((0,I["default"])(ee))},7419:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(12),_=o(g),v=a(7432),b=o(v),y=a(7124),E=o(y),S=a(7262),C=o(S),M=a(7263),k=o(M),w=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onClick=function(e,t){Store.Chat.find(t.id).then(_["default"].openChatFromUnread.bind(_["default"])),o.end()},o.onNewGroup=function(e){o.push(m["default"].createElement(k["default"],{onBack:o.pop,onContinue:o.onSetGroupInfo}))},o.onSetGroupInfo=function(e){o.push(m["default"].createElement(C["default"],{participants:e,onBack:function(){o.popAndUpdate({participants:e})},onContinue:o.end}))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(b["default"],{title:l10n.t("new_chat_flow_title"),onBack:this.end,onClick:this.onClick,onNewGroup:this.onNewGroup}))}}]),t}(E["default"]);t["default"]=w},7420:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7124),_=o(g),v=a(7262),b=o(v),y=a(7263),E=o(y),S=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onSetGroupInfo=function(e){o.push(m["default"].createElement(b["default"],{participants:e,onBack:function(){o.popAndUpdate({participants:e})},onContinue:o.end}))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(E["default"],{onBack:this.end,onContinue:this.onSetGroupInfo}))}}]),t}(_["default"]);t["default"]=S},7421:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7124),_=o(g),v=a(7267),b=o(v),y=a(108),E=(o(y),a(7131)),S=(o(E),function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.closeStatusViewer=function(){o.end()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(b["default"],{initialStatusV3:this.props.statusV3,quotedMsgKey:this.props.msgKey,closeStatusViewer:this.closeStatusViewer,onMsgNotFound:this.props.onMsgNotFound}),"none")}}]),t}(_["default"]));e.exports=S},7422:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7124),E=o(y),S=a(484),C=(o(S),a(12)),M=o(C),k=a(8),w=o(k),N=a(7180),T=o(N),P=a(180),I=o(P),R=a(7281),A=o(R),x=a(93),O=o(x),D=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(s))),o.handleForwardConfirmed=function(e){r["default"].map(e,function(e){var t=void 0;t=e.isUser&&e.contact.isBlocked()?e.contact.setBlock(!1):r["default"].resolve(!0),t.then(function(t){e.sendMessage(o.props.chat.groupMetadata.groupInviteLink,o.linkPreview)})}),o.end(),M["default"].openChatFromUnread(b["default"].head(e))},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.push(_["default"].createElement(T["default"],{onChat:this.handleForwardConfirmed,title:O["default"].t("group_invite_send_link_title"),listType:N.ListType.CHAT_SELECT_MODAL}));var t=this.props.chat;this.linkPreview={canonicalUrl:w["default"].GROUP_INVITE_LINK_URL,description:O["default"].t("whatsapp_group_invite"),matchedText:t.groupMetadata.groupInviteLink,title:t.title(),thumbnail:null};var a=t.contact.profilePicThumb;a&&a.imgFull?I["default"].generateLinkPreview(a.imgFull).then(function(t){e.linkPreview.thumbnail=t}):(0,A["default"])(t.groupMetadata.groupInviteLink).then(function(t){t&&(e.linkPreview.thumbnail=t.data.thumbnail)})["catch"](b["default"].noop)}}]),t}(E["default"]);t["default"]=D},7423:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7180),E=o(y),S=a(12),C=o(S),M=a(7124),k=o(M),w=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var i=arguments.length,s=Array(i),c=0;i>c;c++)s[c]=arguments[c];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(s))),o.onForwardConfirmed=function(e){var t=o.props.msgText;1===e.length?!function(){var a=void 0,o=b["default"].head(e);a=o.isUser&&o.contact.isBlocked()?o.contact.setBlock(!1):r["default"].resolve(!0),a.then(function(e){return t&&o.setComposeContents({text:t}),C["default"].openChatFromUnread(o).then(function(e){e&&C["default"].focusChatTextInput(o)})})}():(r["default"].map(e,function(e){var a=void 0;a=e.isUser&&e.contact.isBlocked()?e.contact.setBlock(!1):r["default"].resolve(!0),a.then(function(a){e.sendMessage(t)})}),C["default"].openChatFromUnread(b["default"].head(e))),o.end()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){this.push(_["default"].createElement(E["default"],{onChat:this.onForwardConfirmed,title:l10n.t("msg_send_title"),listType:y.ListType.CHAT_SELECT_MODAL}))}}]),t}(k["default"]);t["default"]=w},7424:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7429),_=o(g),v=a(36),b=o(v),y=a(7124),E=o(y),S=a(7449),C=o(S),M=a(7458),k=o(M),w=a(7265),N=o(w),T=a(7460),P=o(T),I=a(7470),R=o(I),A=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.showWallpaperDrawer=function(){o.push(m["default"].createElement(R["default"],{onClose:o._pop}))},o.showBlockedDrawer=function(){o.push(m["default"].createElement(_["default"],{onClose:o._pop}))},o.showProfileDrawer=function(){var e=Store.Status.get(Store.Conn.me),t=Store.ProfilePicThumb.get(Store.Conn.me);o.push(m["default"].createElement(N["default"],{status:e,profilePicThumb:t,conn:Store.Conn,onClose:o._pop}))},o.showNotifications=function(){o.push(m["default"].createElement(k["default"],{onClose:o._pop}))},o.showHelp=function(){b["default"].upload("help-page-opened"),o.push(m["default"].createElement(C["default"],{onClose:o._pop}))},o._pop=function(){o.pop()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(P["default"],{profileId:Store.Conn.me,onWallpaper:this.showWallpaperDrawer,onBlocked:this.showBlockedDrawer,onProfile:this.showProfileDrawer,onNotifications:this.showNotifications,onHelp:this.showHelp,onClose:this._pop}))}}]),t}(E["default"]);t["default"]=A},7425:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7124),_=o(g),v=a(7463),b=o(v),y=a(7267),E=o(y),S=a(53),C=(o(S),a(7131)),M=(o(C),function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.openStatusViewer=function(e,t){o.push(m["default"].createElement(E["default"],{initialStatusV3:e,initialStatusMsg:t,closeStatusViewer:o.closeStatusViewer}),"none")},o.closeStatusViewer=function(e){e?o.end():o.pop("none")},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.push(m["default"].createElement(b["default"],{onOpenStatus:this.openStatusViewer,closeStatusViewer:this.closeStatusViewer}),"status-v3-modal")}},{key:"componentWillUnmount",value:function(){this.props.onFlowEnd()}}]),t}(_["default"]));e.exports=M},7426:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(46),_=o(g),v=a(264),b=o(v),y=a(176),E=o(y),S=a(174),C=a(8),M=o(C),k=a(28),w=o(k),N=a(172),T=o(N),P=a(7592),I=o(P),R=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){var e=_["default"].findDOMNode(this.img),t=_["default"].findDOMNode(this.txt);this.props.animate?((0,b["default"])(e,{scale:[1,0],opacity:[1,0]},{delay:1340,duration:180,easing:[.05,1.02,0,1.01]}),(0,b["default"])(t,{translateY:[0,80],opacity:[1,0]},{delay:1300,duration:140,easing:[.05,1.02,0,1.01]})):(e.style.opacity=1,t.style.opacity=1)}},{key:"render",value:function(){return m["default"].createElement("div",{className:I["default"].intro},m["default"].createElement("div",{className:I["default"].body},m["default"].createElement("div",{ref:(0,S.GetRef)("img",this),"data-asset-intro-image":!0,className:I["default"].image}),m["default"].createElement("div",{ref:(0,S.GetRef)("txt",this),className:I["default"].textContainer},m["default"].createElement("h1",{"data-a8n":E["default"].key("intro-title"),className:I["default"].title},l10n.t("intro_title")),m["default"].createElement("div",{"data-a8n":E["default"].key("intro-text"),className:I["default"].text},l10n.t("intro_connection")),m["default"].createElement(A,null))))}}]),t}(h.PureComponent),A=function(){var e=void 0;switch(w["default"].os){case M["default"].OS_TYPE.MAC:e=l10n.t("intro_native_mac");break;case M["default"].OS_TYPE.WINDOWS:e=l10n.t("intro_native_windows")}if(e){var t='<a href="https://www.whatsapp.com/download" target="_blank">'+l10n.t("intro_native_link")+"</a>";return e=e.replace("__get_it_here__",t),m["default"].createElement(x,null,m["default"].createElement(T["default"],{name:"laptop"}),m["default"].createElement("div",{dangerouslySetInnerHTML:{__html:e},className:I["default"].secondaryTextBody}))}return null},x=function(e){var t=e.children;return m["default"].createElement("div",{className:I["default"].secondary},m["default"].createElement("div",{className:I["default"].divider}),m["default"].createElement("div",{className:I["default"].secondaryText},t))};t["default"]=R},7427:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=o(v),y=a(10),E=o(y),S=a(7163),C=o(S),M=a(7205),k=(o(M),a(7428)),w=o(k),N=a(7287),T=o(N),P=a(7288),I=o(P),R=a(7183),A=o(R),x=a(7289),O=o(x),D=a(7290),L=o(D),U=a(484),F=(o(U),a(12)),j=o(F),B=a(8),G=o(B),V=a(7168),Y=o(V),W=a(7120),H=o(W),q=a(7121),z=o(q),K=a(7122),Q=o(K),J=a(14),X=o(J),Z=a(75),$=a(177),ee=o($),te=a(7209),ae=a(173),oe=o(ae),ne=a(71),re=o(ne),ie=a(128),le=o(ie),se=a(53),ue=o(se),ce=a(485),de=o(ce),fe=a(126),pe=o(fe),he=a(7144),me=o(he),ge=a(175),_e=o(ge),ve=a(7343),be=o(ve),ye=a(263),Ee=o(ye),Se=a(34),Ce=a(172),Me=o(Ce),ke=ue["default"].TYPE,we=ke.IMAGE,Ne=ke.VIDEO,Te=ke.DOCUMENT,Pe=ke.AUDIO,Ie=function(e){return 150+15*e},Re=400,Ae=C["default"].STATE.PROCESSING;t["default"]=(0,de["default"])((0,re["default"])(function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.populateInitCaption=function(e,t,o){var n=a.props.initCaption;!e&&t&&n&&""!==n.text&&o.activeMedia&&(o.activeMedia.caption=n.text,a.initCaptionUsed=!0)},a.onMediaProcessUpdate=function(){if(a.props.mediaCollection.canSend()){var e=a.props.mediaCollection.getPreviewableMedias(),t=a.props.mediaCollection.uiProcessMsgs(),o=t.activeMedia,n=t.errorMsgs;n&&e.length>0&&j["default"].openToast(_["default"].createElement(Ee["default"],{msg:n,id:(0,ye.genId)()})),o?a.setState({activeMedia:o}):a.forceUpdate()}},a.showIgnoredToast=function(e){if(e>0){var t=l10n.t("too_many_files_uploaded",{number:e,_plural:e});j["default"].openToast(_["default"].createElement(Ee["default"],{msg:t,id:(0,ye.genId)()}))}},a.onWindowDrop=function(){E["default"].isEmpty(a.props.files)&&E["default"].isEmpty(a.props.mediaCollection)&&a.props.onBack()},a.onDrop=function(e){a.onFilePick(e)},a.onDragLeave=function(e){a.props.mediaCollection.length||a.props.onBack()},a.onDragChange=function(e,t){a.setState({isDragging:e}),e||t||a.props.mediaCollection.length||a.props.onBack()},a.onEnter=function(e){a.state.activeMedia&&(e.repeat||e.shiftKey||a.onSend())},a.onArrowLeft=function(e){if(a.state.activeMedia&&!e.repeat){var t=a.state.activeMedia&&!a.state.activeMedia.caption,o=a.refCaptionInput&&a.refCaptionInput.refInput;(t||o&&!o.isFocused()||o&&o.cursorAtStart())&&a.onPrev()}},a.onArrowRight=function(e){if(a.state.activeMedia&&!e.repeat){var t=a.state.activeMedia&&!a.state.activeMedia.caption,o=a.refCaptionInput&&a.refCaptionInput.refInput;(t||o&&!o.isFocused()||o&&o.cursorAtEnd())&&a.onNext()}},a.onNext=function(){var e=a.props.mediaCollection.getAfter(a.state.activeMedia);e&&(a.refs.sendButton&&ee["default"].focus(a.refs.sendButton),a.setState({activeMedia:e}))},a.onPrev=function(){var e=a.props.mediaCollection.getBefore(a.state.activeMedia);e&&(a.refs.sendButton&&ee["default"].focus(a.refs.sendButton),a.setState({activeMedia:e}))},a.onSelectThumb=function(e){e!==a.state.activeMedia&&a.setState({activeMedia:e})},a.onSend=function(e){if(e&&e.preventDefault(),(!e||!e.shiftKey)&&a.props.mediaCollection.canSend()){var t=[];r["default"].all(t).then(function(){var e=a.props.mediaCollection.getPreviewableMedias();if(0!==e.length){var t=e.map(function(e){var t=e.caption,o=[],n=a.refCaptionInput&&a.refCaptionInput.refInput;if(t&&n){var r=n.serialize(t),i=[r[0].trim(),r[1]],l=i[0],s=i[1];l.length&&(t=l,o=s.mentionedJidList||[])}return e.caption=t||void 0,{media:e,mentionedJidList:o}});a.props.onSendMedia(t,a.initCaptionUsed)}})}},a.onAddFileClick=function(){var e=a.refs.input;e.click()},a.onFilePick=function(e){(0,te.getFiles)(e).then(function(e){return a.props.mediaCollection.processFiles(e,a.props.chat,Se.MEDIA_PICKER_ORIGIN_TYPE.CHAT_PHOTO_LIBRARY)}).checkpoint(a.props.rejectOnUnmount())["catch"](X["default"].Unmount,E["default"].noop)["catch"](X["default"].MediaDragDropError,function(e){if(a.props.mediaCollection.length)throw e;a.props.onDropText(e.src)}),e.target&&e.target.value&&(e.target.value="")},a.onRemoveThumb=function(e,t){t.stopPropagation(),t.preventDefault();var o=a.props.mediaCollection.getBefore(e)||a.props.mediaCollection.getAfter(e);a.props.mediaCollection.remove(e),a.setState({activeMedia:o})},a.onCaptionChange=function(e){var t=a.state.activeMedia;if(t){var o=a.props.mediaCollection.indexOf(a.state.activeMedia);t.caption=e,0===o&&""===e&&a.initCaptionUsed&&(a.initCaptionUsed=!1),a.setState({})}},a.onPaste=function(e){e.preventDefault(),e.stopPropagation();var t=new Y["default"](e.clipboardData);t.hasFiles()&&a.onFiles(t,!0)},a.onFiles=function(e){var t=E["default"].filter(e.getFiles(),function(e){var t=(0,Z.typeFromMimetype)(e.type);return"image"===t||"video"===t});a.props.mediaCollection.processFiles(t,a.props.chat,Se.MEDIA_PICKER_ORIGIN_TYPE.PAST)},a.setRefCaptionInput=function(e){a.state.activeMedia&&!e||(a.refCaptionInput=e)},a.getMedia=function(e){var t=void 0,o=void 0;switch(e.type){case we:case Ne:t||(t=_["default"].createElement(O["default"],{mimeType:e.mimetype,url:e.fullPreview,isGif:e.isGif,size:e.fullPreviewSize,processing:e.state===Ae,preview:e.preview})),o=_["default"].createElement("div",{className:"media-caption"},_["default"].createElement(be["default"],{ref:a.setRefCaptionInput,value:e.caption,placeholder:l10n.t("add_a_caption"),maxLength:G["default"].MAX_CAPTION_LENGTH,onEnter:a.onSend,onChange:a.onCaptionChange,onFiles:a.onFiles,chat:a.props.chat,showRemaining:!0,spellCheck:!0,multiline:!0,supportsEmoji:!0}));break;case Pe:t=_["default"].createElement(T["default"],{mimeType:e.mimetype,url:e.fullPreview});break;case Te:switch(le["default"].previewType(e.mimetype)){case"pdf":t=_["default"].createElement(L["default"],{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,pdfPages:e.pdfPages,mimeType:e.mimetype,filename:e.filename});break;case"msoffice":t=_["default"].createElement(I["default"],{fullPreview:e.fullPreview,fullPreviewSize:e.fullPreviewSize,mimeType:e.mimetype,filename:e.filename});break;default:t=_["default"].createElement(A["default"],{mimeType:e.mimetype,filename:e.filename})}}return _["default"].createElement("div",{className:"media-body-container",key:e.id},t,o)},a.getThumbs=function(e){return e.map(function(e,t){return _["default"].createElement(w["default"],{key:"media-"+e.id,active:e===a.state.activeMedia,attachMedia:e,onClick:a.onSelectThumb.bind(null,e),onClose:a.onRemoveThumb.bind(null,e)})})},a.transition="media-scale",a.disableTransistions=!1,a.initCaptionUsed=!1,a.state={activeMedia:null,isDragging:!1},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.props.listeners.add(window,"drop",this.onWindowDrop);var t=this.props.mediaCollection,a=t.getPreviewableMedias();!this.state.activeMedia&&a.length>0&&(this.disableTransistions=!0,this.setState({activeMedia:a[0]},function(){e.disableTransistions=!1}))}},{key:"componentDidMount",value:function(){var e=this.props,t=e.mediaCollection,a=e.listeners;a.add(t,"add remove reset"),a.add(t,"change:state change:previewable",this.onMediaProcessUpdate),a.add(t,"max_upload_limit",this.showIgnoredToast),this.props.mediaCollection.mediaPickerStatsLogger.resumeTimer()}},{key:"componentWillUpdate",value:function(e,t){var a=t.activeMedia,o=this.state.activeMedia;return o&&a&&o!==a?void(this.props.mediaCollection.indexOf(a)>this.props.mediaCollection.indexOf(o)?this.transition="media-slide-forward":this.transition="media-slide-back"):void(this.transition="media-scale")}},{key:"componentDidUpdate",value:function(e,t){var a=this;!t.activeMedia&&this.state.activeMedia&&this.refCaptionInput?this.props.listeners.uiIdle(function(){a.refCaptionInput&&a.refCaptionInput.restoreFocus()}):!b["default"].findDOMNode(this).contains(document.activeElement)&&this.refs.sendButton&&ee["default"].focus(this.refs.sendButton)}},{key:"componentWillUnmount",value:function(){this.props.mediaCollection.mediaPickerStatsLogger.pauseTimer()}},{key:"render",value:function(){var e=void 0,t=void 0,a=void 0,o=0,n=!0,r=this.props.mediaCollection.getPreviewableMedias();r.length>G["default"].MAX_FILES&&(r=r.slice(0,G["default"].MAX_FILES)),this.props.mediaCollection.canSend()?this.state.activeMedia?e=this.getMedia(this.state.activeMedia):0===r.length&&this.props.mediaCollection.errorMsgs&&(e=_["default"].createElement("div",{className:"invalid-media-container",key:"pending"},_["default"].createElement("div",{className:"invalid-media"},this.props.mediaCollection.errorMsgs))):(n=!1,e=_["default"].createElement(_e["default"],{key:"processing",color:"highlight"})),r.length>0&&(t=this.getThumbs(r),o=1===r.length?Re:Re+Ie(r.length),a=n?_["default"].createElement("div",{className:"drawer-controls",tabIndex:"-1",ref:"sendButton",onKeyPress:function(e){return e.preventDefault()}},_["default"].createElement(me["default"],{large:!0,onClick:this.onSend},_["default"].createElement(Me["default"],{name:"send-light",directional:!0}))):null);var i=this.state.isDragging?_["default"].createElement("div",{key:"container",className:"drag-drop"},_["default"].createElement("div",{className:"stitching"},l10n.t("drag_media_here"))):null,l=r.length<G["default"].MAX_FILES?_["default"].createElement("div",{key:"media-more",className:"media-thumb btn-add-media",onClick:this.onAddFileClick},_["default"].createElement("div",{role:"button",className:"btn-fill"},_["default"].createElement(Me["default"],{name:"add-alt"}),_["default"].createElement("div",{className:"btn-add-media-text"},l10n.t("add_media")))):null,s={enter:this.onEnter,left:this.onArrowLeft,right:this.onArrowRight},u="*"===le["default"].DOC_MIMES?"*":[G["default"].IMAGE_MIMES,G["default"].VIDEO_MIMES,le["default"].DOC_MIMES].join();return _["default"].createElement(oe["default"],{handlers:s},_["default"].createElement(H["default"],{key:"attach-image-modal",ref:"container",className:"drawer-media",variant:"noheader",onDrop:this.onDrop,onDragChange:this.onDragChange},_["default"].createElement(Q["default"],{title:l10n.t("web_preview_msg"),type:K.DRAWER_HEADER_TYPE.OFFSET,onCancel:this.props.onBack}),_["default"].createElement(z["default"],{tabIndex:"-1",overflow:"hidden",onPaste:this.onPaste},i,_["default"].createElement("div",{className:"media-body"},_["default"].createElement(pe["default"],{transitionName:this.disableTransistions?"noop":this.transition},e)),_["default"].createElement(pe["default"],{transitionAppear:!0,transitionName:this.disableTransistions?"noop-full-opacity":"thumb-scale",className:"media-collection"},t,l),_["default"].createElement(pe["default"],{
transitionAppear:!0,transitionName:this.disableTransistions?"noop-full-opacity":"btn",delay:this.disableTransistions?0:o},a),_["default"].createElement("input",{ref:"input",type:"file",accept:u,style:{display:"none"},onChange:this.onFilePick,multiple:!0}))))}}]),t}(_["default"].Component)))},7428:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7163),b=(o(v),a(23)),y=o(b),E=a(128),S=o(E),C=a(53),M=o(C),k=a(7007),w=o(k),N=a(172),T=o(N),P=a(7118),I=o(P),R=a(1),A=o(R),x=M["default"].TYPE,O=x.IMAGE,D=x.VIDEO,L=x.DOCUMENT,U=x.AUDIO,F=(0,w["default"])(S["default"].MIMETYPES,function(e){return e.msgType===L});t["default"]=(0,I["default"])((r=n=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"_renderBody",value:function(){var e=this.props.attachMedia,t=void 0,a=void 0,o=void 0;switch(e.type){case O:o={backgroundImage:"url("+e.preview+")"},t=_["default"].createElement("div",{className:"media-thumb-body",style:o});break;case D:o={backgroundImage:"url(data:image/jpeg;base64,"+e.preview+")"},t=_["default"].createElement("div",{className:"media-thumb-body",style:o});break;case U:t=_["default"].createElement("div",{className:"attach-media-audio-thumb"});break;case L:if(A["default"].log("media is",e)(),e.preview){var n={backgroundImage:"url("+e.preview+")"};F[e.mimetype]&&(a=F[e.mimetype].icon),a=(0,y["default"])(a,"icon-doc","icon-doc-thumb-filetype"),t=_["default"].createElement("div",{className:"media-thumb-body",style:n},_["default"].createElement("div",{className:a}));break}F[e.mimetype]&&(a=F[e.mimetype].icon);default:a=(0,y["default"])(a,"icon-doc"),t=_["default"].createElement("div",{className:"media-thumb-body"},_["default"].createElement("div",{className:a}))}return t}},{key:"render",value:function(){var e=this.props,t=e.onClick,a=e.onClose,o=(0,y["default"])("media-thumb","stagger-delay",{active:this.props.active});return _["default"].createElement("div",{className:o,onClick:t},_["default"].createElement("button",{className:"btn-delete",onClick:a},_["default"].createElement(T["default"],{name:"x-alt-light"})),this._renderBody())}}]),t}(_["default"].PureComponent),n.CONCERNS={attachMedia:["mimetype","preview","type"]},r))},7429:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(176),b=o(v),y=a(12),E=o(y),S=a(94),C=o(S),M=a(7135),k=o(M),w=a(7257),N=o(w),T=a(7120),P=o(T),I=a(7121),R=o(I),A=a(7122),x=o(A),O=a(7145),D=o(O),L=a(7126),U=a(7148),F=o(U),j=a(71),B=o(j),G=a(7593),V=o(G),Y=a(172),W=o(Y);t["default"]=(0,B["default"])(function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onBlockConfirm=function(e){e.setBlock(!0)["catch"](_["default"].noop),E["default"].closeModal()},o.onBlock=function(){var e=function(e){return Store.Contact.isFilteredContact(e)?Store.Blocklist.get(e.id)?l10n.t("participant_already_blocked"):!0:!1};E["default"].openModal(m["default"].createElement(N["default"],{title:l10n.t("add_blocked_title"),filter:e,onCancel:E["default"].closeModal.bind(E["default"]),onSelect:_["default"].once(o.onBlockConfirm)}))},o.onUnblockConfirm=function(e){e.setBlock(!1)["catch"](_["default"].noop),E["default"].closeModal()},o.onUnblockCancel=function(){E["default"].closeModal()},o.onUnblock=function(e,t){E["default"].openModal(m["default"].createElement(C["default"],{okText:l10n.t("unblock_button"),onOK:o.onUnblockConfirm.bind(o,t),cancelText:l10n.t("web_cancel"),onCancel:o.onUnblockCancel},l10n.t("unblock_confirmation",{contact:t.formattedName})))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(Store.Blocklist,"add remove")}},{key:"render",value:function(){var e=this,t=void 0,a=void 0;if(Store.Blocklist.length>0){var o=Store.Blocklist.map(function(t){return m["default"].createElement(k["default"],{contact:t.contact,key:t.contact.id,onClick:e.onUnblock,onDelete:e.onUnblock})});t=m["default"].createElement("div",{className:V["default"].list,"data-list-scroll-container":!0},m["default"].createElement(F["default"],{data:o,extraItems:4})),a=m["default"].createElement("div",{"data-a8n":b["default"].key("blocked-description"),className:V["default"].hint},l10n.t("add_blocked_description"))}else t=m["default"].createElement(L.Blocked,null);return m["default"].createElement(P["default"],{onCancel:this.props.onClose},m["default"].createElement(x["default"],{title:l10n.t("blocked_flow_title"),onBack:this.props.onClose,type:A.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement("div",{className:V["default"].button},m["default"].createElement(D["default"],{onClick:this.onBlock,a8n:"li-add-blocked",icon:m["default"].createElement(W["default"],{name:"add-user",directional:!0})},l10n.t("add_blocked_title"))),m["default"].createElement(R["default"],null,t,a))}}]),t}(m["default"].Component))},7430:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(62),v=o(_),b=a(12),y=n(b),E=a(7135),S=n(E),C=a(7123),M=n(C),k=a(7120),w=n(k),N=a(7121),T=n(N),P=a(7122),I=n(P),R=a(7145),A=n(R),x=a(7151),O=n(x),D=a(47),L=n(D),U=a(7148),F=n(U),j=a(71),B=n(j),G=a(7171),V=n(G),Y=a(7118),W=n(Y),H=a(487),q=a(72),z=n(q),K=a(172),Q=n(K),J=a(7133),X=n(J),Z=a(7594),$=n(Z),ee=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.onParticipantClick=function(e,t){Store.Conn.me!==t.id&&Store.Chat.find(t.id).then(function(e){y["default"].openChatFromUnread(e).then(function(t){t&&y["default"].focusChatTextInput(e)})})},o.onClose=function(){o.props.onClose?o.props.onClose():o.context.uim.uie.requestDismiss()},o.onDelete=function(){y["default"].deleteOrExitChat((0,H.unproxy)(o.props.chat))},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.chat.groupMetadata;this.props.listeners.add(e.participants,"add remove sort reset")}},{key:"render",value:function(){var e=this.props.chat,t=e.groupMetadata,a=this.onParticipantClick,o=t.participants.map(function(e){var t=Store.Contact.get(e.id)||Store.Contact.add({id:e.id});return g["default"].createElement(S["default"],{contact:t,theme:"drawer-list",admin:!!e.isAdmin,onClick:a,key:e.id})}),n=null;if(this.props.onMediaGallery){var r=g["default"].createElement(Q["default"],{name:"chevron-right-alt",directional:!0}),i=L["default"].supportsFeature(L["default"].F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");n=g["default"].createElement(O["default"],{title:i,titleOnClick:this.props.onMediaGallery,subtitle:r,theme:"padding"},g["default"].createElement(V["default"],{chat:(0,H.unproxy)(e),mediaMsgs:e.getMediaMsgs()}))}var l=null,s=g["default"].createElement(X["default"],{theme:"section-title"},l10n.n(o.length)),u=o.length?g["default"].createElement(O["default"],{title:l10n.t("web_recipients_title"),subtitle:s,"data-list-scroll-offset":!0},g["default"].createElement(F["default"],{data:o,height:72,extraItems:4})):null,c=void 0;e.canDelete()&&(c=g["default"].createElement(O["default"],null,g["default"].createElement(A["default"],{icon:g["default"].createElement(Q["default"],{name:"delete-danger"}),color:"danger",theme:"list-aligned",a8n:"li-delete-broadcast",onClick:this.onDelete},l10n.t("web_delete_list"))));var d=void 0;e.groupMetadata.creation?(d=v.timeStr(e.groupMetadata.creation),d=g["default"].createElement(X["default"],{theme:"small",block:!0},l10n.t("web_group_creation_time",{when:d}))):d=null;var f=null,p=null;return(l||f)&&(p=g["default"].createElement(O["default"],null,l,f)),g["default"].createElement(w["default"],{key:"contact-info-modal",variant:"panel",onCancel:this.onClose},g["default"].createElement(I["default"],{type:P.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose},g["default"].createElement(X["default"],{theme:"title",block:!0},l10n.t("broadcast_list_info")),d),g["default"].createElement(T["default"],null,g["default"].createElement("div",{className:$["default"].body,"data-list-scroll-container":!0},g["default"].createElement("div",{className:$["default"].photo},g["default"].createElement(M["default"],{id:e.id,size:M["default"].Size.LARGE})),n,p,u,c)))}}]),t}(g["default"].Component);ee.contextTypes={uim:g["default"].PropTypes.instanceOf(z["default"])},ee.CONCERNS={chat:["id","groupMetadata"],contact:["plaintextDisabled"]},t["default"]=(0,B["default"])((0,W["default"])(ee))},7431:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(176),_=o(g),v=a(484),b=o(v),y=a(12),E=o(y),S=a(47),C=o(S),M=a(7142),k=o(M),w=a(7119),N=o(w),T=a(94),P=o(T),I=a(7595),R=o(I),A=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={keepStarred:!0},o.onCancel=function(){E["default"].closeModal()},o.onClear=function(){var e=o.props.chat;e.pendingAction++,e.sendClear(C["default"].supportsFeature(C["default"].F.STARRED)&&C["default"].supportsFeature(C["default"].F.CHAT_CLEAR_STARRED)&&o.state.keepStarred)["finally"](function(){e.pendingAction--}),E["default"].closeModal()},o.onToggleStarred=function(){o.setState({keepStarred:!o.state.keepStarred})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"getText",value:function(){var e=this.props.chat;switch(e.kind){case b["default"].KIND.GROUP:return l10n.t("clear_chat_group",{name:e.title()});case b["default"].KIND.CHAT:return l10n.t("clear_chat_chat",{name:e.title()});case b["default"].KIND.BROADCAST:return l10n.t("clear_chat_broadcast");default:return""}}},{key:"render",value:function(){var e=void 0;return C["default"].supportsFeature(C["default"].F.STARRED)&&C["default"].supportsFeature(C["default"].F.CHAT_CLEAR_STARRED)&&(e=m["default"].createElement("div",{className:R["default"].section,onClick:this.onToggleStarred},m["default"].createElement("div",{"data-a8n":_["default"].key("menu-icon-clear-chat"),className:R["default"].control},m["default"].createElement(k["default"],{onChange:this.onToggleStarred,checked:this.state.keepStarred})),m["default"].createElement("div",{className:R["default"].label},l10n.t("keep_starred")))),m["default"].createElement(P["default"],{onOK:this.onClear,okText:l10n.t("clear_button"),onCancel:this.onCancel},m["default"].createElement("div",null,m["default"].createElement(N["default"],{text:this.getText()}),e))}}]),t}(m["default"].Component);t["default"]=A},7432:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(7219),b=o(v),y=a(7120),E=o(y),S=a(7121),C=o(S),M=a(7122),k=o(M),w=a(7126),N=a(177),T=o(N),P=a(173),I=o(P),R=a(265),A=o(R),x=a(7140),O=o(x),D=a(127),L=o(D),U=a(7141),F=o(U),j=a(7223),B=o(j),G=a(7237),V=o(G),Y=a(172),W=o(Y),H=a(7596),q=o(H);t["default"]=(0,L["default"])(function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={searchText:"",active:!1},o.setSearch=function(e){return o.search=e},o.onSearch=o.props.debounce(function(e){o.setState({searchText:e})},100),o.onFocusList=function(e){o.refs.list&&(e.preventDefault(),e.stopPropagation(),(0,P.shouldIndicateFocus)(),o.refs.list.focusFirst())},o.onSelectFirst=function(e){e.preventDefault(),e.stopPropagation();var t=_["default"].head(o.getFilteredContacts());t&&((0,P.shouldIndicateFocus)(),o.props.onClick(e,t))},o.onFocusSearch=function(){(0,P.shouldIndicateFocus)(),T["default"].focus(o.search)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.props.setTimeout(function(){e.setState({active:!0})},0)}},{key:"getFilteredContacts",value:function(){var e=Store.Contact.getFilteredContacts(),t=this.state.searchText;if(!t)return e;t=l10n.accentFold(t);var a=A["default"].numberSearch(t);return e.filter(function(e){return e.searchMatch(t,a)})}},{key:"render",value:function(){var e=void 0,t=null;if(this.state.active){var a=this.getFilteredContacts();if(e=0===a.length?m["default"].createElement(w.SearchContacts,null):m["default"].createElement(b["default"],{ref:"list",contacts:a,onFocusSearch:this.onFocusSearch,onClick:this.props.onClick}),!this.state.searchText){var o=m["default"].createElement(V["default"],null,m["default"].createElement(W["default"],{name:"new-group",directional:!0}));t=m["default"].createElement("div",{"data-list-scroll-offset":!0},m["default"].createElement("div",{className:q["default"].newGroupButton},m["default"].createElement(F["default"],{image:o,primary:l10n.t("web_menuitem_groupchat"),onClick:this.props.onNewGroup}),m["default"].createElement(B["default"],null)))}}else e=null;var n={down:this.onFocusList,enter:this.onSelectFirst};return m["default"].createElement(E["default"],{key:"contact-modal",onCancel:this.props.onBack},m["default"].createElement(k["default"],{title:this.props.title,type:M.DRAWER_HEADER_TYPE.LARGE,onBack:this.props.onBack}),m["default"].createElement(I["default"],{handlers:n},m["default"].createElement(O["default"],{ref:this.setSearch,onSearch:this.onSearch,placeholder:l10n.t("search_contacts")})),m["default"].createElement(C["default"],{"data-list-scroll-container":!0},t,e))}}]),t}(m["default"].Component))},7433:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){switch(e){case"auto":return w["default"].t("business_vertical_automotive");case"beauty":return w["default"].t("business_vertical_beauty_spa_salon");case"apparel":return w["default"].t("business_vertical_clothing_apparel");case"edu":return w["default"].t("business_vertical_education");case"entertain":return w["default"].t("business_vertical_entertainment");case"event-plan":return w["default"].t("business_vertical_event_planning_service");case"finance":return w["default"].t("business_vertical_finance_banking");case"grocery":return w["default"].t("business_vertical_food_grocery");case"govt":return w["default"].t("business_vertical_public_government_service");case"hotel":return w["default"].t("business_vertical_hotel_lodging");case"health":return w["default"].t("business_vertical_medical_health");case"nonprofit":return w["default"].t("business_vertical_non_profit");case"prof-services":return w["default"].t("business_vertical_professional_services");case"retail":return w["default"].t("business_vertical_shopping_retail");case"travel":return w["default"].t("business_vertical_travel_transportation");case"restaurant":return w["default"].t("business_vertical_restaurant");default:return w["default"].t("business_vertical_other")}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=o(r),l=a(2),s=o(l),u=a(4),c=o(u),d=a(7),f=o(d),p=a(6),h=o(p),m=a(3),g=o(m),_=a(23),v=o(_),b=a(10),y=o(b),E=a(14),S=o(E),C=a(7119),M=o(C),k=a(93),w=o(k),N=a(1),T=o(N),P=a(485),I=o(P),R=a(175),A=o(R),x=a(7118),O=o(x),D=a(172),L=o(D),U=a(7597),F=o(U),j=function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.state={businessProfileLoading:!0},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.props.contact.queryBusinessProfile().checkpoint(this.props.rejectOnUnmount()).then(function(t){e.businessProfile=t,e.setState({businessProfileLoading:!1})})["catch"](S["default"].Unmount,y["default"].noop)["catch"](function(e){T["default"].log("BusinessProfile:queryBusinessProfile failed")(),T["default"].log(e)()})}},{key:"render",value:function(){var e=this.props.contact,t=null;t=e.isVerified?g["default"].createElement(B,{icon:"psa-verified",className:(0,v["default"])(F["default"].businessMarker,F["default"].businessMarkerVerified)},w["default"].t("verified_business")):g["default"].createElement(B,{icon:"psa-unverified",className:(0,v["default"])(F["default"].businessMarker,F["default"].businessMarkerUnverified)},w["default"].t("unverified_business"));var a=void 0,o=void 0,r=void 0,i=void 0,l=void 0;if(this.state.businessProfileLoading)a=g["default"].createElement("div",{className:F["default"].contactBusinessInfoSpinner},g["default"].createElement(A["default"],{size:20,stroke:5}));else if(this.businessProfile){var s=this.businessProfile;o=s.vertical_canonical?g["default"].createElement(B,{icon:"business-tag"},g["default"].createElement(M["default"],{selectable:!0,direction:"auto",text:n(s.vertical_canonical)})):null,r=s.description?g["default"].createElement(B,{icon:"business-info"},g["default"].createElement(M["default"],{selectable:!0,direction:"auto",text:s.description})):null,i=s.address?g["default"].createElement(B,{icon:"business-location"},g["default"].createElement(M["default"],{selectable:!0,direction:"auto",text:s.address})):null;var u=null;s.website&&y["default"].isArray(s.website)&&s.website.length&&(u=s.website.map(function(e,t){var a=encodeURIComponent(e),o="https://l.wl.co/l?u="+a,n=g["default"].createElement(M["default"],{selectable:!0,direction:"auto",text:e}),r=g["default"].createElement("a",{href:o,target:"_blank",rel:"noopener noreferrer"},n);return g["default"].createElement("div",{key:t},r)}));var c=void 0;if(s.email){var d=g["default"].createElement(M["default"],{selectable:!0,direction:"auto",text:s.email}),f=g["default"].createElement("a",{href:"mailto:"+s.email,target:"_blank",rel:"noopener noreferrer"},d);c=g["default"].createElement("div",{dir:"auto"},f)}l=u||c?g["default"].createElement(B,{icon:"business-web"},u,c):null}return g["default"].createElement("div",{className:F["default"].contactBusinessInfo},t,a,i,o,r,l)}}]),t}(g["default"].Component);j.CONCERNS={contact:["isVerified"]};var B=function(e){return g["default"].createElement("div",{className:(0,v["default"])(F["default"].dataRow,e.className)},g["default"].createElement("div",{className:F["default"].dataRowIcon},g["default"].createElement(L["default"],{name:e.icon})),g["default"].createElement("div",{className:F["default"].dataRowText},e.children))};t["default"]=(0,I["default"])((0,O["default"])(j))},7434:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(12),E=o(y),S=a(7155),C=o(S),M=a(7151),k=o(M),w=a(14),N=o(w),T=a(7136),P=o(T),I=a(7133),R=o(I),A=a(71),x=o(A),O=a(485),D=o(O),L=a(7118),U=o(L);t["default"]=(0,D["default"])((0,x["default"])((0,U["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.onClick=function(e,t){E["default"].openChatFromUnread(t).then(function(e){e&&E["default"].focusChatTextInput(t)}),o.props.onClose()},o.keyForRowAtIndexPath=function(e){return o.props.contact.commonGroups.at(e.row).id},o.itemForRowAtIndexPath=function(e){var t=o.props.contact.commonGroups.at(e.row);return _["default"].createElement(C["default"],{chat:t,theme:"drawer-list",contact:t.contact,mode:S.Mode.INFO,onClick:o.onClick,key:t.id})},o.numberOfRowsInSection=function(e){return o.props.contact.commonGroups.length},o.numberOfSections=function(){return 1},o.sectionForSection=function(e){return null},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){var e=this;this.props.contact.findCommonGroups().checkpoint(this.props.rejectOnUnmount()).then(function(t){e.props.listeners.add(e.props.contact.commonGroups,"add remove"),t&&e.setState({})})["catch"](N["default"].Unmount,b["default"].noop)["catch"](N["default"].WapDrop,b["default"].noop)["catch"](b["default"].noop)}},{key:"render",value:function(){var e=this.props.contact.commonGroups;if(!e||!e.length)return null;var t=_["default"].createElement(R["default"],{theme:"section-title"},l10n.n(e.length));return _["default"].createElement(k["default"],{title:l10n.t("web_groups_participation_you_and_name"),subtitle:t,"data-list-scroll-offset":!0},_["default"].createElement(P["default"],{className:"drawer-section-body",keyForRowAtIndexPath:this.keyForRowAtIndexPath,itemForRowAtIndexPath:this.itemForRowAtIndexPath,numberOfSections:this.numberOfSections,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,extraItems:4}))}}]),t}(_["default"].Component),n.CONCERNS={contact:["commonGroups"]},r))))},7435:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7433),_=o(g),v=a(12),b=o(v),y=a(7434),E=o(y),S=a(94),C=o(S),M=a(7256),k=o(M),w=a(7123),N=o(w),T=a(7120),P=o(T),I=a(7121),R=o(I),A=a(7122),x=o(A),O=a(7145),D=o(O),L=a(7151),U=o(L),F=a(7119),j=o(F),B=a(47),G=o(B),V=a(71),Y=o(V),W=a(1),H=o(W),q=a(7171),z=o(q),K=a(7229),Q=o(K),J=a(7264),X=o(J),Z=a(485),$=o(Z),ee=a(7187),te=o(ee),ae=a(39),oe=a(7118),ne=o(oe),re=a(72),ie=o(re),le=a(7195),se=o(le),ue=a(32),ce=o(ue),de=a(7147),fe=o(de),pe=a(7143),he=o(pe),me=a(172),ge=o(me),_e=a(7598),ve=o(_e),be=a(7133),ye=o(be),Ee=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a._init=function(){G["default"].supportsFeature(G["default"].F.QUERY_IDENTITY)&&a.props.contact.queryIdentity()["catch"](function(e){H["default"].error("contactInfoDrawer:queryIdentity error: "+e)()})},a.onBlocklistChange=function(){a.state.contactIsBlocked!==!!Store.Blocklist.get(a.props.contact.id)&&a.setState({contactIsBlocked:!!Store.Blocklist.get(a.props.contact.id)})},a.onDeleteChat=function(){var e=Store.Chat.get(a.props.contact.id);b["default"].deleteOrExitChat(e)},a.onBlockContact=function(){b["default"].openModal(m["default"].createElement(k["default"],{contact:a.props.contact,onCancel:b["default"].closeModal.bind(b["default"]),blockContact:a.blockContact,reportSpam:a.reportSpam}))},a.onReportSpam=function(){b["default"].openModal(m["default"].createElement(C["default"],{onOK:a.reportSpam,okText:l10n.t("report_contact_spam"),onCancel:b["default"].closeModal.bind(b["default"]),cancelText:l10n.t("web_cancel")},m["default"].createElement(fe["default"],{id:"report_spam_ack"})))},a.reportSpam=function(){var e=Store.Chat.get(a.props.contact.id);e.reportSpam(),b["default"].closeModal()},a.onUnblockContact=function(){var e=m["default"].createElement(he["default"],{contact:a.props.contact});b["default"].openModal(m["default"].createElement(C["default"],{okText:l10n.t("unblock_button"),onOK:a.unblockContact,cancelText:l10n.t("web_cancel"),onCancel:b["default"].closeModal.bind(b["default"])},m["default"].createElement(fe["default"],{id:"unblock_confirmation",params:{contact:e}})))},a.blockContact=function(){a.props.contact.setBlock(!0),b["default"].closeModal()},a.unblockContact=function(){a.props.contact.setBlock(!1),b["default"].closeModal()},a.onClose=function(){a.props.onClose?a.props.onClose():a.context.uim.uie.requestDismiss()},a.onViewPicture=function(e){if(a.canViewPicture){var t=e.target,o=function(e){e(t)};b["default"].openModalMedia(m["default"].createElement(X["default"],{contact:a.props.contact,profilePicThumb:a.props.contact.profilePicThumb,animateBorderRadius:!0,getZoomNode:o}),"profile-viewer")}},a.onDetailImageLoad=function(){a.canViewPicture=!0},a.canViewPicture=!1,a.state={contactIsBlocked:!!Store.Blocklist.get(e.contact.id)},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(Store.Blocklist,"add remove reset sync",this.onBlocklistChange),this.props.listeners.uiIdle(this._init)}},{key:"render",value:function(){var e=this.props.contact,t=void 0,a=m["default"].createElement(E["default"],{contact:this.props.contact,onClose:this.onClose}),o=Store.Chat.get(e.id);o&&o.canDelete()&&(t=m["default"].createElement(U["default"],null,m["default"].createElement(D["default"],{icon:m["default"].createElement(ge["default"],{name:"delete-danger"}),a8n:"li-delete-chat",color:"danger",onClick:this.onDeleteChat},l10n.t("delete_chat"))));var n=null;this.props.contact.canBlock()&&(n=this.state.contactIsBlocked?m["default"].createElement(U["default"],null,m["default"].createElement(D["default"],{a8n:"li-unblock",color:"success",icon:m["default"].createElement(ge["default"],{name:"settings-blocked-success",directional:!0}),onClick:this.onUnblockContact},l10n.t("unblock_contact"))):m["default"].createElement(U["default"],null,m["default"].createElement(D["default"],{a8n:"li-block",icon:m["default"].createElement(ge["default"],{name:"settings-blocked",directional:!0}),onClick:this.onBlockContact},l10n.t("block_contact"))));var r=m["default"].createElement(U["default"],null,m["default"].createElement(D["default"],{a8n:"li-report-spam",color:"danger",icon:m["default"].createElement(ge["default"],{name:"thumbs-down",directional:!0}),onClick:this.onReportSpam},l10n.t("report_spam"))),i=null;if(this.props.onMediaGallery&&o){var l=m["default"].createElement(ge["default"],{name:"chevron-right-alt",directional:!0}),s=G["default"].supportsFeature(G["default"].F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");i=m["default"].createElement(U["default"],{title:s,titleOnClick:this.props.onMediaGallery,subtitle:l,theme:"padding"},m["default"].createElement(z["default"],{chat:o,mediaMsgs:o.getMediaMsgs()}))}var u=null,c=o&&o.mute.canMute()?m["default"].createElement(Q["default"],{chat:o,mute:o.mute}):null,d=null;if(this.props.onStarred){var f=m["default"].createElement(ge["default"],{name:"chevron-right-alt",directional:!0});d=m["default"].createElement(te["default"],{side:f,onClick:this.props.onStarred,border:!0},m["default"].createElement(ye["default"],{theme:"title"},l10n.t("chat_starred_msgs")))}var p=null,h=o&&o.getReceivedVCardMsgs();if(G["default"].supportsFeature(G["default"].F.INDEX_RECEIVED_VCARD)&&h&&h.length){var g=m["default"].createElement(ge["default"],{name:"chevron-right-alt",directional:!0});p=m["default"].createElement(te["default"],{side:g,onClick:this.props.onContactCard},m["default"].createElement(ye["default"],{theme:"title"},l10n.t("contact_card",{_plural:h.length})))}var v=null,b=null;(c||d||p||v)&&(b=m["default"].createElement(U["default"],null,c,d,p,v));var y=this.props.status,S=Store.ServerProps.statusV2&&y.status?m["default"].createElement(te["default"],null,m["default"].createElement(ye["default"],{theme:"title"},m["default"].createElement(j["default"],{selectable:!0,direction:"auto",text:y.status}))):null,C=m["default"].createElement(te["default"],null,m["default"].createElement(ae.SelectableSpan,{dir:"auto",selectable:!0},m["default"].createElement(ye["default"],{theme:"title"},ce["default"].formattedUser(e.id)))),M=l10n.t("contact_info_status_phone"),k=l10n.t("contact_info_phone_number"),w=m["default"].createElement(U["default"],{title:Store.ServerProps.statusV2?M:k},S,C),T=o&&o.presence?m["default"].createElement(se["default"],{presence:o.presence,chatstate:o.presence.chatstate,location:"list"}):null,I=e.verified?m["default"].createElement(_["default"],{contact:e}):null;return m["default"].createElement(P["default"],{key:"contact-info-modal",variant:"panel"},m["default"].createElement(x["default"],{title:l10n.t("web_contact_info"),type:A.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),m["default"].createElement(R["default"],{"data-list-scroll-container":!0},m["default"].createElement("div",{className:ve["default"].body},m["default"].createElement(U["default"],{theme:"padding-large"},m["default"].createElement("div",{className:ve["default"].avatar},m["default"].createElement(N["default"],{id:e.id,size:N["default"].Size.LARGE,loader:!0,onLoad:this.onDetailImageLoad,onClick:this.onViewPicture,quality:N["default"].Quality.HIGH})),m["default"].createElement(ye["default"],{theme:"large"},m["default"].createElement(he["default"],{contact:e})),m["default"].createElement("div",{className:ve["default"].nameSecondary},m["default"].createElement(ye["default"],{theme:"muted"},T)),I),i,b,w,u,a,n,r,t)))}}]),t}(m["default"].Component);Ee.contextTypes={uim:m["default"].PropTypes.instanceOf(ie["default"])},Ee.CONCERNS={contact:["id","plaintextDisabled","formattedName","formattedUser","formattedShortName","profilePicThumb","verified","commonGroups"],status:["status"]},t["default"]=(0,$["default"])((0,Y["default"])((0,ne["default"])(Ee)))},7436:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(7435);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o(n)["default"]}})},7437:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(8),E=o(y),S=a(7316),C=o(S),M=a(7120),k=o(M),w=a(7121),N=o(w),T=a(7122),P=o(T),I=a(7151),R=o(I),A=a(14),x=o(A),O=a(71),D=o(O),L=a(53),U=o(L),F=a(7166),j=(o(F),a(108)),B=(o(j),a(485)),G=o(B),V=a(175),Y=o(V),W=a(7118),H=o(W),q=a(172),z=o(q),K=a(263),Q=o(K),J=a(72),X=o(J),Z=a(7176),$=o(Z),ee=a(174),te=a(7228),ae=o(te),oe=a(7599),ne=o(oe),re=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={msgInfo:void 0,unimplemented:!1},o.wrapper=null,o.isMsgVisible=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return e===o.props.msg.id&&(t?!0:o.getMsgComponent())},o.onClose=function(){o.context.uim.uie.requestDismiss()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this;Store.MsgInfo.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then(function(t){e.setState({msgInfo:t}),e.props.listeners.add(t,"change:playedRemaining change:readRemaining change:deliveryRemaining")})["catch"](x["default"].Unmount,_["default"].noop)["catch"](function(){e.setState({unimplemented:!0}),b["default"].openToast(m["default"].createElement(Q["default"],{msg:l10n.t("msg_info_failed"),id:(0,K.genId)("msg_info_failed")}))})}},{key:"componentDidMount",value:function(){
if(this.props.msg.type===U["default"].TYPE.IMAGE&&(this.refs.scrollable.scrollTop=this.refs.scrollable.scrollHeight),this.props.msg.isGif){var e=this.getMsgComponent();e.play()}}},{key:"getMsgComponent",value:function(){var e=this.wrapper;return e?e.getMsgComponentRef():void 0}},{key:"render",value:function(){var e=this.props.msg,t=this.state,a=t.msgInfo,o=t.unimplemented,n=void 0,r=void 0;if(a){var i=[],l=void 0,s=void 0,u=void 0;a.isPTT&&(r=l10n.t("message_info_seen"),l=a.played.head(),s=l&&l.t,u=m["default"].createElement("span",{className:ne["default"].icon},m["default"].createElement(z["default"],{name:"status-ptt-blue"})),i.push(m["default"].createElement(C["default"],{title:l10n.t("message_info_played"),t:s,icon:u,key:"played"}))),l=a.read.head(),s=l&&l.t,u=m["default"].createElement("span",{className:ne["default"].icon},m["default"].createElement(z["default"],{name:"status-dblcheck-ack"})),r=r||l10n.t("message_info_read"),i.push(m["default"].createElement(C["default"],{title:r,t:s,icon:u,key:"read"})),l=a.delivery.head(),s=l&&l.t,u=m["default"].createElement("span",{className:ne["default"].icon},m["default"].createElement(z["default"],{name:"status-dblcheck"})),i.push(m["default"].createElement(C["default"],{title:l10n.t("message_info_delivered"),t:s,icon:u,key:"delivery"})),n=m["default"].createElement(R["default"],{theme:"padding"},i)}var c=void 0;return a||o||(c=m["default"].createElement("div",{className:ne["default"].spinner,key:"spinner"},m["default"].createElement(Y["default"],{size:50,stroke:4}))),m["default"].createElement(k["default"],{key:"message-info-modal",variant:"panel",onCancel:this.onClose},m["default"].createElement(P["default"],{title:l10n.t("message_info"),type:T.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),m["default"].createElement(ae["default"],{ref:"scrollable",msg:e,chatPreference:Store.ChatPreference.get("defaultPreference")},m["default"].createElement($["default"],{msg:e,key:"star-"+e.star.toString(),ref:(0,ee.GetRef)("wrapper",this),displayType:E["default"].DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:Z.MsgPosition.END})),m["default"].createElement(N["default"],null,m["default"].createElement("div",{className:ne["default"].body},c,n)))}}]),t}(m["default"].Component);re.CONCERNS={msg:["id","star","type","isGif"]},re.contextTypes={uim:m["default"].PropTypes.instanceOf(X["default"])},t["default"]=(0,G["default"])((0,D["default"])((0,H["default"])(re)))},7438:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(3),r=o(n),i=a(12),l=o(i),s=a(178),u=o(s),c=a(7120),d=o(c),f=a(7122),p=o(f),h=a(7121),m=o(h),g=a(173),_=o(g),v=a(7204),b=o(v),y=a(266),E=o(y);t["default"]=function(e){var t=e.vcard,a=E["default"].parse(t);return r["default"].createElement(u["default"],{type:s.BoxModalType},r["default"].createElement(d["default"],{key:"vcard-modal",onCancel:function(){return l["default"].closeModal()}},r["default"].createElement(p["default"],{title:l10n.t("contact_viewer"),type:f.DRAWER_HEADER_TYPE.POPUP,onCancel:function(){return l["default"].closeModal()}}),r["default"].createElement(m["default"],null,r["default"].createElement(_["default"],null,r["default"].createElement(b["default"],{parsedVCard:a,thumbnail:E["default"].thumbnail(t)})))))}},7439:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(484),E=(o(y),a(12)),S=o(E),C=a(94),M=o(C),k=a(7119),w=o(k),N=a(1),T=o(N),P=a(7118),I=o(P);t["default"]=(0,I["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.getText=function(){var e=o.props.chat,t=e.title();return e.isGroup?e.isReadOnly?l10n.t("web_delete_group_dialog_title",{groupName:t}):l10n.t("web_exit_group_dialog_title",{groupName:t}):e.isUser?l10n.t("delete_chat_dialog_title",{name:t}):e.isBroadcast?l10n.t("delete_list_dialog_title"):void 0},o.getButton=function(){var e=o.props.chat;return e.isGroup?e.isReadOnly?l10n.t("web_delete"):l10n.t("web_exit"):e.isUser||e.isBroadcast?l10n.t("web_delete"):void 0},o.onCancel=function(){S["default"].closeModal();var e=o.props.onCancel;e&&b["default"].isFunction(e)&&e()},o.onDelete=function(){var e=o.props.chat,t=void 0;e.isGroup?t=e.isReadOnly?e.sendDelete():e.sendExit():e.isUser||e.isBroadcast?t=e.sendDelete():T["default"].error("deleteChatPopup:onDelete Unsupported chat type")(),b["default"].isFunction(o.props.onDeleteOrExit)&&t&&o.props.onDeleteOrExit(t),S["default"].closeModal()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"render",value:function(){return _["default"].createElement(M["default"],{onOK:this.onDelete,okText:this.getButton(),onCancel:this.onCancel},_["default"].createElement(w["default"],{text:this.getText()}))}}]),t}(_["default"].PureComponent),n.CONCERNS={chat:["isReadOnly","isGroup","isUser","isBroadcast"]},r))},7440:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(176),b=o(v),y=a(484),E=(o(y),a(7142)),S=o(E),C=a(12),M=o(C),k=a(173),w=o(k),N=a(93),T=o(N),P=a(178),I=o(P),R=a(53),A=(o(R),a(492)),x=o(A),O=a(7284),D=o(O),L=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={clearMedia:!0},o.onCancel=function(){var e=o.props.onPopupCancel;e()},o.onRevoke=function(){var e=o.props,t=e.chat,a=e.msgList,n=e.toastPosition,r=e.onCancel,i=e.onRevoke;M["default"].sendRevokeMsgs(t,a,o.state.clearMedia,null,n),i(),r&&r()},o.onDelete=function(){var e=o.props,t=e.chat,a=e.msgList,n=e.toastPosition,r=e.onCancel,i=e.onDelete;M["default"].sendDeleteMsgs(t,a,o.state.clearMedia,null,n),i(),r&&r()},o.onToggleClearMedia=function(){o.setState({clearMedia:!o.state.clearMedia})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=void 0,t=this.props,a=t.msgList,o=t.deletePrompt,n=t.revokePrompt;_["default"].some(a,function(e){return e.isMMS})&&(e=m["default"].createElement("div",{className:D["default"].container,onClick:this.onToggleClearMedia,key:0},m["default"].createElement("div",{"data-a8n":b["default"].key("menu-icon-revoke-message"),className:D["default"].control},m["default"].createElement(S["default"],{onChange:this.onToggleClearMedia,checked:this.state.clearMedia})),m["default"].createElement("div",{className:D["default"].label},T["default"].t("clear_media"))));var r=m["default"].createElement(x["default"],{type:"plain",onClick:this.onCancel,key:0},T["default"].t("web_cancel")),i=null,l=null,s=null,u=_["default"].noop,c=a.length,d=T["default"].t("delete_message_confirmation",{count:c,_plural:c});if(n&&(i=m["default"].createElement(x["default"],{a8n:b["default"].key("popup-controls-revoke"),type:"plain",onClick:this.onRevoke,key:1},T["default"].t("revoke_button")),u=this.onRevoke),o){var f=Store.ServerProps.edit?T["default"].t("delete_button"):T["default"].t("web_delete");l=m["default"].createElement(x["default"],{a8n:b["default"].key("popup-controls-delete"),type:n?"plain":"primary",onClick:this.onDelete,key:2},f),u=this.onDelete}var p={enter:u,escape:this.onCancel};return l&&(s=i?m["default"].createElement("div",{className:D["default"].buttons},m["default"].createElement("div",{className:D["default"].button},l),m["default"].createElement("div",{className:D["default"].button},r),m["default"].createElement("div",{className:D["default"].button},i)):[r,l]),m["default"].createElement(w["default"],{handlers:p},m["default"].createElement(I["default"],{title:d,actions:s,children:[e]}))}}]),t}(m["default"].Component);t["default"]=L},7441:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(48),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(176),_=o(g),v=a(7142),b=o(v),y=a(12),E=o(y),S=a(23),C=o(S),M=a(1),k=o(M),w=a(54),N=o(w),T=a(3),P=o(T),I=a(263),R=o(I),A=a(7133),x=o(A),O=a(7600),D=o(O),L={title:0,hour:1,day:24,week:168},U=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={notifications:Store.Mute.getGlobalNotifications(),sounds:Store.Mute.getGlobalSounds(),previews:Store.Mute.getGlobalPreviews(),dnd:L.title},o.onSounds=function(){var e=!o.state.sounds;o.setState({sounds:e}),Store.Mute.setGlobalSounds(e)},o.onNotifications=function(){var e=!o.state.notifications;o.setState({notifications:e}),Store.Mute.setGlobalNotifications(e)},o.onPreviews=function(){var e=!o.state.previews;o.setState({previews:e}),Store.Mute.setGlobalPreviews(e)},o.onDND=function(e){if(e.target&&e.target.value){var t=parseInt(e.target.value,10);if(0===t)return o.setState({dnd:L.title}),void Store.Mute.globalMute().unmute();o.setState({dnd:t});var a=(0,N["default"])().unix()+60*t*60;Store.Mute.globalMute().mute(a)}},o.onClose=function(){E["default"].closeModal()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillUnmount",value:function(){this.state.dnd!==L.title&&E["default"].openToast(P["default"].createElement(R["default"],{msg:this.globalMuteDurationLabel(this.state.dnd),id:(0,I.genId)()}))}},{key:"globalMuteDurationLabel",value:function(e){switch(this.state.dnd){case 1:return l10n.t("global_muted_1hour");case 24:return l10n.t("global_muted_1day");case 168:return l10n.t("global_muted_1week");default:return k["default"].log("DoNotDisturbSettings:globalMuteDurationLabel non standard global mute duration:"+e)(),l10n.t("global_muted")}}},{key:"render",value:function(){var e=[];if(window.Notification){e.push(P["default"].createElement("div",{className:D["default"].section,onClick:this.onNotifications,key:0},P["default"].createElement("div",{"data-a8n":_["default"].key("menu-icon-notifications"),className:D["default"].control},P["default"].createElement(b["default"],{onChange:this.onNotifications,checked:this.state.notifications})),P["default"].createElement("div",{"data-a8n":_["default"].key("option-desktop-notifications"),className:D["default"].label},l10n.t("option_desktop_notifications"))));var t=(0,C["default"])(D["default"].section,(0,r["default"])({},D["default"].disabled,!this.state.notifications));e.push(P["default"].createElement("div",{className:t,onClick:this.onPreviews,key:1},P["default"].createElement("div",{"data-a8n":_["default"].key("menu-icon-notifications"),className:D["default"].control},P["default"].createElement(b["default"],{onChange:this.onPreviews,checked:this.state.previews})),P["default"].createElement("div",{"data-a8n":_["default"].key("option-msg-previews"),className:D["default"].label},l10n.t("option_msg_previews"),P["default"].createElement(x["default"],{theme:"muted",block:!0},l10n.t("option_msg_previews_hint_text")))))}return P["default"].createElement("div",{className:D["default"].container},P["default"].createElement("div",{className:D["default"].section,onClick:this.onSounds},P["default"].createElement("div",{"data-a8n":_["default"].key("menu-icon-notifications"),className:D["default"].control},P["default"].createElement(b["default"],{onChange:this.onSounds,checked:this.state.sounds})),P["default"].createElement("div",{"data-a8n":_["default"].key("option-sounds"),className:D["default"].label},l10n.t("option_sounds"))),e,P["default"].createElement("div",{className:(0,C["default"])(D["default"].section,D["default"].sectionWide)},P["default"].createElement("div",{className:D["default"].select},P["default"].createElement("select",{"data-a8n":_["default"].key("alert-dnd-options"),value:this.state.dnd,onChange:this.onDND},P["default"].createElement("option",{value:L.title},l10n.t("option_select_mute")),P["default"].createElement("option",{value:L.hour},l10n.t("mute_1hour")),P["default"].createElement("option",{value:L.day},l10n.t("mute_1day")),P["default"].createElement("option",{value:L.week},l10n.t("mute_1week"))))))}}]),t}(T.Component);t["default"]=U},7442:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(12),_=o(g),v=a(94),b=o(v),y=a(8),E=o(y),S=a(72),C=o(S),M=a(73),k=o(M),w=a(32),N=o(w),T=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onVerificationClick=function(){_["default"].closeModal(),_["default"].verificationDrawer(o.props.jid)},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=void 0,t=void 0,a=null,o=null,n=_["default"].closeModal.bind(_["default"]),r=l10n.t("web_ok");switch(this.props.e2eSubtype){case"info_encrypted":N["default"].isGroup(this.props.chatId)?e=l10n.t("web_group_info_encrypted_description"):N["default"].isBroadcast(this.props.chatId)&&(e=l10n.t("web_broadcast_info_encrypted_description")),t=E["default"].E2E_FAQ_LINK;break;case"info_unencrypted":e=N["default"].isGroup(this.props.chatId)?l10n.t("web_group_info_unencrypted_description"):N["default"].isBroadcast(this.props.chatId)?l10n.t("web_broadcast_info_unencrypted_description"):l10n.t("web_contact_info_unencrypted_description",{contact:this.props.unencryptedContact}),t=E["default"].E2E_FAQ_LINK;break;case"identity":var i=Store.Contact.get(this.props.jid),l=i?i.formattedName:"";e=l10n.t("web_security_code_change_description",{name:l}),a=n,o=r,n=this.onVerificationClick,r=l10n.t("web_verify_button"),t=E["default"].CODE_CHANGE_FAQ_LINK;break;case"encrypt":default:e=N["default"].isGroup(this.props.chatId)?l10n.t("web_group_encryption_state_change_description"):N["default"].isBroadcast(this.props.chatId)?l10n.t("web_broadcast_encryption_state_change_description"):l10n.t("web_individual_chat_encryption_state_change_description"),t=E["default"].SECURITY_LINK}var s=k["default"].build(t,{lg:Store.Conn.lg,lc:Store.Conn.lc}),u=m["default"].createElement("a",{target:"_blank",href:s},l10n.t("learn_more"));return m["default"].createElement(b["default"],{onOK:n,okText:r,onCancel:a,cancelText:o},e,"",u)}}]),t}(m["default"].Component);T.contextTypes={uim:m["default"].PropTypes.instanceOf(C["default"])},t["default"]=T},7443:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(46),b=a(12),y=o(b),E=a(7208),S=a(93),C=o(S),M=a(262),k=o(M),w=a(7134),N=o(w),T=a(7179),P=o(T),I=a(7344),R=o(I),A=a(7118),x=o(A),O=a(487),D=a(175),L=o(D),U=a(7196),F=o(U),j=a(7605),B=o(j),G=10,V=10,Y=240;t["default"]=(0,x["default"])((r=n=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.handleFullscreen=function(){var e=o.props.onFullscreen;e&&e(o.getCurrentTime())},o.handleMissingMedia=function(){o.props.onClose(),y["default"].openModal(_["default"].createElement(N["default"],{msg:o.props.msg}))},o.handleUnsupportedMedia=function(){o.props.onClose(),y["default"].openModal(_["default"].createElement(P["default"],{msg:(0,O.unproxy)(o.props.msg)}))},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidUpdate",value:function(){switch(this.props.mediaData.mediaStage){case k["default"].STAGE.ERROR_MISSING:this.handleMissingMedia();break;case k["default"].STAGE.ERROR_UNSUPPORTED:this.handleUnsupportedMedia()}}},{key:"getCurrentTime",value:function(){var e=(0,v.findDOMNode)(this.refs.player);return e.currentTime}},{key:"getInitialMediaStyle",value:function(){var e=this.props,t=e.width,a=e.left,o=e.bottom,n=t?t:Y,r=a?a:G,i=o?o:V;return{width:n,height:n/this.props.mediaData.aspectRatio,left:r,bottom:i}}},{key:"renderMedia",value:function(){var e=this.props;if(e.mediaData.mediaStage===k["default"].STAGE.RESOLVED||(0,E.checkStreamingSupported)())return _["default"].createElement(F["default"],{msg:e.msg,mediaData:e.mediaData,onDoubleClick:this.handleFullscreen,className:B["default"].videoTag,ref:"player",startTime:e.startTime,key:"floating-media",controls:!0,autoPlay:!0},C["default"].t("video_playback_not_supported"));var t=e.mediaData.preview;return t?_["default"].createElement("div",{key:"floating-media"},_["default"].createElement(L["default"],{size:50,stroke:3}),_["default"].createElement("img",{src:t.url(),draggable:"false"})):null}},{key:"render",value:function(){var e=_["default"].createElement("button",{className:B["default"].videoFloaterClose,onClick:this.props.onClose,key:"close-btn"},C["default"].t("web_close")),t=void 0;t=this.props.mediaData.mediaStage!==k["default"].STAGE.RESOLVED?_["default"].createElement("div",{className:B["default"].videoFloaterMedia,key:"floating-media-container"},this.renderMedia()):this.renderMedia();var a=[e,t],o={x:G,y:V};return _["default"].createElement(R["default"],{children:a,aspectRatio:this.props.mediaData.aspectRatio,margin:o,minWidth:Y,className:B["default"].videoFloater,onMove:this.props.onMove,onResize:this.props.onResize,width:this.props.width,left:this.props.left,bottom:this.props.bottom})}}]),t}(g.Component),n.CONCERNS={msg:["id"],mediaData:["mediaStage","aspectRatio","preview"]},r))},7444:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(10),v=n(_),b=a(176),y=n(b),E=a(12),S=n(E),C=a(484),M=(n(C),a(62)),k=o(M),w=a(7136),N=n(w),T=a(7171),P=n(T),I=a(7120),R=n(I),A=a(7121),x=n(A),O=a(7122),D=n(O),L=a(7151),U=n(L),F=a(7145),j=n(F),B=a(7189),G=n(B),V=a(7119),Y=n(V),W=a(7127),H=n(W),q=a(94),z=n(q),K=a(7410),Q=n(K),J=a(263),X=n(J),Z=a(14),$=n(Z),ee=a(265),te=n(ee),ae=a(7161),oe=n(ae),ne=a(7137),re=n(ne),ie=a(261),le=n(ie),se=a(72),ue=n(se),ce=a(7229),de=n(ce),fe=a(47),pe=n(fe),he=a(7153),me=(n(he),a(71)),ge=n(me),_e=a(7118),ve=n(_e),be=a(487),ye=a(172),Ee=n(ye),Se=a(7147),Ce=n(Se),Me=a(7237),ke=n(Me),we=a(7141),Ne=n(we),Te=a(7321),Pe=n(Te),Ie=a(7187),Re=n(Ie),Ae=a(7133),xe=n(Ae),Oe=a(7606),De=n(Oe),Le=(0,J.genId)("max_participant_toast"),Ue=function(e){function t(e){(0,s["default"])(this,t);var a=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).call(this,e));return a.onImageSet=function(e,t){var o=Store.ProfilePicThumb.get(a.props.chat.id);a.setState({pendingPhoto:!0});var n=void 0;n=e&&t?o.setPicture(e,t):o.deletePicture(),n.then(function(){a.setState({pendingPhoto:!1})})["catch"]($["default"].Unmount,v["default"].noop)},a.onParticipantClick=function(e,t){Store.Conn.me!==t.id&&Store.Chat.find(t.id).then(function(e){S["default"].openChatFromUnread(e).then(function(t){t&&S["default"].focusChatTextInput(e)})})},a.menuEnabled=function(e){var t=a.props.groupMetadata.participants,o=t.get(e.id);return o&&(t.canPromote(o)||t.canRemove(o)||t.canVerifyIdentity(o))},a.onParticipantMenu=function(e,t){var o=a.props.groupMetadata.participants,n=o.get(t.id);if(a.menuEnabled(t)){var r=[];if(o.canPromote(n)){var i=a.confirmParticipantPromote.bind(a,n);r.push(g["default"].createElement(H["default"],{a8n:"mi-grp-promote-admin",key:"promote",action:i},l10n.t("menuitem_make_group_admin")))}if(o.canRemove(n)){var l=a.confirmParticipantRemove.bind(a,n);r.push(g["default"].createElement(H["default"],{a8n:"mi-grp-remove-participant",key:"remove",action:l,shortcut:"d"},l10n.t("menuitem_remove")))}e.event&&e.event.persist(),a.setState({contextMenu:{contactId:t.id,menu:r,anchor:e.anchor,event:e.event}})}},a.contextClose=function(){a.setState({contextMenu:null})},a.confirmParticipantRemove=function(e){var t=a.onParticipantRemove.bind(a,e),o=l10n.t("confirm_remove_group_participant",{participant:e.contact.formattedName,subject:a.props.contact.name});S["default"].openModal(g["default"].createElement(z["default"],{onOK:t,okText:l10n.t("remove"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},g["default"].createElement(Y["default"],{text:o})))},a.onParticipantRemove=function(e){e.contact.pendingAction++,a.props.groupMetadata.participants.removeParticipant(e).then(function(){e.contact.pendingAction--}),S["default"].closeModal()},a.confirmParticipantPromote=function(e){var t=a.onParticipantPromote.bind(a,e),o=l10n.t("confirm_promote_group_participant",{participant:e.contact.formattedName,subject:a.props.contact.name});S["default"].openModal(g["default"].createElement(z["default"],{onOK:t,okText:l10n.t("menuitem_make_group_admin"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},g["default"].createElement(Y["default"],{text:o})))},a.onParticipantPromote=function(e){e.contact.pendingAction++,a.props.groupMetadata.participants.promoteParticipant(e).then(function(){e.contact.pendingAction--}),S["default"].closeModal()},a.onVerifyIdentity=function(e){a.props.onVerification(e.contact)},a.openAddGroupParticipantFlow=function(){if(a.props.groupMetadata.participants.length>=Store.ServerProps.maxParticipants){var e=l10n.t("action_group_create_failed_participant",{max:Store.ServerProps.maxParticipants});S["default"].openToast(g["default"].createElement(X["default"],{msg:e,id:Le}))}else{var t=g["default"].createElement(Q["default"],{chat:(0,be.unproxy)(a.props.chat),pushTransition:"none",popTransition:"none"});S["default"].openModal(t,"modal-flow")}},a.onClose=function(){a.props.onClose?a.props.onClose():a.context.uim.uie.requestDismiss()},a.onExitOrDeleteGroup=function(){S["default"].deleteOrExitChat(a.props.chat)},a.onSubjectChange=function(e){a.setState({name:e})},a.validateSubject=function(e){return!(!e||!e.trim())},a.onSetSubjectError=function(){S["default"].openModal(g["default"].createElement(z["default"],{onOK:S["default"].closeModal.bind(S["default"]),okText:l10n.t("web_ok")},l10n.t("action_group_subject_empty")))},a.onSetSubject=function(e){var t=a.props.chat,o=a.props.groupMetadata;if(o.canSetSubject()){var n=te["default"].emojify(a.state.name||"");if(n===a.props.contact.name)return a.setState({name:n});a.setState({pendingSubject:!0}),t.setSubject(n).then(function(){a.setState({name:a.props.contact.name,pendingSubject:!1})})["catch"]($["default"].Unmount,v["default"].noop)}},a.onCancelSubject=function(){a.setState({name:a.props.contact.name})},a.keyForRowAtIndexPath=function(e){var t=a.props.groupMetadata.participants;return t.at(e.row).id},a.itemForRowAtIndexPath=function(e){var t=a.props.groupMetadata.participants,o=t.at(e.row),n=o.contact,r=!!a.state.contextMenu&&n.id===a.state.contextMenu.contactId;return g["default"].createElement(Pe["default"],{contact:n,participant:o,key:o.id,onClick:a.onParticipantClick,contextEnabled:a.menuEnabled.bind(a,n),contextMenu:r,onContext:function(e){return a.onParticipantMenu(e,n)},showNotifyName:!0,waitIdle:!0})},a.numberOfRowsInSection=function(e){return a.props.groupMetadata.participants.length},a.numberOfSections=function(){return 1},a.sectionForSection=function(e){return null},a.onReportSpam=function(){S["default"].openModal(g["default"].createElement(z["default"],{onOK:a.reportSpam,okText:l10n.t("report_group_spam"),onCancel:S["default"].closeModal.bind(S["default"]),cancelText:l10n.t("web_cancel")},g["default"].createElement(Ce["default"],{id:"report_group_spam_ack"})))},a.reportSpam=function(){var e=a.props.chat;e.reportSpam(),S["default"].closeModal()},a.state={pendingSubject:!1,pendingPhoto:!1,contextMenu:null,name:e.contact.name},a}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.groupMetadata;this.props.listeners.add(t.participants,"add remove reset sort change:isAdmin",function(){e.forceUpdate()})}},{key:"render",value:function(){var e,t=this.props.chat,a=this.props.groupMetadata;t.canDelete()&&(e=g["default"].createElement(U["default"],null,g["default"].createElement(j["default"],{icon:g["default"].createElement(Ee["default"],{name:"exit",directional:!0}),a8n:"li-delete-group",theme:"list-aligned",color:"danger",onClick:this.onExitOrDeleteGroup},t.isReadOnly?l10n.t("web_delete_group"):l10n.t("web_exit_group"))));var o=void 0;t.isReadOnly||(o=g["default"].createElement(U["default"],null,g["default"].createElement(j["default"],{a8n:"li-report-spam",theme:"list-aligned",color:"danger",icon:g["default"].createElement(Ee["default"],{name:"thumbs-down",directional:!0}),onClick:this.onReportSpam},l10n.t("report_spam"))));var n=void 0;if(a.participants.canAdd()){var r=g["default"].createElement(ke["default"],null,g["default"].createElement(Ee["default"],{name:"add-user-light",directional:!0}));n=g["default"].createElement(Ne["default"],{image:r,theme:"drawer-list",primary:l10n.t("add_group_participant"),onClick:this.openAddGroupParticipantFlow})}var i=void 0;if(a.participants.iAmAdmin()&&this.props.onGroupInviteLink){var l=g["default"].createElement(ke["default"],null,g["default"].createElement(Ee["default"],{name:"link"}));i=g["default"].createElement(Ne["default"],{image:l,theme:"drawer-list",primary:l10n.t("group_invite_link"),onClick:this.props.onGroupInviteLink})}var s=g["default"].createElement(xe["default"],{theme:"section-title"},l10n.t("web_participants_count",{count:a.participants.length,max:Store.ServerProps.maxParticipants})),u=a.participants.length?g["default"].createElement(U["default"],{a8n:"section-participants",title:l10n.t("web_participants_title"),subtitle:s,"data-list-scroll-offset":!0},n,i,g["default"].createElement(N["default"],{keyForRowAtIndexPath:this.keyForRowAtIndexPath,itemForRowAtIndexPath:this.itemForRowAtIndexPath,numberOfSections:this.numberOfSections,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,extraItems:4})):null,c=null;if(this.props.onMediaGallery){var d=g["default"].createElement(Ee["default"],{name:"chevron-right-alt",directional:!0}),f=pe["default"].supportsFeature(pe["default"].F.LINK_DOC_GALLERY)?l10n.t("media_links_docs"):l10n.t("media");c=g["default"].createElement(U["default"],{a8n:"section-media",title:f,titleOnClick:this.props.onMediaGallery,subtitle:d,theme:"padding"},g["default"].createElement(P["default"],{chat:(0,be.unproxy)(t),mediaMsgs:t.getMediaMsgs()}))}var p=this.props.contact.profilePicThumb,h=B.Type.GROUP,m=t.isReadOnly||!p.canDelete()&&!p.canSet(),_=g["default"].createElement("div",{className:De["default"].avatar},g["default"].createElement(G["default"],{type:h,id:this.props.contact.id,pending:this.state.pendingPhoto,startImage:this.props.profilePicThumb.imgFull,readOnly:m,onImageSet:this.onImageSet})),v=null;this.props.groupMetadata.creation&&(v=g["default"].createElement("div",{"data-a8n":y["default"].key("group-created-time"),className:De["default"].nameSecondary},g["default"].createElement(xe["default"],{theme:"muted"},l10n.t("web_group_creation_time",{when:k.relativeDateAndTimeStr(this.props.groupMetadata.creation)}))));var b=null,E=t.mute.canMute()?g["default"].createElement(de["default"],{chat:t,mute:t.mute}):null,S=null;if(this.props.onStarred){var C=g["default"].createElement(Ee["default"],{name:"chevron-right-alt",directional:!0});S=g["default"].createElement(Re["default"],{side:C,onClick:this.props.onStarred},g["default"].createElement(xe["default"],{theme:"title"},l10n.t("chat_starred_msgs")))}var M=void 0;this.state.contextMenu&&(M=g["default"].createElement(le["default"],{displayName:"ChatContextMenu",escapable:!0,popable:!0,requestDismiss:this.contextClose},g["default"].createElement(re["default"],{contextMenu:this.state.contextMenu})));var w=null;(E||S||b)&&(w=g["default"].createElement(U["default"],null,E,S,b));var T=void 0;return g["default"].createElement(R["default"],{key:"contact-info-modal",variant:"panel",onCancel:this.onClose},g["default"].createElement(D["default"],{title:l10n.t("web_group_info"),type:O.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),g["default"].createElement(x["default"],{"data-list-scroll-container":!0},g["default"].createElement("div",{className:De["default"].body},g["default"].createElement(U["default"],{theme:"padding-large"},_,g["default"].createElement(oe["default"],{value:this.state.name||"",editable:a.canSetSubject(),pending:this.state.pendingSubject,showRemaining:!0,validate:this.validateSubject,maxLength:Store.ServerProps.maxSubject,onChange:this.onSubjectChange,onSave:this.onSetSubject,onError:this.onSetSubjectError,onCancel:this.onCancelSubject,supportsEmoji:!0,lockable:!0,lowProfile:!0,theme:"large",customStyleThemes:[ae.TextInputCustomStyleThemes.groupInfoName]}),v),T,c,w,u,e,o)),M)}}]),t}(g["default"].Component);Ue.contextTypes={uim:g["default"].PropTypes.instanceOf(ue["default"])},Ue.CONCERNS={chat:["isReadOnly","mute","id","pendingAction"],groupMetadata:["desc","participants","creation"],contact:["name","plaintextDisabled","id","profilePicThumb","pendingAction"],profilePicThumb:["imgFull"]},t["default"]=(0,ge["default"])((0,ve["default"])(Ue))},7445:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(57),r=o(n),i=a(0),l=o(i),s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(3),b=o(v),y=a(10),E=o(y),S=a(94),C=o(S),M=a(7123),k=o(M),w=a(7126),N=a(12),T=o(N),P=a(14),I=o(P),R=a(38),A=o(R),x=a(7165),O=o(x),D=a(485),L=o(D),U=a(7608),F=o(U),j={LOADING:0,SUCCESS:1,ACCEPT_ERROR:2,QUERY_ERROR:3};t["default"]=(0,L["default"])(function(e){function t(){var e,a,o,n;(0,d["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,m["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(i))),o.state={state:j.LOADING,status:void 0,groupMetadata:void 0},o.onViewGroup=function(){o.state.groupMetadata&&T["default"].openChatFromUnread(Store.Chat.get(o.state.groupMetadata.id)),T["default"].closeModal()},o.onJoinGroup=function(){A["default"].acceptGroupInvite(o.props.groupCode).then(function(e){var t=e.status,a=e.gid;return 200===t?Store.Chat.find(a):l["default"].reject(t)}).then(function(e){T["default"].openChatFromUnread(e).then(function(t){t&&T["default"].focusChatTextInput(e)}),T["default"].closeModal()}).checkpoint(o.props.rejectOnUnmount())["catch"](I["default"].Unmount,E["default"].noop)["catch"](function(e){o.setState({state:j.ACCEPT_ERROR,status:e})})},o.onCancel=function(){T["default"].closeModal()},n=a,(0,m["default"])(o,n)}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"componentWillMount",value:function(){var e=this;A["default"].groupInviteInfo(this.props.groupCode).checkpoint(this.props.rejectOnUnmount()).then(function(t){var a=t.status,o=(0,r["default"])(t,["status"]);if(200===a){var n=new O["default"](o);Store.Contact.gadd(o.id),e.setState({status:a,groupMetadata:n,state:j.SUCCESS})}else e.setState({status:a,state:j.QUERY_ERROR})})["catch"](I["default"].Unmount,E["default"].noop)}},{key:"render",value:function(){var e=this.state,t=e.state,a=e.status,o=e.groupMetadata,n={
cancelText:l10n.t("group_invite_cancel"),onCancel:this.onCancel,onOK:void 0,okText:void 0},r=void 0;if(t===j.LOADING)r=b["default"].createElement(w.LoadingWithText,{text:l10n.t("group_invite_check_link")});else if(t===j.SUCCESS&&o){var i=o.participants.map(function(e){return b["default"].createElement("div",{key:e.id,className:F["default"].participantWrapper},b["default"].createElement(k["default"],{className:F["default"].participantImage,id:e.id}),b["default"].createElement("span",{className:F["default"].participantText},e.contact.formattedName))}),l=Store.Contact.gadd(o.owner).formattedName;r=b["default"].createElement("div",null,b["default"].createElement("div",{className:F["default"].metadataContainer},b["default"].createElement("div",{className:F["default"].metadataIcon},b["default"].createElement(k["default"],{id:o.id,size:75,quality:k["default"].Quality.HIGH})),b["default"].createElement("div",{className:F["default"].metadataText},b["default"].createElement("span",{className:F["default"].metadataTitle},o.subject),b["default"].createElement("span",{className:F["default"].metadataSubtitle},l10n.t("group_invite_created_by",{participant:l})))),b["default"].createElement("span",{className:F["default"].participantsTitle},l10n.t("group_invite_participants",{count:i.length,_plural:i.length})),b["default"].createElement("div",{className:F["default"].participantsContainer},i));var s=Store.Chat.get(o.id),u=!!s&&!s.isReadOnly;n.onOK=u?this.onViewGroup:this.onJoinGroup,n.okText=u?l10n.t("group_invite_view"):l10n.t("group_invite_join")}else{var c=void 0;if(t===j.QUERY_ERROR)switch(a){case 401:c=l10n.t("group_invite_query_401");break;case 403:c=l10n.t("group_invite_query_403");break;case 404:c=l10n.t("group_invite_query_404");break;case 406:c=l10n.t("group_invite_query_406");break;case 410:c=l10n.t("group_invite_query_410");break;default:c=l10n.t("group_invite_query_500")}else if(t===j.ACCEPT_ERROR)switch(a){case 401:c=l10n.t("group_invite_accept_401");break;case 404:c=l10n.t("group_invite_accept_404");break;case 410:c=l10n.t("group_invite_accept_410");break;case 419:c=l10n.t("group_invite_accept_419");break;default:c=l10n.t("group_invite_accept_500")}n.cancelText=l10n.t("web_ok"),r=b["default"].createElement("div",null,c)}return b["default"].createElement(C["default"],n,r)}}]),t}(b["default"].Component))},7446:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(94),_=o(g),v=a(484),b=(o(v),a(12)),y=o(b),E=a(93),S=o(E),C=a(7609),M=o(C),k=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.handleCancel=function(){y["default"].closeModal()},o.handleOK=function(){o.props.onConfirm(),y["default"].closeModal()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement(_["default"],{title:S["default"].t("group_invite_drawer_revoke_link"),onOK:this.handleOK,okText:S["default"].t("group_invite_drawer_revoke_link"),onCancel:this.handleCancel,cancelText:S["default"].t("web_cancel")},m["default"].createElement("div",{className:M["default"].confirmationText},S["default"].t("group_invite_revoke_confirmation_text",{groupName:this.props.chat.contact.name})))}}]),t}(m["default"].Component);t["default"]=k},7447:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(10),_=o(g),v=a(12),b=o(v),y=a(8),E=o(y),S=a(7120),C=o(S),M=a(7121),k=o(M),w=a(7122),N=o(w),T=a(14),P=o(T),I=a(7317),R=o(I),A=a(71),x=o(A),O=a(7136),D=o(O),L=a(53),U=o(L),F=a(7166),j=(o(F),a(108)),B=(o(j),a(485)),G=o(B),V=a(7238),Y=o(V),W=a(175),H=o(W),q=a(7118),z=o(q),K=a(172),Q=o(K),J=a(263),X=o(J),Z=a(72),$=o(Z),ee=a(7176),te=o(ee),ae=a(174),oe=a(7228),ne=o(oe),re=a(7133),ie=o(re),le=a(7610),se=o(le),ue=50,ce=50,de=0,fe=1,pe=2,he=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={msgInfo:void 0,unimplemented:!1},o.wrapper=null,o.isMsgVisible=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;return e===o.props.msg.id&&(t?!0:o.getMsgComponent())},o.onClose=function(){o.context.uim.uie.requestDismiss()},o.getSections=function(){var e=o.state.msgInfo,t=[];return e&&e.isPTT&&t.push(de),e&&(e.read.length>0||e.playedRemaining>0)&&t.push(fe),e&&(e.delivery.length>0||e.deliveryRemaining>0)&&t.push(pe),t},o.getHeaderAtSection=function(e){var t=void 0,a=void 0;switch(o.getSections()[e]){case de:a=m["default"].createElement(Q["default"],{name:"status-ptt-blue"}),t=l10n.t("message_info_played_by");break;case fe:a=m["default"].createElement(Q["default"],{name:"status-dblcheck-ack"}),t=l10n.t("message_info_read_by");break;case pe:a=m["default"].createElement(Q["default"],{name:"status-dblcheck"}),t=l10n.t("message_info_delivered_to")}return a=m["default"].createElement("div",{className:se["default"].titleIcon},a),m["default"].createElement("div",{className:se["default"].title},m["default"].createElement(Y["default"],{side:a,ellipsify:!0},m["default"].createElement(ie["default"],{theme:"section-title"},t)))},o.getParticipantsAtSection=function(e){var t=o.state.msgInfo;switch(o.getSections()[e]){case de:return t?t.played:null;case fe:return t?t.read:null;case pe:return t?t.delivery:null}},o.getFooterAtSection=function(e){var t=o.state.msgInfo,a=void 0,n=void 0;switch(o.getSections()[e]){case de:a=t&&t.playedRemaining>0?l10n.t("message_info_remaining",{count:t.playedRemaining,_plural:t.playedRemaining}):null,n="played-footer";break;case fe:a=t&&t.readRemaining>0?l10n.t("message_info_remaining",{count:t.readRemaining,_plural:t.readRemaining}):null,n="read-footer";break;case pe:a=t&&t.deliveryRemaining>0?l10n.t("message_info_remaining",{count:t.deliveryRemaining,_plural:t.deliveryRemaining}):null,n="delivered-footer"}return m["default"].createElement("div",{className:se["default"].footer,key:n},m["default"].createElement(ie["default"],{theme:"muted"},a))},o.itemForRowAtIndexPath=function(e){var t=o.getParticipantsAtSection(e.section);return t&&e.row<t.length?o.getInfoCell(t.at(e.row)):o.getFooterAtSection(e.section)},o.keyForRowAtIndexPath=function(e){var t=o.itemForRowAtIndexPath(e);return t?t.key:null},o.numberOfRowsInSection=function(e){var t=o.getParticipantsAtSection(e).length;return o.getFooterAtSection(e)?t+1:t},o.sectionForSection=function(e){return o.getHeaderAtSection(e)},o.numberOfSections=function(){return o.getSections().length},o.heightForItem=function(e){return e.row<o.getParticipantsAtSection(e.section).length?O.DEFAULT_ITEM_HEIGHT:ue},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this;Store.MsgInfo.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then(function(t){e.setState({msgInfo:t}),e.props.listeners.add(t.played,"add remove"),e.props.listeners.add(t.read,"add remove"),e.props.listeners.add(t.delivery,"add remove"),e.props.listeners.add(t,"change:playedRemaining change:readRemaining change:deliveryRemaining")})["catch"](P["default"].Unmount,_["default"].noop)["catch"](function(){e.setState({unimplemented:!0}),b["default"].openToast(m["default"].createElement(X["default"],{msg:l10n.t("msg_info_failed"),id:(0,J.genId)("msg_info_failed")}))})}},{key:"componentDidMount",value:function(){if(this.props.msg.type===U["default"].TYPE.IMAGE&&(this.refs.scrollable.scrollTop=this.refs.scrollable.scrollHeight),this.props.msg.isGif){var e=this.getMsgComponent();e.play()}}},{key:"getAnimateEnterClass",value:function(e){return"animate-enter"+(-1===e?"":e)}},{key:"getMsgComponent",value:function(){var e=this.wrapper;return e?e.getMsgComponentRef():void 0}},{key:"getInfoCell",value:function(e){return m["default"].createElement(R["default"],{msgInfoParticipant:e,contact:e.contact,key:e.id})}},{key:"render",value:function(){var e=this.props.msg,t=this.state,a=t.msgInfo,o=t.unimplemented,n=void 0;a||o||(n=m["default"].createElement("div",{className:se["default"].spinner,key:"spinner"},m["default"].createElement(H["default"],{size:50,stroke:4})));var r=this.getSections().length?m["default"].createElement(D["default"],{itemForRowAtIndexPath:this.itemForRowAtIndexPath,keyForRowAtIndexPath:this.keyForRowAtIndexPath,numberOfSections:this.numberOfSections,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,heightForItem:this.heightForItem,heightForSection:function(e){return ce},extraItems:4}):null;return m["default"].createElement(C["default"],{key:"message-info-modal",variant:"panel",onCancel:this.onClose},m["default"].createElement(N["default"],{title:l10n.t("message_info"),type:w.DRAWER_HEADER_TYPE.SMALL,onCancel:this.onClose}),m["default"].createElement(ne["default"],{ref:"scrollable",msg:e,chatPreference:Store.ChatPreference.get("defaultPreference")},m["default"].createElement(te["default"],{msg:e,key:"star-"+e.star.toString(),ref:(0,ae.GetRef)("wrapper",this),displayType:E["default"].DISP_TYPE.MSG_INFO,isMsgVisible:this.isMsgVisible,position:ee.MsgPosition.END})),m["default"].createElement(k["default"],{"data-list-scroll-container":!0},n,m["default"].createElement("div",{className:se["default"].list},r)))}}]),t}(m["default"].Component);he.CONCERNS={msg:["id","star","type","isGif"]},he.contextTypes={uim:m["default"].PropTypes.instanceOf($["default"])},t["default"]=(0,G["default"])((0,x["default"])((0,z["default"])(he)))},7448:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(7155),E=o(y),S=a(7126),C=a(7261),M=o(C),k=a(7125),w=o(k),N=a(265),T=o(N),P=function(e){function t(e){(0,u["default"])(this,t);var a=(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).call(this,e));return a.onSelect=function(e,t){if(t instanceof y.Mode){var o=t.props.chat;a.props.filter(o)===!0&&a.props.onGroup(t.props.chat)}},a.onSearch=b["default"].debounce(function(e){a.setState({searchText:e})},100),a.selection=new w["default"],a.state={loading:!0,searchText:void 0},a}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.chats;r["default"].delay(300).then(function(){return r["default"].all(b["default"].map(b["default"].filter(t,function(e){return e.groupMetadata.stale}),function(e){return e.groupMetadata.update()["catch"](b["default"].noop)}))}).then(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.chats,o=t.onGroup,n=t.filter,r=t.onCancel,i=void 0;return this.state.loading?i=_["default"].createElement(S.Loading,null):!function(){var t=l10n.accentFold(e.state.searchText),r=T["default"].numberSearch(t),l=a.filter(function(e){return n(e)&&(!t||t&&e.contact.searchMatch(t,r))});l.length?(e.selection.init(b["default"].map(l.filter(function(e){return n(e)===!0}),"id")),i=l.map(function(t){var a=void 0,r=void 0,i=n(t),l=!b["default"].isBoolean(i);return l&&(a=_["default"].createElement("div",{className:"chat-status ellipsify",title:i},i),r="member"),_["default"].createElement(E["default"],{chat:t,contact:t.contact,mode:y.Mode.INFO,active:e.selection,secondary:a,noContext:!0,className:r,onClick:l?void 0:o.bind(null,t),key:t.id})})):i=_["default"].createElement(S.SearchGroups,null)}(),_["default"].createElement(M["default"],{title:l10n.t("web_groups"),selection:this.selection,onSearch:this.onSearch,searchPlaceholder:l10n.t("search_groups"),onSelect:this.onSelect,onCancel:r},i)}}]),t}(_["default"].Component);P.defaultProps={filter:function(){return!0}},t["default"]=P},7449:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(176),_=o(g),v=a(8),b=o(v),y=a(7120),E=o(y),S=a(7122),C=o(S),M=a(7121),k=o(M),w=a(7145),N=o(w),T=a(7459),P=o(T),I=a(12),R=o(I),A=a(282),x=o(A),O=a(73),D=o(O),L=a(39),U=a(7612),F=o(U),j="animated-doodle",B=a(7517),G={selector:"."+F["default"].animation,low:{"default":B},high:{"default":B}},V=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onTOS=function(){var e="https://www.whatsapp.com/legal/";e=D["default"].build(e,{lg:l10n.getLocale()}),window.open(e,"_blank")},o.onFAQ=function(){var e=b["default"].FAQ_BASE_URL+"/faq/web";e=e=D["default"].build(e,{lg:l10n.getLocale()}),window.open(e,"_blank")},o.onContactUs=function(){R["default"].openModal(m["default"].createElement(P["default"],null))},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){x["default"].isAssetLoaded(j)||x["default"].loadAsset(G,j)}},{key:"render",value:function(){return m["default"].createElement(E["default"],null,m["default"].createElement(C["default"],{a8n:"drawer-title-help",title:l10n.t("help_drawer_title"),onBack:this.props.onClose,type:S.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(k["default"],null,m["default"].createElement("div",{className:F["default"].animation}),m["default"].createElement(L.SelectableDiv,{"data-a8n":_["default"].key("version"),className:F["default"].version,selectable:!0},l10n.t("version",{version:b["default"].VERSION_STR})),m["default"].createElement(N["default"],{a8n:"li-faq",onClick:this.onFAQ},l10n.t("web_settings_faq")),m["default"].createElement(N["default"],{a8n:"li-contact-us",onClick:this.onContactUs},l10n.t("send_logs_title")),m["default"].createElement(N["default"],{a8n:"li-tos",onClick:this.onTOS},l10n.t("terms_and_privacy_link"))))}}]),t}(m["default"].Component);t["default"]=V},7450:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var r=a(0),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(8),v=n(_),b=a(12),y=n(b),E=a(7120),S=n(E),C=a(7122),M=n(C),k=a(7121),w=n(k),N=a(177),T=n(N),P=a(173),I=n(P),R=a(7336),A=n(R),x=a(7140),O=n(x),D=a(1),L=n(D),U=a(485),F=n(U),j=a(127),B=n(j),G=a(263),V=n(G),Y=a(97),W=n(Y),H=a(292),q=n(H),z=a(10),K=o(z),Q=a(14),J=o(Q),X=a(7182),Z=a(3),$=o(Z),ee=a(46),te=o(ee),ae=a(28),oe=o(ae),ne=a(38),re=o(ne),ie=a(7500),le=o(ie),se=a(7126),ue=a(174),ce=v["default"].MIN_CHARS_FOR_FTS,de=function(e){function t(e){(0,c["default"])(this,t);var a=(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).call(this,e));return a._search=function(e,t){a._hasPendingSearch=!1;var o=le.search(e,t).cancellable().then(function(t){o===a._searchPromise&&(a._addSearchResults(e,t),a.setState({isSearching:!1}))})["catch"](i["default"].CancellationError,K.noop)["catch"](function(e){L["default"].errorVerbose("Image search failed")(e),y["default"].openToast($.createElement(V["default"],{msg:l10n.t("image_search_failed"),id:(0,G.genId)()})),o===a._searchPromise&&a.setState({isSearching:!1})})["finally"](function(){o===a._searchPromise&&(a._searchPromise=null)});a._searchPromise=o,a.setState({isSearching:!0})},a.handleUserInput=function(e){var t=K.trim(e||"");return t?void((0,X.numCodepoints)(t)<ce||t!==a.state.query&&(a._cancelSearch(),a._resetState(),a._requestSearch(t))):(a._cancelSearch(),void a._resetState())},a.handleRequestMoreImages=function(){a._hasPendingSearch||a._searchPromise||!a.state.totalEstimatedMatches||a.state.nextOffset>=a.state.totalEstimatedMatches||a._requestSearch(a.state.query,a.state.nextOffset)},a.handleImageClick=function(e){var t=a.state.imageData[e];if(t){var o=t.contentUrl,n=void 0;n=oe.isElectron?q["default"].getRetry(o,W["default"].RESP_TYPE.BLOB).then(function(e){if(200!==e.status)throw new J.ServerStatusError(null,o,e.status);return e.response}):re.downloadImage(o),n.checkpoint(a.props.rejectOnUnmount()).then(function(e){if(!(e instanceof Blob))throw new J.ImageError("Server did not respond with image bytes",o);a.props.onImageSelected(e,t.hostPageUrl)})["catch"](J.Unmount,K.noop)["catch"](function(e){L["default"].errorVerbose("Image search failed")(e),y["default"].openToast($.createElement(V["default"],{msg:l10n.t("image_download_failed"),id:(0,G.genId)()}))})}},a.focusSearch=function(){(0,P.shouldIndicateFocus)(),T["default"].focus(a.searchRef)},a.focusGallery=function(e){if(!e.repeat&&a.galleryRef&&a.searchRef&&a.searchRef.isAtEnd()){var t=a.galleryRef;e.preventDefault(),e.stopPropagation(),(0,P.shouldIndicateFocus)(),T["default"].focus(te.findDOMNode(t))}},a.handleSearchFocus=function(e){(0,P.indicateFocus)(a.refs.search_hotkeys,["#fbfbfb","#D9F3FF"])},a.state={imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0},a._hasPendingSearch=!1,a._searchPromise=null,a._debouncedSearch=a.props.debounce(a._search,750),a}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentWillUnmount",value:function(){this._cancelSearch()}},{key:"_requestSearch",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._hasPendingSearch=!0,this._debouncedSearch(e,t)}},{key:"_cancelSearch",value:function(){this._hasPendingSearch&&(this._debouncedSearch.cancel(),this._hasPendingSearch=!1),this._searchPromise&&this._searchPromise.cancel()}},{key:"_resetState",value:function(){this.setState({imageData:{},isSearching:!1,nextOffset:0,query:"",thumbnails:[],totalEstimatedMatches:0})}},{key:"_addSearchResults",value:function(e,t){this.setState(function(a,o){var n=K.keyBy(t.value,function(e){return e.thumbnailUrl}),r=K.map(t.value,function(e){return{id:e.imageId,thumbUrl:e.thumbnailUrl}}),i=t.value.length,l={};return a.query===e?(l.nextOffset=t.nextOffset?t.nextOffset:a.nextOffset+i,l.thumbnails=K.concat(a.thumbnails,r),l.totalEstimatedMatches=t.totalEstimatedMatches,l.imageData=K.assign(n,a.imageData)):(l.imageData=n,l.nextOffset=t.nextOffset?t.nextOffset:i,l.query=e,l.thumbnails=r,l.totalEstimatedMatches=t.totalEstimatedMatches),l})}},{key:"render",value:function(){var e=C.DRAWER_HEADER_TYPE.POPUP,t={down:this.focusGallery},a=void 0;return a=0===this.state.thumbnails.length?this.state.isSearching?$.createElement(se.SearchingImages,null):this.state.query?$.createElement(se.ImageSearchEmpty,null):$.createElement(se.BeforeImageSearch,null):$.createElement(A["default"],{ref:(0,ue.GetRef)("galleryRef",this),canLoadMore:this.state.nextOffset<this.state.totalEstimatedMatches,isLoadingMore:this.state.isSearching,thumbnails:this.state.thumbnails,onFocusPrev:this.focusSearch,onImageClick:this.handleImageClick,onRequestMoreImages:this.handleRequestMoreImages}),$.createElement(S["default"],null,$.createElement(M["default"],{title:l10n.t("image_search_title"),type:e,onBack:this.props.onBack,onCancel:this.props.onCancel}),$.createElement(w["default"],null,$.createElement(I["default"],{ref:"search_hotkeys",handlers:t,onFocus:this.handleSearchFocus},$.createElement(O["default"],{ref:(0,ue.GetRef)("searchRef",this),placeholder:l10n.t("image_search_hint"),onSearch:this.handleUserInput,loading:this.state.isSearching})),a))}}]),t}($.Component);t.Component=de;t["default"]=(0,B["default"])((0,F["default"])(de))},7451:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(484),m=(o(h),a(53)),g=(o(m),a(179)),_=a(7120),v=o(_),b=a(7122),y=o(b),E=a(7121),S=o(E),C=a(7276),M=o(C),k=a(126),w=o(k),N=a(3),T=a(7171),P=a(7337),I=a(7332),R=a(261),A=a(7128),x=a(93),O=a(47),D=a(10),L=a(23),U={MEDIA:"media",DOCS:"docs",LINKS:"links"},F=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.onSelectMessages=function(){e.state.selectable||e.setState({selectable:!0})},e.onCancelSelection=function(){e.state.selectable&&(e.selectedMessages.unsetAll(),e.setState({selectable:!1}))},e.onMessageSelect=function(t,a){e.onSelectMessages(),e.selectedMessages.setVal(t,a),0===e.selectedMessages.getSelected().length&&e.onCancelSelection()},e.selectedMessages=new A([],function(e){return e.id.toString()}),e.state={selected:U.MEDIA,direction:null,selectable:!1},e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"onSelectTab",value:function(e){var t=D.values(U).indexOf(this.state.selected),a=D.values(U).indexOf(e);t!==a&&this.selectedMessages.unsetAll();var o=a>t?"right":"left";this.setState({selected:e,direction:o,selectable:!1})}},{key:"getTabs",value:function(){var e=this;if(!O.supportsFeature(O.F.LINK_DOC_GALLERY))return null;var t=[{tab:U.MEDIA,title:x.t("media")},{tab:U.DOCS,title:x.t("docs")},{tab:U.LINKS,title:x.t("links")}].map(function(t){var a=L("menu-item",{active:e.state.selected===t.tab});return N.createElement("button",{className:a,onClick:e.onSelectTab.bind(e,t.tab),key:t.tab,title:t.title},t.title)});return N.createElement("div",{className:"menu-tabs menu-tabs-lists","data-active-tab":this.state.selected},t)}},{key:"getContent",value:function(){var e=this.props.chat;if(!O.supportsFeature(O.F.LINK_DOC_GALLERY))return N.createElement(T,{chat:e,mediaMsgs:e.getMediaMsgs(),selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages,fullCollection:!0});var t=void 0;switch(this.state.selected){case U.MEDIA:t=N.createElement(T,{chat:e,mediaMsgs:e.getMediaMsgs(),selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages,fullCollection:!0});break;case U.LINKS:t=N.createElement(P,{chat:e,linkMsgs:e.getLinkMsgs(),selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages});break;case U.DOCS:t=N.createElement(I,{chat:e,docMsgs:e.getDocMsgs(),selectable:this.state.selectable,onMessageSelect:this.onMessageSelect,selectedMessages:this.selectedMessages})}return t}},{key:"render",value:function(){var e=this.props.chat,t=this.getTabs(),a=this.getContent(),o=this.state.selectable?N.createElement(R,{displayName:"MediaMultiSelect",escapable:!0,requestDismiss:this.onCancelSelection},N.createElement(M["default"],{className:"multi-controls-drawer",chat:e,disableRevoke:!0,noSortOnForward:!0,toastPosition:g.ToastPosition.RIGHT,downloadButton:this.state.selected!==U.LINKS,selectedMessages:this.selectedMessages,onCancel:this.onCancelSelection})):null,n="right"===this.state.direction?"slide-forward":"slide-back",r=O.supportsFeature(O.F.LINK_DOC_GALLERY)?" ":x.t("media");return N.createElement(v["default"],{className:"drawer-multimedia-gallery",onCancel:this.props.onBack},N.createElement(y["default"],{title:r,onBack:this.props.onBack,type:b.DRAWER_HEADER_TYPE.LARGE}),o,t,N.createElement(S["default"],{"data-list-scroll-container":!0},N.createElement(w["default"],{transitionName:n,className:"column"},N.createElement("div",{className:"multimedia-gallery",key:this.state.selected},N.createElement("div",{className:"column"},a)))))}}]),t}(N.Component);e.exports=F},7452:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(62),y=o(b),E=a(23),S=n(E),C=a(7123),M=n(C),k=a(7119),w=n(k),N=a(47),T=n(N),P=a(262),I=(n(P),a(7118)),R=n(I),A=a(172),x=n(A),O=a(7149),D=a(53),L=n(D);t["default"]=(0,R["default"])((i=r=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.getMenuBtns=function(){var e=o.props,t=e.msg,a=e.mediaData,n=v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:"bubble"}),title:l10n.t("go_to_message"),onClick:o.props.onGoToMsgClick}),r=void 0;if(T["default"].supportsFeature(T["default"].F.STARRED)){var i=void 0,l=void 0,s=void 0;t.star?(i=o.props.onUnstarClick,l="unstar-btn",s=l10n.t("unstar_message")):(i=o.props.onStarClick,l="star-btn",s=l10n.t("star_message")),r=v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:l}),title:s,onClick:i})}var u=v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:"forward",directional:!0}),title:l10n.t("forward"),onClick:o.props.openForwardFlow}),c=v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:"download"}),title:l10n.t("web_button_download"),disabled:!a.renderableUrl,onClick:o.props.onDownloadClick}),d=void 0;return T["default"].supportsFeature(T["default"].F.PIP)&&(t.type!==L["default"].TYPE.VIDEO||t.isGif||(d=v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:"minimize-video"}),title:l10n.t("media_panel_minimize"),onClick:o.props.onMinimizeClick}))),{btnGoToMsg:n,btnStar:r,btnForward:u,btnDownload:c,btnMinimize:d}},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this.props.msg,t=e.displayName(!0,!0);e.isGroupMsg&&(t+=" @ "+e.chat.title());var a=this.getMenuBtns(),o=a.btnGoToMsg,n=a.btnStar,r=a.btnForward,i=a.btnDownload,l=a.btnMinimize,s=(0,S["default"])("media-panel-header",{}),u="x-viewer";return v["default"].createElement("div",{className:s},v["default"].createElement("div",{className:"chat media-chat"},v["default"].createElement("div",{className:"chat-avatar"},v["default"].createElement(M["default"],{id:e.sender,size:40})),v["default"].createElement("div",{className:"chat-body"},v["default"].createElement("div",{className:"chat-main"},v["default"].createElement(w["default"],{ellipsify:!0,text:t})),v["default"].createElement("div",{className:"chat-secondary"},v["default"].createElement("div",{className:"chat-status ellipsify"},y.relativeDateAndTimeStr(e.t))))),v["default"].createElement("div",{className:"media-panel-tools"},v["default"].createElement(O.MenuBar,{key:"media-panel-header"},l,o,n,r,i,v["default"].createElement(O.MenuBarItem,{icon:v["default"].createElement(x["default"],{name:u}),title:l10n.t("web_close"),onClick:this.props.onClose}))))}}]),t}(v["default"].PureComponent),r.CONCERNS={msg:["star","isGroupMsg","chat","type","isGif","sender","t"],mediaData:["renderableUrl"]},i))},7453:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l,s,u,c,d,f,p=a(181),h=n(p),m=a(5),g=n(m),_=a(2),v=n(_),b=a(4),y=n(b),E=a(7),S=n(E),C=a(6),M=n(C),k=a(3),w=n(k),N=a(46),T=n(N),P=a(10),I=n(P),R=a(7220),A=n(R),x=a(12),O=n(x),D=a(7278),L=n(D),U=a(94),F=n(U),j=a(23),B=n(j),G=a(491),V=n(G),Y=a(7119),W=n(Y),H=a(7201),q=n(H),z=a(267),K=n(z),Q=a(262),J=n(Q),X=a(7452),Z=n(X),$=a(7179),ee=n($),te=a(7157),ae=o(te),oe=a(7132),ne=n(oe),re=a(7118),ie=n(re),le=a(487),se=a(261),ue=n(se),ce=a(264),de=n(ce),fe=a(7173),pe=n(fe),he=a(7196),me=n(he),ge=a(517),_e=a(488),ve=a(174),be=a(7208),ye=a(172),Ee=n(ye),Se=500,Ce=2;t["default"]=(0,ie["default"])((i=r=function(e){function t(e){(0,v["default"])(this,t);var a=(0,S["default"])(this,(t.__proto__||(0,g["default"])(t)).call(this,e));return a.setMediaImage=function(e){return a.mediaImage=e},a.setMediaVideo=function(e){return a.mediaVideo=e},a.onImageLoad=function(e){if(a.props.onImageLoad&&a.props.onImageLoad(),!a.zoomed){a.zoomed=!0;var t=a.state.zoomElement;t&&e&&a.props.zoomIn&&a.animateZoom(t,e)}},a.animateZoom=function(e,t){var o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),r=n.top-o.top,i=n.left-o.left,l=e.clientWidth/t.clientWidth,s=(t.clientHeight-e.clientHeight)/2,u=(t.clientWidth-e.clientWidth)/2;r-=s,i-=u,(0,de["default"])(t,{opacity:[1,0],translateX:[0,i],translateY:[0,r],scale:[1,l]},{duration:Se,easing:[.1,.82,.25,1]});var c=T["default"].findDOMNode(a.caption);c&&(0,de["default"])(c,{opacity:[1,0]},{duration:Se})},a.openForwardFlow=function(e){e.stopPropagation();var t=a.props.msg;t.isUnsentMedia?O["default"].openModal(w["default"].createElement(F["default"],{title:l10n.t("err_unsent_forward_title"),onOK:O["default"].closeModal.bind(O["default"]),okText:l10n.t("web_ok")},l10n.t("err_unsent_forward_text"))):O["default"].openModal(w["default"].createElement(q["default"],{msgs:[(0,le.unproxy)(t)]}),"modal-flow")},a.onScroll=function(e){Math.abs(e.deltaY)>7&&a.onClose()},a.onImgZoomIn=function(e){var t=a.mediaImage;e&&t&&(a.listenToMouseMove=t.heightOverflow>0||t.widthOverflow>0),a.setState({imgZoomed:e}),a.props.onImgZoomIn(e)},a.onZoomOut=function(e){var t=a.mediaImage;t&&a.state.imgZoomed&&t.onImageClick(e)},a.onMouseMove=function(e){a.handleMouseMove(e.pageX,e.pageY)},a._handleMouseMove=function(e,t){var o=a.mediaImage;if(o){var n=o.image;if(n){var r=T["default"].findDOMNode(n);if(r){var i=r.parentNode,l=i.parentNode,s=o.getTranslatePosition(l,e,t),u=s.translateX,c=s.translateY;(0,de["default"])(i,"stop"),(0,de["default"])(i,{translateX:u,translateY:c,scale:Ce},{duration:0})}}}},a.onDownloadClick=function(e){e.stopPropagation(),V["default"].initDownload((0,le.unproxy)(a.props.msg))},a.onStarClick=function(e){e.stopPropagation();var t=a.props.msg;O["default"].sendStarMsgs(t.chat,[(0,le.unproxy)(t)])},a.onUnstarClick=function(e){e.stopPropagation();var t=a.props.msg;O["default"].sendUnstarMsgs(t.chat,[(0,le.unproxy)(t)])},a.onGoToMsgClick=function(e){e.stopPropagation(),a.onClose(),O["default"].existsDrawerRight(function(e){e&&2===L["default"].column&&O["default"].closeDrawerRight()});var t=a.props.msg;O["default"].openChatAt(t.chat,t.chat.getSearchContext((0,le.unproxy)(t)))},a.onClose=function(){if(!a.closing){a.closing=!0,I["default"].isFunction(a.props.onExitAnimation)&&a.props.onExitAnimation();var e=a.props.getZoomNode(a.props.msg.id);if(!e)return a.props.onBack();var t=void 0,o=a.props.mediaData.type;if(o===J["default"].TYPE.IMAGE&&a.mediaImage?t=a.mediaImage.image:a.props.mediaData.isGif&&a.mediaVideo&&(t=a.mediaVideo.player),!t)return a.props.onBack();t=T["default"].findDOMNode(t);var n=t.getBoundingClientRect(),r=e.getBoundingClientRect(),i=r.top-n.top,l=r.left-n.left,s=e.clientWidth/t.clientWidth,u=(t.clientHeight-e.clientHeight)/2,c=(t.clientWidth-e.clientWidth)/2;i-=u,l-=c,(0,de["default"])(t,{translateX:[l,0],translateY:[i,0],scale:[s,1]},{duration:200,easing:[.1,.82,.25,1]}).then(function(){a.props.onBack()});var d=T["default"].findDOMNode(a.caption);d&&(0,de["default"])(d,{opacity:[0,1]},{duration:200,easing:[.1,.82,.25,1]})}},a.onMinimizeClick=function(){var e=a.props,t=e.msg,o=e.getZoomNode,n=a.mediaVideo;if(n){var r=T["default"].findDOMNode(n).querySelector("video"),i=r.currentTime;O["default"].videoPlayerFloater((0,le.unproxy)(t),o,i)}a.onClose()},a.handleMouseMove=I["default"].throttle(a._handleMouseMove,42),a.zoomed=!1,a.closing=!1,a.listenToMouseMove=!1,a.startTime=e.startTime,
a.state={imgZoomed:!1,zoomElement:null},a}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"componentWillMount",value:function(){if(this.props.mediaData.mediaStage===J["default"].STAGE.RESOLVED&&this.props.zoomIn){var e=this.props.getZoomNode(this.props.msg.id);this.setState({zoomElement:e}),this.transparentStyle={opacity:0}}}},{key:"componentDidMount",value:function(){this.transparentStyle={}}},{key:"componentWillUnmount",value:function(){this.handleMouseMove.cancel()}},{key:"componentWillReceiveProps",value:function(e){this.props.mediaData!==e.mediaData&&(this.startTime=0)}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.mediaData,o=void 0;switch(a.type){case J["default"].TYPE.IMAGE:o=w["default"].createElement(ke,{msg:t,mediaData:a,key:t.id,style:this.transparentStyle,onLoad:this.onImageLoad,onImgZoomIn:this.onImgZoomIn,ref:this.setMediaImage});break;case J["default"].TYPE.VIDEO:o=w["default"].createElement(Ne,{msg:t,mediaData:a,key:t.id,onLoad:a.isGif?this.onImageLoad:null,startTime:this.startTime,ref:this.setMediaVideo});break;case J["default"].TYPE.AUDIO:o=w["default"].createElement(Pe,{mediaData:a,key:t.id})}var n=void 0;if(t.caption){var r=t.mentionMap(),i=_e.Configuration.TrustedConversation({mentions:r}),l=this.props.zoomIn&&(a.isGif||a.type===J["default"].TYPE.IMAGE);n=w["default"].createElement(W["default"],{ref:(0,ve.GetRef)("caption",this),className:{"media-caption":!0,"caption-hidden":l},formatters:i,text:t.caption})}var s=(0,B["default"])("media",{"media-with-caption":!!n}),u=w["default"].createElement(Ee["default"],{name:"chevron-right",title:l10n.t("next_button")}),c=(0,B["default"])("btn btn-round btn-media-next",{"disabled-btn":!this.props.onNext}),d=w["default"].createElement("div",{role:"button",className:c,onClick:this.props.onNext||function(e){return e.stopPropagation()}},u),f=w["default"].createElement(Ee["default"],{name:"chevron-left",title:l10n.t("previous_button")}),p=(0,B["default"])("btn btn-round btn-media-prev",{"disabled-btn":!this.props.onPrev}),h=w["default"].createElement("div",{role:"button",className:p,onClick:this.props.onPrev||function(e){return e.stopPropagation()}},f),m=(0,B["default"])("media-viewer",{"media-viewer-animate":this.props.zoomIn,"cursor-zoom-out":this.state.imgZoomed}),g=this.state.imgZoomed?null:this.onScroll,_=this.state.imgZoomed?null:this.onClose,v=this.state.imgZoomed&&this.listenToMouseMove?this.onMouseMove:null,b=this.state.imgZoomed?this.onZoomOut:null;return w["default"].createElement(ue["default"],{displayName:"MediaViewer",escapable:!0,requestDismiss:this.onClose},w["default"].createElement("div",{className:m,onClick:b,onMouseMove:v},w["default"].createElement(Z["default"],{msg:t,mediaData:a,onGoToMsgClick:this.onGoToMsgClick,onUnstarClick:this.onUnstarClick,onStarClick:this.onStarClick,openForwardFlow:this.openForwardFlow,onDownloadClick:this.onDownloadClick,onMinimizeClick:this.onMinimizeClick,onClose:this.onClose}),w["default"].createElement("div",{className:"media-content",dir:"ltr",ref:"container",onWheel:g,onClick:_},h,w["default"].createElement("div",{className:s},w["default"].createElement(Ie,{msg:t,mediaData:a}),o,n),d)))}}]),t}(w["default"].PureComponent),r.CONCERNS={msg:["id","star","isUnsentMedia","chat","caption"],mediaData:["mediaStage","type","isGif"]},r.defaultProps={getZoomNode:I["default"].noop},i));var Me=function(e){function t(){var e,a,o,n;(0,v["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,S["default"])(this,(e=t.__proto__||(0,g["default"])(t)).call.apply(e,[this].concat(i))),o.state={zoomIn:null},o.onImageClick=function(e){if(e.stopPropagation(),o.state.zoomIn)return void o.cancelZoomIn();var t=T["default"].findDOMNode(o.image),a=t.parentNode,n=a.parentNode;o.heightOverflow=a.clientHeight*Ce-n.clientHeight,o.widthOverflow=a.clientWidth*Ce-n.clientWidth;var r=o.getTranslatePosition(n,e.pageX,e.pageY),i=r.translateX,l=r.translateY;o.props.onImgZoomIn(!0),o.setState({zoomIn:{factor:Ce,translateX:i,translateY:l}})},o.cancelZoomIn=function(){o.props.onImgZoomIn(!1),o.setState({zoomIn:null})},o.getTranslatePosition=function(e,t,a){var n=window.innerWidth/2-t,r=window.innerHeight/2-a,i=o.widthOverflow>0?Math.round(1.5*n*o.widthOverflow/e.clientWidth):0,l=o.heightOverflow>0?Math.round(1.5*r*o.heightOverflow/e.clientHeight):0;return{translateX:i,translateY:l}},n=a,(0,S["default"])(o,n)}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"componentDidMount",value:function(){this.props.msg.forceDownloadMedia()}},{key:"render",value:function(){var e=this.props.mediaData,t=this.state.zoomIn,a=(0,B["default"])("media-viewer-img",{"cursor-zoom-in":!t});if(e.mediaStage===J["default"].STAGE.RESOLVED){var o={width:e.fullWidth,height:e.fullHeight},n=w["default"].createElement(K["default"],{src:e.renderableUrl,ref:(0,ve.GetRef)("image",this),onClick:this.onImageClick,style:this.props.style,className:a});return t&&(n=w["default"].createElement(ue["default"],{displayName:"ZoomInImage",ref:(0,ve.GetRef)("image",this),escapable:!0,requestDismiss:this.cancelZoomIn},n)),w["default"].createElement(ne["default"],{type:"zoomIn",size:o,position:"relative",zoomIn:this.state.zoomIn,onObjectLoad:this.props.onLoad},n)}return w["default"].createElement(Te,{mediaData:e})}}]),t}(w["default"].PureComponent);Me.CONCERNS={mediaData:["mediaStage","fullWidth","fullHeight","renderableUrl"]};var ke=function(e){function t(){return(0,v["default"])(this,t),(0,S["default"])(this,(t.__proto__||(0,g["default"])(t)).apply(this,arguments))}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"onImageClick",value:function(e){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).onImageClick(e)}},{key:"getTranslatePosition",value:function(e,a,o){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).getTranslatePosition(e,a,o)}},{key:"heightOverflow",get:function(){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).heightOverflow}},{key:"widthOverflow",get:function(){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).widthOverflow}},{key:"image",get:function(){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).image}}]),t}((0,ie["default"])(Me)),we=function(e){function t(){var e,a,o,n;(0,v["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,S["default"])(this,(e=t.__proto__||(0,g["default"])(t)).call.apply(e,[this].concat(i))),o.state={played:!1,size:{width:0,height:0}},o.updateSize=function(){var e=o.props.mediaData;e.mediaStage===J["default"].STAGE.RESOLVED&&e.fullWidth&&e.fullHeight&&o.setState({size:o.getSize()})},o.onPlayerError=function(e){},o.onPlayerClick=function(e){e.stopPropagation();var t=T["default"].findDOMNode(o.player);e.clientY>t.clientHeight+t.offsetTop-44||(t.paused?t.play():t.pause())},o.stopPropagation=function(e){e.stopPropagation()},o.getSize=function(){var e=o.props.mediaData,t=330;return!e.isGif||e.fullWidth>=t?{width:e.fullWidth,height:e.fullHeight}:{width:t,height:e.fullHeight*t/e.fullWidth}},n=a,(0,S["default"])(o,n)}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"componentWillMount",value:function(){this.updateSize()}},{key:"componentWillReceiveProps",value:function(){this.updateSize()}},{key:"componentDidMount",value:function(){this.props.msg.forceDownloadMedia()}},{key:"render",value:function(){var e=this.props,t=e.msg,a=e.mediaData,o=a.isGif,n=a.mediaStage===J["default"].STAGE.RESOLVED||(0,be.checkStreamingSupported)();if(n){var r=l10n.t("video_playback_not_supported"),i=void 0;return i=o?w["default"].createElement("div",{className:"media-viewer-img"},w["default"].createElement(pe["default"],{src:a.renderableUrl,onClick:this.stopPropagation,autoPlay:!0,loop:!0},r)):w["default"].createElement(me["default"],{msg:t,mediaData:a,ref:(0,ve.GetRef)("player",this),className:"media-viewer-img",onClick:this.onPlayerClick,autoPlay:!0,controls:!0,startTime:this.props.startTime},r),w["default"].createElement(ne["default"],{type:"scaleDown",position:"relative",size:this.state.size,onObjectLoad:this.props.onLoad},i)}return w["default"].createElement(Te,{mediaData:a})}}]),t}(w["default"].PureComponent);we.CONCERNS={mediaData:["mediaStage","fullWidth","fullHeight","isGif","renderableUrl"]};var Ne=function(e){function t(){return(0,v["default"])(this,t),(0,S["default"])(this,(t.__proto__||(0,g["default"])(t)).apply(this,arguments))}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"player",get:function(){return(0,h["default"])(t.prototype.__proto__||(0,g["default"])(t.prototype),"getComponent",this).call(this).player}}]),t}((0,ie["default"])(we)),Te=(0,ie["default"])((s=l=function(e){function t(){var e,a,o,n;(0,v["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,S["default"])(this,(e=t.__proto__||(0,g["default"])(t)).call.apply(e,[this].concat(i))),o.stopPropagation=function(e){e.stopPropagation()},n=a,(0,S["default"])(o,n)}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"render",value:function(){var e=this.props.mediaData,t=e.preview&&e.preview.url(),a=(0,ge.aspectRatioScaled)(e.aspectRatio,500);return w["default"].createElement("div",{className:"media-viewer-blur-crop",style:a,onClick:this.stopPropagation},w["default"].createElement("img",{className:"media-viewer-blur-img",src:t}))}}]),t}(w["default"].PureComponent),l.CONCERNS={mediaData:["preview","aspectRatio"]},s)),Pe=(0,ie["default"])((c=u=function(e){function t(){return(0,v["default"])(this,t),(0,S["default"])(this,(t.__proto__||(0,g["default"])(t)).apply(this,arguments))}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"render",value:function(){var e=this.props.mediaData;return e.mediaStage===J["default"].STAGE.RESOLVED?w["default"].createElement(A["default"],{url:e.renderableUrl,className:"media-viewer-audio",autoPlay:!0,controls:!0},l10n.t("audio_playback_not_supported")):w["default"].createElement("div",{className:"image-audio"})}}]),t}(w["default"].PureComponent),u.CONCERNS={mediaData:["mediaStage","renderableUrl"]},c)),Ie=(0,ie["default"])((f=d=function(e){function t(){var e,a,o,n;(0,v["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,S["default"])(this,(e=t.__proto__||(0,g["default"])(t)).call.apply(e,[this].concat(i))),o.onUnsupportedDownloadClick=function(e){e.stopPropagation(),O["default"].openModal(w["default"].createElement(ee["default"],{msg:(0,le.unproxy)(o.props.msg)}))},o.downloadMedia=function(e){e.stopPropagation(),o.props.msg.forceDownloadMedia()},o.stopPropagation=function(e){e.stopPropagation()},n=a,(0,S["default"])(o,n)}return(0,M["default"])(t,e),(0,y["default"])(t,[{key:"render",value:function(){var e=this.props.mediaData,t=null;switch(e.mediaStage){case J["default"].STAGE.RESOLVED:case J["default"].STAGE.ERROR_MISSING:return null;case J["default"].STAGE.ERROR_UNSUPPORTED:return t=this.onUnsupportedDownloadClick,w["default"].createElement(ae.Download,{filesize:e.size,onClick:t});case J["default"].STAGE.NEED_POKE:return t=this.downloadMedia,w["default"].createElement(ae.Download,{filesize:e.size,onClick:t});default:return t=this.stopPropagation,w["default"].createElement("div",{onClick:t},w["default"].createElement(ae.Pending,null))}}}]),t}(w["default"].PureComponent),d.CONCERNS={mediaData:["mediaStage","size"]},f))},7454:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(96),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(7126),_=a(484),v=(o(_),a(7215)),b=o(v),y=a(486),E=(o(y),a(265)),S=o(E),C=a(173),M=o(C),k=a(7170),w=o(k),N=a(7136),T=o(N),P=a(7140),I=(o(P),a(1)),R=o(I),A=a(7160),x=o(A),O=a(47),D=(a(7128),a(3)),L=(a(7125),window.Store),U=a(10),F=a(93),j=0,B=1,G=2,V=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.filteredData=null,o.setSearch=function(e){return o.search=e},o.setList=function(e){return o.list=e},o.state={filteredSections:o.calculateFilteredSections(o.props.searchText)},o.keyForRowAtIndexPath=function(e){var t=e.row,a=e.section,n=o.state.filteredSections;switch(n[a].id){case j:return"frequent-contact-"+n[a].data[t].id;case B:return"chat-"+n[a].data[t].id;case G:return"contact-"+n[a].data[t].id;default:return R["default"].error("Unknown section "+n[a].id)(),"unknown-section-"+a+"-row-"+t}},o.itemForRowAtIndexPath=function(e){var t=e.row,a=e.section,n=void 0,r=o.state.filteredSections;switch(r[a].id){case j:n=r[a].data[t];break;case B:n=r[a].data[t];break;case G:n=r[a].data[t];break;default:return R["default"].error("Unknown section "+r[a].id)(),null}return D.createElement(b["default"],{key:n.id,chat:n,active:o.props.activeChat,selections:o.props.selectedChats,onSelect:o.handleSelect})},o.handleSelect=function(e,t,a){o.props.selectedChats.setVal(e,t,a),o.props.activeChat.setVal(e,a),o.props.onSelectionChanged&&o.props.onSelectionChanged(e,t)},o.numberOfSections=function(){return o.state.filteredSections.length},o.numberOfRowsInSection=function(e){var t=o.state.filteredSections;return t[e].data.length},o.sectionForSection=function(e){var t=void 0,a=void 0,n=o.state.filteredSections;switch(n[e].id){case j:t="frequent-contacts-header",a=F.t("web_frequent_contacts");break;case B:t="chat-header",a=F.t("web_recent_chats");break;case G:t="contact-header",a=F.t("web_other_contacts");break;default:return R["default"].error("Unknown section "+n[e].id)(),null}return D.createElement(x["default"],{key:t,header:a})},o.onCancelSelection=function(){o.props.selectedChats.unsetAll()},o.onFocusList=function(e){e.preventDefault(),e.stopPropagation(),(0,C.shouldIndicateFocus)(),o.props.activeChat.setFirst(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())},o.onNext=function(e){e.preventDefault(),e.stopPropagation(),o.props.activeChat.setNext(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())},o.onPrev=function(e){e.stopPropagation(),e.preventDefault();var t=o.props.activeChat.prev();t>-1?(o.props.activeChat.setPrev(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())):o.props.onLeaveList&&(o.props.onLeaveList(e),o.props.activeChat.unset())},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.props.activeChat.init(this.flattenSections(this.state.filteredSections)),this.props.getInitialItems&&U.forEach(this.props.getInitialItems(),function(t){return e.props.selectedChats.setVal(t,!0)})}},{key:"componentWillReceiveProps",value:function(e){if(e.searchText!==this.props.searchText){var t=this.calculateFilteredSections(e.searchText);this.setState({filteredSections:t}),this.props.activeChat.init(this.flattenSections(t))}}},{key:"calculateFrequentContacts",value:function(e){var t=this.props,a=t.msgType,o=t.excludeChat;return e||!O.supportsFeature(O.F.FREQUENT_CONTACTS)?[]:L.Contact.frequentContacts(a,o)}},{key:"calculateFilteredChats",value:function(e){if(!e)return L.Chat.filter(function(e){return e.canSend&&e.isVisible});var t=function(){e=F.accentFold(e);var t=S["default"].numberSearch(e);return{v:L.Chat.filter(function(a){return a.canSend&&a.isVisible&&a.contact.searchMatch(e,t)})}}();return"object"==typeof t?t.v:void 0}},{key:"calculateFilteredContacts",value:function(e){var t=L.Contact.getFilteredContacts();if(!e)return t;e=F.accentFold(e);var a=S["default"].numberSearch(e);return t.filter(function(t){return t.searchMatch(e,a)})}},{key:"calculateFilteredSections",value:function(e){var t={},a=[],o=U.compact(U.map(this.calculateFrequentContacts(e),function(e){var a=e.isGroup?L.Chat.get(e.id):e;return a&&(t[a.id]=!0),a}));o.length&&a.push({id:j,data:o});var n=U.compact(U.map(this.calculateFilteredChats(e),function(e){var a=e.isGroup?e:e.contact;return t[a.id]?null:(t[a.id]=!0,a)}));n.length&&a.push({id:B,data:n});var r=U.compact(U.map(this.calculateFilteredContacts(e),function(e){return t[e.id]?null:e}));return r.length&&a.push({id:G,data:r}),a}},{key:"flattenSections",value:function(e){return U.concat.apply(U,(0,r["default"])(e.map(function(e){return e.data})))}},{key:"getIndexPathForActiveIndex",value:function(){for(var e=this.state.filteredSections,t=this.props.activeChat.index,a=0;a<e.length;++a){if(t<e[a].data.length)return new w["default"](t,a);t-=e[a].data.length}throw new Error("index "+this.props.activeChat.index+" out of bounds of data")}},{key:"toggleFirst",value:function(e){var t=this.state.filteredSections[0].data[0],a=!this.props.selectedChats.isSelected(t);this.handleSelect(t,a,e)}},{key:"getList",value:function(){return this.state.filteredSections.length?D.createElement(T["default"],{ref:this.setList,keyForRowAtIndexPath:this.keyForRowAtIndexPath,itemForRowAtIndexPath:this.itemForRowAtIndexPath,numberOfSections:this.numberOfSections,numberOfRowsInSection:this.numberOfRowsInSection,sectionForSection:this.sectionForSection,extraItems:4}):null}},{key:"render",value:function(){var e=this.getList();e||(e=this.state.searchText?D.createElement(g.Search,null):D.createElement(g.ListChats,null));var t={down:this.onNext,up:this.onPrev};return D.createElement(M["default"],{handlers:t},e)}}]),t}(D.Component);t["default"]=V},7455:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(96),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(7126),_=a(7215),v=o(_),b=a(173),y=o(b),E=a(7170),S=o(E),C=a(7136),M=o(C),k=a(1),w=o(k),N=a(7160),T=o(N),P=a(265),I=o(P),R=a(10),A=(a(7128),a(3)),x=(a(7125),0),O=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={filteredSections:o.calculateFilteredSections(o.props.searchText)},o.setList=function(e){return o.list=e},o.keyForRowAtIndexPath=function(e){var t=e.row,a=e.section,n=o.state.filteredSections,r=n[a].data;switch(n[a].id){case x:return"contact-"+r[t].id;default:return w["default"].error("Unknown section "+n[a].id)(),"unknown-section-"+a+"-row-"+t}},o.itemForRowAtIndexPath=function(e){var t=e.row,a=e.section,n=o.state.filteredSections[a].data[t];return A.createElement(v["default"],{key:n.id,chat:n,active:o.props.activeChat,selections:o.props.selectedChats,onSelect:o.handleSelect})},o.numberOfSections=function(){return o.state.filteredSections.length},o.numberOfRowsInSection=function(e){var t=o.state.filteredSections;return t[e].data.length},o.sectionForSection=function(e){var t=o.state.filteredSections;switch(t[e].id){case x:return A.createElement(T["default"],{key:"contact-header",header:l10n.t("web_contacts")});default:return w["default"].error("Unknown section "+t[e].id)(),null}},o.handleSelect=function(e,t,a){w["default"].log("[Toggle] handle select")(),o.props.selectedChats.setVal(e,t,a),o.props.activeChat.setVal(e,a),o.props.onSelectionChanged&&o.props.onSelectionChanged(e,t)},o.onFocusList=function(e){e.preventDefault(),e.stopPropagation(),(0,b.shouldIndicateFocus)(),o.props.activeChat.setFirst(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())},o.onNext=function(e){e.preventDefault(),e.stopPropagation(),o.props.activeChat.setNext(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())},o.onPrev=function(e){e.stopPropagation(),e.preventDefault();var t=o.props.activeChat.prev();t>-1?(o.props.activeChat.setPrev(!0,e),o.list&&o.list.scrollIntoViewIfNeeded(o.getIndexPathForActiveIndex())):o.props.onLeaveList&&(o.props.onLeaveList(e),o.clearActive())},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentWillMount",value:function(){var e=this;this.props.activeChat.init(this.flattenSections(this.state.filteredSections)),this.props.getInitialItems&&R.forEach(this.props.getInitialItems(),function(t){return e.props.selectedChats.setVal(t,!0)})}},{key:"componentWillReceiveProps",value:function(e){if(e.searchText!==this.props.searchText){var t=this.calculateFilteredSections(e.searchText);this.setState({filteredSections:t}),this.props.activeChat.init(this.flattenSections(t))}}},{key:"calculateFilteredSections",value:function(e){var t=[],a=this.calculateFilteredContacts(e);return a.length&&t.push({id:x,data:a}),t}},{key:"calculateFilteredContacts",value:function(e){var t=Store.Contact.getFilteredContacts();if(!e)return t;e=l10n.accentFold(e);var a=I["default"].numberSearch(e);return t.filter(function(t){return t.searchMatch(e,a)})}},{key:"flattenSections",value:function(e){return R.concat.apply(R,(0,r["default"])(e.map(function(e){return e.data})))}},{key:"getIndexPathForActiveIndex",value:function(){for(var e=this.state.filteredSections,t=this.props.activeChat.index,a=0;a<e.length;++a){if(t<e[a].data.length)return new S["default"](t,a);t-=e[a].data.length}throw new Error("index "+this.props.activeChat.index+" out of bounds of data")}},{key:"getList",value:function(){return this.state.filteredSections.length?A.createElement(M["default"],{ref:this.setList,keyForRowAtIndexPath:this.keyForRowAtIndexPath,itemForRowAtIndexPath:this.itemForRowAtIndexPath,numberOfSections:this.numberOfSections,numberOfRowsInSection:this.numberOfRowsInSection,sectionForSection:this.sectionForSection,extraItems:4}):null}},{key:"toggleFirst",value:function(e){var t=this.state.filteredSections[0].data[0],a=!this.props.selectedChats.isSelected(t);w["default"].log("[Toggle] toggle first")(),this.handleSelect(t,a,e)}},{key:"clearActive",value:function(){this.props.activeChat.unset()}},{key:"render",value:function(){var e=this.getList();e||(e=this.props.searchText?A.createElement(g.Search,null):A.createElement(g.ListChats,null));var t={down:this.onNext,up:this.onPrev};return A.createElement(y["default"],{handlers:t,className:"column",onFocus:this.onFocusList},e)}}]),t}(A.Component);t["default"]=O},7456:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(12),m=o(h),g=a(7120),_=o(g),v=a(7121),b=o(v),y=a(7122),E=o(y),S=a(173),C=o(S),M=a(93),k=o(M),w=a(178),N=o(w),T=a(3),P=o(T),I=a(7204),R=o(I),A=a(266),x=o(A),O=a(7613),D=o(O),L=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this,t=this.props.vcardList;return P["default"].createElement(N["default"],{type:w.BoxModalType},P["default"].createElement(_["default"],{onCancel:function(){return m["default"].closeModal()}},P["default"].createElement(E["default"],{title:k["default"].t("multi_vcard_number_of_contacts",{count:t.length,_plural:t.length}),type:y.DRAWER_HEADER_TYPE.POPUP,onCancel:function(){return m["default"].closeModal()}}),P["default"].createElement(b["default"],null,P["default"].createElement(C["default"],null,P["default"].createElement("div",{className:D["default"].body},t.map(function(t,a){return e.renderVCard(t,a)}))))))}},{key:"renderVCard",value:function(e,t){var a=x["default"].parse(e);return a?P["default"].createElement("div",{className:D["default"].vcardWrapper,key:t},P["default"].createElement(R["default"],{parsedVCard:a,thumbnail:x["default"].thumbnail(e)})):null}}]),t}(T.Component);t["default"]=L},7457:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){v["default"].closeModal()}Object.defineProperty(t,"__esModule",{value:!0});var r,i,l=a(5),s=o(l),u=a(2),c=o(u),d=a(4),f=o(d),p=a(7),h=o(p),m=a(6),g=o(m),_=a(12),v=o(_),b=a(7119),y=o(b),E=a(93),S=o(E),C=a(54),M=o(C),k=a(3),w=o(k),N=a(7118),T=o(N),P=a(21),I=o(P),R=a(94),A=o(R),x=a(7614),O=o(x),D=function(){return[{label:S["default"].t("web_mute_8hours"),duration:8},{label:S["default"].t("web_mute_1week"),duration:168},{label:S["default"].t("web_mute_1year"),duration:8760}]},L=8;t["default"]=(0,T["default"])((i=r=function(e){function t(){var e,a,o,n;(0,c["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,h["default"])(this,(e=t.__proto__||(0,s["default"])(t)).call.apply(e,[this].concat(i))),o.state={},o.onChange=function(e){var t=e.target;t instanceof HTMLInputElement&&o.setState({mute:parseInt(t.value,10)})},o.onMute=function(e){e.stopPropagation(),v["default"].closeModal();var t=o.getMuteDuration();I["default"].setLastChatMuteDuration(t),o.props.onMute(3600*t+(0,M["default"])().unix(),!0)},n=a,(0,h["default"])(o,n)}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"getMuteDuration",value:function(){return this.state.mute||I["default"].getLastChatMuteDuration()||L}},{key:"render",value:function(){var e=this,t=this.props.onCancel||n,a=this.getMuteDuration(),o=D().map(function(t){var o=t.duration;return w["default"].createElement("li",{key:"mute-"+o},w["default"].createElement("label",{className:O["default"].label},w["default"].createElement("input",{type:"radio",name:"duration",className:O["default"].input,value:t.duration,checked:a===o,onChange:e.onChange}),t.label))}),r=w["default"].createElement(y["default"],{text:S["default"].t("mute_time",{name:this.props.chat.title()})});return w["default"].createElement(A["default"],{title:r,okText:S["default"].t("web_menuitem_mute"),onOK:this.onMute,onCancel:t},w["default"].createElement("form",{ref:"form"},w["default"].createElement("ol",null,o)))}}]),t}(k.PureComponent),r.CONCERNS={chat:["id","formattedTitle"]},i))},7458:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(7441),r=o(n),i=a(7120),l=o(i),s=a(7121),u=o(s),c=a(7122),d=o(c),f=a(93),p=o(f),h=a(3),m=o(h);t["default"]=function(e){return m["default"].createElement(l["default"],null,m["default"].createElement(d["default"],{a8n:"drawer-title-notifications",title:p["default"].t("notifications_drawer_title"),onBack:e.onClose,type:c.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(u["default"],null,m["default"].createElement(r["default"],{key:"notifications"})))}},7459:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(17),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(10),b=o(v),y=a(36),E=o(y),S=a(94),C=o(S),M=a(12),k=o(M),w=a(173),N=o(w),T=a(279),P=o(T),I=a(509),R=o(I),A=a(7161),x=o(A),O=a(263),D=o(O),L=a(93),U=o(L),F=a(7209),j=a(172),B=o(j),G=a(7618),V=o(G),Y=a(23),W=o(Y),H=320,q=50,z=10,K=500,Q=3,J=10485760,X=function(e){function t(){var e,a,o,n;(0,u["default"])(this,t);for(var r=arguments.length,i=Array(r),s=0;r>s;s++)i[s]=arguments[s];return a=o=(0,p["default"])(this,(e=t.__proto__||(0,l["default"])(t)).call.apply(e,[this].concat(i))),o.state={email:"",emailError:void 0,confirmEmail:"",confirmEmailError:void 0,subject:U["default"].t("send_logs_default_subject"),subjectError:void 0,description:"",descriptionError:void 0,screenshots:[],isDragging:!1},o.setAttachButton=function(e){o.attachButton=e},o.setEmailAddr=function(e){o.emailAddrInput=e},o.onSend=function(){var e={},t=o.state,a=t.email,n=t.confirmEmail,r=t.subject,i=t.description,l=t.screenshots,s=a.trim(),u=n.trim();if(o.validateEmail(s)||(e.emailError=U["default"].t("send_logs_email_invalid")),o.validateConfirmEmail(u)||(e.confirmEmailError=U["default"].t("send_logs_email_nomatch")),o.validateDescription(i)||(e.descriptionError=U["default"].t("send_logs_too_short")),o.validateSubject(r)||(e.subjectError=U["default"].t("send_logs_subject_error")),b["default"].isEmpty(e)){o.setState({email:s,confirmEmail:u,emailError:void 0,confirmEmailError:void 0,descriptionError:void 0,subjectError:void 0}),l.map(function(e){e.url&&(URL.revokeObjectURL(e.url),delete e.url)});var c=Store.Conn.me?R["default"].format(Store.Conn.me.split("@")[0]):null,d=r.trim()||U["default"].t("send_logs_default_subject");E["default"].uploadUserReport(c,s,d,i,l),k["default"].closeModal(),k["default"].openToast(_["default"].createElement(D["default"],{msg:U["default"].t("send_logs_sent"),id:(0,O.genId)()}))}else e.email=s,e.confirmEmail=u,o.setState(e)},o.onCancel=function(){k["default"].closeModal()},o.onSubjectChange=function(e){var t={subject:e,subjectError:o.state.subjectError};o.state.subjectError&&o.validateSubject(t.subject)&&(t.subjectError=void 0),o.setState(t)},o.onSubjectBlur=function(){var e=void 0;o.validateSubject(o.state.subject)||(e=U["default"].t("send_logs_subject_error")),o.state.subjectError!==e&&o.setState({subjectError:e})},o.onDescriptionChange=function(e){var t={description:e,descriptionError:o.state.descriptionError};o.state.descriptionError&&o.validateDescription(t.description)&&(t.descriptionError=void 0),o.setState(t)},o.onDescriptionBlur=function(){var e=void 0;!o.state.description&&!o.state.descriptionError||o.validateDescription(o.state.description)||(e=U["default"].t("send_logs_too_short")),o.state.descriptionError!==e&&o.setState({descriptionError:e})},o.onEmailChange=function(e){var t={email:e,emailError:o.state.emailError};o.state.emailError&&o.validateEmail(t.email)&&(t.emailError=void 0),o.setState(t)},o.onEmailBlur=function(){var e=void 0,t=o.state.email.trim(),a={};!o.state.email&&!o.state.emailError||o.validateEmail(t)||(e=U["default"].t("send_logs_email_invalid")),o.state.emailError!==e&&(a.emailError=e),o.state.email!==t&&(a.email=t),b["default"].isEmpty(a)||o.setState(a)},o.onConfirmEmailChange=function(e){var t={confirmEmail:e,confirmEmailError:o.state.confirmEmailError};o.state.confirmEmailError&&o.validateConfirmEmail(t.confirmEmail)&&(t.confirmEmailError=void 0),o.setState(t)},o.onConfirmEmailBlur=function(){var e=void 0,t=o.state.confirmEmail.trim(),a={};!o.state.confirmEmail&&!o.state.confirmEmailError||o.validateConfirmEmail(t)||(e=U["default"].t("send_logs_email_nomatch")),o.state.confirmEmailError!==e&&(a.confirmEmailError=e),o.state.confirmEmail!==t&&(a.confirmEmail=t),b["default"].isEmpty(a)||o.setState(a)},o.validateEmail=function(e){return P["default"].validateEmail(e)},o.validateConfirmEmail=function(e){return o.state.email===e},o.validateDescription=function(e){return e.length>z},o.validateSubject=function(e){return!0},o.onFilePick=function(e){e.preventDefault(),e.stopPropagation(),o.reachMaxScreenshots()||(0,F.getFiles)(e,"image/*").then(function(e){o.attachButton&&(o.attachButton.value="");var t=e.filter(function(e){return e.size<=J});t.length<e.length&&k["default"].openToast(_["default"].createElement(D["default"],{msg:U["default"].t("send_logs_image_too_big"),id:(0,O.genId)()}));var a=o.state.screenshots.concat(t).slice(0,Q);a.map(function(e){e.url||(e.url=URL.createObjectURL(e))}),o.setState({screenshots:a})})},o.onDragChange=function(e,t){o.setState({isDragging:e})},o.handleAttachClick=function(e){o.attachButton&&!o.reachMaxScreenshots()&&o.attachButton.click()},o.stopPropagation=function(e){e.stopPropagation()},n=a,(0,p["default"])(o,n)}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"componentDidMount",value:function(){this.emailAddrInput&&this.emailAddrInput.restoreFocus()}},{key:"componentWillUnmount",value:function(){this.state.screenshots.map(function(e){var t=e.url;return t&&URL.revokeObjectURL(t)})}},{key:"reachMaxScreenshots",value:function(){return this.state.screenshots.length>=Q}},{key:"deleteScreenshot",value:function(e){var t=this.state.screenshots.slice(),a=t.splice(e,1),o=(0,
r["default"])(a,1),n=o[0];n.url&&URL.revokeObjectURL(n.url),this.setState({screenshots:t})}},{key:"getScreenshotsList",value:function(){var e=this,t=this.state.screenshots.map(function(t,a){if(!t.url)return null;var o="url("+t.url+")",n="screenshot-"+a;return _["default"].createElement("div",{key:n,className:V["default"].screenshotsImg,style:{backgroundImage:o}},_["default"].createElement("button",{className:V["default"].btnDelete,onClick:function(){e.deleteScreenshot(a)}},_["default"].createElement(B["default"],{name:"x-alt-light"})))});return t.length?_["default"].createElement("div",{className:V["default"].screenshotPreview},t):null}},{key:"getScreenshotAction",value:function(){if(this.reachMaxScreenshots()){var e=Q;return _["default"].createElement("div",{className:(0,W["default"])(V["default"].action,V["default"].disabled)},U["default"].t("send_logs_too_many_screenshots",{count:e,_plural:e}))}return this.state.isDragging?_["default"].createElement("div",{className:V["default"].action},U["default"].t("send_logs_release_screenshots")):_["default"].createElement("div",{className:V["default"].action,onClick:this.handleAttachClick},U["default"].t("send_logs_screenshots"))}},{key:"render",value:function(){var e={enter:this.stopPropagation},t=_["default"].createElement("div",{className:V["default"].screenshots},this.getScreenshotsList(),this.getScreenshotAction(),_["default"].createElement("input",{accept:"image/*",type:"file",multiple:!0,onClick:this.stopPropagation,onChange:this.onFilePick,ref:this.setAttachButton,disabled:this.reachMaxScreenshots()}));return _["default"].createElement(C["default"],{title:U["default"].t("send_logs_title"),okText:U["default"].t("send_logs_confirm"),onOK:this.onSend,onCancel:this.onCancel,onDrop:this.onFilePick,onDragChange:this.onDragChange},_["default"].createElement(N["default"],{handlers:e},_["default"].createElement(x["default"],{ref:this.setEmailAddr,value:this.state.email,error:this.state.emailError,maxLength:H,onChange:this.onEmailChange,onBlur:this.onEmailBlur,placeholder:U["default"].t("send_logs_email_address")}),_["default"].createElement(x["default"],{editable:!0,value:this.state.confirmEmail,error:this.state.confirmEmailError,maxLength:H,onChange:this.onConfirmEmailChange,onBlur:this.onConfirmEmailBlur,placeholder:U["default"].t("send_logs_email_confirm")}),_["default"].createElement(x["default"],{value:this.state.subject,error:this.state.subjectError,maxLength:q,onChange:this.onSubjectChange,onBlur:this.onSubjectBlur,placeholder:U["default"].t("send_logs_email_subject")}),_["default"].createElement(x["default"],{value:this.state.description,error:this.state.descriptionError,maxLength:K,onChange:this.onDescriptionChange,onBlur:this.onDescriptionBlur,placeholder:U["default"].t("describe_logs"),multiline:!0}),t))}}]),t}(_["default"].Component);t["default"]=X},7460:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(7120),_=o(g),v=a(7122),b=o(v),y=a(7121),E=o(y),S=a(7145),C=o(S),M=a(7167),k=(o(M),a(7217)),w=o(k),N=a(93),T=o(N),P=a(7123),I=o(P),R=a(7141),A=o(R),x=a(172),O=o(x),D=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.status=window.Store.Status.gaddUp(o.props.profileId),n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=Store.ServerProps.statusV2?m["default"].createElement(w["default"],{status:this.status}):null,t=m["default"].createElement(I["default"],{id:window.Store.Conn.me,size:82,quality:I["default"].Quality.HIGH});return m["default"].createElement(_["default"],{theme:"settings",onCancel:this.props.onClose},m["default"].createElement(b["default"],{title:T["default"].t("settings_flow_title"),onBack:this.props.onClose,type:v.DRAWER_HEADER_TYPE.LARGE}),m["default"].createElement(E["default"],null,m["default"].createElement(A["default"],{onClick:this.props.onProfile,image:t,primary:window.Store.Conn.pushname,theme:"identity",secondary:e}),m["default"].createElement(C["default"],{a8n:"li-notifications",icon:m["default"].createElement(O["default"],{name:"settings-notifications"}),onClick:this.props.onNotifications},T["default"].t("menuitem_notifications")),m["default"].createElement(C["default"],{a8n:"li-chat_wallpaper",icon:m["default"].createElement(O["default"],{name:"settings-wallpaper"}),onClick:this.props.onWallpaper},T["default"].t("menuitem_wallpaper")),m["default"].createElement(C["default"],{a8n:"li-blocked",icon:m["default"].createElement(O["default"],{name:"settings-blocked"}),onClick:this.props.onBlocked},T["default"].t("menuitem_blocked")),m["default"].createElement(C["default"],{a8n:"li-help",icon:m["default"].createElement(O["default"],{name:"settings-help"}),onClick:this.props.onHelp},T["default"].t("menuitem_help"))))}}]),t}(m["default"].PureComponent);t["default"]=D},7461:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(265),_=o(g),v=a(485),b=o(v),y=a(7230),E=o(y),S=a(7177),C=o(S),M=a(261),k=o(M),w=a(7137),N=o(w),T=a(7200),P=o(T),I=a(126),R=o(I),A=a(489),x=a(12),O=o(x),D=a(263),L=o(D),U=a(172),F=o(U),j=a(23),B=o(j),G=a(93),V=o(G),Y=a(53),W=(o(Y),a(174)),H=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));return e.onSend=function(t){if(t.preventDefault(),e.inputLine){var a=e.inputLine.value.trim();a.length&&(Store.Chat.find(e.props.msg.sender).then(function(t){t.sendMessage(_["default"].emojify(a),{},e.props.msg),O["default"].openToast(m["default"].createElement(L["default"],{msg:V["default"].t("status_v3_reply"),id:(0,D.genId)()}))}),e.inputLine&&e.inputLine.reset(),e.props.dismissReply())}},e.onFocus=function(t){e.setState({focused:!0})},e.onBlur=function(t){e.setState({focused:!1})},e.isFocused=function(){return e.state.focused},e.onEmojiPicker=function(t){t&&(t.preventDefault(),t.stopPropagation());var a=m["default"].createElement(C["default"],{onEmoji:e.onEmoji,onFocusRelease:e.restoreFocus});e.setState({emojiPicker:{menu:a,dirY:A.DirY.TOP,type:"emoji_picker",anchor:t.target}})},e.onEmoji=function(t){e.inputLine&&e.inputLine.replaceSelection(t)},e.restoreFocus=function(t){e.inputLine&&e.inputLine.focus(t)},e.restoreEmojiPickerFocus=function(){e.refs.emojiPickerUIE&&e.refs.emojiPickerUIE.getRef()&&e.refs.emojiPickerUIE.getRef().getElement()&&e.refs.emojiPickerUIE.getRef().getElement().component.restoreFocus()},e.emojiPickerClose=function(){e.setState({emojiPicker:void 0})},e.state={replyCaption:"",focused:!1,emojiPicker:void 0,chat:void 0},Store.Chat.find(e.props.msg.sender).checkpoint(e.props.rejectOnUnmount()).then(function(t){e.setState({chat:t})}),e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidUpdate",value:function(e,t){this.shouldPausePlayback(t)&&!this.shouldPausePlayback(this.state)?this.props.playbackController.resume():!this.shouldPausePlayback(t)&&this.shouldPausePlayback(this.state)&&this.props.playbackController.pause()}},{key:"shouldPausePlayback",value:function(e,t){return e.emojiPicker||e.focused}},{key:"isPaused",value:function(){return this.shouldPausePlayback(this.state)}},{key:"render",value:function(){var e=(0,B["default"])("status-v3-compose-box-wrapper"),t=void 0,a=void 0;this.state.emojiPicker&&(t=m["default"].createElement(k["default"],{displayName:"EmojiPicker",escapable:!0,popable:!0,ref:"emojiPickerUIE",requestDismiss:this.emojiPickerClose,requestFocus:this.restoreEmojiPickerFocus},m["default"].createElement(N["default"],{contextMenu:this.state.emojiPicker})),a=m["default"].createElement(k["default"],{displayName:"EmojiPicker",escapable:!0,requestFocus:this.restoreEmojiPickerFocus},m["default"].createElement("div",null,t)));var o=void 0;return this.state.chat&&this.state.focused&&!this.state.emojiPicker&&(o=m["default"].createElement(k["default"],{displayName:"StatusV3Reply",escapable:!0,requestDismiss:this.props.dismissReply},m["default"].createElement("div",{className:"compose-popup-panel"},m["default"].createElement(P["default"],{msg:this.props.msg,key:this.props.msg.id.toString(),chat:this.state.chat})))),m["default"].createElement("div",null,m["default"].createElement(R["default"],{transitionName:"status-v3-quoted-msg",transitionAppear:!0},o),m["default"].createElement("div",{className:e},m["default"].createElement("button",{className:"status-v3-emoji-icon",onClick:this.onEmojiPicker},m["default"].createElement(F["default"],{name:"status-v3-smiley"})),m["default"].createElement("div",{className:"status-v3-input-line-wrapper"},m["default"].createElement(E["default"],{ref:(0,W.GetRef)("inputLine",this),theme:"status-reply",spellCheck:!0,onFocus:this.onFocus,onBlur:this.onBlur,onEnter:this.onSend,placeholder:V["default"].t("type_a_reply"),editable:!0})),m["default"].createElement("button",{className:"status-v3-send-icon",onClick:this.onSend},m["default"].createElement(F["default"],{name:"send-light",directional:!0})),a))}}]),t}(m["default"].Component);t["default"]=(0,b["default"])(H)},7462:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(96),i=n(r),l=a(5),s=n(l),u=a(2),c=n(u),d=a(4),f=n(d),p=a(7),h=n(p),m=a(6),g=n(m),_=a(3),v=n(_),b=a(7136),y=n(b),E=a(7495),S=n(E),C=a(7131),M=(n(C),a(53)),k=(n(M),a(71)),w=n(k),N=a(7126),T=a(7277),P=n(T),I=a(7123),R=n(I),A=a(47),x=n(A),O=a(93),D=n(O),L=a(62),U=o(L),F=a(10),j=n(F),B=a(23),G=n(B),V=a(172),Y=n(V),W=0,H=1,q=function(e){function t(){(0,c["default"])(this,t);var e=(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments));z.call(e);var a=[].concat((0,i["default"])(e.getStatusList(!0)),(0,i["default"])(e.getStatusList(!1))),o=a.filter(function(e){return!e.contact.statusMute}),n=a.filter(function(e){return e.contact.statusMute});return e.state={statusList:o,mutedStatusList:n,myStatus:Store.StatusV3.getMyStatus()},e}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(Store.StatusV3,"add remove bulk_add change:msgsChanged change:unreadCount",this.onStatusAddRemove),this.props.listeners.add(Store.Contact,"change:statusMute",this.onContactMuteChange),this.props.listeners.add(Store.StatusV3,"sync")}},{key:"getStatusList",value:function(e){return Store.StatusV3.getUnexpired(e)}},{key:"render",value:function(){var e=this.getSections(),t=void 0;return t=Store.StatusV3.hasSynced()&&e.length>0?v["default"].createElement(y["default"],{className:"statuslist",itemForRowAtIndexPath:this.itemForRowAtIndexPath,keyForRowAtIndexPath:this.keyForRowAtIndexPath,sectionForSection:this.sectionForSection,numberOfRowsInSection:this.numberOfRowsInSection,numberOfSections:this.numberOfSections,heightForSection:this.heightForSection,heightForItem:this.heightForItem}):v["default"].createElement(N.ListStatus,null),v["default"].createElement("div",{className:"status-v3-list-panel"},v["default"].createElement(K,{statusV3:this.state.myStatus,onOpenStatus:this.props.onOpenStatus}),v["default"].createElement("div",{className:"status-v3-list-body","data-list-scroll-container":!0},t))}}]),t}(v["default"].Component),z=function(){var e=this;this.getSections=function(){var t=[],a=e.state.statusList,o=e.state.mutedStatusList;return a.length&&t.push(W),o.length&&t.push(H),t},this.numberOfSections=function(){return e.getSections().length},this.numberOfRowsInSection=function(t){var a=e.getSections();switch(a[t]){case W:return e.state.statusList.length;case H:return e.state.mutedStatusList.length;default:return 0}},this.sectionForSection=function(t){var a=e.getSections();switch(a[t]){case W:return v["default"].createElement("div",{className:"status-v3-list-section-sep"},v["default"].createElement("hr",null),v["default"].createElement("div",{className:"status-v3-list-section-text"},v["default"].createElement("span",null,D["default"].t("status_v3_updates"))));case H:return v["default"].createElement("div",{className:"status-v3-list-section-sep"},v["default"].createElement("hr",null),v["default"].createElement("div",{className:"status-v3-list-section-text"},v["default"].createElement("span",null,D["default"].t("status_v3_muted_updates"))))}},this.heightForItem=function(t){var a=t.section,o=e.getSections();switch(o[a]){case W:return 64;case H:return 64}return 0},this.heightForSection=function(t){var a=e.getSections();switch(a[t]){case W:return 32;case H:return 32}},this.keyForRowAtIndexPath=function(t){var a=t.row,o=t.section,n=e.getSections(),r=void 0;switch(n[o]){case W:var i=e.state.statusList[a];r=i.id+i.unreadCount;break;case H:var l=e.state.mutedStatusList[a];r=l.id+l.unreadCount}return r},this.itemForRowAtIndexPath=function(t){var a=t.row,o=t.section,n=e.getSections();switch(n[o]){case W:var r=function(){var t=e.state.statusList[a],o=(0,G["default"])({dimmed:0===t.unreadCount}),n=v["default"].createElement("div",{className:o},v["default"].createElement(S["default"],{statusV3:t,onClick:function(){return e.props.onOpenStatus(t)},contact:t.contact}));return{v:n}}();if("object"==typeof r)return r.v;case H:var i=function(){var t=e.state.mutedStatusList[a],o=(0,G["default"])("dimmed"),n=v["default"].createElement("div",{className:o},v["default"].createElement(S["default"],{statusV3:t,onClick:function(){return e.props.onOpenStatus(t)},contact:t.contact}));return{v:n}}();if("object"==typeof i)return i.v}},this.onStatusAddRemove=function(){var t=[].concat((0,i["default"])(e.getStatusList(!0)),(0,i["default"])(e.getStatusList(!1))),a=t.filter(function(e){return!e.contact.statusMute}),o=t.filter(function(e){return e.contact.statusMute});e.setState({statusList:a,mutedStatusList:o,myStatus:Store.StatusV3.getMyStatus()})},this.onContactMuteChange=function(){var t=[].concat((0,i["default"])(e.getStatusList(!0)),(0,i["default"])(e.getStatusList(!1))),a=t.filter(function(e){return!e.contact.statusMute}),o=t.filter(function(e){return e.contact.statusMute});e.setState({statusList:a,mutedStatusList:o,myStatus:Store.StatusV3.getMyStatus()})}},K=function(e){function t(){return(0,c["default"])(this,t),(0,h["default"])(this,(t.__proto__||(0,s["default"])(t)).apply(this,arguments))}return(0,g["default"])(t,e),(0,f["default"])(t,[{key:"render",value:function(){var e=this,t=void 0,a=this.props.statusV3,o=void 0,n=void 0;a&&(n=a.msgs.models);var r=function(){var t=a.msgs.models;j["default"].isEmpty(t)||e.props.onOpenStatus(a,t[0])},i=void 0,l=void 0;j["default"].isEmpty(n)?(t=v["default"].createElement(R["default"],{id:Store.Conn.me,size:40}),o=v["default"].createElement("span",{className:"secondary"},D["default"].t("status_v3_no_updates"))):(t=v["default"].createElement(P["default"],{statusV3:a,contact:a.contact}),o=v["default"].createElement("span",{className:"secondary"},U.relativeDateAndTimeStr(a.msgs.last().t)),l={cursor:"pointer"},i=r);var s=void 0,u=void 0;x["default"].supportsFeature(x["default"].F.STATUS_V3_UI_SENDING)&&Store.ServerProps.statusV3&&(s=v["default"].createElement(Y["default"],{name:"menu-white"}),u=v["default"].createElement(Y["default"],{name:"status-v3-create"}));var c=v["default"].createElement("span",{className:"primary"},D["default"].t("status_v3_my_status")),d=v["default"].createElement("div",{className:"status-v3-list-panel-header",style:l,onClick:i},v["default"].createElement("div",{className:"status-v3-list-panel-header-buttons-primary"},t),v["default"].createElement("div",{className:"status-v3-list-panel-header-text"},c,o),v["default"].createElement("div",{className:"status-v3-list-panel-header-buttons-secondary"},u,s));return d}}]),t}(v["default"].Component);t["default"]=(0,w["default"])(q)},7463:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(7462),m=o(h),g=a(7464),_=o(g),v=a(7131),b=(o(v),a(53)),y=(o(b),a(12)),E=o(y),S=a(23),C=o(S),M=a(172),k=o(M),w=a(71),N=o(w),T=a(3),P=function(e){function t(e){(0,l["default"])(this,t);var a=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).call(this,e));return a.onStatusAddRemove=function(){a.setState({status:Store.StatusV3.getMyStatus()})},a.state={status:Store.StatusV3.getMyStatus()},a}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"shouldComponentUpdate",value:function(e,t){return t.status!==this.state.status}},{key:"componentWillMount",value:function(){this.props.listeners.add(Store.StatusV3,"add remove",this.onStatusAddRemove),this.props.listeners.add(E["default"],"open_chat",this.props.closeStatusViewer)}},{key:"render",value:function(){var e=this,t=this.props.onOpenStatus,a=(0,C["default"])("status-v3-x",{});return T.createElement("div",{className:"status-v3-modal-background"},T.createElement("div",{className:"status-v3-main-wrapper"},T.createElement(m["default"],{onOpenStatus:t}),T.createElement(_["default"],{status:this.state.status,onOpenStatus:t}),T.createElement("button",{className:a,onClick:function(){return e.props.closeStatusViewer(!0)}},T.createElement(k["default"],{name:"status-v3-x"}))))}}]),t}(T.Component);t["default"]=(0,N["default"])(P)},7464:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(93),g=n(m),_=a(1),v=n(_),b=a(10),y=n(b),E=a(7131),S=(n(E),a(7203)),C=a(53),M=n(C),k=a(71),w=n(k),N=a(485),T=n(N),P=a(62),I=o(P),R=a(47),A=n(R),x=a(14),O=n(x),D=a(172),L=n(D),U=a(3),F=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=U.createElement(B,{statusV3:this.props.status,onOpenStatus:this.props.onOpenStatus}),t=void 0,a=void 0;return A["default"].supportsFeature(A["default"].F.STATUS_V3_UI_SENDING)&&Store.ServerProps.statusV3&&(t=U.createElement("div",{className:"status-v3-update-wrapper"},U.createElement("div",{className:"status-v3-update-title"},g["default"].t("status_v3_update_status")),U.createElement("div",{className:"status-v3-upload-buttons"},U.createElement("div",{className:"status-v3-button-container"},U.createElement(L["default"],{name:"status-v3-upload"}),U.createElement("p",null,g["default"].t("status_v3_upload"))),U.createElement("div",{className:"status-v3-button-container"},U.createElement(L["default"],{name:"status-v3-camera"}),U.createElement("p",null,g["default"].t("status_v3_camera"))))),a=U.createElement("hr",null)),U.createElement("div",{className:"status-v3-out-status-panel"},t,a,e)}}]),t}(U.Component),j=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.statusV3;e&&(this.props.listeners.add(e,"change:msgsChanged"),e.loadMore(e.totalCount)["catch"](function(e){v["default"].error("error while loading all out status: "+e)()}))}},{key:"componentWillReceiveProps",value:function(e){this.props.statusV3&&this.props.listeners.remove(this.props.statusV3,"change:msgsChanged"),e.statusV3&&this.props.listeners.add(e.statusV3,"change:msgsChanged")}},{key:"render",value:function(){var e=this,t=void 0,a=this.props.statusV3,o=void 0;return a&&a.msgs&&(o=a.msgs.models,t=y["default"].map(o,function(t){return U.createElement(V,{key:t.id,msg:t,status:a,onOpenStatus:e.props.onOpenStatus})})),y["default"].isEmpty(o)?U.createElement("div",{className:"status-v3-view-wrapper"},U.createElement("div",{className:"status-v3-view-placeholder-icon"},U.createElement("div",{className:"status-v3-placeholder-icon"},U.createElement(L["default"],{name:"status-v3-placeholder"}))),U.createElement("div",{className:"status-v3-view-placeholder-text"},g["default"].t("status_v3_out_status_placeholder"))):U.createElement("div",{className:"status-v3-view-wrapper"},U.createElement("div",{className:"status-v3-view-title"},g["default"].t("status_v3_view_status")),U.createElement("div",{className:"status-v3-view-updates"},t))}}]),t}(U.Component),B=(0,w["default"])(j),G=function(e){function t(){(0,s["default"])(this,t);var e=(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments));return e.state={},e}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentWillMount",value:function(){var e=this;Store.MsgInfo.find(this.props.msg.id).checkpoint(this.props.rejectOnUnmount()).then(function(t){e.props.listeners.add(t.read,"add remove",function(){e.setState({seenCount:t.read.length})}),e.setState({seenCount:t.read.length})})["catch"](O["default"].Unmount,y["default"].noop)["catch"](O["default"].EphemeralDrop,y["default"].noop)}},{key:"render",value:function(){var e=this,t=this.props,a=t.msg,o=t.status,n=a.mediaData,r=void 0;if(n&&n.preview)r={backgroundImage:"url("+n.preview.url()+")"};else if(a.type===M["default"].TYPE.CHAT){var i=a.statusV3TextBg;r={backgroundColor:i}}var l=void 0;return a.type===M["default"].TYPE.CHAT&&(l=U.createElement(S.StatusV3Text,{msg:a})),U.createElement("div",{className:"status-v3-out-detail"},U.createElement("div",{className:"status-image",style:r,onClick:function(){return e.props.onOpenStatus(o,a)}},l),U.createElement("div",{className:"status-v3-seen"},U.createElement(L["default"],{name:"status-v3-seen"}),U.createElement("div",{className:"status-v3-seen-count"},this.state.seenCount)),U.createElement("div",{className:"status-v3-timestamp"},I.relativeDateAndTimeStr(a.t)))}}]),t}(U.Component),V=(0,T["default"])((0,w["default"])(G));t["default"]=F},7465:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(12),_=o(g),v=a(94),b=o(v),y=a(33),E=o(y),S=a(71),C=o(S);t["default"]=(0,C["default"])(function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.close=function(){0===Store.Conn.tos&&_["default"].closeModal()},o.logout=function(){_["default"].closeModal(),E["default"].logout()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(Store.Conn,"change:tos",this.close)}},{key:"render",value:function(){var e=void 0,t=void 0,a=void 0;switch(Store.Conn.tos){default:case 1:e=l10n.t("web_terms_of_service_1"),t=l10n.t("ok_got_it"),a=function(){return _["default"].closeModal()};break;case 2:e=l10n.t("web_terms_of_service_2"),t=l10n.t("menuitem_logout"),a=this.logout}return m["default"].createElement(b["default"],{onOK:a,okText:t},e)}}]),t}(m["default"].Component))},7466:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(484),_=(o(g),a(53)),v=(o(_),a(12)),b=o(v),y=a(7119),E=o(y),S=a(94),C=o(S),M=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.onCancel=function(){b["default"].closeModal()},o.onUnstar=function(){var e=o.props.chat,t=o.props.msgs;e&&e.pendingAction++,Store.Chat.unstarAllMessages(t,e)["finally"](function(){e&&e.pendingAction--}),b["default"].closeModal()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){return m["default"].createElement(C["default"],{onOK:this.onUnstar,okText:l10n.t("unstar_all_button"),onCancel:this.onCancel},m["default"].createElement("div",null,m["default"].createElement(E["default"],{text:l10n.t("unstar_all_confirm")})))}}]),t}(m["default"].Component);t["default"]=M},7467:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(486),m=(o(h),a(484)),g=o(m),_=a(7120),v=o(_),b=a(7121),y=o(b),E=a(7122),S=o(E),C=a(173),M=o(C),k=a(93),w=o(k),N=a(178),T=o(N),P=a(3),I=o(P),R=a(7144),A=o(R),x=a(7204),O=o(x),D=a(266),L=o(D),U=a(172),F=o(U),j=a(7620),B=o(j),G=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.contactList,o=t.onSend,n=t.onBack,r=t.chat,i=void 0;switch(r.kind){case g["default"].KIND.CHAT:i=w["default"].t("confirm_sending_contact_chat",{chat:r.title(),count:w["default"].n(a.length),_plural:a.length});break;case g["default"].KIND.GROUP:i=w["default"].t("confirm_sending_contact_group",{chat:r.title(),count:w["default"].n(a.length),_plural:a.length});break;case g["default"].KIND.BROADCAST:i=w["default"].t("confirm_sending_contact_broadcast",{chat:r.title(),count:w["default"].n(a.length),_plural:a.length})}return I["default"].createElement(T["default"],{type:N.BoxModalType},I["default"].createElement(v["default"],null,I["default"].createElement(S["default"],{title:i,type:E.DRAWER_HEADER_TYPE.POPUP,onBack:n}),I["default"].createElement(y["default"],null,I["default"].createElement(M["default"],null,I["default"].createElement("div",{className:B["default"].body},a.map(function(t,a){return e.renderVCard(L["default"].fromContactModel(t),a.toString())})))),I["default"].createElement("div",{className:B["default"].btnContainer},I["default"].createElement("div",{className:B["default"].btnPosition},I["default"].createElement(A["default"],{large:!0,onClick:o},I["default"].createElement(F["default"],{name:"send-light",directional:!0}))))))}},{key:"renderVCard",value:function(e,t){var a=L["default"].parse(e.vcard);return a?I["default"].createElement("div",{className:B["default"].vcardWrapper},I["default"].createElement(O["default"],{key:t,parsedVCard:a,thumbnail:L["default"].thumbnail(e.vcard)})):null}}]),t}(P.Component);t["default"]=G},7468:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(178),m=o(h),g=a(7120),_=o(g),v=a(7122),b=o(v),y=a(7121),E=o(y),S=a(7259),C=o(S),M=a(7622),k=o(M),w=a(3),N=a(32),T=a(266),P=window._,I=window.l10n,R=function(e){function t(){return(0,l["default"])(this,t),(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments))}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"renderContacts",value:function(){var e=this,t=P.filter(this.props.vCard.TEL,function(e){return e.properties.waid});return t.map(function(t){var a=N.numberToWid(P.first(t.properties.waid));return w.createElement("div",{className:k["default"].container,key:"vCard-"+t.index},w.createElement(C["default"],{title:N.formattedUser(a),onClick:function(){return e.onSelect(a)},icon:e.props.icon},T.getType(t)))})}},{key:"onSelect",value:function(e){this.props.onSelect(e)}},{key:"render",value:function(){return w.createElement(m["default"],{type:h.BoxModalType},w.createElement(_["default"],null,w.createElement(b["default"],{onCancel:this.props.onCancel,type:v.DRAWER_HEADER_TYPE.POPUP,title:I.t("choose_phone_number")}),w.createElement(E["default"],null,this.renderContacts())))}}]),t}(w.Component);R.defaultProps={onCancel:P.noop,onSelect:P.noop},e.exports=R},7469:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.visible,a=null;return t&&(a=X["default"].createElement("div",{className:"verification-circle"},X["default"].createElement("div",{className:"spinner"},X["default"].createElement(ae["default"],{size:40,stroke:4})))),a}function i(e){var t=e.binary,a=e.contact,o=e.visible,n=null;return o&&(n=X["default"].createElement("div",{className:"verification-circle-container"},X["default"].createElement(Se,{visible:!!t,binary:t,contact:a}),X["default"].createElement(r,{visible:!t}))),n}function l(e){var t=e.visible,a=null;return t&&(a=X["default"].createElement("div",{className:"verification-checkmark-container"},X["default"].createElement("div",{className:"verification-checkmark"}," "))),a}function s(e){var t=e.visible,a=null;return t&&(a=X["default"].createElement("div",{className:"verification-error-container"},X["default"].createElement("div",{className:"verification-error"},"!"))),a}function u(e){var t=e.children;return X["default"].createElement("div",{className:"error-banner"},t)}function c(e,t){var a=new Uint8Array(e),o=new Uint8Array(t),n=a.length,r=o.length;if(n!==r)return!1;for(var i=0;n>i;i++)if(a[i]!==o[i])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});var d=a(0),f=n(d),p=a(5),h=n(p),m=a(2),g=n(m),_=a(4),v=n(_),b=a(7),y=n(b),E=a(6),S=n(E),C=a(10),M=n(C),k=a(8),w=n(k),N=a(12),T=n(N),P=a(486),I=(n(P),a(7120)),R=n(I),A=a(7121),x=n(A),O=a(7122),D=n(O),L=a(14),U=n(L),F=a(7152),j=n(F),B=a(71),G=n(B),V=a(1),Y=n(V),W=a(485),H=n(W),q=a(7005),z=n(q),K=a(503),Q=n(K),J=a(3),X=n(J),Z=a(46),$=n(Z),ee=a(39),te=a(175),ae=n(te),oe=a(7118),ne=n(oe),re=a(127),ie=n(re),le=a(72),se=n(le),ue=a(7173),ce=n(ue),de=a(7169),fe=o(de),pe=a(7494),he=a(174),me=a(172),ge=n(me),_e=a(7133),ve=n(_e),be=a(7221),ye=n(be),Ee=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o.stopPropagation=function(e){e.stopPropagation()},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"render",value:function(){return X["default"].createElement("input",{accept:this.props.mime,type:"file",style:{display:"none"},onChange:this.props.onPick,onClick:this.stopPropagation})}}]),t}(X["default"].Component),Se=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o.state={hover:!1,currentQRBinary:null,currentQRDataURL:null},o.onMouseOver=function(e){o.state.hover||o.setState({hover:!0})},o.onMouseEnter=function(e){o.state.hover||o.setState({hover:!0})},o.onMouseLeave=function(e){o.state.hover&&o.setState({hover:!1})},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentDidMount",value:function(){this.props.binary&&this.generateQRCode()}},{key:"componentDidUpdate",value:function(e,t){this.generateQRCode()}},{key:"shouldComponentUpdate",value:function(e,t){return!(this.compareBinary(e.binary,this.props.binary)&&this.compareBinary(t.currentQRBinary,this.state.currentQRBinary)&&e.visible===this.props.visible&&t.hover===this.state.hover&&t.currentQRDataURL===this.state.currentQRDataURL);
}},{key:"fingerprintsMatched",value:function(e,t){return c(e.publicKey,t.publicKey)&&c(e.identifier,t.identifier)}},{key:"compareBinary",value:function(e,t){if(!e&&!t)return!0;var a=pe.CombinedFingerprint.parse(e),o=pe.CombinedFingerprint.parse(t);if(!a&&!o)return!0;if(!(a.version||o.version||a.localFingerprint||o.localFingerprint||a.remoteFingerprint||o.remoteFingerprint))return!0;if(a.version!==o.version)return!1;var n=this.fingerprintsMatched(a.localFingerprint,o.localFingerprint),r=this.fingerprintsMatched(a.remoteFingerprint,o.remoteFingerprint);return n&&r}},{key:"generateQRCode",value:function(){var e=$["default"].findDOMNode(this.refs.QRCodeContainer),t=this.props.binary;if(!e||!t)return void this.setState({currentQRBinary:null,currentQRDataURL:null});if(!this.compareBinary(this.state.currentQRBinary,t)){this.qr&&delete this.qr,this.qr=new Q["default"](e,{text:t,width:w["default"].QR_EDGE/2,height:w["default"].QR_EDGE/2,correctLevel:Q["default"].CorrectLevel.L}),this.setState({currentQRBinary:t});var a=e.getElementsByTagName("canvas")[0];if(!a)return void this.setState({currentQRDataURL:null});var o=a.toDataURL("image/png");this.setState({currentQRDataURL:o})}}},{key:"render",value:function(){var e=null;if(this.props.visible){var t=null;if(this.state.hover&&this.state.currentQRDataURL){var a=this.props.contact.formattedUser,o=Store.Contact.get(Store.Conn.me).formattedUser,n="Verification Code between "+o+" and "+a+".png";t=X["default"].createElement("a",{href:this.state.currentQRDataURL,download:n},X["default"].createElement(ye["default"],{text:l10n.t("web_verify_download_code")}))}e=X["default"].createElement("div",{onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},t,X["default"].createElement("div",{className:"verification-circle",ref:"QRCodeContainer"}))}return e}}]),t}(X["default"].Component);Se.defaultProps={binary:null};var Ce=3,Me=4,ke=5,we=function(e){function t(){return(0,g["default"])(this,t),(0,y["default"])(this,(t.__proto__||(0,h["default"])(t)).apply(this,arguments))}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"shouldComponentUpdate",value:function(e){return e.string!==this.props.string}},{key:"numDigitsInVerificationString",value:function(){return Ce*Me*ke}},{key:"render",value:function(){if(!this.props.string)return X["default"].createElement("div",null,l10n.t("loading"));var e=this.props.string;if(e.length!==this.numDigitsInVerificationString())return Y["default"].error("verificationString:render this.props.string"+("should be "+this.numDigitsInVerificationString()+" ")+("characters long instead of "+e.length+"."))(),X["default"].createElement("div",null,l10n.t("web_verify_string_error"));for(var t=[],a=0;Ce>a;a++){for(var o=[],n=0;Me>n;n++){for(var r=[],i=0;ke>i;i++){var l=e.charAt(a*ke*Me+n*ke+i);r.push(X["default"].createElement("span",{className:"digit",key:i},l))}o.push(X["default"].createElement("span",{className:"block",key:n},r," "))}t.push(X["default"].createElement("div",{className:"code-row",key:a},o))}return X["default"].createElement(ee.SelectableDiv,{className:"textfield-static",selectable:!0},t)}}]),t}(X["default"].Component);we.defaultProps={string:null};var Ne=200,Te=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o.state={videoURL:window.URL.createObjectURL(o.props.stream)},o.onVideoLoaded=function(){o.captureInterval||(o.adjustOverlayPosition(),o.captureInterval=o.props.setInterval(o.capture,Ne))},o.capture=function(){if(o.verificationVideo){var e=o.verificationVideo.underlyingVideo();if(e){var t=document.createElement("canvas");t.width=e.videoWidth/2,t.height=e.videoHeight/2;var a=t.getContext("2d");a.drawImage(e,t.width/2,t.height/2,t.width,t.height,0,0,t.width,t.height),t.toBlob(function(e){var t=window.URL.createObjectURL(e);Y["default"].log(t),o.props.onCapture(t)},"image/jpeg",1)}}},o.adjustOverlayPosition=function(){var e=o.verificationVideo.underlyingVideo(),t=$["default"].findDOMNode(o.refs.verificationOverlay);if(e&&t){var a=e.offsetHeight,n=e.offsetWidth,r=n/3,i=r,l=(n-r)/2,s=(a-i)/2;t.style.width=r+"px",t.style.height=i+"px",t.style.margin=s+"px "+l+"px"}},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(window,"resize",this.adjustOverlayPosition)}},{key:"componentWillUnmount",value:function(){if(this.captureInterval&&this.props.clearInterval(this.captureInterval),this.state.videoURL){var e=this.props.stream;fe.stop(e),window.URL.revokeObjectURL(this.state.videoURL)}}},{key:"render",value:function(){var e=null;return this.state.videoURL&&(e=X["default"].createElement("div",{className:"webcam"},X["default"].createElement(ce["default"],{autoPlay:!0,ref:(0,he.GetRef)("verificationVideo",this),onPlay:this.onVideoLoaded,src:this.state.videoURL}),X["default"].createElement("div",{className:"overlay",ref:"verificationOverlay"}),X["default"].createElement("button",{onClick:this.props.onClose},X["default"].createElement(ge["default"],{name:"x-alt"})))),e}}]),t}(X["default"].Component),Pe=(0,G["default"])((0,ie["default"])(Te)),Ie=3e3,Re=5e3,Ae=7e3,xe={CORRECT:0,PUBLIC_KEY_MISMATCHED:1,REMOTE_MISMATCHED:2,LOCAL_MISMATCHED:3,BOTH_MISMATCHED:4,INVALID_QR_CODE:5},Oe=function(e){function t(){var e,a,o,n;(0,g["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,y["default"])(this,(e=t.__proto__||(0,h["default"])(t)).call.apply(e,[this].concat(i))),o.state={circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,webcamVisible:!1,bannerVisible:!1,bannerText:null,stream:null,isDragging:!1},o.onDragChange=function(e){o.setState({isDragging:e})},o.onDrop=function(e){o.props.contact.verificationBinary&&o.props.contact.verificationString&&o.onUploadSelect(e)},o.showWebcamHint=function(){o.state.webcamVisible&&!o.state.bannerVisible&&o.showBanner(l10n.t("web_verify_webcam_hint"))},o.onWebcamOpen=function(e){var t=fe.start("camera");f["default"].race([t,o.props.rejectOnUnmount()]).checkpoint(o.props.rejectOnUnmount()).then(function(e){return o.showWebcamStream(e)})["catch"](U["default"].Unmount,function(){t.then(function(e){return fe.stop(e)})["catch"](M["default"].noop)})["catch"](U["default"].GUM.PermissionDeniedError,function(){T["default"].openModal(X["default"].createElement(j["default"],{title:"guide_desktop_camera_title",desc:"guide_desktop_camera_fail_description",type:j["default"].TYPE.GUIDE_UNBLOCK}))})["catch"](U["default"].GUM.GUMError,function(){T["default"].openModal(X["default"].createElement(j["default"],{title:"guide_desktop_camera_missing_title",desc:"guide_desktop_camera_missing_description",type:j["default"].TYPE.GUIDE_NONE}))})},o.onWebcamClose=function(){o.setState({webcamVisible:!1,bannerVisible:!1,stream:null})},o.onWebcamCapture=function(e){o.verifyImage(e,!0)},o.onUploadClick=function(){$["default"].findDOMNode(o.refs.verificationFilePicker).click()},o.onUploadSelect=function(e){e.stopPropagation();var t=e.target.files||e.dataTransfer.files;if(t&&t[0]){var a=t[0],n=URL.createObjectURL(a);o.verifyImage(n,!1);var r=$["default"].findDOMNode(o.refs.verificationFilePickerForm);r&&r.reset()}},o.onClose=function(e){o.props.onClose?o.props.onClose():o.context.uim.uie.requestDismiss()},o.hideCheckmark=function(){o.state.errorIconVisible||o.setState({circleVisible:!0}),o.setState({checkmarkVisible:!1})},o.hideError=function(){o.state.checkmarkVisible||o.setState({circleVisible:!0}),o.setState({errorIconVisible:!1})},o.hideBanner=function(){o.setState({bannerVisible:!1})},n=a,(0,y["default"])(o,n)}return(0,S["default"])(t,e),(0,v["default"])(t,[{key:"componentDidUpdate",value:function(e,t){e.contact!==this.props.contact&&this.props.contact.queryIdentity()["catch"](function(e){Y["default"].error("VerificationDrawer:queryIdentity error: "+e)()})}},{key:"componentWillMount",value:function(){this.props.contact.queryIdentity()["catch"](function(e){Y["default"].error("verificationDrawer:queryIdentity error: "+e)()})}},{key:"componentWillUnmount",value:function(){this.props.clearTimeout(this.iconTimer),this.props.clearTimeout(this.bannerTimer),this.props.clearTimeout(this.hintTimer)}},{key:"showWebcamStream",value:function(e){this.setState({webcamVisible:!0,circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,stream:e}),this.hintTimer&&(this.props.clearTimeout(this.hintTimer),delete this.hintTimer),this.hintTimer=this.props.setTimeout(this.showWebcamHint,Ae)}},{key:"getErrorBannerText",value:function(e){var t=void 0,a=this.props.contact.formattedShortName;switch(e){case xe.REMOTE_MISMATCHED:t=l10n.t("web_verify_error_remote_mismatched",{contact:a});break;case xe.LOCAL_MISMATCHED:case xe.BOTH_MISMATCHED:t=l10n.t("web_verify_error_local_mismatched",{contact:a});break;case xe.INVALID_QR_CODE:default:t=l10n.t("web_verify_error_invalid_upload")}return t}},{key:"showCheckmark",value:function(){this.onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!0,errorIconVisible:!1,bannerVisible:!1}),this.iconTimer&&(this.props.clearTimeout(this.iconTimer),delete this.iconTimer),this.iconTimer=this.props.setTimeout(this.hideCheckmark,Ie)}},{key:"showErrorIcon",value:function(){this.onWebcamClose(),this.setState({circleVisible:!1,checkmarkVisible:!1,errorIconVisible:!0,bannerVisible:!1}),this.iconTimer&&(this.props.clearTimeout(this.iconTimer),delete this.iconTimer),this.iconTimer=this.props.setTimeout(this.hideError,Ie)}},{key:"showErrorBanner",value:function(e){var t=this.getErrorBannerText(e);this.showBanner(t)}},{key:"showBanner",value:function(e){this.setState({circleVisible:!0,checkmarkVisible:!1,errorIconVisible:!1,bannerVisible:!0,bannerText:e}),this.bannerTimer&&(this.props.clearTimeout(this.bannerTimer),delete this.bannerTimer),this.bannerTimer=this.props.setTimeout(this.hideBanner,Re)}},{key:"validateFingerprint",value:function(e){if(!e||0===!e.version||!e.localFingerprint||!e.remoteFingerprint)return xe.INVALID_QR_CODE;var t=pe.CombinedFingerprint.parse(this.props.contact.verificationBinary),a=c(e.remoteFingerprint.identifier,t.localFingerprint.identifier),o=c(e.localFingerprint.identifier,t.remoteFingerprint.identifier);if(!a&&!o)return xe.BOTH_MISMATCHED;if(!a)return xe.REMOTE_MISMATCHED;if(!o)return xe.LOCAL_MISMATCHED;var n=c(e.remoteFingerprint.publicKey,t.localFingerprint.publicKey),r=c(e.localFingerprint.publicKey,t.remoteFingerprint.publicKey);return n&&r?xe.CORRECT:xe.PUBLIC_KEY_MISMATCHED}},{key:"decodeQRCode",value:function(e){return new f["default"](function(t,a){z["default"].callback=function(e,o){if(o)a(o);else if(e.length<1)a("QR decoder did not return decoded binary");else{var n=new Uint8Array(e[0]);t(n)}},z["default"].decode(e)})}},{key:"verifyImage",value:function(e,t){var a=this;this.decodeQRCode(e).then(pe.CombinedFingerprint.parse).then(function(e){var o=a.validateFingerprint(e);o?t&&o===xe.INVALID_QR_CODE||(a.setState({errorType:o}),o===xe.PUBLIC_KEY_MISMATCHED?a.showErrorIcon():a.showErrorBanner(o)):a.showCheckmark()})["catch"](function(e){t||(a.setState({errorType:xe.INVALID_QR_CODE}),a.showErrorBanner(xe.INVALID_QR_CODE))})["finally"](function(){window.URL.revokeObjectURL(e)})}},{key:"render",value:function(){var e=null,t=null,a=null;this.props.contact.verificationBinary&&(navigator.getUserMedia&&(e=X["default"].createElement("div",{className:"animate-enter2 verification-section"},X["default"].createElement("button",{className:"btn",onClick:this.state.webcamVisible?this.onWebcamClose:this.onWebcamOpen},this.state.webcamVisible?l10n.t("web_verify_webcam_close_button"):l10n.t("web_verify_webcam_open_button")))),t=X["default"].createElement("div",{className:"animate-enter2 verification-section"},X["default"].createElement("button",{className:"btn",onClick:this.onUploadClick},l10n.t("web_verify_upload_button")),X["default"].createElement("p",{className:"drag-and-drop-explanation"},this.state.isDragging?l10n.t("web_verify_drag_and_drop_dragging"):null)),a=X["default"].createElement("form",{ref:"verificationFilePickerForm"},X["default"].createElement(Ee,{mime:"image/*",onPick:this.onUploadSelect,ref:"verificationFilePicker"})));var o=null;this.state.webcamVisible&&this.state.stream&&(o=X["default"].createElement(Pe,{stream:this.state.stream,onCapture:this.onWebcamCapture,onClose:this.onWebcamClose}));var n=null;return this.state.bannerVisible&&(n=X["default"].createElement(u,null,this.state.bannerText)),X["default"].createElement(R["default"],{className:"drawer-verification",onDrop:this.onDrop,onDragChange:this.onDragChange,onCancel:this.onClose},X["default"].createElement(D["default"],{type:O.DRAWER_HEADER_TYPE.SMALL,onBack:this.onClose},X["default"].createElement(ve["default"],{theme:"title",block:!0},l10n.t("web_verify_title")),X["default"].createElement(ve["default"],{theme:"small",block:!0},l10n.t("web_you"),", ",this.props.contact.formattedUser)),o,n,X["default"].createElement(x["default"],null,X["default"].createElement("div",{className:"drawer-verification-form"},X["default"].createElement("div",{className:"drawer-scale drawer-section-photo"},X["default"].createElement(i,{binary:this.props.contact.verificationBinary,contact:this.props.contact,visible:this.state.circleVisible}),X["default"].createElement(l,{visible:this.state.checkmarkVisible}),X["default"].createElement(s,{visible:this.state.errorIconVisible})),X["default"].createElement("div",{className:"animate-enter2 verification-section"},X["default"].createElement("div",{className:"verification-string"},X["default"].createElement(we,{string:this.props.contact.verificationString}))),X["default"].createElement("div",{className:"animate-enter2 verification-section"},X["default"].createElement("p",{className:"verification-explanation"},X["default"].createElement("span",null,l10n.t("web_verify_explanation"),""),X["default"].createElement("a",{target:"_blank",href:w["default"].E2E_FAQ_LINK},l10n.t("learn_more")))),e,t,a)))}}]),t}(X["default"].Component);Oe.CONCERNS={contact:["verificationBinary","verificationString","formattedUser","formattedShortName"]},Oe.contextTypes={uim:X["default"].PropTypes.instanceOf(se["default"])},t["default"]=(0,H["default"])((0,ie["default"])((0,ne["default"])(Oe)))},7470:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=a(48),l=o(i),s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(3),b=o(v),y=a(23),E=o(y),S=a(176),C=o(S),M=a(7120),k=o(M),w=a(7122),N=o(w),T=a(7121),P=o(T),I=a(12),R=o(I),A=a(263),x=o(A),O=a(8),D=o(O),L=a(93),U=o(L),F=a(7164),j=(o(F),a(7118)),B=o(j),G=a(7623),V=o(G),Y=function(e){function t(){var e,a,o,n;(0,d["default"])(this,t);for(var r=arguments.length,i=Array(r),l=0;r>l;l++)i[l]=arguments[l];return a=o=(0,m["default"])(this,(e=t.__proto__||(0,u["default"])(t)).call.apply(e,[this].concat(i))),o.state={hover:!1},o.onClick=function(e){var t=o.encodeColor(o.props.colorHex);t!==Store.ChatPreference.get("defaultPreference").wallpaperColor&&(Store.ChatPreference.get("defaultPreference").set("wallpaperColor",t),R["default"].openToast(b["default"].createElement(x["default"],{msg:U["default"].t("wallpaper_color_set"),id:(0,A.genId)()})))},o.onMouseOver=function(e){o.state.hover||(o.setState({hover:!0}),Store.ChatPreference.trigger("wallpaper_color_preview",o.encodeColor(o.props.colorHex)))},o.onMouseEnter=function(e){o.state.hover||(o.setState({hover:!0}),Store.ChatPreference.trigger("wallpaper_color_preview",o.encodeColor(o.props.colorHex)))},o.onMouseLeave=function(e){o.state.hover&&(o.setState({hover:!1}),Store.ChatPreference.trigger("wallpaper_color_preview"))},o.encodeColor=function(e){return"#ede9e4"===e?D["default"].DEFAULT_CHAT_WALLPAPER:e},n=a,(0,m["default"])(o,n)}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"render",value:function(){var e,t=this.props.isDefault?b["default"].createElement("span",{"data-a8n":C["default"].key("wallpaper-default-title"),className:V["default"].wallpaperDefaultTitle},U["default"].t("default_wallpaper")):null,a=(0,E["default"])(V["default"].wallpaperColorCanvas,(e={},(0,l["default"])(e,V["default"].canvasHover,this.state.hover),(0,l["default"])(e,V["default"].canvasActive,this.props.isSelected),e));return b["default"].createElement("span",{className:a,style:{backgroundColor:this.props.colorHex},onMouseOver:this.onMouseOver,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick},t)}}]),t}(b["default"].Component),W=(0,B["default"])((r=n=function(e){function t(){return(0,d["default"])(this,t),(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).apply(this,arguments))}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"render",value:function(){for(var e=this.props,t=e.chatPreference,a=e.colors,o=!0,n=t.wallpaperColor,r=a.map(function(e){var t=!1,a=!1;return(n===e||n===D["default"].DEFAULT_CHAT_WALLPAPER&&o)&&(t=!0),o&&(a=!0,o=!1),b["default"].createElement(Y,{colorHex:e,isSelected:t,isDefault:a,key:e})}),i=0;2>i;i++)r.push(b["default"].createElement("div",{key:"emptyEl"+i,className:V["default"].wallpaperColorEmpty}));return b["default"].createElement("div",{className:V["default"].wallpaperColorGrid},r)}}]),t}(b["default"].Component),n.CONCERNS={chatPreference:["wallpaperColor"]},r)),H=function(e){function t(){return(0,d["default"])(this,t),(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).apply(this,arguments))}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"componentWillUnmount",value:function(){Store.ChatPreference.trigger("wallpaper_color_preview")}},{key:"render",value:function(){return b["default"].createElement(k["default"],{onCancel:this.props.onClose},b["default"].createElement(N["default"],{title:U["default"].t("wallpaper_flow_title"),onBack:this.props.onClose,type:w.DRAWER_HEADER_TYPE.LARGE}),b["default"].createElement(P["default"],null,b["default"].createElement(W,{colors:D["default"].WALLPAPER_COLOR,chatPreference:Store.ChatPreference.get("defaultPreference")})))}}]),t}(b["default"].Component);t["default"]=H},7471:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(7268),r=o(n),i=a(63),l=i.extend({model:r["default"],handle:function(e){var t=e.shift(),a=t.blocklist,o=_.map(a,function(e){return{id:e}});this.set(o)}});e.exports=new l},7472:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(7269),r=o(n),i=a(269),l=o(i),s=a(63),u=s.extend({model:r["default"],handle:function(e){var t=e.shift();switch(t.type){case"offer":case"offer_video":case"accept":case"reject":case"terminate":l["default"].tosShowCallNotification&&this.add(t,{merge:!0})}}});e.exports=new u},7473:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(56),r=o(n),i=a(0),l=o(i),s=a(484),u=o(s),c=a(179),d=a(265),f=o(d),p=a(3),h=a(8),m=a(1),g=a(63),v=a(38),b=a(35),y=a(108),E=a(12),S=a(14),C=a(32),M=a(33),k=g.extend({model:u["default"],comparator:u["default"].Comparator,initialize:function(){var e=this;g.prototype.initialize.call(this),this.notSpam={},this.promises={sendUnstarAll:null},this._sortEnabled=!1,this.enableSortListener(),this.listenTo(M,"change:stream",function(){M.stream===M.STREAM.RESUMING&&e.forEach(function(e){e.pendingMsgs=!1})})},enableSortListener:function(e){this._sortEnabled||(this[e?"listenToAndRun":"listenTo"](this,"change:t change:pin change:isVisible",this.sort),this._sortEnabled=!0)},disableSortListener:function(){this._sortEnabled&&(this.stopListening(null,null,this.sort),this._sortEnabled=!1)},active:function w(){var w=_.head(this.filter("active"));return w?w.id:void 0},_find:function(e){return l["default"].resolve({id:e,createdLocally:!0})},_findQuery:function(e){var t=this;return v.chatFindQuery(!!e.retry).then(function(e){return"preempted"===e?l["default"].reject("chats preempted"):(Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&(_.isEmpty(e)?Store.Msg.trigger(h.COLLECTION_HAS_SYNCED):setTimeout(function(){Store.Msg.trigger(h.COLLECTION_HAS_SYNCED)},2500)),t.trigger(h.COLLECTION_HAS_SYNCED),l["default"].resolve(e))})},handle:function(e){var t=e.shift(),a=this;if(_.isArray(t)){var o=[],n=[];t.forEach(function(e){if("c.us"===e.id)n.push(e);else{var t=!!a.get(e.id),i=["delete","clear","archive","unarchive","star","unstar","spam","modify_tag","pin"].indexOf(e.type)>-1;i?t&&i?n.push(e):m.log("Model:chat:handle received junk chat record: "+(0,r["default"])(e))():o.push(e)}});var i=_.findIndex(o,function(e){return C.isPSA(e.id)});i>-1&&(o[i].name=l10n.t("whatsapp_psa_contact_name")),a.add(o,{merge:!0}),n.forEach(function(e){var t=e.type;if("c.us"===e.id)switch(t){case"clear":m.log("Model:chat:handle:clear:all before:"+e.before+" kind:"+e.kind)(),a.forEach(function(t){"number"==typeof e.before?t.deleteMsgsOlderThan(e.before,e.star,e.kind):t.deleteMsgs(e.star,e.kind)});break;case"delete":m.log("Model:chat:handle:delete:all")(),a.forEach(function(e){e["delete"]()});break;case"archive":m.log("Model:chat:handle:archive:all")(),a.forEach(function(e){e.archive=!0});break;case"unarchive":m.log("Model:chat:handle:unarchive:all")(),a.forEach(function(e){e.archive=!1});break;case"unstar":m.log("Model:chat:handle:unstar:all")(),Store.AllStarredMsgs["delete"](),a.forEach(function(e){e.unstarAll()});break;default:m.error("Model:chat:handle unknown "+(0,r["default"])(e),e)()}else{var o=a.get(e.id);if(!o)return;switch(t){case"clear":case"star":case"unstar":if(e.keys){for(var n=e.keys.length,i="star"===t,l=[],s=[],u=[],c=!1,d=0;n>d;d++){var f,p,h,g,v,b=e.keys[d];_.isArray(b)?(f=b[0],p=b[1],h=b[2],g=new y({fromMe:p,remote:e.id,id:f,participant:h}),v=Store.Msg.get(g),v?"clear"===t?v["delete"]():(v.star=i,u.push(v)):i&&(c=!0)):!_.isObject(b)||"star"!==t&&"unstar"!==t||(g=b.id,v=Store.Msg.get(b.id),v?(v.star=i,u.push(v)):s.push(b)),l.push(g.toString())}"star"!==t&&"unstar"!==t||Store.AllStarredMsgs.process(i,s,u,c),m.log("model:Chat:handle:messages:"+[t,e.id,l.join(),e.modifyTag].join())()}else"clear"===t?("number"==typeof e.before?o.deleteMsgsOlderThan(e.before,e.star,e.kind):o.deleteMsgs(e.star,e.kind),m.log("model:Chat:handle cleared chat:"+[e.id,e.before,e.modifyTag,e.kind].join())()):"unstar"===t&&(o.unstarAll(),m.log("model:Chat:handle unstarred chat: "+e.id)());isNaN(e.modifyTag)||(o.modifyTag=e.modifyTag);break;case"delete":o["delete"](),m.log("model:Chat:handle deleted chat for "+e.id)();break;case"archive":o.archive=!0,o.pin=void 0;break;case"unarchive":o.archive=!1;break;case"spam":o.notSpam=e.notSpam;break;case"modify_tag":o.modifyTag=e.modifyTag;break;case"pin":o.pin=e.pin}}})}else if("leave"===t.cmd)t.gids.forEach(function(e){var t=a.get(e);t&&t.exit()});else if("preempt"===t.cmd)Store.Chat.add(t.response,{merge:!0}),Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&(_.isEmpty(t.response)?Store.Msg.trigger(h.COLLECTION_HAS_SYNCED):setTimeout(function(){Store.Msg.trigger(h.COLLECTION_HAS_SYNCED)},2500)),this.trigger(h.COLLECTION_HAS_SYNCED);else if("action"===t.cmd){var l=t.id,s=t.data;if("create"===s[0]||"introduce"===s[0]){var u=s[1],c=s[2],d=_.map(c.admins,function(e){return{id:e,isAdmin:!0}}).concat(_.map(c.regulars,function(e){return{id:e,isAdmin:!1}}));Store.GroupMetadata.add({id:l,creation:c.creation,owner:u,participants:d,stale:!1,desc:c.desc,descId:c.descId,descTime:c.descTime,descOwner:c.descOwner},{merge:!0}),Store.Contact.add({id:l,name:c.subject},{merge:!0});var f=Store.Chat.get(l);if(!f)return;var p=f.msgs.last();if(!p)return;"gp2"===p.type&&"add"===p.subtype&&(Store.GroupMetadata.trigger("group_participant_change_"+Store.Conn.me,l),_.head(p.recipients===Store.Conn.me)&&E.alertNewMsg(p))}else{var g=Store.Chat.get(t.id);g?g.handleGroupAction.apply(g,t.data):m.error("model:chat: unknown chat for action "+(0,r["default"])(t))()}}else m.error("model:chat: unknown payload: "+(0,r["default"])(t))()},createGroup:function(e,t,a,o,n){var r=this,i=_.map(o,"id"),l=v.createGroup(e,i),s=new c.ActionType(l10n.t("action_group_creating"));n=n||(0,c.genId)();var u=l.then(function(e){return 200===e.status?new c.ActionType(l10n.t("action_group_created")):406===e.status?new c.ActionType(l10n.t("action_group_create_failed")+" "+l10n.t("action_group_create_failed_406")):void 0})["catch"](function(i){return m.error("models:chatCollection:createGroup dropped")(i),new c.ActionType(l10n.t("action_group_create_failed"),l10n.t("action_try_again"),r.createGroup.bind(r,e,t,a,o,n))});return E.openToast(p.createElement(c.ActionToast,{id:n,initialAction:s,pendingAction:u})),l.then(function(e){if(200===e.status&&e.gid&&Store.Chat.find(e.gid).then(function(e){E.openChatBottom(e).then(function(t){t&&E.focusChatTextInput(e)})}),200===e.status&&!e._duplicate&&t&&a){var o=Store.ProfilePicThumb.gadd(e.gid);return o.setPicture(t,a)}200===e.status&&e._duplicate&&m.error("createGroup failed to set picture.")()})},sync:function(){return this.findQuery({})["catch"](S.WapDrop,_.noop),l["default"].all([b.waitForBBEvent(this,h.COLLECTION_HAS_SYNCED),Store.Msg._hasSynced()])},resyncMessages:function(){var e=this;m.log("ChatStore:resyncMessages")();var t=Store.Chat.filter(function(e){return e.isVisible}),a=t.map(function(e){var t=e.getAckedPhoneProps(),a=e.lastReceivedKey;return a&&(t.id=a.id,t.fromMe=a.fromMe.toString(),t.participant=a.participant),t});return v.resyncMessages(a).then(function(t){return t.status>=400?(m.error("ChatStore:resyncMessages resume error "+t.status)(),l["default"].reject(new Error("ChatStore:resyncMessages resume error "+t.status))):(m.log("ChatStore:resyncMessages resume success")(),t.checksum&&Store.Contact.resyncContacts(t.checksum),t.statusChecksum&&Store.StatusV3.sync(t.statusChecksum),e.disableSortListener(),t.data.forEach(function(e){if(e.disableUnreadAnchor=!1,"delete"!==e.type&&!C.isPSA(e.id)){var t=Store.Contact.get(e.id);t?e.name&&(t.name=e.name):Store.Contact.add({id:e.id,name:e.name})}var a=Store.Chat.get(e.id);return a?void("clear"===e.type?!function(){a.resetMediaMsgs();var t=[];a.msgs.forEach(function(e){return t.push(e)}),a.msgChunks.length&&a.msgChunks.forEach(function(e){e.models.forEach(function(e){return t.push(e)})}),a.set({t:e.t,unreadCount:e.unreadCount,createdLocally:!1,archive:e.archive,isReadOnly:e.isReadOnly,modifyTag:e.modifyTag,msgs:[],notSpam:e.notSpam,unreadMsgAnchor:void 0,disableUnreadAnchor:e.disableUnreadAnchor,pendingMsgs:e.pendingMsgs,pin:e.pin}),a.mute.setMute(e.muteExpiration),_.each(t,function(e){e["delete"]()}),m.log("model:chat:resume: cleared chat for "+e.id)()}():"delete"===e.type?(a["delete"](),m.log("model:chat:resume: deleted chat for "+e.id)()):(a.set(e,{merge:!0}),a.mute.setMute(e.muteExpiration))):void Store.Chat.add(e)}),e.enableSortListener(!0),l["default"].resolve())})["catch"](S.WapDrop,function(e){return m.error("ChatStore:resyncMessages resume dropped")(),l["default"].reject(e)})},unstarAllMessages:function(e,t){var a=this,o=t?t.promises:this.promises,n=t?t.id:void 0;if(o.sendUnstarAll)return o.sendUnstarAll;o.sendUnstarAll=v.sendUnstarAll(n);var r=new c.ActionType(l10n.t("action_message_unstarring_all")),i=o.sendUnstarAll.then(function(e){return 200===e.status?new c.ActionType(l10n.t("action_message_unstarred_all")):e.status>=400?new c.ActionType(l10n.t("action_message_unstar_all_failed")):void 0})["catch"](function(o){return m.error("models:chat:sendUnstarAll dropped")(o),new c.ActionType(l10n.t("action_message_unstar_all_failed"),l10n.t("action_try_again"),function(){return a.unstarAllMessages(e,t)})});return E.openToast(p.createElement(c.ActionToast,{id:(0,c.genId)(),initialAction:r,pendingAction:i})),o.sendUnstarAll.then(function(a){200===a.status&&(_.forEach(e,function(e){e.set("star",!1)}),t?Store.AllStarredMsgs.remove(e):(Store.AllStarredMsgs.reset(),Store.StarredGifMsgs.reset()))})["finally"](function(){o.sendUnstarAll=null})},forwardMessagesToChats:function(e,t){var a=l["default"].map(e,function(e){return l["default"].props({message:e,canForward:e.canForward()})});return l["default"].map(t,function(e){var t=void 0;return t=e.isUser&&e.contact.isBlocked()?e.contact.setBlock(!1):l["default"].resolve(!0),l["default"].all([a,t]).spread(function(t,a){var o=_.map(_.filter(t,{canForward:!0}),"message"),n=_.map(_.filter(t,{canForward:!1}),"message");return l["default"].props({chat:e,undelivered:e.forwardMessages(o),canForward:o,cannotForward:n})})}).then(function(e){var t=_.compact(e.map(function(e){var t=e.chat,a=e.undelivered,o=e.canForward,n=e.cannotForward,r=null;return(a.length||n.length)&&(r=f["default"].formatForwardError(t,a,o,n)),r?{chat:t,reason:r}:null}));if(t.length)throw new S.ForwardError("Forward Messages Error",t);return!0})}});e.exports=new k},7474:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(96),r=o(n),i=a(7164),l=o(i),s=a(63),u=a(8),c=s.extend({model:l["default"],initialize:function(){s.prototype.initialize.call(this,{CachePolicy:{id:"chat_preference",policy:s.CACHE_POLICY.LOAD,delay:1e3}})},initializeFromCache:function(e){e=e||[],this.add([].concat((0,r["default"])(e),[{id:"defaultPreference",wallpaperColor:u.DEFAULT_CHAT_WALLPAPER}]))},get:function(e,t){return s.prototype.get.call(this,e,t)||s.prototype.get.call(this,"defaultPreference")}});e.exports=new c},7475:function(e,t,a){"use strict";var o=a(8),n=a(1),r=a(36),i=a(14),l={handle:function(e){var t=e.shift();switch(t.type){case"const":o[t.key]=t.value;break;case"read":if(t.isStatus){Store.StatusV3.handle([t]);break}case"unread":var a=Store.Chat.get(t.jid);a&&("read"===t.type?a.markSeen():"unread"===t.type&&a.markUnseen());break;case"picture":Store.ProfilePicThumb.imageChanged(t.jid,t.tag);break;case"log":r.upload("server-requested",!0,!0);break;case"privacy":t.jid?(Store.Presence.update(t.jid)["catch"](i.WapDrop,_.noop),Store.ProfilePicThumb.update(t.jid)["catch"](i.WapDrop,_.noop),Store.Status.update(t.jid)["catch"](i.WapDrop,_.noop)):n.error("Store:Cmd:handle:privacy no jid",t)();break;case"identity":if(t.jid){var l=Store.Contact.get(t.jid);l?l.updateIdentity(t):n.error("Store:Cmd:handle:identity no contact",t)()}else n.error("Store:Cmd:handle:identity no jid",t)();break;default:n.warn("Store.Cmd:handle:unknown "+t.type,t)()}}};e.exports=l},7476:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(63),r=o(n),i=a(7270),l=o(i),s=a(62),u=r["default"].extend({model:l["default"],initialize:function(){r["default"].prototype.initialize.call(this,{CachePolicy:{id:"conversion_tuple",policy:r["default"].CACHE_POLICY.LOAD,delay:1e3}})},initializeFromCache:function(e){if(e){var t=1e3*(0,s.globalUnixTime)()-i.ConversionTupleExpiry;this.add(e.filter(function(e){return e.timestamp-t>0})),this.saveToCache()}}});e.exports=new u},7477:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(7271),r=o(n),i=a(63),l=a(95),s=i.extend({model:r["default"],initialize:function(){i.prototype.initialize.call(this,{CachePolicy:{id:"emoji_variant_collection",policy:i.CACHE_POLICY.LOAD,delay:1e3}})},setVariant:function(e,t){var a=l.skinToneEmojis[e];if(!a)throw new Error("attempt to store variantless emoji");this.gadd({id:a,"char":a,variant:t})},getVariant:function(e){if(l.skinToneEmojis[e]){var t=this.get(e);return t?t.variant:null}throw new Error("attempt to get variantless emoji")}});e.exports=new s},7478:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7165),l=o(i),s=a(1),u=a(63),c=a(38),d=a(14),f=a(32),p=u.extend({model:l["default"],initialize:function(){u.prototype.initialize.call(this,{staleCollection:!0})},onResume:function(){_.union(Store.Chat.where({active:!0}).filter(function(e){return e.isGroup||e.isBroadcast}),Store.Chat.where({isBroadcast:!0})).forEach(function(e){Store.GroupMetadata.find(e.id)["catch"](d.WapDrop,_.noop)})},_find:function(e){var t=this;if(f.isGroup(e)){var a=Store.Chat.get(e);
return a&&a.isReadOnly?c.groupMetadataFindFromPhone(e).then(function(t){return"ok"===t.status?t.data:"missing"===t.status?void _.defer(function(){Store.Chat.get(e)["delete"]()}):"error"===t.status?(s.error("model:GroupMetadata:find error "+t.info)(),r["default"].reject(new Error("model:GroupMetadata:find error"))):void 0}):c.groupMetadataFind(e).then(function(a){if(a.status>=400)return{id:e,stale:!1};var o=[],n=t.get(e);return n?n.participants.set(a.participants):o=a.participants,t.updateSubject(e,a.subject),{id:a.id,owner:a.owner,creation:a.creation,participants:o,desc:a.desc,descId:a.descId,descOwner:a.descOwner,descTime:a.descTime}})}return f.isBroadcast(e)?c.contactFindBroadcast(e).then(function(t){if(200===t.status){var a=Store.GroupMetadata.get(e);if(a&&!a.stale)return r["default"].resolve(a);var o=[];return a?a.participants.set(t.recipients):o=t.recipients,{id:e,participants:o}}return 404===t.status?r["default"].reject("False broadcast list query."):(s.error("models:GroupMetadataCollection:_find:bclist error: "+t.status)(),r["default"].reject(new Error("models:GroupMetadataCollection:_find:bclist error: "+t.status)))}):(s.log("groupMetadata:find trying to fetch non-group/bclist wid "+e)(),r["default"].reject(new Error("groupMetadata:find trying to fetch non-group/bclist wid "+e)))},_handle:function(e){return e},updateSubject:function(e,t){_.isString(t)&&Store.Contact.find(e).then(function(e){e.name||(e.name=t)})}});e.exports=new p},7479:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.LocationProxy=t["default"]=void 0;var n=a(74),r=o(n),i=a(38),l=o(i),s=(0,n.defineState)("Location",{Collection:"Location",props:{id:"string",lat:"number",lng:"number",accuracy:"number",speed:"number",degrees:"number",sequence:"number",sharing:"boolean",sharers:"array",comment:"string",body:"string",elapsed:"number",duration:"number"},initialize:function(){r["default"].prototype.initialize.call(this)},"delete":function(){r["default"].prototype["delete"].call(this)},ping:function(){return l["default"].subscribeLiveLocation(this.id,!1)}}),u=s.Location,c=s.LocationProxy;t["default"]=u,t.LocationProxy=c},7480:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7479),l=o(i),s=a(1),u=o(s),c=a(32),d=o(c),f=a(38),p=o(f),h=a(63),m=h.extend({model:l["default"],initialize:function(){h.prototype.initialize.call(this,{staleCollection:!0,resumeOnAvailable:!0})},_find:function(e){var t=this;return d["default"].isUser(e)||d["default"].isGroup(e)?p["default"].subscribeLiveLocation(e,!0).then(function(a){var o={id:e};if(_.isNumber(a.duration)&&(o.duration=a.duration),d["default"].isUser(e)){var n=_.find(a.participants,function(t){return t.id===e&&t.isLive});n?(o.sharing=!0,_.merge(o,n)):o.sharing=!1}else if(d["default"].isGroup(e)){var r=a.participants.filter(function(e){return e.isLive});o.sharers=r.map(function(e){return e.id});var i=r.filter(function(e){var a=t.get(e.id);return!a||a.sequence<e.sequence});t.add(i)}return o}):r["default"].reject(new Error("invalid wid for live location: "+e))},onResume:function(){this.filter(function(e){return e._uiObservers&&(!d["default"].isUser(e.id)||e.sharing)}).forEach(function(e){e.update()})},handle:function(e){var t=this;_.isArray(e)?e.forEach(function(e){switch(e.type){case"update":var a=t.get(e.jid);a&&e.sequence>a.sequence&&a.set(e);break;case"disable":var o=t.get(e.jid);if(o&&e.seq>o.sequence){if(d["default"].isUser(e.chat))o.sharing=!1;else if(d["default"].isGroup(e.chat)){var n=t.get(e.chat);n&&_.pull(n.sharers,e.jid)}t.hasLiveShares(e.jid)||(t.remove(e.jid),o["delete"]())}break;default:u["default"].error("models:location:handle unknown location type: "+e.type)(e)}}):u["default"].error("models:location:handle unrecognized payload")(e)},hasLiveShares:function(e){return this.forEach(function(t){return t.id===e&&t.sharing?!0:d["default"].isGroup(t.id)&&t.sharers.indexOf(e)>-1?!0:void 0}),!1}});e.exports=new m},7481:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(!k.supportsFeature(k.F.CONTACT_HAS_PUSHNAME)&&e.notifyName){var t=Store.Contact.get(e.sender);t&&!t.isMe&&(!t._notifyName||t._notifyName.t<e.t)&&(t._notifyName={name:e.notifyName,t:e.t},t.trigger("change:_notifyName",e.notifyName))}}function r(e,t,a,o){var r=[],i=[],l=[];t.forEach(function(t,s){t.id instanceof T||(E.error("msgCollection:_processMultipleMessages: el.id is not a MsgKey"+(new Error).stack)(),A.upload("forgot-to-create-msgkey"),t.id=new T({from:t.from,to:t.to,id:t.id,participant:t.participant,self:t.self})),_.isString(e)&&M.isBroadcast(e)&&delete t.broadcast,"ptt"===t.type&&!t.id.fromMe&&t.ack<0&&(t.ack=0);var u=Store.Msg.get(t.id);if(t.type===b["default"].TYPE.PROTOCOL)switch(t.subtype){case"revoke":if(u=Store.Msg.get(t.protocolMessageKey)){var d=new b["default"](t);u.sender===d.sender?(M.isStatusV3(e)&&u.msgChunk.remove(u),u.revoke(d.id)):E.warn("model:Msg:processMM revoke sender mismatch "+d.id.toString()+", "+u.id.toString())()}break;default:E.info("unknown protocolMessage "+t.id.toString())(t)}else if(u&&!u.isRevoked){var f;!function(){t.ack<u.ack&&delete t.ack;for(f in t)t.hasOwnProperty(f)&&"undefined"==typeof t[f]&&delete t[f];t.id.fromMe&&!u.clientUrl&&t.clientUrl&&(t.phoneUploading=!1),a.isHistory&&(t.isNewMsg=!1);var e=["t","id","from","to"],s=u.t?_.omit(t,e):t,d=u.applyUpdate(s)["return"](u);if(l.push(d),M.isBroadcast(u.id.remote)){var p=c(u);p&&p.forEach(function(e){var t=Store.Msg.get(e);t&&l.push(t.applyUpdate(s)["return"](u))})}a.isHistory&&(u.recvFresh||o)&&!u.search?(E.warn("model:Msg:handle:processMM:"+(u.recvFresh?"dup:":"overlap:")+u.id)(),i.push(u)):a.isHistory&&u.search?(u.search=!1,E.warn("model:Msg:handle:processMM load search as history "+u.id)(),r.push({id:u.id})):"search"!==a.add&&"resync"!==a.add||r.push({id:u.id}),n(u)}()}else b["default"].typeIsMMS(t.type)&&!t.clientUrl&&(t.phoneUploading=t.id.fromMe&&0===t.ack),"search"===a.add&&(t.search=!0),a.update||r.push(t)});var u=l.length?g["default"].all(l):g["default"].resolve();return u.then(function(){if(0===r.length&&0===i.length){if(e&&a.pendingMsgsDone){var l=Store.Chat.get(e);l&&(l.pendingMsgs=!1)}return t.map(function(e){return Store.Msg.get(e.id)})}var u=Store.Msg.add(r,{merge:!0}),c=g["default"].map(u,function(e){return n(e),e.waitForPrep()["catch"](function(e){E.assert(!1,"bad-msg-prep",""+e)(e)})});if(e){var f;if(M.isStatusV3(e)){var p=t[0],h=p.id.fromMe?Store.Conn.me:p.author;f=Store.StatusV3.find(h)}else f=Store.Chat.find(e);return c["return"](f).then(function(n){var r,l,c="after"===a.add||"last"===a.add,f=!a.isHistory,p=!1;if("unread"===a.add?(r=o,n.msgChunks.push(r),l=a.firstUnreadKey):"last"===a.add&&a.resume?(r=o,p=!0):r="function"==typeof o?o():o,s(t,u,i,n,c,r||n.msgs,l,p),a.pendingMsgsDone&&(n.pendingMsgs=!1),f&&M.isBroadcast(e)&&!M.isStatusV3(e)&&u.forEach(function(t){if("broadcast_notification"===t.type){var a=Store.GroupMetadata.get(e);"add"===t.subtype?a.participants.add({id:t.body},{merge:!0}):"remove"===t.subtype&&a.participants.remove(t.body),n.groupMetadata.stale=!1}else t.recvFresh&&!t.isNotification&&d(t)}),k.supportsFeature(k.F.RECENT_EMOJI_SYNC)&&!Store.RecentEmoji.syncDue)for(var h=0;h<u.length;h++){var m=u[h];if(m.isNewMsg&&m.isSentByMe&&m.containsEmoji){Store.RecentEmoji.periodicSync();break}}return t.map(function(e){return Store.Msg.get(e.id)})})}return c["return"](t.map(function(e){return Store.Msg.get(e.id)}).filter(function(e){return!!e.chat}))})}function i(e,t,a,o,n,r){var i=o||t.msgs;if(e=_.isArray(e)?e:[e],0!==e.length){var l=i===t.msgs;if(r){l&&E.error("models:msg:store:resetMostRecentMsgs .msgs === cmc !")(),l=!0,t.lastReceivedKey=_.last(e).id,i.add(e);var s=new R;s.replace(t.msgs),t.msgChunks.push(s),t.replaceMsgsCollection(i),t.msgs.trigger("change:last",t.msgs.last())}else a?(l&&(t.lastReceivedKey=_.last(e).id),i.add(e)):i.add(e,{at:0,silent:_.every(e,f)});if(a&&l||!Store.Msg.lastReceivedReceipt[t.id])for(var u=e.length,c=u-1;c>=0;c--){var d=e[c],p=d.id;if(p.fromMe&&!d.isNotification){Store.Msg.updateLastReceipt(p.remote,d.t);break}}n&&!t.unreadMsgAnchor&&(t.disableUnreadAnchor?t.disableUnreadAnchor=!1:t.unreadMsgAnchor=_.find(e,function(e){return e.id.toString()===n.toString()}))}}function l(e,t,a,o,n){var r,i,l,s={},u={},c=a.length,d=n;if(0===c)return{msgs:t,collection:d};for(r=0;c>r;r++)i=a[r],u[i.id]=i;for(c=t.length,r=0;c>r;r++)i=t[r],s[i.id]=i;var f=[];for(c=e.length,r=0;c>r;r++)if(i=e[r],l=s[i.id],l&&f.push(l),l=u[i.id])if(l.recvFresh)f.push(l),o.removeMsg(l),l.unset("recvFresh");else{var p=o.getAllCMCs(),h=_.find(p,function(e){return e.get(i.id)});n&&h===n||(h?(h.forEach(function(e){f.push(e),delete u[e.id]}),h===o.msgs?(o.replaceMsgsCollection(n),d=o.msgs):(o.notifyMsgCollectionMerge(n,h,n),o.removeMsgsCollection(h))):(E.error("models:Msg:reorder trying to merge CMC of orphaned message "+i.id,i)(),f.push(u[i.id])))}return{msgs:f,collection:d}}function s(e,t,a,o,n,r,s,u){var c=l(e,t,a,o,r);i(c.msgs,o,n,c.collection,s,u)}function u(e){return _.isObject(e)?JSON.parse((0,h["default"])(e)):e}function c(e){var t=void 0,a=void 0,o=void 0;if(e instanceof b["default"])a=e,o=e.id;else{if(!(e instanceof T))return void E.error("model:msgs:broadcastFanout: unknown msgOrKey: "+e)(e);o=e}if(!M.isStatusV3(o.remote)){if(a&&a.recipients&&0!==a.recipients.length)t=a.recipients;else{var n=Store.GroupMetadata.get(o.remote);n?t=_.map(u(n.participants),"id"):E.log("model:msgs:broadcastFanout no group_metadata rec for bclist, cant fanout: "+o.remote)()}return t?t.map(function(e){return new T({fromMe:o.fromMe,remote:e,id:o.id})}):void 0}}function d(e){var t=void 0;if(!e.invis){var a=c(e);a&&(t=a.map(function(e){return e.remote}),a.forEach(function(t){Store.Msg.some(_.matches({id:t}))||!function(){var a=u(e);a.to=t.remote,a.id=t,a.broadcast=!0;var o=Store.Msg.add(a,{merge:!0});Store.Chat.find(t.remote).then(function(e){i(o,e,!0)})}()}))}return t}function f(e){return"i"===e.eventType}var p=a(56),h=o(p),m=a(0),g=o(m),v=a(53),b=o(v),y=a(8),E=a(1),S=a(63),C=a(14),M=a(32),k=a(47),w=a(35),N=a(73),T=a(108),P=a(33),I=a(38),R=a(268),A=a(36),x=6e4,O=S.extend({model:b["default"],initialize:function(){S.prototype.initialize.call(this),this.lastReceivedReceipt={},this.preAck={},this.pendingAdd={},this.ftsCache={},this.listenTo(P,"change:stream",function(){P.stream===P.STREAM.DISCONNECTED&&(this.preAck={})}),this.listenTo(this,"remove",this.removeFromCollection)},removeFromCollection:function(e){e.chat&&e.chat.removeFromCollection(e)},_findQuery:function(e){var t,a=this;switch(e.direction){case"before":case"after":t=e.direction;break;default:t="before"}return I.msgFindQuery(t,e).then(function(o){if(o.status>=400)return E.error("model:Msg:findQuery error "+o.status)(),g["default"].reject(o.status);var n=function(){var t=a.get(e),o=Store.Chat.get(e.remote);return t?t.msgChunk:o?o.msgs:void 0};return o.forEach(function(e){e.invis=!0}),E.log("model:Msg:findQuery:got:"+o.length+":"+e.direction)(),a.processMultipleMessages(e.remote,o,{add:t,isHistory:!0},n)})},resyncChatMsgs:function(e,t){var a=this,o="number"!=typeof t||isNaN(t)?y.PAGE_SIZE:t;return I.msgFindQuery("before",{remote:e,count:o}).then(function(e){return e.status>=400?(E.error("model:Msg:resyncChatMsgs error "+e.status)(),g["default"].reject(e.status)):a.processMultipleMessages(void 0,e,{add:"resync"})})},getStarred:function(e,t,a,o){var n=this,r={count:"number"!=typeof t||isNaN(t)?y.PAGE_SIZE:t,chat:e&&_.isString(e)?e:void 0,remote:a&&a.remote,id:a&&a.id,fromMe:a&&a.fromMe,participant:a&&a.participant,media:o?"gif":void 0};return I.msgFindQuery("star",r).then(function(e){var t=e.status;return e.status>=400?(499===t?E.log("model:Msg:getStarred error 499 (unimplemented)")():E.error("model:Msg:getStarred error "+t)(),g["default"].reject(t)):n.processMultipleMessages(void 0,e,{add:"search"})})},queryVCard:function(e){var t=this;return I.queryVCard(e).then(function(e){return 499===e.status?(E.log("model:Msg:queryVCard error 499 (unimplemented)")(),g["default"].reject(new C.E499)):void t.processMultipleMessages(void 0,e,{add:"search"})})},incrementalStarredUpdate:function(e){return this.processMultipleMessages(void 0,e,{add:"search"})},search:function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this,o=arguments[2],n=arguments[3];if(1!==t||n)return this._search(e,t,o,n);var r=this.ftsCache[e];if(r)return r;var D=this._search(e,t,o,n);this.ftsCache[e]=D;var i=function(){a.ftsCache[e]=null};return _.delay(i,x),D["catch"](i),D},_search:function(e,t,a,o){var n=this,r={searchTerm:e,page:t&&_.isNumber(t)?t:1,count:a&&_.isNumber(a)?a:y.PAGE_SIZE,remote:o};return I.msgFindQuery("search",r).then(function(e){if(404===e.status)return g["default"].reject(new C.E404);if(e.status>=400)return E.error("model:Msg:search error "+e.status)(),g["default"].reject(e.status);var t=_.isArray(e)?e:e.messages,a=_.isArray(e)?!0:e.eof;return g["default"].props({messages:n.processMultipleMessages(void 0,t,{add:"search"}),eof:a})})},queryMedia:function(e,t,a,o,n){var r=this,i={remote:e,count:t&&_.isNumber(t)?t:y.PAGE_SIZE,id:o&&o.id,fromMe:o&&o.fromMe,participant:o&&o.participant,direction:a||"before",media:n};return I.msgFindQuery("media",i).then(function(e){return e.status>=400?(E.error("model:Msg:media error "+e.status)(),g["default"].reject(e.status)):n?r.processMultipleMessages(void 0,e,{add:"search"}):g["default"].props({docCount:e.docCount,linkCount:e.linkCount,mediaCount:e.mediaCount,messages:r.processMultipleMessages(void 0,e.messages,{add:"search"})})})},getContext:function(e,t){var a=this,o=this.get(e);return o?g["default"].all([I.msgFindQuery("before",e),I.msgFindQuery("after",e)]).spread(function(n,r){return _.isArray(n)&&_.isArray(r)?(o.search=!1,g["default"].all([a.processMultipleMessages(e.remote,n,{add:"before",isHistory:!0},t),a.processMultipleMessages(e.remote,r,{add:"after",isHistory:!0},t)])):(E.error("model:msg:getContext fetch error",n,r)(),g["default"].reject(n.status||r.status))}):I.msgFindQuery("after",e).then(function(o){return _.isArray(o)?M.isStatusV3(o[0].id.remote)?g["default"].reject("statusV3, stop querying before the msg"):a.processMultipleMessages(e.remote,o,{add:"after",isHistory:!0},t):(E.error("model:msg:getContext:after fetch error",o)(),g["default"].reject(o.status))}).then(function(t){var o=t[0],n=o.id.clone();return n.count=e.count+1,g["default"].all([I.msgFindQuery("before",n).then(function(t){if(!_.isArray(t))return E.error("model:msg:getContext:before fetch error",t)(),g["default"].reject(t.status);var n=t[t.length-1],r=n.id;if(!r.equals(e))return E.error("model:msg:getContext:before ctx message mismatch",t)(),g["default"].reject(405);var i=function(){return o.msgChunk};return a.processMultipleMessages(e.remote,t,{add:"before",isHistory:!0},i)}),g["default"].resolve(t)])})},handle:function(e){function t(e,t){var a=void 0;a=new T(M.isStatusV3(i.broadcast)?{from:i.from,to:i.broadcast,id:t,selfDir:i.self||"out"}:{from:i.from,to:e,id:t,participant:i.participant,selfDir:i.self||"out"});var o=r.get(a);if(o){o.updateAck(i.ack),r.updateLastReceipt(a.remote,i.t);var n=a.remote;M.isUser(n)?(Store.MsgInfo.update(t,i.from,e,i.ack,n,i.t),M.isBroadcast(i.broadcast)&&Store.MsgInfo.update(t,i.from,i.broadcast,i.ack,n,i.t)):M.isStatusV3(n)&&Store.MsgInfo.update(t,i.from,n,i.ack,e,i.t)}else E.log("Msg:out of order ack",i)(),r.preAck[a]=i}var a,o,n,r=this,i=e.shift();if("ack"===i.cmd){var l=[i.to];if(M.isBroadcast(i.to)&&1===i.ack){var s=Store.GroupMetadata.get(i.to);s&&Array.prototype.push.apply(l,_.map(s.participants.toArray(),"id"))}return l.forEach(function(e){t(e,i.id)}),!0}if("acks"===i.cmd)return i.id.forEach(function(e){t(i.to,e)}),!0;if(i.msg){var u="update"===i.meta.add;return M.isStatusV3(i.chat)&&!Store.StatusV3.handleUpdate(i.msg,i.meta.checksum,u)||(i.msg.recvFresh=!0,i.msg.isNewMsg=!0,this.processMultipleMessages(i.chat,[i.msg],{add:"after",update:u,isHistory:!1})["catch"](C.LogoutDrop,_.noop)),!0}if(i.msgs){var c=i.msgs.length;if(!c)return!1;o=i.meta,o.isHistory=!0,"unread"===o.add&&(o.firstUnreadKey=new T({fromMe:o.unreadFromMe,remote:i.chat,id:o.unreadId,participant:o.unreadParticipant}),n=new R);for(var d=0;c>d;d++)a=i.msgs[d],a.invis=!0;return Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE&&this.trigger(y.COLLECTION_HAS_SYNCED),this.processMultipleMessages(i.chat,i.msgs,o,n)["catch"](C.LogoutDrop,_.noop),!0}if(i.recent){o=i.meta,delete i.recent,delete i.meta,this.trigger(y.COLLECTION_HAS_SYNCED),o.isHistory=!0;for(var f in i)"last"===o.add&&o.resume&&(n=new R),a=i[f],a.invis=!0,this.processMultipleMessages(f,[a],o,n)["catch"](C.LogoutDrop,_.noop)}else E.log("************** Msg else clause. something strange is going on")()},_hasSynced:function(){return w.waitForBBEvent(this,y.COLLECTION_HAS_SYNCED)},"delete":function(){S.prototype["delete"].call(this),this.lastReceivedReceipt={},this.preAck={}},send:function(e){var t=this;return g["default"].callSynchronously(function(){var a=e.id,o=e.toJSON();if(k.supportsFeature(k.F.SPAM)&&Store.Chat.find(e.id.remote).then(function(e){e.isTrusted()||e.sendNotSpam()["catch"](_.noop)}),e.isNewMsg=!0,!e.isGroupMsg&&Store.Blocklist.get(e.to))return g["default"].reject(new C.ContactBlocked("Contact is blocked"));if(M.isBroadcast(o.to))var n=d(e);delete o.status,delete o.mimetype,delete o.height,delete o.width,delete o.recipients,delete o.chat,delete o.broadcast,delete o.ack,delete o.invis,delete o.filehash,delete o.recvFresh,delete o.mediaData,N.isHttp(e.url)||delete o.url,N.isHttp(e.clientUrl)||delete o.clientUrl;for(var r in o)null!==o[r]&&"undefined"!=typeof o[r]||delete o[r];e.isMMS&&(o.avparams=e.isUnsentPhoneMsg()?{type:e.type}:e.avParams()),"chat"!==o.type||"url"!==o.subtype||k.supportsFeature(k.F.URL)||delete o.subtype,o.quotedMsg&&!k.supportsFeature(k.F.REPLIES_OUT)&&(delete o.quotedMsg,delete o.quotedStanzaID,delete o.quotedRemoteJid,delete o.quotedParticipant),o.mentionedJidList&&!k.supportsFeature(k.F.MENTIONS_OUT)&&delete o.mentionedJidList;var i=Store.ConversionTuple.get(e.id.remote);return i&&(o.conversionTuple=i.toJSON()),Store.Chat.find(e.id.remote).then(function(a){return a.sendSeen(),t.trigger(y.NEW_MSG_SENT),g["default"].props({reply:I.msgCreateRecord(o,e.local),chat:a})}).then(function(t){var r=t.reply,i=t.chat;if(200===r.status){var l=a.remote,s=a.fromMe&&a.remote===Store.Conn.me?3:r.data?r.data.ack:1;return e.updateAck(s),e.type!==b["default"].TYPE.PROTOCOL&&(i.lastReceivedKey=a),Store.Msg.updateLastReceipt(l,r.t),M.isBroadcast(l)&&(n?n.forEach(function(e){var t=new T({from:Store.Conn.me,to:e,id:a.id}),o=Store.Msg.get(t);o&&(o.ack=1,Store.Msg.updateLastReceipt(e,o.t),Store.Chat.find(e).then(function(e){e.lastReceivedKey=t}))}):E.log("model:msg:createRecord bclist server ack, no recipients")()),"success"}if(408!==r.status){var u=o;E.log("json.body: "+(0,h["default"])(u.body)),u.body=void 0,E.logVerbose("Json: "+(0,h["default"])(u))(),E.assert(!1,"send-not-200","Phone responded "+r.status)()}return"dropped"})["catch"](function(e){return E.error("model:msg:createRecord dropped msg: "+o.id)(o.type),E.assert(!1,"send-msg-error","Got error "+e)(e),"dropped"})})["finally"](function(){e.promises.sendPromise&&e.promises.sendPromise.control.settled()})},resyncReceipts:function(){E.log("Msg:resyncReceipts")();var e=[];for(var t in Store.Msg.lastReceivedReceipt){var a,o=Store.Chat.get(t);if(a=o?k.gte([0,5])?o.getFirstMsgWithStatus():o.getFirstMsgFromMe():void 0){var n=a.id;n.t=Store.Msg.lastReceivedReceipt[t]||a.t||0,e.push(n)}else E.error("Msg:resyncReceipts wid in lastReceivedReceipt, but no msg: "+t)()}return 0===e.length?g["default"].resolve():I.resyncReceipts(e).then(function(e){_.isArray(e)?(E.log("Msg:resyncReceipts success")(),e.forEach(function(e){Store.Msg.updateLastReceipt(e.id,e.t),e.acks.forEach(function(t){if(4===t.length){var a=new T({fromMe:t[1],remote:e.id,id:t[0],participant:t[2]}),o=Store.Msg.get(a);o&&o.updateAck(t[3])}else E.error("Msg:resyncReceipts invalid response: "+(0,h["default"])(t))()})})):E.error("Msg:resyncReceipts error",e)()})["catch"](C.LogoutDrop,C.EphemeralDrop,C.BrowserReplacedDrop,_.noop)["catch"](function(e){throw E.error("Msg:resyncReceipts dropped "+e+" "+(e?e.stack:"no stack"))(),new Error("Msg:resyncReceipts dropped")})},updateLastReceipt:function(e,t){var a=this.lastReceivedReceipt[e];(!a||t>a)&&(this.lastReceivedReceipt[e]=t)},processMultipleMessages:function(e,t,a,o){var n=this,i=function(){return r.call(n,e,t,a,o)};if(e){var l,s=this.pendingAdd[e];return l=s?s.then(i):i(),l["finally"](function(){n.pendingAdd[e]===l&&(n.pendingAdd[e]=null)})["catch"](_.noop),this.pendingAdd[e]=l}return i()},getBroadcastFanoutKeys:c});e.exports=new O},7482:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(53),l=o(i),s=a(7166),u=o(s),c=a(1),d=a(32),f=a(108),p=a(63),h=a(33),m=a(38),g=p.extend({model:u["default"],initialize:function(){p.prototype.initialize.call(this,{staleCollection:!0})},_initializeStaleCollection:function(){var e=this;this.listenTo(h,"change:stream",function(){h.stream===h.STREAM.DISCONNECTED&&e.forEach(function(e){e.settled||e.set("stale",!0)})})},_find:function(e){var t=Store.Msg.get(e);return t?t.isSentByMe?m.queryMsgInfo(t.id).then(function(e){return e.status>=400?(c.log("model:MsgInfo:findQuery error "+e.status)(),r["default"].reject(e.status)):(e.id=t.id,e.isPTT=t.type===l["default"].TYPE.PTT,r["default"].resolve(e))}):r["default"].reject("message not sent by me"):r["default"].reject("No message found for id: "+e)},update:function(e,t,a,o,n,r){var i=new f({from:t,to:a,id:e,participant:n}),l=new f({from:t,to:a,id:e}),s=this.get(i)?this.get(i):this.get(l),u=d.isUser(l.remote),p=void 0,h=void 0;if(s)switch(o){case 4:if(p=s.played.get(n),p||(s.played.add({id:n,t:r}),s.playedRemaining-=1),u)break;case 3:if(h=s.read.filter(function(e){return e.id===n}),s.read.remove(h),3===o&&(s.read.add({id:n,t:r}),0===h.length&&(s.readRemaining-=1)),u)break;case 2:h=s.delivery.filter(function(e){return e.id===n}),s.delivery.remove(h),2===o&&(s.delivery.add({id:n,t:r}),0===h.length&&(s.deliveryRemaining-=1));break;default:c.error("model:MsgInfo:handle ack err: "+o,arguments)()}},handle:function(e){var t=this,a=e.shift();switch(a.cmd){case"ack":this.update(a.id,a.from,a.to,a.ack,a.participant,a.t);break;case"acks":a.id.forEach(function(e){t.update(e,a.from,a.to,a.ack,a.participant,a.t)})}}});e.exports=new g},7483:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(1),r=o(n),i=a(63),l=o(i),s=a(7273),u=o(s),c=a(21),d=o(c),f="global_mute",p=!0,h=!0,m=!0,g=l["default"].extend({model:u["default"],initialize:function(){l["default"].prototype.initialize.call(this,{CachePolicy:{id:"mute",policy:l["default"].CACHE_POLICY.LOAD,delay:1e3}})},initializeFromCache:function(e){this.add(e);var t=d["default"].getGlobalSounds();this.setGlobalSounds(t);var a=d["default"].getGlobalNotifications();this.setGlobalNotifications(a);var o=d["default"].getGlobalPreviews();this.setGlobalPreviews(o)},saveToCache:function(){if(Store.Conn.me){var e=this._config.CachePolicy.id;r["default"].log("models:mute:cache-save: "+e)(),d["default"].setCollection(e,[this.globalMute().toJSON()])}},globalMute:function(){var e=this.get(f);return e?e:this.add({id:f})},getGlobalSounds:function(){return p},setGlobalSounds:function(e){p=e,d["default"].setGlobalSounds(e)},getGlobalNotifications:function(){return h},setGlobalNotifications:function(e){h=e,d["default"].setGlobalNotifications(e)},getGlobalPreviews:function(){return m},setGlobalPreviews:function(e){m=e,d["default"].setGlobalPreviews(e)},handle:function(e){for(var t=0;t<e.length;t++){var a=e[t],o=Store.Chat.get(a.id);o&&"mute"===a.type&&o.mute.setMute(a.muteExpiration)}}});e.exports=new g},7484:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7181),l=o(i),s=a(1),u=a(63),c=a(38),d=a(14),f=u.extend({model:l["default"],initialize:function(){u.prototype.initialize.call(this,{staleCollection:!0}),this.listenTo(Store.Stream,"change:phoneActive",this.onPresenceSubscribabilityChange)},_find:function(e){var t=this.gadd(e);return t.isUser?(t.isSubscribed=!0,Store.ServerProps.webPresence?c.subscribePresence(e).then(function(){return{id:e}})["catch"](function(e){return t.isSubscribed=!1,r["default"].reject(e)}):(c.presenceSubscribe(e)["catch"](function(e){return t.isSubscribed=!1,r["default"].reject(e)})["catch"](d.WapDrop,_.noop),c.lastseenFind(e).then(function(a){return 423===a.status?{id:e,stale:!0,hasData:!1}:401===a.status?(t.handle({id:e,deny:!0}),{id:e}):(a.id=e,t.handle(a),{id:e})}))):r["default"].resolve({id:e})},handle:function(e){var t=e.shift();if(t.id===Store.Conn.me)"unavailable"===t.type?this.forEach(function(e){"unavailable"===e.type||e.stale||this.add({id:e.id,type:"unavailable",t:t.t,stale:!1},{merge:!0})}.bind(this)):s.log('models:presence:handle for self is not "unavailable" !')();else{var a=this.get(t.id);a&&("unsubscribe"===t.type?a.set({isSubscribed:!1,stale:!0}):(a.handle(t),a.stale=!1))}},onPresenceSubscribabilityChange:function(){Store.Stream.phoneActive?Store.Chat.forEach(function(e){e.active&&e.presence.isUser&&e.presence.update()["catch"](d.WapDrop,_.noop)}):this.forEach(function(e){e.reset(),e.set({stale:!0,isSubscribed:!1})})}});e.exports=new f},7485:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7153),l=o(i),s=a(290),u=o(s),c=a(64),d=o(c),f=a(1),p=a(63),h=a(21),m=a(38),g=a(14),v=a(32),b=a(33),y=p.extend({model:l["default"],initialize:function(){p.prototype.initialize.call(this,{staleCollection:!0,resumeOnAvailable:!0,CachePolicy:{id:"profile_pic_thumb",trigger:"change:tag change:raw",policy:p.CACHE_POLICY.LOAD,delay:5e3}}),this.listenTo(d["default"],"change:phoneActive",function(){d["default"].phoneActive&&this.onPhoneActive()})},get:function(e){var t=p.prototype.get.call(this,e);if(!_.isString(e))return t;var a=p.prototype.get.call(this,(0,u["default"])(e));if(a){if(this.remove(a,{silent:!0}),t)return t;var o=a.toJSON();return o.id=e,this.add(o,{silent:!0})}return t?t:void 0},saveToCache:function(){if(Store.Conn.me){var e=this._config.CachePolicy.id,t=this.models.filter(function(e){return v.isWid(e.id)});t=t.map(function(e){return e=e.toJSON(),e.id=(0,u["default"])(e.id),e}),f.log("models:profilePic:cache-save: "+e)(),h.setCollection(e,t)}},onPhoneActive:function(){b.stream===b.STREAM.CONNECTED&&this._onResume()},onResume:function(){var e=this.filter(function(e){var t=Store.Chat.get(e.id);return e._uiObservers&&e.stale&&(v.isUser(e.id)||v.isGroup(e.id))&&!(t&&t.isReadOnly)}).map(function(e){return e.tag||e.unset("tag",{silent:!0}),e});this.resyncPictures(e)},_find:function(e){var t=Store.Chat.get(e);return t&&t.isReadOnly?m.profilePicFindThumbFromPhone(e,this.get(e)):v.isUser(e)||v.isGroup(e)?m.profilePicFind(e).then(function(t){var a={id:e};switch(t.status){case 401:a.tag="",a.raw=void 0;break;case 423:a.stale=!0;break;case 429:a.stale=!0;break;default:"undefined"==typeof t.status?(a.tag=t.tag,a.raw=null,a.eurl=t.eurl):(a.tag=null,a.eurl=null)}return a})["catch"](g.WapDrop,function(){return{id:e,stale:!0}}):r["default"].resolve({id:e,tag:null})},imageChanged:function(e,t){var a=Store.ProfilePicThumb.get(e);a&&("remove"===t?a.set({tag:void 0,eurl:void 0}):a.tag!==t&&a.update()["catch"](g.WapDrop,_.noop))},resyncPictures:function(e){return 0===e.length?r["default"].resolve():m.resyncPictures(e.map(function(e){return{id:e.id,tag:e.tag}})).then(function(t){if(423===t.status||429===t.status)f.warn("ProfilePicThumbStore:resyncPictures blocked "+t.status)();else{if(t.status>=400)throw f.error("ProfilePicThumbStore:resyncPictures error "+t.status)(t),new Error("ProfilePicThumbStore:resyncPictures error");if(!_.isArray(t))throw f.error("ProfilePicThumbStore:resyncPictures unknown reply",t)(),new Error("ProfilePicThumbStore:resyncPictures unknown reply");f.log("ProfilePicThumbStore:resyncPictures success")(),t.forEach(function(e){var t=Store.ProfilePicThumb.get(e.id);t&&t.set({tag:e.tag,raw:void 0,stale:!1,eurl:e.eurl})}),e.forEach(function(e){e.stale=!1})}})["catch"](g.WapDrop,_.noop)["catch"](function(e){f.error("ProfilePicThumbStore:resyncPictures dropped: "+e)()})}});e.exports=new y},7486:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.MediaDataProxy=t.StreamProxy=t.StatusV3Proxy=t.StatusProxy=t.ServerPropsProxy=t.RecentEmojiProxy=t.ProfilePicThumbProxy=t.ChatstateProxy=t.PresenceProxy=t.MuteProxy=t.MsgProxy=t.MsgLoadProxy=t.MsgInfoParticipantProxy=t.MsgInfoProxy=t.ParticipantProxy=t.GroupMetadataProxy=t.EmojiVariantProxy=t.ConversionTupleProxy=t.ContactProxy=t.ConnProxy=t.ChatProxy=t.ChatPreferenceProxy=t.CallProxy=t.BlocklistProxy=t.AttachMediaProxy=void 0;var n=a(7163);Object.defineProperty(t,"AttachMediaProxy",{enumerable:!0,get:function(){return n.AttachMediaProxy}});var r=a(7268);Object.defineProperty(t,"BlocklistProxy",{enumerable:!0,get:function(){return r.BlocklistProxy}});var i=a(7269);Object.defineProperty(t,"CallProxy",{enumerable:!0,get:function(){return i.CallProxy}});var l=a(7164);Object.defineProperty(t,"ChatPreferenceProxy",{enumerable:!0,get:function(){return l.ChatPreferenceProxy}});var s=a(484);Object.defineProperty(t,"ChatProxy",{enumerable:!0,get:function(){return s.ChatProxy}});var u=a(269);Object.defineProperty(t,"ConnProxy",{enumerable:!0,get:function(){return u.ConnProxy}});var c=a(486);Object.defineProperty(t,"ContactProxy",{enumerable:!0,get:function(){return c.ContactProxy}});var d=a(7270);Object.defineProperty(t,"ConversionTupleProxy",{enumerable:!0,get:function(){return d.ConversionTupleProxy}});var f=a(7271);Object.defineProperty(t,"EmojiVariantProxy",{enumerable:!0,get:function(){return f.EmojiVariantProxy}});var p=a(7165);Object.defineProperty(t,"GroupMetadataProxy",{enumerable:!0,get:function(){return p.GroupMetadataProxy}}),Object.defineProperty(t,"ParticipantProxy",{enumerable:!0,get:function(){return p.ParticipantProxy}});var h=a(7166);Object.defineProperty(t,"MsgInfoProxy",{enumerable:!0,get:function(){return h.MsgInfoProxy}}),Object.defineProperty(t,"MsgInfoParticipantProxy",{enumerable:!0,get:function(){return h.MsgInfoParticipantProxy}});var m=a(268);Object.defineProperty(t,"MsgLoadProxy",{enumerable:!0,get:function(){return m.MsgLoadProxy}});var g=a(53);Object.defineProperty(t,"MsgProxy",{enumerable:!0,get:function(){return g.MsgProxy}});var _=a(7273);Object.defineProperty(t,"MuteProxy",{enumerable:!0,get:function(){return _.MuteProxy}});var v=a(7181);Object.defineProperty(t,"PresenceProxy",{enumerable:!0,get:function(){return v.PresenceProxy}}),Object.defineProperty(t,"ChatstateProxy",{enumerable:!0,get:function(){return v.ChatstateProxy}});var b=a(7153);Object.defineProperty(t,"ProfilePicThumbProxy",{enumerable:!0,get:function(){return b.ProfilePicThumbProxy}});var y=a(7274);Object.defineProperty(t,"RecentEmojiProxy",{enumerable:!0,get:function(){return y.RecentEmojiProxy}});var E=a(7275);Object.defineProperty(t,"ServerPropsProxy",{enumerable:!0,get:function(){return E.ServerPropsProxy}});var S=a(7167);Object.defineProperty(t,"StatusProxy",{enumerable:!0,get:function(){return S.StatusProxy}});var C=a(7131);Object.defineProperty(t,"StatusV3Proxy",{enumerable:!0,get:function(){return C.StatusV3Proxy}});var M=a(64);Object.defineProperty(t,"StreamProxy",{enumerable:!0,get:function(){return M.StreamProxy}});var k=a(262),w=o(k);t.MediaDataProxy=w["default"].Proxy},7487:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7274),l=o(i),s=a(8),u=a(1),c=a(63),d=a(38),f=a(14),p=a(95),h=a(47),m=c.extend({model:l["default"],comparator:function(e,t){return e.weight>t.weight?-1:1},initialize:function(){c.prototype.initialize.call(this,{CachePolicy:{id:"recent_emoji_collection",
policy:c.CACHE_POLICY.LOAD,delay:2e3}}),this.listenTo(this,"change:weight change:length",this.sortTrimScale),this.dirty=!1,this.syncDue=!1},"delete":function(){c.prototype["delete"].call(this),this.dirty=!1,this.syncDue=!1,this._sync.cancel()},_findQuery:function(e){return h.supportsFeature(h.F.RECENT_EMOJI_SYNC)?d.recentEmojiQuery(e?this.toArray():void 0).then(function(e){return _.isArray(e)?(e.forEach(function(e){e["char"]=p.normalizeEmoji(e["char"]),e.id=e["char"]}),r["default"].resolve(e)):(u.error("models:recentEmoji:findQuery error",e)(),r["default"].reject("recent emoji fetch error"))}):r["default"].reject("gk recent emoji sync unsupported")},sync:function(){var e=this;return this.findQuery(this.dirty)["finally"](function(){e.dirty=!1})["catch"](f.WapDrop,_.isString,_.noop)},_sync:_.throttle(function(e,t){e.syncDue&&e.sync()["finally"](t)},s.EMOJI_SYNC_DELAY,{leading:!1}),periodicSync:function(){h.supportsFeature(h.F.RECENT_EMOJI_SYNC)&&(u.log("models:recentEmoji:periodicSync due:"+this.syncDue+" dirty: "+this.dirty)(),this.syncDue=!0,this._sync(this,function(){this.syncDue=!1}.bind(this)))},sortTrimScale:function(){var e=this.length;e&&(this.sort(),e>30&&this.remove(this.models.slice(30)),_.head(this.models).weight<10&&_.last(this.models).weight>.01||this.forEach(function(t,a){t.weight=1+3*((e-a)/e)}))},increment:function(e){p.skinToneEmojis[e]&&(e=p.skinToneEmojis[e]),this.forEach(function(t){t["char"]===e?t.weight+=1:t.weight*=.9,t.weight=Math.round(1e3*t.weight)/1e3}),this.get(e)||this.add({id:e,"char":e,weight:1}),this.dirty=!0,this.periodicSync()}});e.exports=new m},7488:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(53),l=o(i),s=a(63),u=a(33),c=a(47),d=a(1),f=s.extend({model:l["default"],initialize:function(){var e=this;this.syncPromise=null,this.isSynced=!1,this.listenTo(u,"change:stream",function(){u.stream===u.STREAM.DISCONNECTED&&(e.isSynced=!1)})},comparator:function(e,t){return t.t-e.t},onResume:function(){this.isSynced=!1,this.sync()},maySync:function(){return c.supportsFeature(c.F.STARRED_GIFS)&&Store.Conn.platform===Store.Conn.PLATFORMS.IPHONE},sync:function(){var e=this;return this.isSynced?r["default"].resolve():this.syncPromise?this.syncPromise:this.maySync()?(this.syncPromise=Store.Msg.getStarred(void 0,void 0,void 0,!0).then(function(t){var a=[];t&&t.length&&(a=_.filter(t,function(e){return e.isGif&&!e.isUnsentMedia})),e.set(a)})["catch"](function(e){499!==e&&d.error("starred gif msgs sync error: ",e)()})["finally"](function(){e.syncPromise=null,e.isSynced=!0}),this.syncPromise):r["default"].resolve()},add:function(e,t){var a=this;if(e&&this.maySync()&&this.isSynced){var o=this.isModel(e)?[e]:e;return o=_.filter(o,function(e){return e.isGif&&!a.get(e)}),s.prototype.add.call(this,o,t)}},remove:function(e,t){var a=this;if(e&&this.maySync()&&this.isSynced){var o=this.isModel(e)?[e]:e;return o=_.filter(o,function(e){return e.isGif&&a.get(e)}),s.prototype.remove.call(this,o,t)}}});e.exports=f},7489:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(7167),l=o(i),s=a(64),u=o(s),c=a(179),d=a(3),f=a(1),p=a(63),h=a(38),m=a(14),g=a(33),v=a(12),b=a(47),y=p.extend({model:l["default"],initialize:function(){p.prototype.initialize.call(this,{staleCollection:!0,resumeOnAvailable:!0}),this.listenTo(u["default"],"change:phoneActive",function(){u["default"].phoneActive&&this.onPhoneActive()})},onPhoneActive:function(){g.stream===g.STREAM.CONNECTED&&this._onResume()},onResume:function(){this.filter(_.property("_uiObservers")).forEach(function(e){Store.Status.find(e.id)["catch"](m.WapDrop,_.noop)})},_find:function(e){var t=this,a=Store.ServerProps.statusV2?h.statusFind(e).then(function(a){var o={id:e};if(_.isNumber(a.status))switch(a.status){case 423:o.stale=!0,o.status="";break;case 429:o.stale=!0,_.isString(t.get(e).status)||(o.status="");break;default:o.status=""}else o.status=a.status;return o})["catch"](m.WapDrop,function(){return{id:e,stale:!0,status:""}}):r["default"].resolve({id:e,status:""});return a},_handle:function(e){return e},canSetMyStatus:function(){return b.supportsFeature(b.F.SET_STATUS)&&!!Store.ServerProps.statusV2},setMyStatus:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments[1];if(t=t.trim(),!t)return r["default"].reject(new m.ActionError);if(!this.canSetMyStatus())return r["default"].reject(new m.ActionError);var o=h.sendSetStatus(t),n=new c.ActionType(l10n.t("action_status_setting")),i=this.get(Store.Conn.me).status;a=a||(0,c.genId)();var l=o.then(function(t){return 200===t.status?new c.ActionType(l10n.t("action_status_set"),l10n.t("action_undo"),e.setMyStatus.bind(e,i,a)):t.status>=400?new c.ActionType(l10n.t("action_status_set_failed")):void 0})["catch"](function(o){throw f.error("models:statusCollection:setMyStatus dropped")(o),new c.ActionType(l10n.t("action_status_set_failed"),l10n.t("action_try_again"),e.setMyStatus.bind(e,t,a))});return v.openToast(d.createElement(c.ActionToast,{id:a,initialAction:n,pendingAction:l})),o.bind(this).then(function(e){200!==e.status||e._duplicate||(this.get(Store.Conn.me).status=t)})}});e.exports=new y},7490:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}var r=a(96),i=n(r),l=a(0),s=n(l),u=a(7131),c=n(u),d=a(62),f=o(d),p=a(76),h=n(p),m=a(63),g=a(8),v=a(14),b=a(1),y=a(38),E=86400,S=m.extend({model:c["default"],initialize:function(){m.prototype.initialize.call(this)},"delete":function(){m.prototype["delete"].call(this),delete this.checksum},_find:function(e){return s["default"].resolve({id:e})},findQuery:function(e,t){var a=this;return m.prototype.findQuery.call(this,e,t).then(function(e){e.forEach(function(e){var t=[].concat((0,i["default"])(e.msgs.models)),o=0;_.forEach(t,function(t){o<e._msgs.length&&e._msgs[o].id.equals(t.id)?++o:t["delete"]()}),e._msgs.length>0&&a.addStatusMessages(e.id,e._msgs)})})},_findQuery:function(e){var t=this;return y.statusQuery().then(function(e){return t.checksum=e.checksum,s["default"].map(e.statuses,function(e){var t=e.pic;return t?h["default"].createFromData(t,"image/jpeg").then(function(t){return e.pic=t,e}):e})})},loadMore:function(e,t,a){return y.statusQuery(e,t,a&&a.id,"after").then(function(e){return e.status>=400?(b.error("model:statusv3:findQuery error "+e.status)(),s["default"].reject(e.status)):(e.forEach(function(e){e.invis=!0}),b.log("model:statusv3:loadMore:"+e.length)(),Store.Msg.processMultipleMessages(g.STATUS_WID,e,{add:"after",isHistory:!0}))})},sync:function(e){var t=this;return!e||this.checksum&&this.checksum!==e?this.findQuery({},{set:this.hasSynced()})["catch"](v.WapDrop,_.noop)["finally"](function(){t.trigger("sync")}):s["default"].resolve(void 0)},hasSynced:function(){return!!this.checksum},handleUpdate:function(e,t,a){var o=e.id.fromMe?Store.Conn.me:e.author;if(this.updateChecksum(t),this.hasSynced()){if(a)return!0;var n=this.get(o);if(n){var r=n.totalCount===n.msgs.length;if("revoke"===e.subtype){var i=_.take(n.msgs.models,n.totalCount-n.unreadCount),l=_.map(i,function(e){return e.id.toString()}),s={totalCount:n.totalCount-1};_.find(l,e.protocolMessageKey.toString())||n.readKeys[e.protocolMessageKey.toString()]||(s.unreadCount=n.unreadCount-1),n.set(s)}else{var u={totalCount:n.totalCount+1};e.invis||(u.unreadCount=n.unreadCount+1),u.t=e.t,n.set(u)}return!r&&e.body&&h["default"].createFromBase64Jpeg(e.body).then(function(e){n.pic=e}),r}return this.add({id:o,t:e.t,unreadCount:e.invis?0:1,totalCount:1}),!0}return!1},updateChecksum:function(e){e?this.hasSynced()&&(this.checksum=e):b.info("models:statusV3:no_checksum")()},handle:function(e){var t=e.shift();if(_.isArray(t))b.warn("models:statusV3:unexpected update")(t);else switch(t.type){case"read":this.updateChecksum(t.checksum);var a=this.get(t.chat);a?a.handleReadStatus(t.key):b.log("models:statusV3:read:no_status:"+[t.chat,t.key].join())(t);break;case"privacy":Store.StatusV3Privacy.update(t);break;default:b.warn("models:statusV3:unknown:"+t.type,t)()}},addStatusMessages:function(e,t){return Store.Msg.processMultipleMessages(g.STATUS_WID,t,{add:"after",isHistory:!0})},getUnexpired:function(e){var t=this.filter(function(e){return e.totalCount>0&&f.globalUnixTime()-e.t<=E&&e.contact.isMyContact&&!e.contact.isMe});if(e){var a=_.sortBy(_.filter(t,function(e){return e.unreadCount>0}),function(e){return e.t});return a.reverse(),a}var o=_.sortBy(_.filter(t,function(e){return 0===e.unreadCount}),function(e){return e.t});return o.reverse(),o},getMyStatus:function(){var e=this.filter(function(e){return e.contact.isMe});return _.isEmpty(e)?void 0:f.globalUnixTime()-e[0].t>E?void 0:e[0]}});e.exports=new S},7491:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(0),r=o(n),i=a(74),l=o(i),s=a(1),u=a(33),c=a(38),d=a(32),f=(0,i.defineState)("StatusPrivacy",{props:{id:"number",blacklist:{type:"array","default":function(){return[]}},whitelist:{type:"array","default":function(){return[]}},type:"string"},session:{isValid:"boolean"},initialize:function(){var e=this;l["default"].prototype.initialize.call(this),this.isValid=!1,this.listenTo(u,"change:stream",function(){u.stream===u.STREAM.RESUMING&&(e.isValid=!1)})},query:function(){var e=this;return c.getStatusPrivacy().then(function(t){switch(t.status){case 200:e.set({blacklist:t.blacklist,whitelist:t.whitelist,type:t["default"],isValid:!0});break;case 404:e.set({type:"contacts",isValid:!0});break;default:return s.error("statusV3Privacy:query:error:"+t.status,t)(),r["default"].reject(t.status)}})},update:function(e){this.isValid&&(e.whitelist&&this.set({type:"whitelist",whitelist:e.whitelist}),e.blacklist&&this.set({type:"blacklist",blacklist:e.blacklist}),e.contacts&&(this.type="contacts"))},sendSetPrivacy:function(e,t){var a=this;if(!this.isValid)return r["default"].reject("called setPrivacy when isValid false");var o;switch(e){case"blacklist":case"whitelist":if(o=_.isArray(t)?t.filter(function(e){return d.isUser(e)}):void 0,!_.isArray(o)||0===o.length)return r["default"].reject("called setPrivacy blacklist/whitelist with no valid jids");break;case"contacts":break;default:e="contacts"}return c.setStatusPrivacy(e,o).then(function(t){if(200===t.status){var n={};n[e]=o,a.update(n)}return t})["catch"](function(e){})}}),p=f.StatusPrivacy;e.exports=new p({id:1})},7492:function(e,t){"use strict";e.exports={Action:"keyboard_action",Event:"keyboard_event",Events:{LOGGED_IN:"logged_in",LOGGED_OUT:"logged_out",ARCHIVE:"archived",MUTE:"muted",READ:"read",READ_ONLY:"read_only",CHAT_KIND:"chat_kind",ZOOM:"zoom",LAUNCH:"launch"},Actions:{PREFERENCES:"preferences",NEW_CHAT:"new_chat",NEW_GROUP:"new_group",PROFILE_STATUS:"profile_status",LOGOUT:"logout",SEARCH:"search",ZOOM_IN:"zoom_in",ZOOM_OUT:"zoom_out",ZOOM_RESET:"zoom_reset",TOGGLE_UNREAD:"toggle_unread",DELETE_CHAT:"delete_chat",DELETE_GROUP:"delete_group",EXIT_GROUP:"exit_group",TOGGLE_ARCHIVE:"toggle_archive",TOGGLE_MUTE:"toggle_mute",SEARCH_CHAT:"search_chat",NEXT_CHAT:"next_chat",PREV_CHAT:"prev_chat",CONTACT_US:"contact_us",METRIC_UPDATE:"metric_update"},Metrics:{BETA_UPDATES:"beta_updates"}}},7493:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(12),v=n(_),b=a(71),y=n(b),E=a(520),S=o(E),C=a(291),M=a(64),k=n(M);t["default"]=(0,y["default"])(function(e){function t(){var e,a,o,n;(0,s["default"])(this,t);for(var r=arguments.length,l=Array(r),u=0;r>u;u++)l[u]=arguments[u];return a=o=(0,f["default"])(this,(e=t.__proto__||(0,i["default"])(t)).call.apply(e,[this].concat(l))),o.count=0,o.updateUnreadCount=function(){var e;e=k["default"].displayInfo===k["default"].INFO.OFFLINE?-1:k["default"].displayInfo===k["default"].INFO.TIMEOUT?-1:Store.Chat.filter(function(e){return!e.archive&&e.isDirty()}).length,o.count!==e&&(o.count=e,(0,C.setTitleAndIcon)(e))},n=a,(0,f["default"])(o,n)}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.listeners;t.add(v["default"],"alert_new_msg",function(t){return S.handleNewMessage(t,e.matchesFilter)}),t.add(v["default"],"alert_call",S.showCallNotification),t.add(v["default"],"cancel_call",S.cancelCallNotification),t.add(Store.Chat,"add remove reset change:archive change:unreadCount",this.updateUnreadCount),t.add(Store.Chat,"change:hasUnread",S.closeNotifications),t.add(k["default"],"change:displayInfo",this.updateUnreadCount),(0,C.setTitleAndIcon)(0),this.updateUnreadCount()}},{key:"componentWillUnmount",value:function(){}},{key:"matchesFilter",value:function(e){return!1}},{key:"render",value:function(){return null}}]),t}(g["default"].Component))},7494:function(e,t,a){"use strict";function o(e){l(this,o,e)}function n(e){l(this,n,e)}var r=a(274),i=r.defineProtobufClass,l=r.construct,s=3,u=13,c=14;i(o,{publicKey:[1,u],identifier:[2,u]}),i(n,{version:[1,s],localFingerprint:[2,c,o],remoteFingerprint:[3,c,o]}),e.exports={FingerprintData:o,CombinedFingerprint:n}},7495:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(5),i=n(r),l=a(2),s=n(l),u=a(4),c=n(u),d=a(7),f=n(d),p=a(6),h=n(p),m=a(3),g=n(m),_=a(7118),v=n(_),b=a(7146),y=n(b),E=a(7277),S=n(E),C=a(7131),M=(n(C),a(486)),k=(n(M),a(62)),w=o(k),N=function(e){function t(){return(0,s["default"])(this,t),(0,f["default"])(this,(t.__proto__||(0,i["default"])(t)).apply(this,arguments))}return(0,h["default"])(t,e),(0,c["default"])(t,[{key:"render",value:function(){var e=this.props,t=e.statusV3,a=e.contact;return g["default"].createElement(y["default"],{id:t.id,key:t.id,customImage:!0,image:g["default"].createElement(S["default"],{statusV3:t,contact:a}),primary:a.formattedName,secondary:w.relativeDateAndTimeStr(t.t),onClick:this.props.onClick,contextEnabled:function(){return!1}})}}]),t}(m.PureComponent);N.CONCERNS={statusV3:["id","t"],contact:["formattedName"]},t["default"]=(0,v["default"])(N)},7496:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(24),r=o(n),i=a(5),l=o(i),s=a(2),u=o(s),c=a(4),d=o(c),f=a(7),p=o(f),h=a(6),m=o(h),g=a(3),_=o(g),v=a(7118),b=o(v),y=a(7131),E=(o(y),a(7624)),S=o(E),C=50,M=10,k=function(e){function t(){return(0,u["default"])(this,t),(0,p["default"])(this,(t.__proto__||(0,l["default"])(t)).apply(this,arguments))}return(0,m["default"])(t,e),(0,d["default"])(t,[{key:"genCircle",value:function(e){var t=2*C+this.props.stroke;return _["default"].createElement("circle",(0,r["default"])({cx:t/2,cy:t/2,r:C,fill:"none",strokeLinecap:"round",strokeWidth:this.props.stroke},e))}},{key:"genDasharray",value:function(e,t,a,o){for(var n="",r=0;e>r;r++)n+=r===e-1?t+" "+(a-e*(o+t)+o)+" ":t+" "+o+" ";return n}},{key:"render",value:function(){var e=this.props,t=e.statusV3,a=e.stroke,o=e.size,n=2*C+a,r="0 0 "+n+" "+n,i=t.totalCount,l=M,s=Math.PI*C*2;1>s-M*i&&(l=s/i/1.2);var u=(s-l*i)/i,c=s/4-l/2,d=void 0,f=void 0;f=t.contact.isMe?0:t.unreadCount;var p=i-f;if(p){var h=c+i*(l+u),m=void 0;1!==i&&(m=this.genDasharray(p,u,s,l)),d=this.genCircle({strokeDashoffset:h,strokeDasharray:m,className:S["default"].read})}var g=void 0;if(f){var v=c+f*(l+u),b=void 0;1!==i&&(b=this.genDasharray(f,u,s,l)),g=this.genCircle({strokeDashoffset:v,strokeDasharray:b,className:S["default"].unread})}return _["default"].createElement("svg",{className:S["default"].ring,width:o,height:o,viewBox:r},d,g)}}]),t}(g.PureComponent);k.CONCERNS={statusV3:["unreadCount","totalCount","contact"]},k.defaultProps={size:48,stroke:4},t["default"]=(0,b["default"])(k)},7497:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(71),_=o(g),v=a(93),b=o(v),y=a(7425),E=o(y),S=a(12),C=o(S),M=a(10),k=o(M),w=a(172),N=o(w),T=a(7149),P=T.MenuBarItem,I=function(e){function t(){(0,l["default"])(this,t);var e=(0,d["default"])(this,(t.__proto__||(0,r["default"])(t)).apply(this,arguments));R.call(e);var a=k["default"].some(Store.StatusV3.getUnexpired(!0),function(e){return e.unreadCount>0&&!e.contact.statusMute});return e.state={hasUnread:a},e.lastViewerTimestamps={},e}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){this.props.listeners.add(Store.StatusV3,"add remove change:unreadCount change:t",this.onUnreadChange)}},{key:"render",value:function(){var e=this.state.hasUnread?m["default"].createElement(N["default"],{name:"status-v3-unread",directional:!0}):m["default"].createElement(N["default"],{name:"status-v3"});return m["default"].createElement(P,{icon:e,a8n:"menu-bar-status",title:b["default"].t("web_menuitem_status_v3"),onClick:this.onStatus})}}]),t}(h.PureComponent);I.CONCERNS={statusV3:["unreadCount"]};var R=function(){var e=this;this.onUnreadChange=function(){var t=k["default"].some(Store.StatusV3.getUnexpired(!0),function(t){var a=e.lastViewerTimestamps[t.id],o=!a||t.t>a;return!t.contact.statusMute&&t.unreadCount>0&&o});t!==e.state.hasUnread&&e.setState({hasUnread:t})},this.updateViewerTimestamps=function(){k["default"].forEach(Store.StatusV3.getUnexpired(!0),function(t){e.lastViewerTimestamps[t.id]=t.t})},this.onFlowEnd=function(){e.updateViewerTimestamps(),e.setState({hasUnread:!1})},this.onStatus=function(t){t.preventDefault(),C["default"].openModalMedia(m["default"].createElement(E["default"],{onFlowEnd:e.onFlowEnd,removeTopDrawer:!1}),"status-v3-modal")}};t["default"]=(0,_["default"])(I)},7498:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.StatusV3GifController=t.StatusV3CountdownController=t.StatusV3VideoController=void 0;var n=a(4),r=o(n),i=a(2),l=o(i),s=a(1),u=t.StatusV3VideoController=function p(){var e=this;(0,l["default"])(this,p),this.addListeners=function(t,a,o){e._onStart=t,e._onPause=a,e._onEnded=o},this.setVideo=function(t){e._video=t,e._video.addEventListener("playing",e._onPlayingHandler),e._video.addEventListener("pause",e._onPauseHandler),e._video.addEventListener("ended",e._onEndedHandler)},this.play=function(){e._video&&e._video.play()},this.pause=function(){e._video&&!e._video.paused&&e._video.pause()},this.resume=function(){e._video&&e._video.play()},this.stop=function(){e._video&&!e._video.paused&&e._video.pause()},this._onPlayingHandler=function(){var t=e._onStart;t&&t(1e3*(e._video.duration-e._video.currentTime),1e3*e._video.duration)},this._onPauseHandler=function(){var t=e._onPause;t&&t()},this._onEndedHandler=function(){var t=e._onEnded;t&&t()}},c=t.StatusV3CountdownController=function h(e){var t=this;(0,l["default"])(this,h),this.addListeners=function(e,a,o){t._onStart=e,t._onPause=a,t._onEnded=o},this.play=function(){if(t._timer)return void s.info("Duplicate timer start")();t._timer=setTimeout(t._onTimeup,t._timeout),t._start=(new Date).getTime();var e=t._onStart;e&&e(t._timeout,t._duration)},this.stop=function(){if(t._timer){clearTimeout(t._timer),t._timer=null;var e=(new Date).getTime();t._timeout-=e-t._start;var a=t._onPause;a&&a()}else s.info("Timer stop called on stopped timer")()},this.resume=function(){t.play()},this.pause=function(){t.stop()},this._onTimeup=function(){var e=t._onEnded;e&&e()},this._duration=e,this._timeout=this._duration,this._start=0},d=6e3,f=3;t.StatusV3GifController=function(){function e(){var t=this;(0,l["default"])(this,e),this.setVideo=function(e){t._video=e,t._videoController.setVideo(e)},this._onVideoStartHandler=function(){var e=t._onStart,a=Math.max(f*t._video.duration*1e3,d);e&&e(a-1e3*t._video.duration*t._playCounter-1e3*t._video.currentTime,a)},this._onVideoPauseHandler=function(){var e=t._onPause;e&&e()},this._onVideoEndedHandler=function(){t._playCounter++;var e=t._onEnded;t._playCounter===f&&(t._videoEnded=!0,t._timerEnded&&e&&e()),t._video.currentTime=0,t._videoEnded&&t._timerEnded||setTimeout(function(){t._videoController.play()},0)},this._onTimerEndedHandler=function(){var e=t._onEnded;t._timerEnded=!0,e&&t._videoEnded&&e()},this.play=function(){t._videoController.play(),t._countdownController.play()},this.stop=function(){t._videoController.stop(),t._countdownController.stop()},this.resume=function(){t._videoController.resume(),t._countdownController.resume()},this.pause=function(){t._videoController.pause(),t._countdownController.pause()},this._playCounter=0,this._timerEnded=!1,this._videoEnded=!1,this._videoController=new u,this._countdownController=new c(d),this._videoController.addListeners(this._onVideoStartHandler,this._onVideoPauseHandler,this._onVideoEndedHandler),this._countdownController.addListeners(void 0,void 0,this._onTimerEndedHandler)}return(0,r["default"])(e,[{key:"addListeners",value:function(e,t,a){this._onStart=e,this._onPause=t,this._onEnded=a}}]),e}()},7499:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(48),r=o(n),i=a(0),l=o(i),s=a(5),u=o(s),c=a(2),d=o(c),f=a(4),p=o(f),h=a(7),m=o(h),g=a(6),_=o(g),v=a(3),b=o(v),y=a(264),E=o(y),S=a(7625),C=o(S),M=a(46),k=a(23),w=function(e){function t(){(0,d["default"])(this,t);var e=(0,m["default"])(this,(t.__proto__||(0,u["default"])(t)).apply(this,arguments));return e.onStart=function(t,a){var o=M.findDOMNode(e.refs.bar),n="-"+t/a*100+"%";(0,E["default"])(o,"stop"),e.barAnimation=(0,E["default"])(o,{translateX:["0%",n]},{duration:t,easing:"linear"})},e.onPause=function(){var t=M.findDOMNode(e.refs.bar);(0,E["default"])(t,"stop")},e.onEnded=function(){return e.barAnimation?e.barAnimation:l["default"].resolve()},e}return(0,_["default"])(t,e),(0,p["default"])(t,[{key:"render",value:function(){for(var e=[],t=100/this.props.total+"%",a=0;a<this.props.total;++a){var o,n=k(C["default"].foreground,(o={},(0,r["default"])(o,C["default"].filled,a<this.props.current),(0,r["default"])(o,C["default"].empty,a>this.props.current),(0,r["default"])(o,C["default"].active,a===this.props.current),o)),i={width:t},l=void 0;a===this.props.current&&(l="bar");var s=b["default"].createElement("div",{className:C["default"].wrapper,style:i,key:a},b["default"].createElement("div",{className:C["default"].bg}),b["default"].createElement("div",{className:C["default"].mask},b["default"].createElement("div",{className:n,ref:l})));e.push(s)}return b["default"].createElement("div",{className:C["default"].container},e)}}]),t}(b["default"].Component);e.exports=w},7500:function(e,t,a){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,o={q:e,SafeSearch:"Strict",appid:m,mkt:v[l10n.getLocale()]||v.en,size:_.MEDIUM,aspect:g.SQUARE,count:a,offset:t},n=p.build(h,o);return u["default"].get(n,u["default"].RESP_TYPE.JSON).then(function(t){if(!t.response.hasOwnProperty("_type"))throw new d.InvalidServerResponseError(n,status,"Not a valid Bing response: "+(0,l["default"])(t.response));if("ErrorResponse"===t.response._type){var a=t.response;throw new d.BingServerError(e,t.status,a)}if("Images"!==t.response._type)throw new d.InvalidServerResponseError(n,status,"Did not receive an image search response, potentially malformed query "+(0,l["default"])(t.response));return t.response})}Object.defineProperty(t,"__esModule",{value:!0});var i=a(56),l=n(i);t.search=r;var s=a(97),u=n(s),c=a(14),d=o(c),f=a(73),p=o(f),h="https://www.bingapis.com/api/v6/images/search",m="D41D8CD98F00B204E9800998ECF8427E4F4A7492",g={SQUARE:"Square",WIDE:"Wide",TALL:"Tall",ALL:"All"},_={SMALL:"Small",MEDIUM:"Medium",LARGE:"Large",WALLPAPER:"Wallpaper",ALL:"All"},v={ar:"ar-SA",da:"da-DK",de:"de-DE",en:"en-US",es:"es-US",fi:"fi-FI",fr:"fr-FR",it:"it-IT",ko:"ko-KR",nl:"nl-NL",pl:"pl-PL","pt-BR":"pt-BR",ru:"ru-RU",sv:"sv-SE",tr:"tr-TR","zh-CN":"zh-CN","zh-TW":"zh-TW"},b=30},7501:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){for(var t in e)return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=o(r),l=a(4),s=o(l),u=function(){function e(){(0,i["default"])(this,e),this._children={}}return(0,s["default"])(e,[{key:"addBackwardsString",value:function(t){for(var a=t.length-1,o=this;a>=0;){var n=t.charAt(a);o=o.get(n)||o.set(n,new e),a--}return this}},{key:"get",value:function(e){return this._children[e]}},{key:"set",value:function(e,t){return this._children[e]=t,t}},{key:"hasChildren",value:function(){return!n(this._children)}}],[{key:"fromBackwardsStrings",value:function(t){return t.reduce(function(e,t){return e.addBackwardsString(t)},new e)}}]),e}();t["default"]=u},7502:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(!e)return!1;var t=window.getSelection();if(1!==t.rangeCount)return!1;var a=t.getRangeAt(0);if(!a.collapsed)return!1;var o=a.endContainer;if(a.startOffset!==r(o))return!1;if(e===o)return!0;if(!e.contains(o))return!1;var n=o;do{if(n.nextSibling)return!1;n=n.parentNode}while(n!==e);return!0}function r(e){return(0,l["default"])(e)?e.textContent.length:e.childNodes.length}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var i=a(287),l=o(i)},7503:function(e,t){"use strict";function a(e){if(!e)return!1;var t=window.getSelection();if(1!==t.rangeCount)return!1;var a=t.getRangeAt(0);if(!a.collapsed||0!==a.startOffset)return!1;var o=a.startContainer;if(e===o)return!0;if(!e.contains(o))return!1;var n=o;do{if(n.previousSibling)return!1;n=n.parentNode}while(n!==e);return!0}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a},7504:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=o(n),i=a(4),l=o(i),s=function(){function e(){(0,r["default"])(this,e)}return(0,l["default"])(e,[{key:"on",value:function(e,t,a){throw new Error("Unimplemented!")}},{key:"once",value:function(e,t,a){throw new Error("Unimplemented!")}},{key:"off",value:function(e,t,a){throw new Error("Unimplemented!")}},{key:"trigger",value:function(e){throw new Error("Unimplemented!")}},{key:"stopListening",value:function(e,t,a){throw new Error("Unimplemented!")}},{key:"listenTo",value:function(){throw new Error("Unimplemented!")}},{key:"listenToOnce",value:function(){throw new Error("Unimplemented!")}},{key:"listenToAndRun",value:function(e,t,a){throw new Error("Unimplemented!")}}]),e}();t["default"]=s},7505:function(e,t,a){"use strict";function o(e,t,a,o,r){var i=e.msg,l=e.date,s=e.unread,u=[],c=void 0,d=void 0;for(c=0;!d&&c<t.length;c++)d=t[c];for(var f=!1,p=!1,h=d?(0,n.dayOfMsg)(d):0,m=0;d;){p||u.push(l(d,m++)),d===o&&s&&u.push(s(r));for(var g=void 0;!g&&c<t.length;c++)g=t[c];var _=void 0,v=void 0,b=void 0;g?(b=(0,n.dayOfMsg)(g),v=b===h,_=v&&!d.isNotification&&!g.isNotification&&g!==o&&(d.isGroupMsg?d.author===g.author:d.from===g.from)):(_=!1,v=!1,b=0),u.push(i(d,d===a,f,_)),f=_,p=v,h=b,d=g}return u}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var n=a(62)},7506:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(2),r=o(n),i=a(4),l=o(i),s=function(){function e(){(0,r["default"])(this,e)}return(0,l["default"])(e,[{key:"trigger",value:function(e){}}]),e}();e.exports=new s},7507:function(e,t,a){"use strict";var o=a(526),n=function r(e){if(!r.isRecordingSupported())throw"Recording is not supported in this browser";this.audioContext=new window.AudioContext,this.config=e=e||{},this.config.command="encode-init",this.config.bufferLength=e.bufferLength||4096,this.config.monitorGain=e.monitorGain||0,this.config.numberOfChannels=e.numberOfChannels||1,this.config.originalSampleRate=this.audioContext.sampleRate,this.config.encoderSampleRate=e.encoderSampleRate||48e3,this.config.streamPages=e.streamPages||!1,this.config.leaveStreamOpen=e.leaveStreamOpen||!1,this.config.maxBuffersPerPage=e.maxBuffersPerPage||40,this.config.encoderApplication=e.encoderApplication||2049,this.config.encoderFrameSize=e.encoderFrameSize||20,this.config.streamOptions=e.streamOptions||{optional:[],mandatory:{googEchoCancellation:!1,googAutoGainControl:!1,googNoiseSuppression:!1,googHighpassFilter:!1}},this.storePage=this._storePage.bind(this),this.streamPage=this._streamPage.bind(this),this.state="inactive",this.eventTarget=document.createDocumentFragment(),this.createAudioNodes()};n.isRecordingSupported=function(){return window.AudioContext&&navigator.getUserMedia},n.prototype.addEventListener=function(e,t,a){this.eventTarget.addEventListener(e,t,a)},n.prototype.clearStream=function(){this.stream&&(this.stream.getTracks().forEach(function(e){e.stop()}),delete this.stream)},n.prototype.createAudioNodes=function(){var e=this;this.scriptProcessorNode=this.audioContext.createScriptProcessor(this.config.bufferLength,this.config.numberOfChannels,this.config.numberOfChannels),this.scriptProcessorNode.onaudioprocess=function(t){e.encodeBuffers(t.inputBuffer)},this.monitorNode=this.audioContext.createGain(),this.setMonitorGain(this.config.monitorGain),this.config.sampleRate<this.audioContext.sampleRate&&this.createButterworthFilter()},n.prototype.createButterworthFilter=function(){this.filterNode=this.audioContext.createBiquadFilter(),this.filterNode2=this.audioContext.createBiquadFilter(),this.filterNode3=this.audioContext.createBiquadFilter(),this.filterNode.type=this.filterNode2.type=this.filterNode3.type="lowpass";var e=this.config.sampleRate/2;this.filterNode.frequency.value=this.filterNode2.frequency.value=this.filterNode3.frequency.value=e-e/3.5355,this.filterNode.Q.value=.51764,this.filterNode2.Q.value=.70711,this.filterNode3.Q.value=1.93184,this.filterNode.connect(this.filterNode2),this.filterNode2.connect(this.filterNode3),this.filterNode3.connect(this.scriptProcessorNode)},n.prototype.encodeBuffers=function(e){if("recording"===this.state){for(var t=[],a=0;a<e.numberOfChannels;a++)t[a]=e.getChannelData(a);this.encoder.postMessage({command:"encode",buffers:t}),this.duration+=e.duration,this.eventTarget.dispatchEvent(new CustomEvent("duration",{detail:this.duration}))}},n.prototype.initStream=function(e){if(this.stream)return void this.eventTarget.dispatchEvent(new Event("streamReady"));if(e)return this.stream=e,this.sourceNode=this.audioContext.createMediaStreamSource(e),this.sourceNode.connect(this.filterNode||this.scriptProcessorNode),this.sourceNode.connect(this.monitorNode),void this.eventTarget.dispatchEvent(new Event("streamReady"));var t=this;navigator.getUserMedia({audio:this.config.streamOptions},function(e){t.stream=e,t.sourceNode=t.audioContext.createMediaStreamSource(e),t.sourceNode.connect(t.filterNode||t.scriptProcessorNode),t.sourceNode.connect(t.monitorNode),t.eventTarget.dispatchEvent(new Event("streamReady"))},function(e){t.eventTarget.dispatchEvent(new ErrorEvent("streamError",{error:e}))})},n.prototype.pause=function(){"recording"===this.state&&(this.state="paused",this.eventTarget.dispatchEvent(new Event("pause")))},n.prototype.removeEventListener=function(e,t,a){this.eventTarget.removeEventListener(e,t,a)},n.prototype.resume=function(){"paused"===this.state&&(this.state="recording",this.eventTarget.dispatchEvent(new Event("resume")))},n.prototype.setMonitorGain=function(e){this.monitorNode.gain.value=e;
},n.prototype.start=function(){"inactive"===this.state&&this.stream&&(this.encoder=new o,this.config.streamPages?this.encoder.addEventListener("message",this.streamPage):(this.recordedPages=[],this.totalLength=0,this.encoder.addEventListener("message",this.storePage)),this.encodeBuffers=function(){delete this.encodeBuffers},this.duration=0,this.state="recording",this.monitorNode.connect(this.audioContext.destination),this.scriptProcessorNode.connect(this.audioContext.destination),this.eventTarget.dispatchEvent(new Event("start")),this.eventTarget.dispatchEvent(new CustomEvent("duration",{detail:this.duration})),this.encoder.postMessage(this.config))},n.prototype.stop=function(){"inactive"!==this.state&&(this.state="inactive",this.audioContext.close&&this.audioContext.close(),this.monitorNode.disconnect(),this.scriptProcessorNode.disconnect(),this.config.leaveStreamOpen||this.clearStream(),this.encoder.postMessage({command:"encode-done"}))},n.prototype._storePage=function(e){var t=e.data;if(this.recordedPages.push(t),this.totalLength+=t.length,4&t[5]){this.encoder.removeEventListener("message",this.storePage);for(var a=new Uint8Array(this.totalLength),o=0,n=0;n<this.recordedPages.length;n++)a.set(this.recordedPages[n],o),o+=this.recordedPages[n].length;this.eventTarget.dispatchEvent(new CustomEvent("dataAvailable",{detail:new Blob([a],{type:"audio/ogg; codecs=opus"})})),this.recordedPages=[],this.eventTarget.dispatchEvent(new Event("stop"))}},n.prototype._streamPage=function(e){var t=e.data;this.eventTarget.dispatchEvent(new CustomEvent("dataAvailable",{detail:new Blob([t],{type:"audio/ogg; codecs=opus"})})),4&t[5]&&(this.encoder.removeEventListener("message",this.streamPage),this.eventTarget.dispatchEvent(new Event("stop")))},e.exports=n},7508:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var n=a(29),r=o(n),i=a(4),l=o(i),s=a(2),u=o(s),c=function f(e){(0,u["default"])(this,f),this.promise=e,this.lastUsedTime=this.createdTime=+Date.now()},d=function(){function e(t,a){var o=a.maxCached,n=void 0===o?10:o,r=a.maxAge,i=void 0===r?1/0:r,l=a.shouldCache;(0,u["default"])(this,e),this._cache={},this._maxCached=n,this._maxAge=i,this._createPromiseFunc=t,this._shouldCacheFunc=l}return(0,l["default"])(e,[{key:"getOrRun",value:function(){for(var e=this,t=arguments.length,a=Array(t),o=0;t>o;o++)a[o]=arguments[o];var n=a[0],i=this._cache;if(this._maxAge!==1/0)for(var l=Date.now()-this._maxAge,s=(0,r["default"])(i),u=0;u<s.length;u++){var d=s[u];i[d].createdTime<l&&delete i[d]}var f=i[n];if(f)return f.lastUsedTime=+Date.now(),f.promise;var p=(0,r["default"])(i);if(p.length>=this._maxCached){for(var h=void 0,m=void 0,g=0;g<p.length;g++){var _=p[g],v=i[_];(!m||v.lastUsedTime<m)&&(m=v.lastUsedTime,h=_)}delete i[h]}var b=this._createPromiseFunc.apply(void 0,a);return i[n]=new c(b),b.then(function(t){var a=e._shouldCacheFunc;a&&e._cache[n]===b&&!a(t)&&delete e._cache[n]})["catch"](function(){e._cache[n]===b&&delete e._cache[n]}),b}}]),e}();e.exports=d},7509:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(3),m=o(h),g=a(12),_=o(g),v=a(7443),b=o(v),y=a(71),E=o(y),S=a(126),C=o(S),M=function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.state={msg:null,getZoomNode:null,startTime:null,width:null,left:null,bottom:null},o.handleMediaRequest=function(e,t,a){e.forceDownloadMedia(),o.setState({msg:e,getZoomNode:t,startTime:a})},o.handleClose=function(){o.setState({msg:null,getZoomNode:null,startTime:null})},o.handleFullscreen=function(e){var t=o.state,a=t.msg,n=t.getZoomNode;o.handleClose(),_["default"].mediaViewerModal(a,n,e)},o.handleMove=function(e,t){o.setState({left:e,bottom:t})},o.handleResize=function(e,t,a){o.setState({width:e,left:t,bottom:a})},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentDidMount",value:function(){this.props.listeners.add(_["default"],"media_viewer_modal",this.handleClose),this.props.listeners.add(_["default"],"video_player_floater",this.handleMediaRequest)}},{key:"renderVideoPlayer",value:function(){return this.state.msg?m["default"].createElement(b["default"],{key:this.state.msg.id,msg:this.state.msg,mediaData:this.state.msg.mediaData,startTime:this.state.startTime,onClose:this.handleClose,onFullscreen:this.handleFullscreen,width:this.state.width,left:this.state.left,bottom:this.state.bottom,onMove:this.handleMove,onResize:this.handleResize}):null}},{key:"render",value:function(){return m["default"].createElement(C["default"],{transitionName:"pop"},this.renderVideoPlayer())}}]),t}(h.Component);t["default"]=(0,E["default"])(M)},7510:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(522),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(34),d={document:c.MEDIA_TYPE.DOCUMENT,video:c.MEDIA_TYPE.VIDEO,gif:c.MEDIA_TYPE.GIF,image:c.MEDIA_TYPE.PHOTO,audio:c.MEDIA_TYPE.AUDIO},f=function(){function e(t,a,o){(0,l["default"])(this,e),this.mediaPickerSentUnchanged=0,this.mediaPickerDeleted=0,this.mediaPickerChanged=new r["default"],this.mediaPickerCroppedRotated=new r["default"],this.mediaPickerDrawing=new r["default"],this.mediaPickerStickers=new r["default"],this.mediaPickerText=new r["default"],this.mediaPickerLikeDoc=0,this.mediaPickerNotLikeDoc=0,this.mediaPickerOrigin=0,this.mediaPickerT=0,this.t0=Date.now(),this.mediaType=d[a],this.mediaPickerOrigin=o,this.medias=new r["default"],this.medias.add(t),this.changeTypes={mediaPickerCroppedRotated:this.mediaPickerCroppedRotated,mediaPickerDrawing:this.mediaPickerDrawing,mediaPickerStickers:this.mediaPickerStickers,mediaPickerText:this.mediaPickerText}}return(0,u["default"])(e,[{key:"onAdd",value:function(e){this.medias.add(e),"document"===this.mediaType?this.mediaPickerLikeDoc++:this.mediaPickerNotLikeDoc++}},{key:"onChange",value:function(e,t){this.mediaPickerChanged.add(e),this.changeTypes[t].add(e)}},{key:"onDelete",value:function(e){return this.medias["delete"](e),this.mediaPickerDeleted++,0===this.medias.size?this.onCancel():void 0}},{key:"onSend",value:function(){return this.mediaPickerSent=this.medias.size,this.mediaPickerSentUnchanged=this.mediaPickerSent-this.mediaPickerChanged.size,this.dataPreflight()}},{key:"onCancel",value:function(){return this.mediaPickerSent=0,this.mediaPickerSentUnchanged=0,this.dataPreflight()}},{key:"onPause",value:function(){this.mediaPickerT+=Date.now()-(this.t0||0),this.t0=null}},{key:"onResume",value:function(){this.t0=this.t0||Date.now()}},{key:"dataPreflight",value:function(){return{mediaPickerSent:this.mediaPickerSent,mediaPickerSentUnchanged:this.mediaPickerSentUnchanged,mediaPickerT:this.mediaPickerT+(Date.now()-(this.t0||0)),mediaType:this.mediaType,mediaPickerOrigin:this.mediaPickerOrigin,mediaPickerChanged:this.mediaPickerChanged.size,mediaPickerCroppedRotated:this.mediaPickerCroppedRotated.size,mediaPickerDrawing:this.mediaPickerDrawing.size,mediaPickerStickers:this.mediaPickerStickers.size,mediaPickerText:this.mediaPickerText.size,mediaPickerLikeDoc:this.mediaPickerLikeDoc,mediaPickerNotLikeDoc:this.mediaPickerNotLikeDoc,mediaPickerDeleted:this.mediaPickerDeleted}}}]),e}();t["default"]=f},7511:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(){return Math.floor(2147483648*Math.random()).toString(36)}Object.defineProperty(t,"__esModule",{value:!0});var r=a(2),i=o(r),l=a(4),s=o(l),u=a(55),c=o(u),d=2,f=32*d,p=function(){function e(t){var a=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();(0,i["default"])(this,e),this.sessionId=n(),this.sequenceId=-1,this.cumulativeBitsSet=0,this.ship=function(){var e=Date.now();if(e>a.lastActiveInMS&&(a.bitmapLength=Math.min(f,Math.ceil(e/1e3-a.startTimeInSec))),a.bitmap){var t={userActivitySessionId:a.sessionId,userActivityStartTime:a.startTimeInSec,userActivityBitmap:a.bitmap,userActivityBitmapLen:a.bitmapLength,userActivitySessionSeq:a.sequenceId,userActivitySessionCum:a.cumulativeBitsSet};a.loggingCallback(t)}a.reset()},this.loggingCallback=t,this.timer=new c["default"](this.ship),this._initArray(Math.floor(o/1e3))}return(0,s["default"])(e,[{key:"_initArray",value:function(e){this.startTimeInSec=e,this.lastActiveInMS=1e3*this.startTimeInSec,this.bitmap=new Int32Array(d),this.bitmap[0]=1,this.bitmapLength=1,this.cumulativeBitsSet+=1,this.sequenceId+=1,this._startTimer()}},{key:"_startTimer",value:function(){this._stopTimer();var e=1e3*f;this.timer.debounceAndCap(e,e)}},{key:"_stopTimer",value:function(){this.timer.cancel()}},{key:"_doUpdate",value:function(e){var t=e-this.startTimeInSec;(0>t||t>=f)&&this.ship(),this.bitmap?(this.bitmap[t>>5]|=1<<(31&t),this.bitmapLength=t+1,this.cumulativeBitsSet+=1,this.lastActiveInMS=1e3*e):this._initArray(e)}},{key:"update",value:function(e){e>=this.lastActiveInMS&&e-this.lastActiveInMS<1e3||this._doUpdate(Math.floor(e/1e3))}},{key:"shipAndEndSession",value:function(){this.ship(),this.cumulativeBitsSet=0,this.sequenceId=-1,this.sessionId=n()}},{key:"reset",value:function(){this._stopTimer(),this.bitmap=null}}]),e}();t["default"]=p},7512:function(e,t,a){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(5),r=o(n),i=a(2),l=o(i),s=a(4),u=o(s),c=a(7),d=o(c),f=a(6),p=o(f),h=a(71),m=o(h),g=a(1),_=o(g),v=a(34),b=o(v),y=a(3),E=o(y),S=a(7210),C=o(S),M=a(7511),k=o(M),w=500,N=-5,T=[{source:window,name:"focus"},{source:document,name:"wheel"},{source:document,name:"keydown"},{source:document,name:"mouseover"},{source:document,name:"mousemove"},{source:document,name:"click"},{source:document,name:"scroll"}];t["default"]=(0,m["default"])(function(e){function t(){var e,a,o,n;(0,l["default"])(this,t);for(var i=arguments.length,s=Array(i),u=0;i>u;u++)s[u]=arguments[u];return a=o=(0,d["default"])(this,(e=t.__proto__||(0,r["default"])(t)).call.apply(e,[this].concat(s))),o.lastActive=Date.now(),o.lastInform=Date.now(),o.idleTime=0,o.lastPageX=-1,o.lastPageY=-1,o.bitArray=null,o.stop=function(){o.bitArray&&(o.bitArray.ship(),o.bitArray=null)},o.endSession=function(){o.bitArray&&o.bitArray.shipAndEndSession()},o.handleRestore=function(){var e=o.bitArray;return e?(o.lastActive=Date.now(),o.lastInform=o.lastActive,void e.update(o.lastInform)):void _["default"].error("Time Spent Logger not started")()},o.handleEvent=function(e){var t=o.bitArray;if(!t)return void _["default"].error("Time Spent Logger not started")();if(e instanceof MouseEvent){if(e.pageX===o.lastPageX&&e.pageY===o.lastPageY&&"click"!==e.type)return;o.lastPageX=e.pageX,o.lastPageY=e.pageY}o.lastActive=Date.now();var a=o.lastActive-o.lastInform;a>w?(o.lastInform=o.lastActive,t.update(o.lastInform)):N>a&&(o.lastInform=o.lastActive)},o.shipLogs=function(e){if(!e)throw new Error("Received empty stats");var t=new b["default"].UserActivity({userActivitySessionId:e.userActivitySessionId,userActivityStartTime:e.userActivityStartTime,userActivityBitmapLen:e.userActivityBitmapLen,userActivityBitmapLow:e.userActivityBitmap[0],userActivitySessionSeq:e.userActivitySessionSeq,userActivitySessionCum:e.userActivitySessionCum});e.userActivityBitmapLen>32&&(t.userActivityBitmapHigh=e.userActivityBitmap[1]),t.commit()},n=a,(0,d["default"])(o,n)}return(0,p["default"])(t,e),(0,u["default"])(t,[{key:"componentWillMount",value:function(){var e=this.props.listeners;this.bitArray=new k["default"](this.shipLogs,Date.now());var t=C["default"]?{passive:!0,capture:!0}:!0;e.add(window,"onbeforeunload",this.stop);for(var a=0;a<T.length;++a){var o=T[a],n=o.source,r=o.name;e.add(n,r,this.handleEvent,t)}}},{key:"componentWillUnmount",value:function(){this.stop()}},{key:"render",value:function(){return null}}]),t}(E["default"].Component))},7513:function(e,t,a){e.exports=a.p+"assets/20e48b2ec8c64b2a1ceb5b28d9bcc9d0.ttf"},7514:function(e,t,a){e.exports=a.p+"img/11db6f2b8049628f3a75acc641b2ac19.jpg"},7515:function(e,t,a){e.exports=a.p+"img/5638efdf1f64aa5327d85b2f02cab9db.jpg"},7516:function(e,t,a){e.exports=a.p+"img/91feba6481906fc3f2266d77c3892e7a.jpg"},7517:function(e,t,a){e.exports=a.p+"img/600127bdb5f7627ede5cd4ef320f55b0.png"},7518:function(e,t,a){e.exports=a.p+"img/9ffd93df96e5ea172c74144dd96c7a9b.jpg"},7519:function(e,t,a){e.exports=a.p+"img/22aeecf90e5bca0b23af99873928d693.jpg"},7520:function(e,t,a){e.exports=a.p+"img/e62687e643b9777ffb4aa04323241b12.jpg"},7521:function(e,t){t=e.exports={muted:"fJqTG","color-1":"_3xV4G","color-2":"gSS7Y","color-3":"_2riBy","color-4":"Dyfdq","color-5":"_2ANJt","color-6":"zygwI","color-7":"_3CWR4","color-8":"dlOFt","color-9":"_2puJz","color-10":"_2tJxU","color-11":"_1Aj7f","color-12":"rIH25","color-13":"wGlFd","color-14":"RCo7b","color-15":"_1Ksj-","color-16":"_3diI0","color-17":"_3NsDb","color-18":"_1Ngoc","color-19":"_1qfsQ","color-20":"_2lkP2","bg-color-1":"_3QElm","bg-color-2":"_1gIwr","bg-color-3":"ovvf_","bg-color-4":"FhlbZ","bg-color-5":"L87RL","bg-color-6":"oxWSQ","bg-color-7":"GZKap","bg-color-8":"_3MJBP","bg-color-9":"TV8PE","bg-color-10":"_3T89k","bg-color-11":"_3Ebk5","bg-color-12":"_3vEHP","bg-color-13":"_1Resy","bg-color-14":"_3B4i_","bg-color-15":"_35kSk","bg-color-16":"ULlCL","bg-color-17":"_2zt41","bg-color-18":"_1gapd","bg-color-19":"Irchd","bg-color-20":"_2dzeR",container:"_2qtw6",media:"_1-okK"}},7522:function(e,t){t=e.exports={muted:"_3oOG8","color-1":"_1ui3f","color-2":"_3hcnW","color-3":"_2wdLH","color-4":"_2cMYp","color-5":"SM7Ty","color-6":"_2pB3w","color-7":"_3Q8H2","color-8":"_1xxBK","color-9":"_1JWJy","color-10":"_2c3AG","color-11":"vKmuo","color-12":"oMi6Q","color-13":"tA1sm","color-14":"_3eTQd","color-15":"_2MViV","color-16":"_3SMqW","color-17":"_32Z1j","color-18":"_2qv_x","color-19":"_3dSIt","color-20":"_2CLlh","bg-color-1":"fpW_H","bg-color-2":"_2QhX2","bg-color-3":"_2PnUE","bg-color-4":"_1DyVg","bg-color-5":"_27FCA","bg-color-6":"_3kW5F","bg-color-7":"_2WIKM","bg-color-8":"_2PiHV","bg-color-9":"_3gt0E","bg-color-10":"_2bsjL","bg-color-11":"Kq3Ff","bg-color-12":"NUKz5","bg-color-13":"_1ts5-","bg-color-14":"eCWa9","bg-color-15":"_1D5QZ","bg-color-16":"_3XFe1","bg-color-17":"_2HPFX","bg-color-18":"_3asvL","bg-color-19":"_2_U3G","bg-color-20":"_3w-RL",container:"_3Qeli",preview:"_1RUry",img:"mBkWs"}},7523:function(e,t){t=e.exports={muted:"_1_E3y","color-1":"_3sCZ-","color-2":"_2iGtL","color-3":"_3bOo5","color-4":"_1oyNs","color-5":"_3Vae6","color-6":"K5hSg","color-7":"_3lIc8","color-8":"FynF1","color-9":"_1fYi7","color-10":"_1VOY6","color-11":"_1gGog","color-12":"_3eoqK","color-13":"_1c5m6","color-14":"BHm1E","color-15":"_3ZhwH","color-16":"_1SOIs","color-17":"YNnDz","color-18":"_3z3d3","color-19":"_1i0G7","color-20":"_2He9Y","bg-color-1":"dK7uy","bg-color-2":"_3Bmo_","bg-color-3":"_449hL","bg-color-4":"_39Ec7","bg-color-5":"_2CSm9","bg-color-6":"_1rBi4","bg-color-7":"_1FZ53","bg-color-8":"_39nTq","bg-color-9":"_3kM-A","bg-color-10":"_1tfDK","bg-color-11":"_2nGFo","bg-color-12":"_3l-P3","bg-color-13":"gv1wZ","bg-color-14":"RTxxX","bg-color-15":"_1NkE7","bg-color-16":"_2yUjs","bg-color-17":"_2EfJE","bg-color-18":"_2BNgH","bg-color-19":"_2pU0u","bg-color-20":"_3mSB7",container:"_3y0EN",media:"_3EjgV",document:"_6Pnex",text:"QA8Vz",icon:"jcxhw"}},7524:function(e,t){t=e.exports={muted:"t2olY","color-1":"_3a1jl","color-2":"_3PRMN","color-3":"_2A5wd","color-4":"_1ykfD","color-5":"_263dc","color-6":"_1wiGV","color-7":"_1oqxn","color-8":"_3MHlm","color-9":"_33b6k","color-10":"_3Yf4E","color-11":"_2ys8m","color-12":"_3RXfU","color-13":"n9L2V","color-14":"_31DPB","color-15":"_17vxu","color-16":"_3pmwu","color-17":"_2imQK","color-18":"fXTqA","color-19":"BTMEj","color-20":"_3wwMT","bg-color-1":"_2E9q1","bg-color-2":"_1ZWbX","bg-color-3":"bi2Oe","bg-color-4":"MLtrG","bg-color-5":"_3QTEa","bg-color-6":"_14K0a","bg-color-7":"_3xbB_","bg-color-8":"_2ZE3r","bg-color-9":"_1EuIr","bg-color-10":"vuSyU","bg-color-11":"_1156o","bg-color-12":"_3pJf-","bg-color-13":"_2tBX_","bg-color-14":"_3Ctsd","bg-color-15":"_2lQic","bg-color-16":"_1QtMC","bg-color-17":"_2rBCz","bg-color-18":"_1F_-d","bg-color-19":"SRfv6","bg-color-20":"_2e2UM",container:"_2k1om",media:"xVBLL",img:"_1a4Ru",audio:"_3MIB_",videoContainer:"_3S63o",spinner:"_3sxu7",video:"_3q7Vo",staticPreview:"_2XZGZ"}},7525:function(e,t){t=e.exports={muted:"_2rdjh","color-1":"_1FcJy","color-2":"_24rdu","color-3":"_2aMCx","color-4":"_3xZdf","color-5":"_2_Rqy","color-6":"_3l4Ai","color-7":"_2kc_2","color-8":"_3FhE0","color-9":"_3QwzC","color-10":"_3Apvi","color-11":"_2iVk6","color-12":"_31vgH","color-13":"_2RG-Z","color-14":"_1QOnm","color-15":"_1F_Aq","color-16":"_1Khpu","color-17":"_3kseh","color-18":"AakwR","color-19":"_1YGiI","color-20":"_1yk8P","bg-color-1":"_16akX","bg-color-2":"_1LmR-","bg-color-3":"_1l9bI","bg-color-4":"_2w79w","bg-color-5":"_5e6gk","bg-color-6":"_14zZA","bg-color-7":"_3sgz4","bg-color-8":"_1FP4o","bg-color-9":"_3DNvN","bg-color-10":"hf1Dw","bg-color-11":"_8Egu7","bg-color-12":"_1BM8m","bg-color-13":"Kfji2","bg-color-14":"H_t21","bg-color-15":"_1xaPw","bg-color-16":"_3mmNH","bg-color-17":"_1pGFG","bg-color-18":"_3tMmJ","bg-color-19":"_1j6Lb","bg-color-20":"_1YSsA",container:"r4crx",preview:"_2-_Pl",caption:"_2GgBs",img:"_3m_5X"}},7526:function(e,t){t=e.exports={muted:"_3fgSk","color-1":"QMk2a","color-2":"_3FfV1","color-3":"_2R_ul","color-4":"yjm23","color-5":"_2ELw1","color-6":"_2yg9X","color-7":"_3479i","color-8":"_-4YEZ","color-9":"_3bZFA","color-10":"_1IrIj","color-11":"-zRbo","color-12":"_39HjK","color-13":"_3tJB2","color-14":"_30seK","color-15":"_3ayJa","color-16":"_3nSPf","color-17":"_3ifxC","color-18":"_3m349","color-19":"_3gFNY","color-20":"_1BEVf","bg-color-1":"_133xI","bg-color-2":"_1cg_1","bg-color-3":"nDvHl","bg-color-4":"_1a2gL","bg-color-5":"SrlGP","bg-color-6":"_2MK-5","bg-color-7":"_1MIxa","bg-color-8":"_2dU8-","bg-color-9":"_1P2Yd","bg-color-10":"b72Ah","bg-color-11":"_16xx1","bg-color-12":"CoApY","bg-color-13":"_3SXEI","bg-color-14":"_3nbup","bg-color-15":"_37BlD","bg-color-16":"_1kkAM","bg-color-17":"_2rE7G","bg-color-18":"_10-R8","bg-color-19":"z8_As","bg-color-20":"cRhyH",actionLink:"_43SdW",action:"_31v_P",container:"m6ZEb",wrapper:"_1Wk6A",butterbar:"_3YewW",icon:"_2fJ2T",body:"l2BEH",controls:"ZZ7tn",title:"U0cj3",text:"_21zbN",update:"_2Ptrm",computer:"MwhOx",phone:"_1UvQg",battery:"_2BhJP"}},7527:function(e,t){t=e.exports={muted:"_3U5nl","color-1":"_3-t7C","color-2":"_3nySU","color-3":"_22v01","color-4":"_1EFi3","color-5":"_30tfZ","color-6":"_3QuEQ","color-7":"VAlb8","color-8":"yIgJy","color-9":"_DU7n","color-10":"k3FqC","color-11":"_2HXp5","color-12":"_3w4ME","color-13":"_2IkxS","color-14":"_23TFb","color-15":"KUF4n","color-16":"aoseE","color-17":"_11ghY","color-18":"_1NnPA","color-19":"_3agmG","color-20":"_2b4av","bg-color-1":"_7rM42","bg-color-2":"_2gS-G","bg-color-3":"_1Zk5h","bg-color-4":"_2086T","bg-color-5":"_21l9A","bg-color-6":"_2uLXG","bg-color-7":"_3Degk","bg-color-8":"_3cWvd","bg-color-9":"_2Ycl_","bg-color-10":"_1KhLv","bg-color-11":"_2eiID","bg-color-12":"_1gMgM","bg-color-13":"_2UM5a","bg-color-14":"_2mAs3","bg-color-15":"_3N6x_","bg-color-16":"_1BlxG","bg-color-17":"_2cBe8","bg-color-18":"_1voDi","bg-color-19":"KVvei","bg-color-20":"_2vzqH",chatstateTyping:"vdXUe"}},7528:function(e,t){t=e.exports={muted:"_2LUtF","color-1":"JCVbv","color-2":"_3_9k4","color-3":"_1dYZV","color-4":"Vaviu","color-5":"_1rS8i","color-6":"_2K-G0","color-7":"KXibo","color-8":"_3TAXS","color-9":"_3W7Cm","color-10":"_3aUMi","color-11":"_2l0HB","color-12":"_1H_EL","color-13":"Fnf92","color-14":"SPsmQ","color-15":"_12qXv","color-16":"_1oD2w","color-17":"_1gp-I","color-18":"_3rjeu","color-19":"_3Utxf","color-20":"_3EdNv","bg-color-1":"VDhrL","bg-color-2":"d3byS","bg-color-3":"_3KcrG","bg-color-4":"_7Mnkh","bg-color-5":"_1M1hJ","bg-color-6":"_1it81","bg-color-7":"_2LrzX","bg-color-8":"_1wV-e","bg-color-9":"_1M2Aa","bg-color-10":"_1cYje","bg-color-11":"_1zhaR","bg-color-12":"_37lDi","bg-color-13":"_3J938","bg-color-14":"_1TLcc","bg-color-15":"_2sYYh","bg-color-16":"_1zyWi","bg-color-17":"_1-kni","bg-color-18":"UMD_S","bg-color-19":"KuqC0","bg-color-20":"_1GlIA",checkboxChatWrapper:"JSbIY",checkboxChatControl:"_1Xt68",checkboxChatCell:"uC7o2"}},7529:function(e,t){t=e.exports={muted:"lP63K","color-1":"_1efB-","color-2":"_17sgL","color-3":"_1vh--","color-4":"_1cs8m","color-5":"_3xV8N","color-6":"kaBjT","color-7":"_8jjOF","color-8":"_3Cd3b","color-9":"_1XS49","color-10":"_28G7u","color-11":"_1kVqY","color-12":"_3sk4Z","color-13":"_1wKU_","color-14":"_37t8q","color-15":"pw58G","color-16":"_3kaoR","color-17":"_2cB6U","color-18":"_1xUTA","color-19":"_3E6e1","color-20":"ric5n","bg-color-1":"_2Yvqf","bg-color-2":"_3fAl3","bg-color-3":"_3zX95","bg-color-4":"_1wa6l","bg-color-5":"_2c3L0","bg-color-6":"_1cwOY","bg-color-7":"UK41p","bg-color-8":"_2Bq0E","bg-color-9":"_1Ed2P","bg-color-10":"_24wY7","bg-color-11":"_1ei6D","bg-color-12":"_2ZypN","bg-color-13":"_1ykkK","bg-color-14":"_9qB6N","bg-color-15":"jqqSw","bg-color-16":"_1rGke","bg-color-17":"_1BD9Q","bg-color-18":"_1TPyu","bg-color-19":"_3oQdN","bg-color-20":"_1Ta-o",secondaryDetailContainer:"_2q0z6"}},7530:function(e,t){t=e.exports={muted:"_6pRSD","color-1":"_1r9FA","color-2":"nrl36","color-3":"_1zTW8","color-4":"_3h_Ja","color-5":"_1VN-m","color-6":"_3Onld","color-7":"_167Re","color-8":"_1ri25","color-9":"_1Addp","color-10":"xHRYI","color-11":"_1I_uq","color-12":"_1C2HK","color-13":"_3KpcB","color-14":"_2kAyw","color-15":"_1KA2F","color-16":"_1x5Jj","color-17":"_2C35c","color-18":"_326pu","color-19":"_25F_b","color-20":"_3_QUc","bg-color-1":"_34F66","bg-color-2":"_10b2q","bg-color-3":"_1kXb_","bg-color-4":"_14tWU","bg-color-5":"rgAAz","bg-color-6":"fMhHW","bg-color-7":"_39y1N","bg-color-8":"_1DRVK","bg-color-9":"_2NI2V","bg-color-10":"_1zXm1","bg-color-11":"_3zBXn","bg-color-12":"_371c5","bg-color-13":"_1Brex","bg-color-14":"_3mUkv","bg-color-15":"baegE","bg-color-16":"Fkn5G","bg-color-17":"_2nIcN","bg-color-18":"_3W403","bg-color-19":"_3cJ7j","bg-color-20":"_2Ry6R",icon:"_15G96",archived:"_3JEcM"}},7531:function(e,t){t=e.exports={muted:"_2AF4z","color-1":"_1-yun","color-2":"_1Sm7k","color-3":"_18bgj","color-4":"_2Zpr_","color-5":"WP1ri","color-6":"_1x03z","color-7":"_3q78u","color-8":"kPe-0","color-9":"_2PE1K","color-10":"_1hlgF","color-11":"_1e2Q4","color-12":"Snap8","color-13":"_3Cm_3","color-14":"_2yhkg","color-15":"_1_WPx","color-16":"_1Kci3","color-17":"_1mfJA","color-18":"_2f2pb","color-19":"_2cEs3","color-20":"_30CNT","bg-color-1":"_2pvCp","bg-color-2":"_2WN3C","bg-color-3":"_37-Rx","bg-color-4":"_7pyxI","bg-color-5":"_3W6ON","bg-color-6":"_14iUU","bg-color-7":"_3EMMb","bg-color-8":"_39SfJ","bg-color-9":"_3Kr-q","bg-color-10":"GXNuJ","bg-color-11":"USJkW","bg-color-12":"EX82U","bg-color-13":"_377n9","bg-color-14":"ly64_","bg-color-15":"_3eVVB","bg-color-16":"_34r6Q","bg-color-17":"_2MAgT","bg-color-18":"_2Iphn","bg-color-19":"_3lqQp","bg-color-20":"_3laT4",revoked:"_2hMbR",last:"_2_LEW"}},7532:function(e,t){t=e.exports={muted:"_3-vgx","color-1":"_3bSAb","color-2":"flgn2","color-3":"mJEPH","color-4":"_1zhjb","color-5":"_1Nl8k","color-6":"_1S0mw","color-7":"_3b2tI","color-8":"_3nS_S","color-9":"_1CgSb","color-10":"_3DMvj","color-11":"_11qG7","color-12":"_3dBbW","color-13":"_14Bf2","color-14":"_3Mgez","color-15":"_3yXCL","color-16":"_3glUW","color-17":"_1dGeD","color-18":"kR7ph","color-19":"_1eoxx","color-20":"LAuL7","bg-color-1":"_2WHQ4","bg-color-2":"ZDupM","bg-color-3":"_28m9p","bg-color-4":"wSIFe","bg-color-5":"_1dlhw","bg-color-6":"_183y2","bg-color-7":"wtYRe","bg-color-8":"LCaCn","bg-color-9":"_1GZ2w","bg-color-10":"_3CbPP","bg-color-11":"_2H6jd","bg-color-12":"_1ju2K","bg-color-13":"Og2Mu","bg-color-14":"nOeSp","bg-color-15":"QZowL","bg-color-16":"_2plyV","bg-color-17":"_2fKAn","bg-color-18":"_1KZpC","bg-color-19":"_2EAo0","bg-color-20":"_1A3Eg",ack:"_1VfKB"}},7533:function(e,t){t=e.exports={muted:"_2f-VI","color-1":"_10pcs","color-2":"_1aEWm","color-3":"s1dwA","color-4":"_2v6vP","color-5":"_3qiuH","color-6":"_3Y82a","color-7":"_34jlP","color-8":"_7FnhN","color-9":"_3bGpK","color-10":"_2qoDO","color-11":"_32L9l","color-12":"_2H9kw","color-13":"_3oUAO","color-14":"_3xMPy","color-15":"_3AST_","color-16":"_21dZz","color-17":"i6Io-","color-18":"_2WjGP","color-19":"qzZ3V","color-20":"_3to2r","bg-color-1":"_3L6-P","bg-color-2":"_2TXn3","bg-color-3":"_2yg6l","bg-color-4":"_3H6Hv","bg-color-5":"_3_m4R","bg-color-6":"_33bH-","bg-color-7":"_1sSlN","bg-color-8":"_2aqq4","bg-color-9":"aDMVk","bg-color-10":"_24POu","bg-color-11":"_1US7F","bg-color-12":"_3x2L5","bg-color-13":"CG5AO","bg-color-14":"_1fFti","bg-color-15":"_2jiqd","bg-color-16":"_2mdyW","bg-color-17":"_3lgAV","bg-color-18":"_1TiGB","bg-color-19":"sk7ak","bg-color-20":"_156do",symbol:"_3FwEk",margin:"I9L8x"}},7534:function(e,t){t=e.exports={muted:"_2RCKf","color-1":"_3fg-t","color-2":"_27rpT","color-3":"TXTxn","color-4":"_2IRJx","color-5":"_6tK5p","color-6":"_1wwIB","color-7":"_3ZePW","color-8":"_3bI6M","color-9":"auzbf","color-10":"_1XDYn","color-11":"_3Z2ZE","color-12":"D15me","color-13":"_3kfpf","color-14":"_2T-Sj","color-15":"WQlLx","color-16":"_1d12I","color-17":"_3yBCM","color-18":"_2keIf","color-19":"_1IJ8n","color-20":"_2DFdW","bg-color-1":"_2wN3B","bg-color-2":"_3ZSuw","bg-color-3":"_2TW0C","bg-color-4":"_3tOY8","bg-color-5":"_2jqeD","bg-color-6":"_3RciU","bg-color-7":"_3Lkts","bg-color-8":"_3QC8V","bg-color-9":"_1ag41","bg-color-10":"_1OknJ","bg-color-11":"_1aJ2D","bg-color-12":"_2F64o","bg-color-13":"_1a24O","bg-color-14":"_18fMM","bg-color-15":"_2YQmW","bg-color-16":"_2k881","bg-color-17":"_1O67d","bg-color-18":"_1Yloj","bg-color-19":"_662Dj","bg-color-20":"_20syc",sender:"_1bX-5"}},7535:function(e,t){t=e.exports={muted:"_3tXvW","color-1":"_2LOGF","color-2":"_3tU2F","color-3":"_2WUms","color-4":"_1ht00","color-5":"_2tvRs","color-6":"_2woqq","color-7":"_1RKQ3","color-8":"_23ZXM","color-9":"_1itMr","color-10":"_1mHG8","color-11":"_3YenU","color-12":"_3SPQR","color-13":"_2CCP5","color-14":"XiJhC","color-15":"XMe6u","color-16":"eMTah","color-17":"_3zgtm","color-18":"_3QQXb","color-19":"_36qdk","color-20":"_3lq6M","bg-color-1":"_3Tf2J","bg-color-2":"_1j8iL","bg-color-3":"_2iqM6","bg-color-4":"Uu0ap","bg-color-5":"_1dFv7","bg-color-6":"_2y4T_","bg-color-7":"_199LH","bg-color-8":"_157i7","bg-color-9":"_3J01F","bg-color-10":"_2pAq1","bg-color-11":"_1hOJv","bg-color-12":"_2fY8s","bg-color-13":"_2Ug6G","bg-color-14":"_2pODf","bg-color-15":"_27Qa-","bg-color-16":"_1bWse","bg-color-17":"mPnJ5","bg-color-18":"_2JgVZ","bg-color-19":"_3AEE7","bg-color-20":"_1O3lb",statusLoading:"_1mpL5"}},7536:function(e,t){t=e.exports={muted:"_10JZ8","color-1":"SMHXW","color-2":"_3sZ0I","color-3":"_37Nrp","color-4":"_2bJYX","color-5":"_3RZaq","color-6":"_-th-","color-7":"BySeb","color-8":"_2QOyK","color-9":"_3bJWT","color-10":"_2gjxH","color-11":"_1PMfq","color-12":"_1ggvT","color-13":"l_hwU","color-14":"_3YGKD","color-15":"_3gmxI","color-16":"RnUTs","color-17":"pfoit","color-18":"_3R9Kh","color-19":"_26dRE","color-20":"T_sMB","bg-color-1":"_1a_Bs","bg-color-2":"qixyA","bg-color-3":"X8mqk","bg-color-4":"_2y71D","bg-color-5":"_3l2jL","bg-color-6":"_340_A","bg-color-7":"_2ZL32","bg-color-8":"IiKEM","bg-color-9":"_18pWL","bg-color-10":"_2p_vf","bg-color-11":"_2c-Mc","bg-color-12":"_1TYjU","bg-color-13":"_1NRC1","bg-color-14":"Af9qY","bg-color-15":"_3-65N","bg-color-16":"_1tBds","bg-color-17":"_4rkq0","bg-color-18":"me8zM","bg-color-19":"_2797t","bg-color-20":"uKzof",timestamp:"_3T2VG"}},7537:function(e,t){t=e.exports={muted:"_2iSIf","color-1":"_3-zCZ","color-2":"_1lRKr","color-3":"JOwp9","color-4":"_2nMs0","color-5":"_2ONCJ","color-6":"_2Mmpn","color-7":"_3qHWI","color-8":"_1K4Xf","color-9":"MtUOE","color-10":"_3yiy9","color-11":"_3jM70","color-12":"_33_NK","color-13":"Ivmcb","color-14":"_3zp4t","color-15":"L2qiA","color-16":"_1fNl2","color-17":"_3Af3_","color-18":"_3gCDV","color-19":"jNIio","color-20":"_2dJWQ","bg-color-1":"_14hv-","bg-color-2":"_2XAIz","bg-color-3":"_1FWWr","bg-color-4":"_2MUyt","bg-color-5":"_1eMEX","bg-color-6":"DxDCp","bg-color-7":"_3_1Ge","bg-color-8":"Kyx51","bg-color-9":"_2JZ5V","bg-color-10":"_13Nqh","bg-color-11":"_1uZW7","bg-color-12":"_3xX66","bg-color-13":"_2_mKm","bg-color-14":"_34N2-","bg-color-15":"TfELF","bg-color-16":"_3y7CN","bg-color-17":"_1PmSd","bg-color-18":"_1zhKQ","bg-color-19":"QueS0","bg-color-20":"_1FHXV",count:"OUeyt",ffFix:"_3zmhL"}},7538:function(e,t){t=e.exports={muted:"KRCrf","color-1":"_2pfIX","color-2":"_1jVEa","color-3":"SXjGB","color-4":"_3G8nd","color-5":"_3df88","color-6":"_14dkp","color-7":"_3wFOB","color-8":"_1OS7L","color-9":"_3C34U","color-10":"aTQNs","color-11":"_1EWB0","color-12":"_1KV5N","color-13":"_1O99f","color-14":"_1LVp9","color-15":"_26SWt","color-16":"_33WhS","color-17":"_1PsoE","color-18":"wkpoW","color-19":"_1Sxde","color-20":"_3G5Lk","bg-color-1":"PoeS1","bg-color-2":"_34zTA","bg-color-3":"_3G6YK","bg-color-4":"_3dJvl","bg-color-5":"_1LskV","bg-color-6":"_3SZd8","bg-color-7":"_3bgqd","bg-color-8":"_3VeIA","bg-color-9":"dwizL","bg-color-10":"_2kIQH","bg-color-11":"BIDe3","bg-color-12":"_2k3An","bg-color-13":"_2iqg7","bg-color-14":"_3UF5O","bg-color-15":"_2aB1C","bg-color-16":"vf3tL","bg-color-17":"_3lyNf","bg-color-18":"CbOx5","bg-color-19":"_3b7-n","bg-color-20":"_579ui",container:"_1CzIm",btnActive:"_12sbx",btnAction:"eTCKi",controlsSummary:"iHLo1",summaryText:"_3-Xnb"}},7539:function(e,t){t=e.exports={muted:"_1igN6","color-1":"YwT4k","color-2":"_3sDVt","color-3":"_3vNeh","color-4":"_3-1-m","color-5":"_2DoSg","color-6":"CiRO0","color-7":"_22hUC","color-8":"_2XsbC","color-9":"_1s52c","color-10":"_338CZ","color-11":"_22rGe","color-12":"_289fo","color-13":"l3_DA","color-14":"_2pLe7","color-15":"_2oxZH","color-16":"_2JlEQ","color-17":"_1CIOo","color-18":"_1BhBr","color-19":"afbPk","color-20":"_2BDqM","bg-color-1":"_3JTRn","bg-color-2":"_2StEX","bg-color-3":"r_R4N","bg-color-4":"_25UDO","bg-color-5":"_1Gp-P","bg-color-6":"_1jkse","bg-color-7":"_1-qm_","bg-color-8":"_6iWY5","bg-color-9":"_3kFZ7","bg-color-10":"_3U3ID","bg-color-11":"_2F0Zd","bg-color-12":"_3Wz-l","bg-color-13":"_3xExy","bg-color-14":"fQn6Q","bg-color-15":"_3w0CT","bg-color-16":"_1YJ1l","bg-color-17":"_27f49","bg-color-18":"_2cM_O","bg-color-19":"aUm0r","bg-color-20":"GJ8L6",header:"_2zkF3"}},7540:function(e,t){t=e.exports={muted:"_3vstp","color-1":"WqOuY","color-2":"_3by_N","color-3":"_29sUv","color-4":"_2sw1Z","color-5":"_2dXcE","color-6":"_3xB07","color-7":"_1RwLx","color-8":"_2BrLL","color-9":"_3Zw8p","color-10":"_2McPN","color-11":"_1HMsF","color-12":"_1M1An","color-13":"QkYbP","color-14":"_2rSMj","color-15":"_3D9c8","color-16":"_1NKu5","color-17":"_2cShZ","color-18":"ctkam","color-19":"cpLT_","color-20":"_2QBUP","bg-color-1":"_8v2nZ","bg-color-2":"_24LC7","bg-color-3":"_1awSU","bg-color-4":"_37YcX","bg-color-5":"_1VROT","bg-color-6":"_22ZBU","bg-color-7":"IZouA","bg-color-8":"_1fRcD","bg-color-9":"_2Lb-Q","bg-color-10":"_1DFfc","bg-color-11":"_3YRs-","bg-color-12":"_1AcIu","bg-color-13":"_1NJk4","bg-color-14":"_3QL1l","bg-color-15":"yJn_H","bg-color-16":"_1WoaV","bg-color-17":"qRIs6","bg-color-18":"_2dEUe","bg-color-19":"wtWqT","bg-color-20":"_2ihtY",overlay:"WX_XW",text:"_22f7I"}},7541:function(e,t){t=e.exports={muted:"_18gR8","color-1":"kYfQw","color-2":"_1zSpT","color-3":"_3DDO-","color-4":"_2ypAK","color-5":"_369jb","color-6":"_3Q48V","color-7":"z0TSc","color-8":"_1Oe9e","color-9":"_1s9zJ","color-10":"_2BMLr","color-11":"_2R5QI","color-12":"n3K1B","color-13":"_2Kgu4","color-14":"_27UIu","color-15":"_1usmS","color-16":"STQvd","color-17":"wc4O8","color-18":"_1gK6a","color-19":"_3GL9F","color-20":"_3jzEA","bg-color-1":"_38Ygg","bg-color-2":"lKkdF","bg-color-3":"_1V7Xa","bg-color-4":"_1kiG8","bg-color-5":"_1X4er","bg-color-6":"_2ppiV","bg-color-7":"_1-byy",
"bg-color-8":"_1e6-g","bg-color-9":"_13XRp","bg-color-10":"_2AiIv","bg-color-11":"_3gUS0","bg-color-12":"_2NhzI","bg-color-13":"_21gEJ","bg-color-14":"_3tya5","bg-color-15":"qQg0U","bg-color-16":"_3_07x","bg-color-17":"_2-3af","bg-color-18":"_3h25u","bg-color-19":"_2BP6A","bg-color-20":"_1XStV",container:"_1TiMY"}},7542:function(e,t){t=e.exports={muted:"_6bb_d","color-1":"_1IPnG","color-2":"_31QpV","color-3":"_3WfuC","color-4":"_1Q_VL","color-5":"_2wFRV","color-6":"_2rH-2","color-7":"_3pxqC","color-8":"_2_dwU","color-9":"_34g-_","color-10":"_31k7p","color-11":"_211AP","color-12":"_3kUmM","color-13":"rSrIA","color-14":"qqgNV","color-15":"_2Udrz","color-16":"_47yPP","color-17":"bxyBh","color-18":"_36SSa","color-19":"_3M-aK","color-20":"_3zLZI","bg-color-1":"_3evq2","bg-color-2":"_1k6A7","bg-color-3":"_3L0D4","bg-color-4":"_3utRI","bg-color-5":"_3IJoJ","bg-color-6":"_2k0Ol","bg-color-7":"_2HKcS","bg-color-8":"hOYS6","bg-color-9":"_2z8Vv","bg-color-10":"BIO0L","bg-color-11":"_1VzJw","bg-color-12":"_3NJ5Q","bg-color-13":"_1v8WU","bg-color-14":"N48f_","bg-color-15":"_3FnIF","bg-color-16":"qU3A9","bg-color-17":"CtOjP","bg-color-18":"_1ov7j","bg-color-19":"_212Ug","bg-color-20":"_1l91J",border:"_3YwRO"}},7543:function(e,t){t=e.exports={muted:"_2aN6i","color-1":"_2-NKQ","color-2":"_2gePi","color-3":"vapuq","color-4":"_1EUAP","color-5":"_43psC","color-6":"_2Osi0","color-7":"_3HNtF","color-8":"_1mwJI","color-9":"_2IQ9D","color-10":"_3RvQs","color-11":"_240g1","color-12":"_2VNgJ","color-13":"_3bJzo","color-14":"BgOP2","color-15":"_3UMb9","color-16":"_2NCP2","color-17":"_2Tyb4","color-18":"_1D8J1","color-19":"_1SNfY","color-20":"_2Iz5q","bg-color-1":"oFSLj","bg-color-2":"_195vW","bg-color-3":"_2VZKT","bg-color-4":"_1qsoq","bg-color-5":"gTuyU","bg-color-6":"_36E6M","bg-color-7":"zzhyz","bg-color-8":"_3-PwT","bg-color-9":"_3mhgk","bg-color-10":"_3EcUK","bg-color-11":"_2SXlC","bg-color-12":"Jrkjo","bg-color-13":"_4YW4y","bg-color-14":"_9Cqat","bg-color-15":"_3MiVq","bg-color-16":"_1cXq4","bg-color-17":"_26j8c","bg-color-18":"_3Dzyj","bg-color-19":"_1B-ec","bg-color-20":"_1fILp",chatSubtitle:"_3sgkv",chatSubtitleHeader:"Gd51Q",chatSubtitleText:"O90ur"}},7544:function(e,t){t=e.exports={muted:"_3RTEI","color-1":"_2-Qsk","color-2":"_1ic7s","color-3":"HQbS7","color-4":"CikhT","color-5":"_2_Zy4","color-6":"_1Vuf5","color-7":"_3vMcT","color-8":"_3bIa-","color-9":"WcqUk","color-10":"_1XFoM","color-11":"_2DTCy","color-12":"B7d4R","color-13":"_14-27","color-14":"_21lRy","color-15":"XXsca","color-16":"_1sKQT","color-17":"_2kwwY","color-18":"_3HwsN","color-19":"_1OMkC","color-20":"liEwW","bg-color-1":"P1j6b","bg-color-2":"_2LSdS","bg-color-3":"_2WZ4n","bg-color-4":"Fq-Z_","bg-color-5":"_2yilS","bg-color-6":"_20E5v","bg-color-7":"_2THcT","bg-color-8":"_3dSOF","bg-color-9":"LGcV2","bg-color-10":"_3Bo1l","bg-color-11":"_2psJF","bg-color-12":"_3OK_a","bg-color-13":"_2zb1l","bg-color-14":"_1pV6g","bg-color-15":"_2BXf0","bg-color-16":"_3wojn","bg-color-17":"_2IF9h","bg-color-18":"_1ciQ4","bg-color-19":"_2nZv4","bg-color-20":"_1msVG",checkboxContainer:"_3I_df",checkbox:"me9CP",checkmark:"_1KfC8",checkedCheckbox:"_1VD7W",checkedCheckmark:"_1s8CA","checkmark-expand":"_28R-H",uncheckedCheckmark:"_2uQfJ",disabled:"_2yfCz","checkmark-expand-ltr":"b2PEZ","checkmark-expand-rtl":"_3RS1Z"}},7545:function(e,t){t=e.exports={muted:"_3XVuG","color-1":"XWRkS","color-2":"_3IyH_","color-3":"_1CtT1","color-4":"_1SkDp","color-5":"GCR06","color-6":"_9mvFm","color-7":"_3pn3O","color-8":"gPzGE","color-9":"_1HH0s","color-10":"_3ikGh","color-11":"_3s_K4","color-12":"_3DQpJ","color-13":"_1aI_6","color-14":"_2YyUr","color-15":"_3CQ4L","color-16":"ZYyOn","color-17":"tln5V","color-18":"Rpx0r","color-19":"_2rX8r","color-20":"aKh_T","bg-color-1":"_3HPWd","bg-color-2":"_2kSgg","bg-color-3":"UA5Nt","bg-color-4":"_1V-us","bg-color-5":"_1ecBn","bg-color-6":"_1LEAn","bg-color-7":"_2D87C","bg-color-8":"_100oN","bg-color-9":"_13_dQ","bg-color-10":"_3zZv0","bg-color-11":"_3fQLR","bg-color-12":"_3_xAs","bg-color-13":"_1VvxE","bg-color-14":"_2e6kB","bg-color-15":"_1qJGp","bg-color-16":"_10oHg","bg-color-17":"_24hEb","bg-color-18":"_2gplQ","bg-color-19":"_3Gk44","bg-color-20":"_3joRK",container:"_3tV8v",roundIcon:"_2nLPG",unchecked:"_3LY6P",passive:"Ljds8"}},7546:function(e,t){t=e.exports={muted:"_2-Zzx","color-1":"ZJziM","color-2":"_3RF20","color-3":"iOS1O","color-4":"_1d8XU","color-5":"_3ZY_j","color-6":"_2SUAo","color-7":"_6sIM","color-8":"_2n13y","color-9":"_1Ihc6","color-10":"_2o5AL","color-11":"_3fffj","color-12":"_24rxN","color-13":"_15D_F","color-14":"_1VWbz","color-15":"_2W-n2","color-16":"_1CKwu","color-17":"_3HTWm","color-18":"Paveg","color-19":"_2wdJG","color-20":"F-Alp","bg-color-1":"tvdyD","bg-color-2":"_1Jpu1","bg-color-3":"_2rJMv","bg-color-4":"wkZ6_","bg-color-5":"_2Woic","bg-color-6":"_2HAal","bg-color-7":"MAR6Q","bg-color-8":"idckv","bg-color-9":"_15SwF","bg-color-10":"_3_VBI","bg-color-11":"_3dGwR","bg-color-12":"_1cYNq","bg-color-13":"_2N8Nj","bg-color-14":"Z1bke","bg-color-15":"_2Og8P","bg-color-16":"_20hZz","bg-color-17":"_24Yxo","bg-color-18":"_1KSzd","bg-color-19":"_8NkXq","bg-color-20":"_1xOJx",docGallery:"CKZZo",spinner:"tral_"}},7547:function(e,t){t=e.exports={muted:"IlvCY","color-1":"_3cC8J","color-2":"FZ8Da","color-3":"_2YZoz","color-4":"_1Wh12","color-5":"_3aETY","color-6":"_11KT1","color-7":"_1956J","color-8":"_2saT4","color-9":"_2CizS","color-10":"vk0vz","color-11":"bHWCm","color-12":"_3CiU6","color-13":"tAcV6","color-14":"_2AWHA","color-15":"g-ACA","color-16":"_2TEqj","color-17":"_3wMjK","color-18":"_1gsa1","color-19":"_230jT","color-20":"PRkO9","bg-color-1":"_3NSp0","bg-color-2":"_182a-","bg-color-3":"mF2IU","bg-color-4":"_3EAGC","bg-color-5":"-TBHv","bg-color-6":"_2Nw9E","bg-color-7":"_3DsbN","bg-color-8":"_2s_w4","bg-color-9":"_3KKY_","bg-color-10":"_2uvJG","bg-color-11":"uA3E5","bg-color-12":"_3JPav","bg-color-13":"_1B6J2","bg-color-14":"_2JFEH","bg-color-15":"_11swX","bg-color-16":"_1iOXl","bg-color-17":"_2NcsP","bg-color-18":"_1f7nt","bg-color-19":"pKfMU","bg-color-20":"_2GuxS",docState:"_17viz",spinner:"_3SUnz"}},7548:function(e,t){t=e.exports={muted:"_1Hu89","color-1":"_2UBuP","color-2":"_1GinG","color-3":"_3bPF2","color-4":"yI37h","color-5":"_1KjIB","color-6":"_3ywd0","color-7":"_1uBfg","color-8":"_3ZAWK","color-9":"_2hgu3","color-10":"_3sXBm","color-11":"_3479U","color-12":"_22-51","color-13":"_3XYjV","color-14":"_3DK8R","color-15":"_2XI9g","color-16":"_2chtz","color-17":"_2upP3","color-18":"RU7cK","color-19":"_3KNpm","color-20":"_3cGkC","bg-color-1":"t5qEK","bg-color-2":"_3vIke","bg-color-3":"hyjxi","bg-color-4":"_1rINP","bg-color-5":"llC3e","bg-color-6":"_2Q1H4","bg-color-7":"_2lYnL","bg-color-8":"SLsU7","bg-color-9":"_3vfYw","bg-color-10":"_1jwbO","bg-color-11":"_3tAsS","bg-color-12":"_309rm","bg-color-13":"_p9dL","bg-color-14":"_1h4Z_","bg-color-15":"_2VpTD","bg-color-16":"iUmGz","bg-color-17":"wpdGH","bg-color-18":"_1xH7L","bg-color-19":"hW-CF","bg-color-20":"xlc4T",draggable:"_2wZI6",dragging:"_1mUIS"}},7549:function(e,t){t=e.exports={muted:"_3bgV4","color-1":"_1bLsA","color-2":"_1dwNt","color-3":"JmM_J","color-4":"yfddF","color-5":"PJp7V","color-6":"_2ID0O","color-7":"_3omDl","color-8":"_1hA1r","color-9":"reOHR","color-10":"TOW2g","color-11":"_14s3q","color-12":"_2oRKi","color-13":"_2AQ8U","color-14":"_27-Sk","color-15":"_1CPt8","color-16":"_33d3F","color-17":"_2jgI_","color-18":"_1qOwM","color-19":"_220wb","color-20":"_1LDne","bg-color-1":"_1pm8x","bg-color-2":"yRiSM","bg-color-3":"_2J0bX","bg-color-4":"_38kDB","bg-color-5":"_35QKb","bg-color-6":"_2ytHl","bg-color-7":"_3hGm7","bg-color-8":"_3_8Bp","bg-color-9":"_1bJmr","bg-color-10":"_1buAV","bg-color-11":"YOrqX","bg-color-12":"GdF7k","bg-color-13":"_3S6ai","bg-color-14":"_2fV-Q","bg-color-15":"_1Zcjx","bg-color-16":"_3zsxf","bg-color-17":"_26aWR","bg-color-18":"_1zA5J","bg-color-19":"_2vLZt","bg-color-20":"_2FpMu",container:"_14oqx",block:"DcItJ",main:"_3WCza",side:"_39lFW",multiline:"_1mf1Y"}},7550:function(e,t){t=e.exports={muted:"_1gbxz","color-1":"_3VPgy","color-2":"_3g6AY","color-3":"_3SWhb","color-4":"_28RTl","color-5":"_2FXQd","color-6":"_1Yxfa","color-7":"_14nFc","color-8":"Pijkj","color-9":"Cw3O8","color-10":"_1-o7O","color-11":"lo-Yi","color-12":"_1dvOJ","color-13":"_27bo5","color-14":"_1Y1Vf","color-15":"_2RELq","color-16":"_3ZMYI","color-17":"_3hAja","color-18":"_1Aom5","color-19":"_1JTie","color-20":"cQnna","bg-color-1":"_2pbcI","bg-color-2":"_227lZ","bg-color-3":"_2wFg-","bg-color-4":"_3dOlg","bg-color-5":"_13aqQ","bg-color-6":"_2GaZt","bg-color-7":"_14SGW","bg-color-8":"_3nzAN","bg-color-9":"_1WFnE","bg-color-10":"_2dt3k","bg-color-11":"_3bANr","bg-color-12":"_3tmDs","bg-color-13":"_1kcgk","bg-color-14":"juk0i","bg-color-15":"_1l7jm","bg-color-16":"_3hQN2","bg-color-17":"NuV1E","bg-color-18":"_2OEAF","bg-color-19":"_33rzC","bg-color-20":"_1CKmo",empty:"_1OnaQ",emptyTop:"_3xG0U",icon:"_2Lev2",title:"_27YTC",text:"_3WZoe",spinner:"ZCCWI",action:"gjAmq"}},7551:function(e,t){t=e.exports={muted:"_3UZQy","color-1":"_3HtjD","color-2":"_3xeip","color-3":"_1ox5n","color-4":"_1Lz9s","color-5":"_22W_t","color-6":"N7dAb","color-7":"Mzf9r","color-8":"fQsGa","color-9":"_2gP2H","color-10":"_1lPIA","color-11":"_3Ln-p","color-12":"_2saNF","color-13":"UX_u2","color-14":"_3uoHs","color-15":"_1TShe","color-16":"_2LLSy","color-17":"_3sUU2","color-18":"_3HVjk","color-19":"_1JPVV","color-20":"_2-05B","bg-color-1":"WVI1A","bg-color-2":"_1LGky","bg-color-3":"_1ur2b","bg-color-4":"_3WFyE","bg-color-5":"VqYcP","bg-color-6":"_1IT36","bg-color-7":"_3dQQ-","bg-color-8":"_3iEpW","bg-color-9":"_27dw5","bg-color-10":"VIsfe","bg-color-11":"_2wnoF","bg-color-12":"_3YXKc","bg-color-13":"_2Z0tr","bg-color-14":"_2lP9R","bg-color-15":"_2jtkW","bg-color-16":"_3ikBp","bg-color-17":"KRHIk","bg-color-18":"_3V33Q","bg-color-19":"_3oYZ1","bg-color-20":"_2sksv",tooltip:"_2ICcy","tooltip-left-ltr":"_1Tgzi","tooltip-left-rtl":"_jWIn"}},7552:function(e,t){t=e.exports={muted:"JvSGN","color-1":"_1ANOm","color-2":"_3tVoo","color-3":"_25KOW","color-4":"_1wTis","color-5":"_3h1uL","color-6":"_269qB","color-7":"_3Jn3R","color-8":"_1roF4","color-9":"_1tn3J","color-10":"B6_1t","color-11":"rvI-a","color-12":"_1NotG","color-13":"_1r8S5","color-14":"_3veHz","color-15":"_1QwiN","color-16":"uS2GN","color-17":"dc9D_","color-18":"_1XpX1","color-19":"_2dMDu","color-20":"_3Eubd","bg-color-1":"tbTmO","bg-color-2":"Q38hS","bg-color-3":"vMkHq","bg-color-4":"_34uz8","bg-color-5":"_1kzHz","bg-color-6":"_3C0iB","bg-color-7":"_33Isq","bg-color-8":"lzKmi","bg-color-9":"_3QzPk","bg-color-10":"_2gKj_","bg-color-11":"_3E9Ix","bg-color-12":"_1L4k-","bg-color-13":"_29b1R","bg-color-14":"_3eElc","bg-color-15":"setbl","bg-color-16":"r4VqZ","bg-color-17":"_1nONr","bg-color-18":"_1s2jN","bg-color-19":"_1ZVEZ","bg-color-20":"_1j7HK",imageGallery:"_3R6k5",imageGalleryList:"_1l0-4",imageGalleryItem:"_3bVfD",imageGalleryItemSpacer:"jpKy7",imageGalleryItemImage:"_1_A1K",imageGalleryItemOverlay:"_3Crwj",selected:"_1f8pw",imageGalleryFooter:"Fm-2u",imageGalleryFooterText:"_2IIkp"}},7553:function(e,t){t=e.exports={muted:"_2esi9","color-1":"_2cQtp","color-2":"_3nLas","color-3":"iD2xS","color-4":"HoUTQ","color-5":"_19fhF","color-6":"_3D49a","color-7":"ov_Ei","color-8":"_21fm1","color-9":"_3Z_Ar","color-10":"_3U6l1","color-11":"_2tjwc","color-12":"_2vTu1","color-13":"HLet_","color-14":"KCWb1","color-15":"_1opJk","color-16":"_1_Eg2","color-17":"CybWJ","color-18":"_3f4Hu","color-19":"_2aY9i","color-20":"_2mQJr","bg-color-1":"_1jO10","bg-color-2":"_2EVfv","bg-color-3":"_1M_Jl","bg-color-4":"_1D4rs","bg-color-5":"KSJOy","bg-color-6":"DubBp","bg-color-7":"w_IhO","bg-color-8":"_1aAm-","bg-color-9":"_3JAas","bg-color-10":"_16Q-C","bg-color-11":"QMqnn","bg-color-12":"_1YyYf","bg-color-13":"_3Fj72","bg-color-14":"_3QRTc","bg-color-15":"_2ESiP","bg-color-16":"_31Gki","bg-color-17":"_2vdar","bg-color-18":"_1AE1r","bg-color-19":"aHBlp","bg-color-20":"_2NRSd",spinner:"vn_d6",wrapper:"_15JI9"}},7554:function(e,t){t=e.exports={muted:"yv-dW","color-1":"GH3GM","color-2":"_38Von","color-3":"_1QHPc","color-4":"_3RrJY","color-5":"R-4D9","color-6":"WCXCY","color-7":"aO9ap","color-8":"_1uI0g","color-9":"_33QgM","color-10":"_2_q2D","color-11":"_2zaF5","color-12":"_3LiX3","color-13":"_3FeqT","color-14":"_1K878","color-15":"_2sVZM","color-16":"_10z5h","color-17":"TTtFp","color-18":"_1rDcK","color-19":"_1LKM5","color-20":"_2nre-","bg-color-1":"_1t-J8","bg-color-2":"ZmoUU","bg-color-3":"_1cg52","bg-color-4":"_2lE1Q","bg-color-5":"_2bGZU","bg-color-6":"_3Ac4V","bg-color-7":"_3bewc","bg-color-8":"_2PFqu","bg-color-9":"snSjR","bg-color-10":"_14nIV","bg-color-11":"_2d8Kx","bg-color-12":"_2xz6z","bg-color-13":"_1ruhq","bg-color-14":"_2rakj","bg-color-15":"SGTfw","bg-color-16":"_1OeXG","bg-color-17":"_3Pmar","bg-color-18":"_2peLb","bg-color-19":"atdsY","bg-color-20":"_28r24",viewport:"RLfQR"}},7555:function(e,t){t=e.exports={muted:"_2Y6xY","color-1":"_3prdI","color-2":"_2gvGb","color-3":"_3oI5P","color-4":"Rhidb","color-5":"_3SoAJ","color-6":"_1bRh8","color-7":"_3OQUx","color-8":"_2tOco","color-9":"bc1rB","color-10":"_1cgaZ","color-11":"_3svzi","color-12":"_2QtCn","color-13":"_vcXk","color-14":"_1wapf","color-15":"zBa00","color-16":"_1lv9D","color-17":"_22qc-","color-18":"_3EFUa","color-19":"_3x70f","color-20":"_2BLwv","bg-color-1":"_36TMX","bg-color-2":"_1dRKf","bg-color-3":"VRASD","bg-color-4":"_2Kzy9","bg-color-5":"_3pfzk","bg-color-6":"_1duTh","bg-color-7":"_3-4qO","bg-color-8":"_2sbjD","bg-color-9":"utuMt","bg-color-10":"_1ax7W","bg-color-11":"_3L-1G","bg-color-12":"LKyea","bg-color-13":"_3FRGc","bg-color-14":"X9-U7","bg-color-15":"_1yZH3","bg-color-16":"_2BuIQ","bg-color-17":"_3bpbV","bg-color-18":"GYtas","bg-color-19":"_1vxSk","bg-color-20":"_2Cw5h",item:"_2wP_Y"}},7556:function(e,t){t=e.exports={muted:"_34GA5","color-1":"_241l1","color-2":"_2I4Vv","color-3":"_1LY88","color-4":"_3qCTN","color-5":"_1QbWa","color-6":"hUOJa","color-7":"FpRhS","color-8":"_1cu4C","color-9":"_3xBjd","color-10":"_2f1FK","color-11":"_1crKe","color-12":"_3eY9m","color-13":"_3kNHy","color-14":"_356P8","color-15":"_1t4yi","color-16":"_12otn","color-17":"_1ppSN","color-18":"_1E05Q","color-19":"_1loY9","color-20":"_3bAj7","bg-color-1":"fezok","bg-color-2":"_2FvJU","bg-color-3":"-F5YG","bg-color-4":"_1Sg3S","bg-color-5":"_3igey","bg-color-6":"_24MOx","bg-color-7":"Ou0eK","bg-color-8":"_2JA6x","bg-color-9":"_2yF1u","bg-color-10":"_2rCL4","bg-color-11":"_1B4GH","bg-color-12":"_1YdUW","bg-color-13":"_21r0n","bg-color-14":"_2D1oo","bg-color-15":"IS-KY","bg-color-16":"J1abH","bg-color-17":"_3calc","bg-color-18":"dqZNO","bg-color-19":"_2VbtO","bg-color-20":"d-YO2",canvasComponent:"_2n3Kr",canvasEmpty:"_29HAH",canvasSecondRow:"_3E2vB",canvasFirst:"koHd4",more:"_8TeUt",container:"_2PoGX",galleryEmpty:"_2IkcY",drawer:"_3C_Jo",drawerBody:"WfLRE"}},7557:function(e,t){t=e.exports={muted:"_1fNm1","color-1":"_2Gz3T","color-2":"_16VHs","color-3":"_1irHY","color-4":"_18k5c","color-5":"_3HVtL","color-6":"_1fMPP","color-7":"_12FI7","color-8":"QgNx1","color-9":"gNkyn","color-10":"y1zZh","color-11":"_3_Wt6","color-12":"_1078p","color-13":"_1g1jU","color-14":"_1qMqj","color-15":"_1WW4a","color-16":"_2ZZkr","color-17":"_1HxfY","color-18":"_293Pj","color-19":"_3rt3I","color-20":"_1uIU6","bg-color-1":"pDiFj","bg-color-2":"vHRUO","bg-color-3":"Ubh_v","bg-color-4":"_11hyy","bg-color-5":"_2AirO","bg-color-6":"_2JC4c","bg-color-7":"_3jJ4X","bg-color-8":"xKD2m","bg-color-9":"mPKc4","bg-color-10":"_37DfI","bg-color-11":"_3AeD3","bg-color-12":"_38xqT","bg-color-13":"BY2eu","bg-color-14":"WOZn3","bg-color-15":"_26ZKT","bg-color-16":"_1yzWt","bg-color-17":"_3M3bK","bg-color-18":"RktTL","bg-color-19":"_3Olvn","bg-color-20":"_2QFcU",controls:"_34Olu",spinner:"_2X3l6","progress-container":"_2fGjn",btnMeta:"_19mFZ",button:"_10MiG",icon:"_2BzIU",cancel:"_1l3ap"}},7558:function(e,t){t=e.exports={muted:"q2kTz","color-1":"_1gOch","color-2":"SEt-x","color-3":"_1Zz6F","color-4":"p_qOl","color-5":"_32EVz","color-6":"_1l_qa","color-7":"_3SeCs","color-8":"_1hHF8","color-9":"_2SgDc","color-10":"_1oxm9","color-11":"_3Z9PG","color-12":"_2CSYw","color-13":"AY-8Q","color-14":"_2nrF1","color-15":"_25vZ4","color-16":"_3G4sH","color-17":"_1Ljpv","color-18":"M4Qu6","color-19":"_2iplh","color-20":"_1LnHW","bg-color-1":"_3ibQS","bg-color-2":"_2_sG1","bg-color-3":"_3BFv3","bg-color-4":"_1bRYD","bg-color-5":"_1tgdG","bg-color-6":"fTupY","bg-color-7":"_1PVMO","bg-color-8":"ESjv5","bg-color-9":"_2J073","bg-color-10":"gHQZj","bg-color-11":"_2ohCz","bg-color-12":"_3WqUi","bg-color-13":"_3styi","bg-color-14":"_-5Gkz","bg-color-15":"_3xyUJ","bg-color-16":"_3ALw2","bg-color-17":"AZ8py","bg-color-18":"_3FTKN","bg-color-19":"_2IW_v","bg-color-20":"GvcXQ",menu:"_3Kxus",item:"rAUz7",active:"_3TbsN",disabled:"_2-Mrp"}},7559:function(e,t){t=e.exports={muted:"kEqgF","color-1":"_3Oq89","color-2":"d7HF8","color-3":"k01z2","color-4":"_15paK","color-5":"V1vGP","color-6":"_1LDxV","color-7":"_1VKFM","color-8":"_3IIYp","color-9":"s4rGx","color-10":"_2s2fw","color-11":"_3ZSUE","color-12":"_2k-op","color-13":"_3RX9v","color-14":"_3VUtM","color-15":"_1gGuE","color-16":"_3Tm_e","color-17":"_3FJ6T","color-18":"_3Z5sC","color-19":"_2Zue0","color-20":"_16UrJ","bg-color-1":"VQoSb","bg-color-2":"_1xM3A","bg-color-3":"_206JW","bg-color-4":"_2hgvF","bg-color-5":"_10EF2","bg-color-6":"_1XIA4","bg-color-7":"_1nZt6","bg-color-8":"_1zQuP","bg-color-9":"nBAro","bg-color-10":"dDsIS","bg-color-11":"_12pZi","bg-color-12":"_4uAUy","bg-color-13":"NPfb2","bg-color-14":"I5sFP","bg-color-15":"_32oAq","bg-color-16":"_33hPd","bg-color-17":"_22Zq6","bg-color-18":"_1NHv7","bg-color-19":"_19ytB","bg-color-20":"_2D5S5",moveResizeComponentContainer:"KwYYU",resizer:"_1k5cI",topResizer:"_1PIHO",bottomResizer:"LPdtQ",leftResizer:"_1H2v_",rightResizer:"_1k6D5",topRightResizer:"_31SXJ",topLeftResizer:"ouJL5",bottomRightResizer:"_38GaD",bottomLeftResizer:"_3wFyY",moveable:"KyPvv"}},7560:function(e,t){t=e.exports={muted:"_80DlC","color-1":"_1mFBT","color-2":"_34iXz","color-3":"_3NOCR","color-4":"_2gdO1","color-5":"_3glgy","color-6":"_19535","color-7":"NfyzC","color-8":"_1f73x","color-9":"J6xRX","color-10":"_1HkP7","color-11":"_2fuGX","color-12":"_3PsXf","color-13":"_2WYwe","color-14":"_39ix-","color-15":"_3E0tX","color-16":"_3zO8o","color-17":"_1B1fx","color-18":"HyF5Q","color-19":"_1khtB","color-20":"kp-TR","bg-color-1":"_38jQH","bg-color-2":"_2YggL","bg-color-3":"_3SlAS","bg-color-4":"_1kO_t","bg-color-5":"_1PDMn","bg-color-6":"n8oiN","bg-color-7":"_33tog","bg-color-8":"_1O2ww","bg-color-9":"_36tk9","bg-color-10":"_21zI_","bg-color-11":"_3B28X","bg-color-12":"k_fin","bg-color-13":"_3StVd","bg-color-14":"_2mton","bg-color-15":"_3iTcy","bg-color-16":"_2v0Zn","bg-color-17":"CyrPp","bg-color-18":"_1as8P","bg-color-19":"QZP5D","bg-color-20":"DM3la",verified:"_2WT4G",psa:"_22ln5",icon:"_2GLbW"}},7561:function(e,t){t=e.exports={muted:"xPJoe","color-1":"_YOti","color-2":"_8xJuH","color-3":"qQAbI","color-4":"H_NvV","color-5":"k4Q9A","color-6":"_2f5Eb","color-7":"_1Apdy","color-8":"_2fNHc","color-9":"_2LJfN","color-10":"_21oAX","color-11":"TDQoJ","color-12":"_3hIuw","color-13":"_3lex_","color-14":"_33rGQ","color-15":"s3z8U","color-16":"_1YPxB","color-17":"kwt5P","color-18":"ENq6w","color-19":"wdANf","color-20":"_2Qdjr","bg-color-1":"t8M6b","bg-color-2":"_3QJdw","bg-color-3":"_1N7t1","bg-color-4":"_22zdb","bg-color-5":"_3Qr1b","bg-color-6":"Z9ihC","bg-color-7":"FswQi","bg-color-8":"_1VYE9","bg-color-9":"_2DH6F","bg-color-10":"_3sMUg","bg-color-11":"R29tl","bg-color-12":"_E1cc","bg-color-13":"_2WNde","bg-color-14":"_17ltR","bg-color-15":"_2OoZn","bg-color-16":"_3Zk9g","bg-color-17":"o4amT","bg-color-18":"ZmCIM","bg-color-19":"_32kQN","bg-color-20":"_1o3us",fit:"IuYNx",fitRelative:"_1V8K0",fitScaledown:"_3E6Ha",fitZoomin:"_2gmeM",nativeCover:"zrbdc",nativeScaleDown:"bUPnO"}},7562:function(e,t){t=e.exports={muted:"_1Wgr1","color-1":"_2l-Ca","color-2":"_1FmDa","color-3":"_1RSXc","color-4":"_2UQd4","color-5":"_22vDc","color-6":"LdQjy","color-7":"Sgw80","color-8":"_3-Zdd","color-9":"_2kFID","color-10":"_3G5yp","color-11":"_3JJIe","color-12":"v9M79","color-13":"_1yv_V","color-14":"_3bbdB","color-15":"_3fUV-","color-16":"_3uWLh","color-17":"lOqEp","color-18":"WL_SO","color-19":"wvemN","color-20":"_1yGCC","bg-color-1":"OQREP","bg-color-2":"_1ZKuu","bg-color-3":"_3ZreC","bg-color-4":"_2NdwZ","bg-color-5":"_31ha4","bg-color-6":"_1eJdi","bg-color-7":"dczRa","bg-color-8":"_6ItSP","bg-color-9":"_3NrJL","bg-color-10":"_1i_l1","bg-color-11":"_3z5uz","bg-color-12":"_3M_nx","bg-color-13":"_39NFI","bg-color-14":"_83H72","bg-color-15":"_17dXC","bg-color-16":"_3pwQN","bg-color-17":"Qhuc7","bg-color-18":"Spo90","bg-color-19":"_1i2rr","bg-color-20":"_35mKJ",editor:"dt2Rz",editorBody:"mzps-",original:"_3yh6f",controls:"_2Gki6",container:"_3Xkyd",svgOverlay:"_3GqD3"}},7563:function(e,t){t=e.exports={muted:"_1jKKj","color-1":"_1Immk","color-2":"_1BECf","color-3":"_3jkUD","color-4":"_37JcR","color-5":"_1lACg","color-6":"_2kosp","color-7":"_1A_gI","color-8":"_3j7OY","color-9":"H1p2X","color-10":"_3B60S","color-11":"_1YZzg","color-12":"_1Clrz","color-13":"_2dssS","color-14":"_2mlUY","color-15":"_1NpqA","color-16":"_1CK0J","color-17":"xgjUo","color-18":"_3bkfQ","color-19":"lajIT","color-20":"_25hh7","bg-color-1":"_1cQ_T","bg-color-2":"XKdLn","bg-color-3":"_1x5tr","bg-color-4":"_2hXJO","bg-color-5":"_185CD","bg-color-6":"_461tN","bg-color-7":"_2_GoH","bg-color-8":"_26PwA","bg-color-9":"_24497","bg-color-10":"_1h3Ng","bg-color-11":"_2n7i0","bg-color-12":"_1psNC","bg-color-13":"_2n2QT","bg-color-14":"Q7COL","bg-color-15":"_12V--","bg-color-16":"RIkGy","bg-color-17":"_1oMJR","bg-color-18":"_3hctv","bg-color-19":"_1pcXY","bg-color-20":"_16Q4V",container:"_1wCju",body:"_2UkYn",imageContainer:"_1WNtc",defaultIcon:"_3IT8Q"}},7564:function(e,t){t=e.exports={muted:"_19y2k","color-1":"_1Raw8","color-2":"_2Ozd9","color-3":"_3gbEg","color-4":"_1kEQP","color-5":"_2j7Wh","color-6":"_2_UmD","color-7":"_2iscS","color-8":"_1x1HJ","color-9":"_3qsJc","color-10":"_3q9ZE","color-11":"__104","color-12":"_3HUXi","color-13":"_1OYfD","color-14":"_2TD-r","color-15":"_3EMqN","color-16":"_3iZEj","color-17":"_1WVUI","color-18":"_1__u9","color-19":"_1k9s_","color-20":"_2pWJm","bg-color-1":"_11wzQ","bg-color-2":"_2zXXG","bg-color-3":"CmtrU","bg-color-4":"_2TXiP","bg-color-5":"igRd3","bg-color-6":"_2Y-KX","bg-color-7":"_1QnGb","bg-color-8":"_2e7Sj","bg-color-9":"_3Tkzm","bg-color-10":"_2h55j","bg-color-11":"_16roo","bg-color-12":"OZh5d","bg-color-13":"tGdWv","bg-color-14":"UN0A8","bg-color-15":"u0KH4","bg-color-16":"cTg8j","bg-color-17":"_32uq2","bg-color-18":"zAKm2","bg-color-19":"B7uJR","bg-color-20":"_3_mX7",mentionsResult:"_3v_lq",selected:"j5Hcb",resultImage:"_2Fr83",mediaCaption:"_212mA",textContact:"_1pX71",textPushname:"_1VZOV"}},7565:function(e,t){t=e.exports={muted:"_1GC7O","color-1":"_3khwe","color-2":"KP1CX","color-3":"KgH0U","color-4":"_1NtDO","color-5":"_3ZyWC","color-6":"ydBDe","color-7":"_2JKbw","color-8":"_1lWnz","color-9":"_2QnBa","color-10":"_1qvk7","color-11":"_2vlTM","color-12":"_2yWhg","color-13":"O3ALY","color-14":"zrL3-","color-15":"RpG-m","color-16":"_1kTvG","color-17":"Fmm0e","color-18":"_23bpb","color-19":"Ia-2R","color-20":"_2xv0q","bg-color-1":"_1ZmfI","bg-color-2":"YsB14","bg-color-3":"_2vV_s","bg-color-4":"_2f-8t","bg-color-5":"_1W66Q","bg-color-6":"_16noj","bg-color-7":"_3LFU_","bg-color-8":"_2nzSK","bg-color-9":"_32Bwe","bg-color-10":"_1Fe22","bg-color-11":"lsyEe","bg-color-12":"_1iJv8","bg-color-13":"_3mRXj","bg-color-14":"_10vJl","bg-color-15":"_2aCyj","bg-color-16":"_3AfIp","bg-color-17":"_18nz2","bg-color-18":"_2-xkz","bg-color-19":"yRoXB","bg-color-20":"fAwFZ",positioningContainer:"TSSFW",resultsContainer:"iR8Cb",overlayContainer:"Uukb4",mediaCaption:"BDk0G"}},7566:function(e,t){t=e.exports={muted:"_3KKlM","color-1":"_1BTDi","color-2":"_1gp2N","color-3":"_3zzlz","color-4":"_2fdDX","color-5":"XNEjQ","color-6":"_2Tk29","color-7":"_3C1MB","color-8":"RXmss","color-9":"_2BjS8","color-10":"_1iHV2","color-11":"_2paUk","color-12":"_3ZvjM","color-13":"_1aMLT","color-14":"Frh4-","color-15":"RS7kh","color-16":"_2un-A","color-17":"_3h1Ln","color-18":"_1z2QH","color-19":"_2pMqA","color-20":"_3IpOl","bg-color-1":"VU2QE","bg-color-2":"_10et8","bg-color-3":"GLLxH","bg-color-4":"_16Fi4","bg-color-5":"_1eUap","bg-color-6":"_2s4WJ","bg-color-7":"jHNhz","bg-color-8":"_3SHkl","bg-color-9":"_1iDHH","bg-color-10":"_3FzXe","bg-color-11":"_1L77C","bg-color-12":"_2XRYB","bg-color-13":"_27tnZ","bg-color-14":"_3T6C0","bg-color-15":"upUcZ","bg-color-16":"_1rwGP","bg-color-17":"_2GNsK","bg-color-18":"_1P0qL","bg-color-19":"_23X-6","bg-color-20":"_1zz1z",btn:"_3hV1n",large:"yavlE"}},7567:function(e,t){t=e.exports={muted:"_3a0cA","color-1":"_1lPJP","color-2":"_5JnM3","color-3":"_2Vk9l","color-4":"_1TvUw","color-5":"_2_Qrs","color-6":"_2CA8v","color-7":"_2oPfl","color-8":"NWJa6","color-9":"_1I6E_","color-10":"_3fFJW","color-11":"Yu0CV","color-12":"_2uBGz","color-13":"wM25W","color-14":"_39EcU","color-15":"OcF1j","color-16":"_3WGrZ","color-17":"_2jyDV","color-18":"Mx_d4","color-19":"_24eQ5","color-20":"YlIe8","bg-color-1":"_1TiJJ","bg-color-2":"_7OiDM","bg-color-3":"_3HvR7","bg-color-4":"_3jPPc","bg-color-5":"_21Tqx","bg-color-6":"_32uAF","bg-color-7":"_2MBNB","bg-color-8":"_1bJLx","bg-color-9":"_3rydj","bg-color-10":"_3vN7W","bg-color-11":"_2vB6Z","bg-color-12":"_38rBG","bg-color-13":"_2B-_o","bg-color-14":"_3sF2Z","bg-color-15":"_3yg53","bg-color-16":"_2zXil","bg-color-17":"_3UDpE","bg-color-18":"_3EZMg","bg-color-19":"_2zMpI","bg-color-20":"_1r9GX",icon:"_1jJLh"}},7568:function(e,t){t=e.exports={muted:"_2mxm_","color-1":"_2jW2J","color-2":"_31eJA","color-3":"_3FXJU","color-4":"rLMeE","color-5":"_2o2sd","color-6":"_179_3","color-7":"_1RBuk","color-8":"oCDY9","color-9":"_3adeH","color-10":"_3cYgM","color-11":"_2TRc2","color-12":"RyBsL","color-13":"_2I9G9","color-14":"_1Uvg1","color-15":"_1W_tM","color-16":"_1--Sb","color-17":"_1MBMe","color-18":"_2jlW2","color-19":"pPJoK","color-20":"_2Gkce","bg-color-1":"_3XAko","bg-color-2":"_2gUsY","bg-color-3":"_2896X","bg-color-4":"_2vIqZ","bg-color-5":"_3chOk","bg-color-6":"_2Fc25","bg-color-7":"_1REQT","bg-color-8":"_2Ihn5","bg-color-9":"_1ljxz","bg-color-10":"aOQFK","bg-color-11":"Bj4uN","bg-color-12":"IyKwC","bg-color-13":"_2ks6N","bg-color-14":"_1srjJ","bg-color-15":"_3hD6o","bg-color-16":"_2KQ9_","bg-color-17":"LqHDq","bg-color-18":"_20NsW","bg-color-19":"fE6Wg","bg-color-20":"_3pjQ9",clickable:"_2csub",body:"LlZXr",main:"_3e7ko",mainEllipsify:"_1AUd-",side:"_1ZiJ3"}},7569:function(e,t){t=e.exports={muted:"_3UYdR","color-1":"auSMJ","color-2":"_34BX0","color-3":"_3ytIT","color-4":"_1PEfS","color-5":"_2d1U_","color-6":"_7Z4ko","color-7":"_2SGsR","color-8":"_2DFYi","color-9":"_2o2Yg","color-10":"_1mXob","color-11":"_1YB8g","color-12":"lyVBj","color-13":"_3msL8","color-14":"zy8Q4","color-15":"_39mu4","color-16":"_2k90j","color-17":"_3Z8XJ","color-18":"_3q25L","color-19":"SvuJS","color-20":"_13-wG","bg-color-1":"_1knng","bg-color-2":"_3ZNiW","bg-color-3":"_1Gn6l","bg-color-4":"iC4Ut","bg-color-5":"GIx6o","bg-color-6":"_1zQ4K","bg-color-7":"rdKrS","bg-color-8":"_1gXGl","bg-color-9":"_3hRXZ","bg-color-10":"_3vSAi","bg-color-11":"_3blPY","bg-color-12":"MNHWj","bg-color-13":"_36kX2","bg-color-14":"_3wuhg","bg-color-15":"_3F7Ie","bg-color-16":"_3DPHU","bg-color-17":"_34l1k","bg-color-18":"_1yQss","bg-color-19":"_1eKKS","bg-color-20":"_1oEqO",container:"_1AKfk"}},7570:function(e,t){t=e.exports={muted:"Cpiae","color-1":"_2qQ_N","color-2":"_3vh4w","color-3":"_3XL6o","color-4":"_9xESi","color-5":"_2IyD9","color-6":"_1_2xV","color-7":"_1ZQpX","color-8":"_3xbMl","color-9":"_1Z2Ae","color-10":"_1cgTQ","color-11":"_31AtC","color-12":"_2dlSf","color-13":"_2fS0Z","color-14":"_33F0g","color-15":"_2HV84","color-16":"CR2A1","color-17":"_2FooE","color-18":"_3rhMz","color-19":"_3uFLq","color-20":"_2_fvd","bg-color-1":"aF9Wn","bg-color-2":"_5T8NK","bg-color-3":"iW5l5","bg-color-4":"_3P8lQ","bg-color-5":"eI7np","bg-color-6":"_1aCQd","bg-color-7":"_1bKMm","bg-color-8":"jH08R","bg-color-9":"JDNhJ","bg-color-10":"_3W7rg","bg-color-11":"_3h_Bw","bg-color-12":"_Q0Uh","bg-color-13":"_1Abxp","bg-color-14":"_2ZXSI","bg-color-15":"_3F8Rt","bg-color-16":"_39iMq","bg-color-17":"zQk6H","bg-color-18":"_1vTds","bg-color-19":"_1b3oq","bg-color-20":"_2z7mQ",title:"_3LL06",large:"iYPsH","section-title":"_1sYdX",small:"_3YPSj",plain:"EfdT5",danger:"_1Vw8y",success:"_3eR-G"}},7571:function(e,t){t=e.exports={muted:"_1uG3l","color-1":"_3a9jb","color-2":"_3QIc5","color-3":"_23ubH","color-4":"_2fCjB","color-5":"_2VAws","color-6":"_1SoJW","color-7":"_1JMmj","color-8":"_31ck4","color-9":"I89Br","color-10":"_2y0b0","color-11":"RK1jQ","color-12":"_3Vx4X","color-13":"UcwGz","color-14":"_2A-pD","color-15":"sdtp8","color-16":"_3ofUC","color-17":"_1FGvQ","color-18":"_282rZ","color-19":"_3fZeO","color-20":"_8iyEZ","bg-color-1":"_18lzV","bg-color-2":"rb7Yn","bg-color-3":"TZgYs","bg-color-4":"_3U_T3","bg-color-5":"_1h32W","bg-color-6":"_2M9UX","bg-color-7":"_3NxEw","bg-color-8":"_25V8Z","bg-color-9":"_2t7yu","bg-color-10":"_3iX_m","bg-color-11":"_1SIOh","bg-color-12":"Sjbpa","bg-color-13":"_2ayNb","bg-color-14":"_1qCo4","bg-color-15":"_3cFDK","bg-color-16":"_3UmXm","bg-color-17":"_3GAa8","bg-color-18":"i6YxB","bg-color-19":"_3hXN2","bg-color-20":"q995G",textInput:"ogWqZ",labelText:"_2rXhY","float":"CrwPM",spacer:"_2OIDe",noPlaceholder:"_2-h1L",wrapper:"_1DTd4",locked:"_1G2k-",textError:"_2Kmxa",errorText:"momMR",textActive:"_1MZ4o",inputControls:"_2YmC2",buttonContainer:"_3jFFV",charCounterContainer:"_3Rw6D",charCounter:"_2EuwQ",inputIcon:"_3cyFx",inputEmoji:"_31pOb",iconSpinner:"_2uETs",infoStrip:"_3ukHf",inputLarge:"PX7XY",active:"_31WRs",groupInfoName:"_1hSLr"}},7572:function(e,t){t=e.exports={muted:"_4eCMa","color-1":"_1lPGX","color-2":"_3JQZr","color-3":"_12XiK","color-4":"_14D5D","color-5":"_39cfh","color-6":"_3M9Ic","color-7":"gaxB6","color-8":"_302ML","color-9":"_2EDYC","color-10":"_2gQbw","color-11":"ahiW-","color-12":"tpuwP","color-13":"_23Nb9","color-14":"N4GBD","color-15":"_322s_","color-16":"_1fuM-","color-17":"_2a4cL","color-18":"_2vetf","color-19":"_2TmwW","color-20":"_2HvAU","bg-color-1":"_2a-YM","bg-color-2":"_3_mMi","bg-color-3":"_292Il","bg-color-4":"_21aZw","bg-color-5":"_2qs2-","bg-color-6":"_1IuSN","bg-color-7":"_1ZqWb","bg-color-8":"_23oGe","bg-color-9":"_3FVRI","bg-color-10":"_3RCNN","bg-color-11":"_14LRU","bg-color-12":"_2Kt-c","bg-color-13":"_2o36l","bg-color-14":"WJ3Sn","bg-color-15":"_3wRe3","bg-color-16":"_3U2h6","bg-color-17":"_1ydSi","bg-color-18":"_2OhuZ","bg-color-19":"_2Kdoe","bg-color-20":"_1EhYp",tooltip:"_2Par4","menu-tooltip":"_10x3U"}},7573:function(e,t){t=e.exports={muted:"_1X0vb","color-1":"_1v2_Z","color-2":"_3fEdW","color-3":"_2S_Vw","color-4":"_1bdjC","color-5":"_2ApLp","color-6":"Zybdl","color-7":"_25LA7","color-8":"_2VYQX","color-9":"_2zPij","color-10":"_6mner","color-11":"_1ZQUa","color-12":"_13QMv","color-13":"_2-xYY","color-14":"_3KU-n","color-15":"_1jH7Z","color-16":"_2_N28","color-17":"_28TSj","color-18":"AJCTB","color-19":"_1CbLV","color-20":"pihJm","bg-color-1":"_2bmDK","bg-color-2":"_2XU09","bg-color-3":"_7VLAi","bg-color-4":"_2U3kn","bg-color-5":"_2Febt","bg-color-6":"_16Kao","bg-color-7":"U7OOG","bg-color-8":"_1PTGM","bg-color-9":"_14i9p","bg-color-10":"_11cSi","bg-color-11":"_2Jfs_","bg-color-12":"_2HLfd","bg-color-13":"_pxww","bg-color-14":"-mZ_B","bg-color-15":"_3WXvG","bg-color-16":"_3xok_","bg-color-17":"_3LwSI","bg-color-18":"_1q678","bg-color-19":"PmaYW","bg-color-20":"_8DPpq",video:"_1Y0rl"}},7574:function(e,t){t=e.exports={muted:"MotI5","color-1":"MUwEx","color-2":"bGF7d","color-3":"_4dsCt","color-4":"_3NWCk","color-5":"_3FCdJ","color-6":"_1b91D","color-7":"_2FFQh","color-8":"_3GtwI","color-9":"_2-BSH","color-10":"_3uf2T","color-11":"_2ilfs","color-12":"_1aO_h","color-13":"_2pult","color-14":"_2e-IM","color-15":"_1KCxR","color-16":"_2qiEI","color-17":"_33aUd","color-18":"_2HrN1","color-19":"_2g3Mh","color-20":"CDT5A",
"bg-color-1":"_38b5L","bg-color-2":"_13Fyt","bg-color-3":"_16z_z","bg-color-4":"_2qHxP","bg-color-5":"_28d5o","bg-color-6":"_1q4MI","bg-color-7":"_2usPn","bg-color-8":"_3JKT7","bg-color-9":"rtRds","bg-color-10":"_15aV8","bg-color-11":"_1dUTw","bg-color-12":"_3tojG","bg-color-13":"_2J0Ez","bg-color-14":"_3WUW3","bg-color-15":"_378qG","bg-color-16":"_5Yw6C","bg-color-17":"f7VIx","bg-color-18":"_2s0PY","bg-color-19":"_12nuH","bg-color-20":"_2OM_d",wrapper:"_1MsrQ",button:"_3dGYA",icon:"LQEjW"}},7575:function(e,t){t=e.exports={muted:"_3E1Co","color-1":"_3UQBl","color-2":"_3_2qX","color-3":"_19-OA","color-4":"_17-Tn","color-5":"_20EPG","color-6":"Gx80M","color-7":"_3e8Zu","color-8":"_12AJH","color-9":"_1_bDQ","color-10":"uAs-D","color-11":"_3Y7iU","color-12":"_1CaWN","color-13":"_1ae4v","color-14":"J7bDb","color-15":"_2AtyZ","color-16":"PkTz0","color-17":"_1FsXa","color-18":"_2YpNE","color-19":"_33Mz3","color-20":"_3ujTL","bg-color-1":"jhpj2","bg-color-2":"LYchJ","bg-color-3":"_26fH4","bg-color-4":"_2U-c5","bg-color-5":"_3JSSR","bg-color-6":"_2WNF3","bg-color-7":"Ay9qW","bg-color-8":"_1kfhO","bg-color-9":"_33wU3","bg-color-10":"_3SXLL","bg-color-11":"MiXLk","bg-color-12":"QNNAF","bg-color-13":"_1WlIF","bg-color-14":"_2PJfK","bg-color-15":"_1WqIr","bg-color-16":"_2PgSd","bg-color-17":"_1w5Td","bg-color-18":"_3eJU6","bg-color-19":"_1kEj-","bg-color-20":"_27PDi",author:"_111ze",name:"_2a1Yw",number:"RZ7GO",screenName:"_3Ye_R",followedByQuote:"-ogGW",verifiedIcon:"_2Y-hG"}},7576:function(e,t){t=e.exports={muted:"_3kqwH","color-1":"qp0QA","color-2":"_1GVTb","color-3":"_2PZN6","color-4":"_2Lw4Y","color-5":"E0qHG","color-6":"_3_mAo","color-7":"_15PBW","color-8":"_3yAnM","color-9":"_2v6ij","color-10":"_3C7XF","color-11":"CulUA","color-12":"_3b222","color-13":"_3AYAh","color-14":"zRyr2","color-15":"_7UaWy","color-16":"_3ayET","color-17":"tXXmJ","color-18":"_2skFm","color-19":"BBBtv","color-20":"_8OLdF","bg-color-1":"_2cd05","bg-color-2":"_1fMgI","bg-color-3":"cfzXw","bg-color-4":"_3C3P5","bg-color-5":"suX3n","bg-color-6":"_1yXDv","bg-color-7":"eXqFX","bg-color-8":"_2DQR2","bg-color-9":"_3xIMq","bg-color-10":"_1oAVt","bg-color-11":"_2wGBi","bg-color-12":"_2Tgsd","bg-color-13":"_1nbvz","bg-color-14":"_1KC59","bg-color-15":"_1iDVa","bg-color-16":"GinHL","bg-color-17":"_302bW","bg-color-18":"_50KTU","bg-color-19":"_3EkJa","bg-color-20":"_3qjV8",context:"_1i1U7",contextSpecial:"_2Cju4",contextMedia:"_20EE3",contextIcon:"_3kN0h",contextIn:"jZ4tp",contextOut:"_2DNgV",contextInverse:"se9J6",contextMediaLtr:"LSBf-",contextMediaRtr:"_2v05X",contextMediaDocument:"_3QtfK",contextIconMedia:"_38oIx",contextDoc:"_2ePBs",contextPtt:"_15hve",contextPttAuthor:"_1iVuG",contextMultiVcard:"o4dWJ"}},7577:function(e,t){t=e.exports={muted:"LA3Y1","color-1":"_3fhBC","color-2":"_3ppq7","color-3":"Gaslt","color-4":"LC6mI","color-5":"_3BmzH","color-6":"Q4N0u","color-7":"_1AyXc","color-8":"_3czav","color-9":"_3-vvz","color-10":"_1VZz0","color-11":"_2E6Cs","color-12":"_25GH7","color-13":"_3Afcm","color-14":"_1XMIl","color-15":"_1LisH","color-16":"mwrUU","color-17":"_36BHE","color-18":"_2DdBF","color-19":"_2autF","color-20":"_3whZC","bg-color-1":"_3c8m2","bg-color-2":"_2HPG8","bg-color-3":"_3Oawu","bg-color-4":"_3cglr","bg-color-5":"_2j6do","bg-color-6":"mpB9j","bg-color-7":"_3b9Ov","bg-color-8":"_2VsJR","bg-color-9":"_2yRb7","bg-color-10":"_1iLV7","bg-color-11":"UBL4s","bg-color-12":"_2NHD0","bg-color-13":"_1ZYWg","bg-color-14":"_1F_tv","bg-color-15":"_3oICp","bg-color-16":"_2SmZR","bg-color-17":"tkg67","bg-color-18":"_1oIS9","bg-color-19":"_2QxPl","bg-color-20":"_1jHhK",meta:"_1DZAH",metaLight:"_2Pjvv",timestamp:"_3EFt_",icon:"_2iy86"}},7578:function(e,t){t=e.exports={muted:"lAcaX","color-1":"_2N9mp","color-2":"_28YbD","color-3":"_3Tgln","color-4":"_2rf3j","color-5":"_1PM2e","color-6":"jInzw","color-7":"_3hH6w","color-8":"MBI70","color-9":"U1PAG","color-10":"_1T-fK","color-11":"_1he_h","color-12":"_2G6dc","color-13":"_2csBa","color-14":"_2gbVr","color-15":"_2ozKx","color-16":"_24tjv","color-17":"_3nvq5","color-18":"_1pQLd","color-19":"_2XFy-","color-20":"rhAhK","bg-color-1":"_2jUCE","bg-color-2":"_3cWRO","bg-color-3":"_1SAv0","bg-color-4":"_2xcOw","bg-color-5":"_3Yujn","bg-color-6":"_2S__m","bg-color-7":"_2y8tG","bg-color-8":"_2ZVLk","bg-color-9":"_1BwPr","bg-color-10":"alvOs","bg-color-11":"_3G0bn","bg-color-12":"MXakA","bg-color-13":"iShR2","bg-color-14":"_1MpGl","bg-color-15":"_4jAw7","bg-color-16":"_3lHK0","bg-color-17":"_3OYEv","bg-color-18":"_13kl9","bg-color-19":"Iwpz3","bg-color-20":"_1kuek",desc:"_1e4iV",descIcon:"AmZ9A",message:"_10EqG"}},7579:function(e,t){t=e.exports={muted:"_24s2n","color-1":"_t997","color-2":"WOuDc","color-3":"_26oHA","color-4":"_1O2tS","color-5":"_37Pje","color-6":"_3MrRU","color-7":"_1i6QK","color-8":"cNTqT","color-9":"_3MGpD","color-10":"GpSn9","color-11":"_1D8wN","color-12":"_2JPB4","color-13":"_3UuHf","color-14":"_265W2","color-15":"_1UevH","color-16":"_19JNJ","color-17":"_1vvI1","color-18":"_2HQAV","color-19":"_-8ohQ","color-20":"_1KBkj","bg-color-1":"_2UhAJ","bg-color-2":"_1AamT","bg-color-3":"_7f-O-","bg-color-4":"_1OOPC","bg-color-5":"_3k1-4","bg-color-6":"_4f3sA","bg-color-7":"hDypO","bg-color-8":"_1AsKO","bg-color-9":"Tm0x2","bg-color-10":"_3bM6W","bg-color-11":"_2QCyp","bg-color-12":"_1WV89","bg-color-13":"_1fhNm","bg-color-14":"_3bvge","bg-color-15":"W2fu0","bg-color-16":"_2pfRJ","bg-color-17":"LuDuU","bg-color-18":"itE--","bg-color-19":"_1Z0m0","bg-color-20":"_3VrNU",wrapper:"_2x9bY"}},7580:function(e,t){t=e.exports={muted:"_1kwlK","color-1":"cFPu4","color-2":"_3jfmL","color-3":"_2HinA","color-4":"_1ry2P","color-5":"YVjye","color-6":"_2Gj9m","color-7":"_1Bs_S","color-8":"_1HyM_","color-9":"_1NdbW","color-10":"_26uRR","color-11":"_3khW4","color-12":"RrR9Q","color-13":"JxOZ0","color-14":"_3FnNX","color-15":"_2LTgD","color-16":"_1bN3F","color-17":"YIb0H","color-18":"_2oAsn","color-19":"boy_0","color-20":"_3T7Gt","bg-color-1":"_3pK5O","bg-color-2":"_3U0rn","bg-color-3":"_2WBPz","bg-color-4":"_19eD2","bg-color-5":"_3JoDG","bg-color-6":"-MBxd","bg-color-7":"_3TOJV","bg-color-8":"_2fkM4","bg-color-9":"_3YI0y","bg-color-10":"_3wiUd","bg-color-11":"_3psXb","bg-color-12":"QQlU1","bg-color-13":"_3zPj-","bg-color-14":"BCWWN","bg-color-15":"rwZof","bg-color-16":"_36wBN","bg-color-17":"jR5tP","bg-color-18":"_3jfPl","bg-color-19":"_3_oyC","bg-color-20":"_2QJS6",icon:"_1vnOZ"}},7581:function(e,t){t=e.exports={muted:"_2l5GQ","color-1":"_2z2V2","color-2":"_3oUEr","color-3":"_17ATc","color-4":"_1aceC","color-5":"_3vkQG","color-6":"_3sOqO","color-7":"_28qnM","color-8":"_3RWdL","color-9":"_3myW9","color-10":"_2J6YI","color-11":"_2xnnL","color-12":"CX5On","color-13":"_1oIyN","color-14":"_14fjS","color-15":"gxpCo","color-16":"_3eS8v","color-17":"_27dOC","color-18":"_3qoem","color-19":"ER_Or","color-20":"_2TRZc","bg-color-1":"_3wuEl","bg-color-2":"_3Pw2D","bg-color-3":"_5oaU1","bg-color-4":"_2WEIU","bg-color-5":"_2g3r4","bg-color-6":"_1zJ3L","bg-color-7":"qtFuR","bg-color-8":"_2m9FL","bg-color-9":"_3dUFn","bg-color-10":"_3FgWX","bg-color-11":"_3X6QF","bg-color-12":"_3gKXm","bg-color-13":"A_-cI","bg-color-14":"_2-0r2","bg-color-15":"_11Ikg","bg-color-16":"r7z-6","bg-color-17":"i3Lyu","bg-color-18":"_2zNgA","bg-color-19":"_1qw6g","bg-color-20":"_1-run",icon:"QnDup",author:"_2EE3j"}},7582:function(e,t){t=e.exports={muted:"_3dJ-y","color-1":"_6SoaO","color-2":"_1Ihtk","color-3":"_KBJZ","color-4":"_1rVz6","color-5":"_2gqqU","color-6":"_3cBAs","color-7":"_3pYfk","color-8":"_3E1MS","color-9":"_2pU9s","color-10":"_3bVwv","color-11":"_10oK9","color-12":"_10KHb","color-13":"XGQtL","color-14":"_1tD0l","color-15":"_1gMmf","color-16":"_1xxGV","color-17":"kGnve","color-18":"_2Fg83","color-19":"_1i6sb","color-20":"_3WG0R","bg-color-1":"_3U7C7","bg-color-2":"b8US4","bg-color-3":"-c6mP","bg-color-4":"_2CWSu","bg-color-5":"_1OznE","bg-color-6":"_3sD1i","bg-color-7":"_1FHRO","bg-color-8":"_2WLs2","bg-color-9":"_3k7Xp","bg-color-10":"_3Mk56","bg-color-11":"_3GzAg","bg-color-12":"gipQM","bg-color-13":"_1Ciq8","bg-color-14":"_1PCqS","bg-color-15":"_1l90N","bg-color-16":"_3o9uf","bg-color-17":"_2RCgX","bg-color-18":"_26tKX","bg-color-19":"_31Nyq","bg-color-20":"_2F0AL",msgUnread:"_1mq8g",msgUnreadBody:"L89LI"}},7583:function(e,t){t=e.exports={muted:"_1yATu","color-1":"_3Xi_F","color-2":"_1dtLp","color-3":"SR4FR","color-4":"_2n0ru","color-5":"_1LxUY","color-6":"VyNqi","color-7":"_3JNPT","color-8":"VRj1X","color-9":"_1grqq","color-10":"_2hWau","color-11":"_2dvbv","color-12":"_2lO2b","color-13":"_26eK-","color-14":"_3U2jq","color-15":"_1D9dJ","color-16":"_1Nu3T","color-17":"_2ajlE","color-18":"_36kBS","color-19":"_3QQK8","color-20":"LFNcr","bg-color-1":"aPIaW","bg-color-2":"gi3Rs","bg-color-3":"_1Jkkd","bg-color-4":"_11MSe","bg-color-5":"_1Bnx3","bg-color-6":"_2o4Km","bg-color-7":"_12RJ8","bg-color-8":"_1on0g","bg-color-9":"l3tMC","bg-color-10":"_3WY7m","bg-color-11":"_1BGMP","bg-color-12":"_1Cpmk","bg-color-13":"DJzte","bg-color-14":"_1xSrR","bg-color-15":"_2I-c9","bg-color-16":"_2zqZC","bg-color-17":"_23daV","bg-color-18":"pYXkv","bg-color-19":"gSMms","bg-color-20":"_28d5X",messageList:"_9tCEa",messageListSelectable:"_1P2Tp"}},7584:function(e,t){t=e.exports={muted:"_3ObEr","color-1":"_1gr8H","color-2":"_1TRm0","color-3":"nX2ot","color-4":"_25B1O","color-5":"_1IsvI","color-6":"_1vu5q","color-7":"_1xA99","color-8":"_3BAXc","color-9":"_19p7l","color-10":"_34gN9","color-11":"_234oX","color-12":"_1GnYc","color-13":"UxFDN","color-14":"UfBRs","color-15":"_2zmVx","color-16":"ThrWF","color-17":"_1jpn4","color-18":"Oj6_4","color-19":"pCHgm","color-20":"_3Lbox","bg-color-1":"_1IMNN","bg-color-2":"_3rh4P","bg-color-3":"_2kdLx","bg-color-4":"_3SoNx","bg-color-5":"_16Eug","bg-color-6":"_1yEAo","bg-color-7":"_1WYSl","bg-color-8":"eT36V","bg-color-9":"lGJq2","bg-color-10":"_2We0k","bg-color-11":"_16VdL","bg-color-12":"_1onDL","bg-color-13":"_21clW","bg-color-14":"dUc8i","bg-color-15":"_1mbVX","bg-color-16":"_1xmCw","bg-color-17":"_1moOY","bg-color-18":"_7ax0Q","bg-color-19":"_2O7oK","bg-color-20":"_1c15x",recording:"_1-hDo",btnBorder:"cOcmP",isHover:"_1K6WL",btnStateDefault:"_1aVJp",btnStateHover:"ZxQVp",pttCounter:"_30ie-","ptt-indicator":"_1fqU3",btnBorderIcon:"ZBZ4i",btnPtt:"_2SbJ1",container:"_1UWg0",active:"_1wU75"}},7585:function(e,t){t=e.exports={muted:"_3ajGc","color-1":"wKxf1","color-2":"_32zy8","color-3":"_3SoAo","color-4":"_1yONG","color-5":"_28bMf","color-6":"_3l8I1","color-7":"rzGff","color-8":"_1-_oF","color-9":"pgxSZ","color-10":"_8zV0w","color-11":"_19744","color-12":"_1rWOV","color-13":"F-jva","color-14":"_1EhuT","color-15":"_3xr6Z","color-16":"_35aBB","color-17":"_3TVAG","color-18":"_1oTI3","color-19":"_9niTq","color-20":"iN9FZ","bg-color-1":"_1r05C","bg-color-2":"_3uABj","bg-color-3":"E1GH5","bg-color-4":"w5QSR","bg-color-5":"_32Ykn","bg-color-6":"_32pQJ","bg-color-7":"_3r-HJ","bg-color-8":"_1TA09","bg-color-9":"_tyHS","bg-color-10":"OHe2B","bg-color-11":"_14Q-y","bg-color-12":"_3cbDg","bg-color-13":"I6kt5","bg-color-14":"_11Vsx","bg-color-15":"JGpg7","bg-color-16":"_3bv56","bg-color-17":"_2dXVo","bg-color-18":"_3Lp26","bg-color-19":"_3o3Tj","bg-color-20":"_3SfJ2",spam:"TYhk9",text:"Bixbo",controls:"_2JCaJ",button:"rvQu_"}},7586:function(e,t){t=e.exports={muted:"_1RtSS","color-1":"_2bZsC","color-2":"RclHd","color-3":"Lhg4j","color-4":"_3TrUD","color-5":"_2W5RS","color-6":"_3SMsI","color-7":"_121IS","color-8":"-KA5n","color-9":"xXcM7","color-10":"_1ZolY","color-11":"_1ajZW","color-12":"_3PQQ_","color-13":"_2ZAYL","color-14":"_3jDfj","color-15":"_236Ai","color-16":"_27aEs","color-17":"_3UstD","color-18":"_1Thl5","color-19":"_3l8nM","color-20":"APl1Q","bg-color-1":"nJI_W","bg-color-2":"_2kat3","bg-color-3":"_4y8T","bg-color-4":"_2QOsv","bg-color-5":"_1Duk7","bg-color-6":"Afya4","bg-color-7":"_1BrDd","bg-color-8":"_2lcdl","bg-color-9":"vgrbh","bg-color-10":"_39x1e","bg-color-11":"_2mcyq","bg-color-12":"_2d2My","bg-color-13":"qJaxg","bg-color-14":"_3qkPo","bg-color-15":"_1WXAX","bg-color-16":"_1Qzv0","bg-color-17":"_2Xx5J","bg-color-18":"_2Ka_K","bg-color-19":"_2d5Gd","bg-color-20":"_1Y5T4",item:"_10anr",text:"_28zBA",hover:"_14ou2",action:"_2dGjP",compact:"_1vu-E",icon:"_3asN5",emoji:"_2WvMb",ellipsify:"_3lSL5",disabled:"_1IFvC",shortcut:"vidHz"}},7587:function(e,t){t=e.exports={muted:"_3pduH","color-1":"_3uqEW","color-2":"OP5Ci","color-3":"_1Fkxx","color-4":"-BL5v","color-5":"_399eH","color-6":"_1MjFp","color-7":"_3qm9R","color-8":"_2crW2","color-9":"_1SA4K","color-10":"_2dp_E","color-11":"cF1Ok","color-12":"_9BF90","color-13":"_34kdb","color-14":"_10T8r","color-15":"_1j42K","color-16":"_3x5m0","color-17":"_2JJUO","color-18":"mC4Pu","color-19":"_1KVeG","color-20":"_3Iyem","bg-color-1":"_3tCPW","bg-color-2":"_1HmNi","bg-color-3":"_3CBot","bg-color-4":"_3tzzr","bg-color-5":"_3Fcza","bg-color-6":"_2A9tK","bg-color-7":"zHWD4","bg-color-8":"_2tZHl","bg-color-9":"_3abC2","bg-color-10":"_3C3vQ","bg-color-11":"_33I-Y","bg-color-12":"_2-dLk","bg-color-13":"_2G-ml","bg-color-14":"_3iSoE","bg-color-15":"_2vs64","bg-color-16":"_3yCav","bg-color-17":"_2MhAE","bg-color-18":"_1GL5-","bg-color-19":"_3NK9U","bg-color-20":"_2wqeg",title:"NDhQd"}},7588:function(e,t){t=e.exports={muted:"_1zngX","color-1":"_1uadE","color-2":"_89bdP","color-3":"_2x_35","color-4":"_3jQYR","color-5":"_18tVA","color-6":"_37KMp","color-7":"_1FFRb","color-8":"rZkvx","color-9":"_2LuRN","color-10":"_3HGUi","color-11":"DOVK1","color-12":"_1m0Wj","color-13":"_3A3N8","color-14":"_11HWv","color-15":"_1tqfB","color-16":"_2UmdP","color-17":"_126s_","color-18":"_32BEd","color-19":"_2uy3D","color-20":"_2fted","bg-color-1":"_39thk","bg-color-2":"_1mJxb","bg-color-3":"_2kevG","bg-color-4":"_2A9__","bg-color-5":"_38zC8","bg-color-6":"Za_Me","bg-color-7":"_2x5Xm","bg-color-8":"_2lOfo","bg-color-9":"_3qteo","bg-color-10":"_35GE3","bg-color-11":"_7PIdi","bg-color-12":"_3QGad","bg-color-13":"_2B9EU","bg-color-14":"_15qnT","bg-color-15":"_33GnU","bg-color-16":"_2TXFf","bg-color-17":"_2xImF","bg-color-18":"_2DVlF","bg-color-19":"_3bBIh","bg-color-20":"_3Fapp",body:"_2y3Vy",icon:"qpQEn",wrapper:"_1SdNj",container:"_3fzto",preview:"_2s3PU"}},7589:function(e,t){t=e.exports={muted:"_2xqkE","color-1":"_1d_wC","color-2":"_2KzgJ","color-3":"JEP05","color-4":"EcKK0","color-5":"_3Reqg","color-6":"_3lRnA","color-7":"_2hOwq","color-8":"IGH8l","color-9":"_1PUFd","color-10":"_1v0ex","color-11":"visUa","color-12":"_1egRv","color-13":"_2USvE","color-14":"_1s-Bb","color-15":"_2DetE","color-16":"z-jdk","color-17":"_2TDS5","color-18":"-mKQ_","color-19":"_1ngJD","color-20":"_1M-8G","bg-color-1":"_1LXac","bg-color-2":"_3P8Rv","bg-color-3":"_2bscQ","bg-color-4":"_2r9VR","bg-color-5":"_1ixeg","bg-color-6":"_2pOBv","bg-color-7":"T_Vxd","bg-color-8":"_2b4x9","bg-color-9":"_1k9y1","bg-color-10":"qd102","bg-color-11":"_1KpEG","bg-color-12":"AEjdT","bg-color-13":"_1hqQh","bg-color-14":"_3l0pW","bg-color-15":"_2O8oo","bg-color-16":"_1kA9Z","bg-color-17":"_1mFbr","bg-color-18":"_1oLXy","bg-color-19":"zmIPs","bg-color-20":"PLNDR",searchContainer:"_3cn1d",section:"_32TKr",blank:"_1PU4b",row:"_1Uq5P",sectionTitle:"_3KEhc"}},7590:function(e,t){t=e.exports={muted:"_30tUa","color-1":"Wvtxe","color-2":"_3_r68","color-3":"_3VPML","color-4":"_3WwcH","color-5":"MAEqZ","color-6":"_2fYIH","color-7":"_12pKJ","color-8":"_5eAEE","color-9":"efrv6","color-10":"_3EApK","color-11":"_1mhKM","color-12":"bdnut","color-13":"_3lrsA","color-14":"_3Y8mC","color-15":"_18gES","color-16":"_18xuh","color-17":"_2QBm_","color-18":"_2Co32","color-19":"_2VJIh","color-20":"_1o78T","bg-color-1":"_1-f7z","bg-color-2":"_17pm2","bg-color-3":"_19873","bg-color-4":"_2g_6L","bg-color-5":"dvM7N","bg-color-6":"_3fbJa","bg-color-7":"_3q8OO","bg-color-8":"_1JvA8","bg-color-9":"_1GrHv","bg-color-10":"_2soBz","bg-color-11":"X2AcQ","bg-color-12":"_2kCdD","bg-color-13":"wNqbj","bg-color-14":"l55OI","bg-color-15":"_2crdA","bg-color-16":"_3J6Zw","bg-color-17":"_2jTw3","bg-color-18":"_3nU-R","bg-color-19":"_3ObYy","bg-color-20":"_2u-7R",container:"_2AHxO",wrapper:"_32Mtt",innerWrapper:"_26YKx",starIcon:"_66z6R",thumb:"_2-2PO",blur:"_11SPE"}},7591:function(e,t){t=e.exports={muted:"_1BsAM","color-1":"_1_nz9","color-2":"_7bkMY","color-3":"_wMwy","color-4":"_2qGj2","color-5":"vQCXu","color-6":"_3pDky","color-7":"XJar-","color-8":"_3vvCL","color-9":"_3TeCH","color-10":"_2f945","color-11":"_1vyJR","color-12":"mvtu2","color-13":"_294BT","color-14":"KDjHG","color-15":"_1E4Qe","color-16":"_3bki7","color-17":"_1UTeF","color-18":"_2JUTN","color-19":"_3QY3J","color-20":"_2kzYC","bg-color-1":"_35GBh","bg-color-2":"bLz6U","bg-color-3":"_2_SXa","bg-color-4":"nSEQx","bg-color-5":"_3cr_v","bg-color-6":"_2wyPQ","bg-color-7":"_2SUuC","bg-color-8":"_3bBRW","bg-color-9":"_3FgXd","bg-color-10":"AjNM4","bg-color-11":"_3ht-N","bg-color-12":"EdwaQ","bg-color-13":"_G63E","bg-color-14":"_3Jx3Y","bg-color-15":"_2C-9N","bg-color-16":"_3G3HQ","bg-color-17":"_2rI4a","bg-color-18":"_3ymyl","bg-color-19":"_3SCBl","bg-color-20":"_2d57q",pager:"_3ut9b",pagerLeft:"_2h6gR",pagerRight:"_2wlqC",pagerDisabled:"_1K2Xw",body:"_3kMjS",section:"_3UT5g",sectionTitle:"-pjpQ",searchRow:"RiTx7"}},7592:function(e,t){t=e.exports={muted:"_31uKD","color-1":"k4yV2","color-2":"Aep8v","color-3":"_1Kdq3","color-4":"_1g-b7","color-5":"_25ZZD","color-6":"_2RlaV","color-7":"zJq1o","color-8":"dRNJy","color-9":"_1H6eu","color-10":"_1RonI","color-11":"LUePJ","color-12":"_1ElPu","color-13":"Gfdtj","color-14":"SwV9t","color-15":"sW9Xv","color-16":"_3lDA2","color-17":"_1ApqR","color-18":"_2DDZJ","color-19":"_1X74S","color-20":"FA6Fu","bg-color-1":"_3cd4y","bg-color-2":"_1Jy2t","bg-color-3":"sis7a","bg-color-4":"_1xdK2","bg-color-5":"_1nu5g","bg-color-6":"_1pKuX","bg-color-7":"_1ywVg","bg-color-8":"_3-wXm","bg-color-9":"_1vjW_","bg-color-10":"_1LN4r","bg-color-11":"KMNib","bg-color-12":"_1ZkV4","bg-color-13":"vySoS","bg-color-14":"_1WUJv","bg-color-15":"_3evCS","bg-color-16":"HbD8h","bg-color-17":"_13kqU","bg-color-18":"iY5hL","bg-color-19":"_14UCm","bg-color-20":"_1mwxW",intro:"_3qlW9",body:"_3BqNZ",title:"iHhHL",text:"_1ClcF",textContainer:"_2MnNk",image:"_2Uo0Z",secondary:"_1Y6o1",divider:"_3zFlu",secondaryText:"_3cK8a",secondaryTextBody:"_1lrYJ"}},7593:function(e,t){t=e.exports={muted:"_1OKDh","color-1":"_2GegJ","color-2":"QGyQK","color-3":"_3RA8t","color-4":"CaTG7","color-5":"_2OWEb","color-6":"_3_jZm","color-7":"GgQQP","color-8":"_1IETk","color-9":"MjMap","color-10":"_2tSZG","color-11":"_2L4I3","color-12":"_1qwuJ","color-13":"_2UltF","color-14":"_1NxlH","color-15":"_2m9NP","color-16":"_2MGgl","color-17":"_16Z8P","color-18":"xQbSB","color-19":"_1TkSp","color-20":"_3PaV4","bg-color-1":"_2d1Bq","bg-color-2":"_1uggU","bg-color-3":"_3Hw8g","bg-color-4":"_3wyNP","bg-color-5":"V5dWI","bg-color-6":"_3nDT5","bg-color-7":"_3eBN8","bg-color-8":"LpZ59","bg-color-9":"_3hN_8","bg-color-10":"_2OHnH","bg-color-11":"_3MJPg","bg-color-12":"_32dhM","bg-color-13":"_2eObU","bg-color-14":"_2q9qB","bg-color-15":"E1_eR","bg-color-16":"REJhT","bg-color-17":"_3QrXL","bg-color-18":"_6hvym","bg-color-19":"PY-fD","bg-color-20":"_1HPI6",list:"_1jyyu",hint:"_1jd1m",button:"_3hhmj"}},7594:function(e,t){t=e.exports={muted:"_3AJsl","color-1":"_1Y08c","color-2":"eCsiu","color-3":"_1_9cf","color-4":"_3QpK-","color-5":"_3cJ2f","color-6":"_3tLZk","color-7":"_2S0Ds","color-8":"_2tmUg","color-9":"_2yz7J","color-10":"_3J1dd","color-11":"pO3QO","color-12":"_1CsEu","color-13":"bQL8E","color-14":"_2pPbH","color-15":"_3hv2y","color-16":"_3a27S","color-17":"VEOrL","color-18":"_2NzgN","color-19":"_31Zkl","color-20":"_2kcyc","bg-color-1":"_3GrOB","bg-color-2":"_3EDKn","bg-color-3":"xTP6K","bg-color-4":"hctfl","bg-color-5":"_3rjH3","bg-color-6":"_3DCln","bg-color-7":"_1sk6t","bg-color-8":"Wbsuh","bg-color-9":"_1ewxg","bg-color-10":"_2HcwB","bg-color-11":"_2EiS1","bg-color-12":"qi_dw","bg-color-13":"_3VxFj","bg-color-14":"_1OGns","bg-color-15":"_2TMuy","bg-color-16":"_1LBEi","bg-color-17":"_2PykV","bg-color-18":"n1NBu","bg-color-19":"lAW5r","bg-color-20":"_1Zbgj",body:"_3fj4f",photo:"ePRKp"}},7595:function(e,t){t=e.exports={muted:"_ynT9","color-1":"_1Sepd","color-2":"_33FZz","color-3":"_3i63T","color-4":"_3bhMX","color-5":"_1xl4J","color-6":"_2r7tN","color-7":"_2cRix","color-8":"UUpJv","color-9":"_3tlCg","color-10":"_3L0b6","color-11":"_3bXmP","color-12":"_3Gsj2","color-13":"qkx_M","color-14":"hloJe","color-15":"_1I43P","color-16":"_3PV-r","color-17":"_2-MOg","color-18":"_124F7","color-19":"CuFzI","color-20":"_2LlpP","bg-color-1":"hG2GI","bg-color-2":"_3v5xG","bg-color-3":"_13ESX","bg-color-4":"_2DD1w","bg-color-5":"_2NIO0","bg-color-6":"_2w2x9","bg-color-7":"KgvhT","bg-color-8":"_14SgU","bg-color-9":"_1kd3e","bg-color-10":"_3vJGI","bg-color-11":"_3EvlJ","bg-color-12":"_3YGdG","bg-color-13":"_2wwzc","bg-color-14":"wgJ1o","bg-color-15":"_2j83E","bg-color-16":"_2V6c9","bg-color-17":"_1kJo3","bg-color-18":"PfV-a","bg-color-19":"GqmNa","bg-color-20":"_3_SDP",section:"_3V8PF",control:"_2gZbo",label:"_1pJVa"}},7596:function(e,t){t=e.exports={muted:"StIbo","color-1":"_1QGMI","color-2":"p019o","color-3":"_3QwLU","color-4":"_27inz","color-5":"_1kJAQ","color-6":"_2yUF1","color-7":"V_pVh","color-8":"_2OwcY","color-9":"_3juAS","color-10":"_35-gi","color-11":"-asGr","color-12":"_3MAt0","color-13":"_12BuI","color-14":"pLYCg","color-15":"_2vALy","color-16":"_2T2IO","color-17":"iPFqa","color-18":"_2V4lh","color-19":"_3FAEu","color-20":"_2U5an","bg-color-1":"_3b6cr","bg-color-2":"_10Aoy","bg-color-3":"_2z1NC","bg-color-4":"_2iBef","bg-color-5":"_3YOVb","bg-color-6":"DdAwM","bg-color-7":"_1JDpd","bg-color-8":"_2D841","bg-color-9":"_1OUN1","bg-color-10":"_35144","bg-color-11":"_3mKRT","bg-color-12":"_3HApN","bg-color-13":"SjrES","bg-color-14":"twSXo","bg-color-15":"_3p3SQ","bg-color-16":"FZZCq","bg-color-17":"_1f_4D","bg-color-18":"_3X1Mh","bg-color-19":"_2AEkm","bg-color-20":"_2kYWQ",newGroupButton:"_39pS-"}},7597:function(e,t){t=e.exports={muted:"_3J-tF","color-1":"_25yVh","color-2":"m3Eaw","color-3":"_2S8hG","color-4":"_2izPO","color-5":"_2_8Rh","color-6":"_2eFmP","color-7":"_1ga6w","color-8":"_1SQ4N","color-9":"vxSsM","color-10":"_1ghJz","color-11":"_3P3NC","color-12":"_2zNNV","color-13":"_2NCYi","color-14":"Aa9oY","color-15":"YrWuV","color-16":"F1A_s","color-17":"_13rGR","color-18":"_88VkO","color-19":"_2lZGY","color-20":"_7E5pc","bg-color-1":"_3lO64","bg-color-2":"_1MrWY","bg-color-3":"_11uT-","bg-color-4":"po-T5","bg-color-5":"_3FvEl","bg-color-6":"_28TsA","bg-color-7":"_2C20O","bg-color-8":"_2_xld","bg-color-9":"_3i4RW","bg-color-10":"_2L0U3","bg-color-11":"_3_3oQ","bg-color-12":"_3OAII","bg-color-13":"_2l6QJ","bg-color-14":"_1O-Oc","bg-color-15":"_3NkU7","bg-color-16":"_2GXKd","bg-color-17":"KCJf5","bg-color-18":"_13OlK","bg-color-19":"_29ua7","bg-color-20":"_2qHjg",contactBusinessInfo:"DKXPl",contactBusinessInfoSpinner:"oOOBW",dataRow:"_1u5dg",dataRowIcon:"JX05Q",dataRowText:"_21mxN",businessMarker:"_3WFA-",businessMarkerVerified:"_1ZOia",businessMarkerUnverified:"_2qyf8"}},7598:function(e,t){t=e.exports={muted:"_3v8Ky","color-1":"_2a92o","color-2":"_2rrGZ","color-3":"_1U29Z","color-4":"_1hZU4","color-5":"_2kprc","color-6":"_2ntJA","color-7":"ejKuV","color-8":"tuKFC","color-9":"hiPwR","color-10":"_2wHhe","color-11":"ZWQv7","color-12":"_2Cz5M","color-13":"GgxTZ","color-14":"_3tHyP","color-15":"_3L3XA","color-16":"offah","color-17":"_1Ld1p","color-18":"_3eWNu","color-19":"_2i7H6","color-20":"_8lyg5","bg-color-1":"_2QX-0","bg-color-2":"_1X1F3","bg-color-3":"_2WPlF","bg-color-4":"_2EacG","bg-color-5":"_1G_i9","bg-color-6":"_2UIow","bg-color-7":"_1dLUR","bg-color-8":"_20BaO","bg-color-9":"LzOMF","bg-color-10":"_1okfm","bg-color-11":"_25EEL","bg-color-12":"_3FEB_","bg-color-13":"_22216","bg-color-14":"_2GO5q","bg-color-15":"_1SdkD","bg-color-16":"_2Hoxz","bg-color-17":"QdAun","bg-color-18":"_22pbM","bg-color-19":"_32lme","bg-color-20":"_34QCG",body:"_2vsnU",avatar:"_2u2Mg",nameSecondary:"_3ml_s"}},7599:function(e,t){t=e.exports={muted:"_2hIYR","color-1":"_31LvS","color-2":"xzkIO","color-3":"LxeqJ","color-4":"_37Qyt","color-5":"_345TH","color-6":"GxwN_","color-7":"_3Bybt","color-8":"_1ebhF","color-9":"_1g6C_","color-10":"_3kAr7","color-11":"_1yDWD","color-12":"_3v7f4","color-13":"_2G_Dm","color-14":"_3JZCb","color-15":"_1IQOP","color-16":"_1XROP","color-17":"YpFjH","color-18":"_1goSE","color-19":"_2i9nq","color-20":"_3kEnV","bg-color-1":"_1AyZU","bg-color-2":"_3FDR6","bg-color-3":"_2lFzG","bg-color-4":"_2OVXO","bg-color-5":"LnM2i","bg-color-6":"DTCW5","bg-color-7":"_2Ld2b","bg-color-8":"_2Q7lh","bg-color-9":"_3NBQA","bg-color-10":"_2LQCW","bg-color-11":"_3DGrG","bg-color-12":"_2115l","bg-color-13":"_1sY9D","bg-color-14":"GRs5v","bg-color-15":"_3cLjU","bg-color-16":"hspQ6","bg-color-17":"_2zAuU","bg-color-18":"_3mu5_","bg-color-19":"ms02r","bg-color-20":"_3VbYD",icon:"_25jR4",body:"_2feU1",spinner:"_1AoLJ"}},7600:function(e,t){t=e.exports={muted:"E86us","color-1":"_13sm9","color-2":"_5bb4k","color-3":"-SFBa","color-4":"_2ZzWV","color-5":"_2Pxt_","color-6":"_3JLb6","color-7":"_3OiDC","color-8":"_3tfSE","color-9":"_2dLa5","color-10":"_2bmTu","color-11":"cvrnB","color-12":"_26_rr","color-13":"_3LMQJ","color-14":"_30imt","color-15":"wfmhd","color-16":"vLFO2","color-17":"bZ3gI","color-18":"_1w2QV","color-19":"_1Z2Y-","color-20":"_2NtGc","bg-color-1":"_3SGo4","bg-color-2":"_34JPg","bg-color-3":"_1ikH-","bg-color-4":"_1yKva","bg-color-5":"_2M89d","bg-color-6":"_30_yR","bg-color-7":"_1F2DU","bg-color-8":"_3D379","bg-color-9":"_2J8yc","bg-color-10":"_1MWwd","bg-color-11":"_1mwuw","bg-color-12":"eNOGF","bg-color-13":"_2_gtj","bg-color-14":"_20EQ1","bg-color-15":"_2Q5LI","bg-color-16":"_1GRfI","bg-color-17":"_3n4S7","bg-color-18":"_2NsmK","bg-color-19":"_3G7e1","bg-color-20":"_3Wavy",container:"_3v1xd",section:"cFkAx",sectionWide:"_9qbSk",control:"_1YO_g",label:"_3FR9x",disabled:"_2ojWN",select:"uyEaY"}},7601:function(e,t){t=e.exports={muted:"_3pJ1s","color-1":"teCtW","color-2":"_1m0jb","color-3":"_12PM7","color-4":"_3fmxh","color-5":"_1toW8","color-6":"_3mXba","color-7":"vTRas","color-8":"_3Ex7R","color-9":"_2o8JV","color-10":"_14I2Y","color-11":"_3onxD","color-12":"_22_W7","color-13":"_3dsCv","color-14":"_3rYvo","color-15":"_2lfuw","color-16":"XEHfX","color-17":"_175ax","color-18":"XjmQI","color-19":"_12jA3","color-20":"_1Zw12","bg-color-1":"_2L1Eg","bg-color-2":"_3O4e0","bg-color-3":"o7nZh","bg-color-4":"_3NSoq","bg-color-5":"eArUO","bg-color-6":"_2VUZc","bg-color-7":"nUq1L","bg-color-8":"_3wx7K","bg-color-9":"_3qg8Q","bg-color-10":"_3rHMC","bg-color-11":"_1MNan","bg-color-12":"_1zBRv","bg-color-13":"o_t3C","bg-color-14":"rsGEh","bg-color-15":"_1Ejcy","bg-color-16":"_3ukEM","bg-color-17":"_3og9T","bg-color-18":"_2e09C","bg-color-19":"_3xmAn","bg-color-20":"rdjCn",container:"_2sNbV",noscroll:"_3ySAH"}},7602:function(e,t){t=e.exports={muted:"_3bf1v","color-1":"_3Iv5N","color-2":"FuFaE","color-3":"_1mae2","color-4":"_3MwCY","color-5":"_1DIkY","color-6":"BEghz","color-7":"_3BqV0","color-8":"_3p-Nh","color-9":"_2ergX","color-10":"_2aSnx","color-11":"Qli2X","color-12":"bAwAg","color-13":"VtDSu","color-14":"_1TZ6V","color-15":"RshvT","color-16":"_2LalA","color-17":"Q_zxq","color-18":"bDbwh","color-19":"fsGkx","color-20":"_2MBCJ","bg-color-1":"_1Z4JH","bg-color-2":"_2GeRQ","bg-color-3":"_242Es","bg-color-4":"S18cy","bg-color-5":"dHjmH","bg-color-6":"OOEjr","bg-color-7":"_3q9pU","bg-color-8":"_2ycZA","bg-color-9":"_1O2D6","bg-color-10":"_3t4Is","bg-color-11":"_38WwS","bg-color-12":"_2jIH4","bg-color-13":"_1aXRq","bg-color-14":"_159D9","bg-color-15":"_30Gdi","bg-color-16":"_2c-Tc","bg-color-17":"ghT2Z","bg-color-18":"_1O53L","bg-color-19":"_3jW3j","bg-color-20":"_3gKSr",container:"_1CkkN",containerNoIcon:"_1gKF2",containerListAligned:"_1RMZB",icon:"rrzlm",bodyContainer:"_10xEB",body:"_2QrOO"}},7603:function(e,t){t=e.exports={muted:"_2HzYk","color-1":"_2iDvU","color-2":"_3ieG3","color-3":"n8-Jn","color-4":"_26Y70","color-5":"_1wM4q","color-6":"_1CwKV","color-7":"_3IJru","color-8":"hrdo-","color-9":"_1Xq1N","color-10":"_3OxU2","color-11":"_1EnhT","color-12":"_2ue3Q","color-13":"_2JYSl","color-14":"_1uAnV","color-15":"LXCer","color-16":"_1XhK6","color-17":"_5Aa15","color-18":"_27GB9","color-19":"_3tcaV","color-20":"unvvv","bg-color-1":"A6Z0h","bg-color-2":"_2_0m3","bg-color-3":"_1AcVL","bg-color-4":"LRyGn","bg-color-5":"_3NlXH","bg-color-6":"CWBS8","bg-color-7":"FaAbj","bg-color-8":"kb8IA","bg-color-9":"_3C2lj","bg-color-10":"_1UxRw","bg-color-11":"_8rAFk","bg-color-12":"_1ldC5","bg-color-13":"_6csvj","bg-color-14":"_7d8em","bg-color-15":"_29R02","bg-color-16":"_29rWr","bg-color-17":"_3vdE7","bg-color-18":"_1DZVw","bg-color-19":"VbiX9","bg-color-20":"_1zbIE",item:"_3Sz_W",itemBody:"_16z-w",row:"_1RRvB",main:"_3T-YY",side:"_1IDI7",primary:"wRfKo",secondary:"_19i9v"}},7604:function(e,t){t=e.exports={muted:"_36yrF","color-1":"_3zLGT","color-2":"NEw4w","color-3":"_3Y3--","color-4":"_17wMw","color-5":"_34Nf5","color-6":"_3GkXI","color-7":"_3dMC2","color-8":"_1nZ1x","color-9":"_2icE0","color-10":"_3AFWu","color-11":"_19idi","color-12":"_1Yycp","color-13":"_2_ANC","color-14":"OBNa4","color-15":"_3gEco","color-16":"_25cPP","color-17":"_2B5ft","color-18":"_3-_N0","color-19":"_3t3G_","color-20":"_31a1s","bg-color-1":"_1FoGm","bg-color-2":"_2SwPu","bg-color-3":"_6V-T7","bg-color-4":"_1a3Dx","bg-color-5":"_2c2ds","bg-color-6":"_1zAus","bg-color-7":"_2VOz9","bg-color-8":"_1_TKi","bg-color-9":"_2JQnP","bg-color-10":"iMM71","bg-color-11":"Bot6a","bg-color-12":"_3AthB","bg-color-13":"_1yhPK","bg-color-14":"_1WXJb","bg-color-15":"_2il-S","bg-color-16":"u0W8M","bg-color-17":"_1ru8t","bg-color-18":"zzdfm","bg-color-19":"_1CvDg","bg-color-20":"zqeGb",container:"_1CRb5",title:"_2VQzd","padding-large":"_3XgGT",padding:"_2phEY",animate:"_34vig","well-animation2":"_1hBRh"}},7605:function(e,t){t=e.exports={muted:"_2cyMR","color-1":"eZ8_R","color-2":"_3C_aR","color-3":"_2CjA3","color-4":"_3MrT2","color-5":"_14s6m","color-6":"_17s90","color-7":"_2ZFC_","color-8":"Rfg0x","color-9":"_3hfC_","color-10":"_1lLsu","color-11":"_1pD3s","color-12":"_1_nGV","color-13":"_2_8_x","color-14":"q0xaO","color-15":"_2QNxH","color-16":"_2VdJo","color-17":"_9xZcS","color-18":"QflM6","color-19":"eutdh","color-20":"_2wUeA","bg-color-1":"_2NBbr","bg-color-2":"_2YcJe","bg-color-3":"_2gsjC","bg-color-4":"_29L_u","bg-color-5":"FY9tX","bg-color-6":"_1R5YK","bg-color-7":"QXQj4","bg-color-8":"_3ibio","bg-color-9":"_3m0u3","bg-color-10":"_1q66k","bg-color-11":"_1tScp","bg-color-12":"_1KMcV","bg-color-13":"_3vFRs","bg-color-14":"_1L5c0","bg-color-15":"_3D_rY","bg-color-16":"Nvzdp","bg-color-17":"nrO4L","bg-color-18":"_3e52Z","bg-color-19":"_2Qrq4","bg-color-20":"_2fjg4",videoFloater:"_1bp9g",videoFloaterClose:"_2-xCd",videoFloaterMedia:"_1OWzJ",videoTag:"_2czw9"}},7606:function(e,t){t=e.exports={muted:"_3LNFp","color-1":"P3yaR","color-2":"_2bpXW","color-3":"_23soh","color-4":"_2Ko7P","color-5":"CUjNG","color-6":"_203Nv","color-7":"_2WOmN","color-8":"_1Vv0v","color-9":"_2CY9Q","color-10":"_2wkSg","color-11":"_3AC3a","color-12":"_30o8K","color-13":"_2YE20","color-14":"PArHV","color-15":"_3AAuK","color-16":"_2GgvK","color-17":"_1aqbu","color-18":"lyf08","color-19":"aFiz0","color-20":"_24Rp7","bg-color-1":"_3s9su","bg-color-2":"aWpp8","bg-color-3":"_13YEd","bg-color-4":"_1UVXC","bg-color-5":"_2pbvZ","bg-color-6":"_1RZuS","bg-color-7":"_2kJsQ","bg-color-8":"_3EZSP","bg-color-9":"_15_t-","bg-color-10":"_26L6L","bg-color-11":"_2TlBx","bg-color-12":"_3tMAv","bg-color-13":"_2CsMS","bg-color-14":"MlWwQ","bg-color-15":"_3tNQY","bg-color-16":"_3IuWs","bg-color-17":"zJJbt","bg-color-18":"_1eq5Y","bg-color-19":"hVIh2","bg-color-20":"_5XpxA",body:"AfVTG",avatar:"_1RIe1",description:"pqx2N",nameSecondary:"_3GoJv"}},7607:function(e,t){t=e.exports={muted:"_3El4W","color-1":"_2j3_E","color-2":"gcr9h","color-3":"_3T8Lj","color-4":"_3Nxfk","color-5":"_2NQAz","color-6":"_276Di","color-7":"_1BCEw","color-8":"aSNVC","color-9":"_3iK2H","color-10":"_3jJNV","color-11":"_1c2VX","color-12":"hAxM3","color-13":"_3Zadx","color-14":"bzgYE","color-15":"_3tKq1","color-16":"xWGtm","color-17":"_3Zve5","color-18":"_1Kpb-",
"color-19":"_29O8S","color-20":"_2ta7I","bg-color-1":"lzhOp","bg-color-2":"gWhpr","bg-color-3":"_1BqWI","bg-color-4":"HSMzg","bg-color-5":"_3pY9g","bg-color-6":"_3JW_f","bg-color-7":"_23GAd","bg-color-8":"gdvwY","bg-color-9":"_3upNJ","bg-color-10":"_12R50","bg-color-11":"_3_LIj","bg-color-12":"AUQmu","bg-color-13":"nB5Af","bg-color-14":"_2qkHe","bg-color-15":"_2mhTE","bg-color-16":"_2vCZd","bg-color-17":"_1O00u","bg-color-18":"_23Wuw","bg-color-19":"Remug","bg-color-20":"_2HxLO",linkContainer:"c4Y9s",descContainer:"_1lcS_"}},7608:function(e,t){t=e.exports={muted:"_1iqam","color-1":"_1CQrr","color-2":"_2iaGk","color-3":"_326ut","color-4":"_2QX3c","color-5":"_1qQZI","color-6":"_2QeWL","color-7":"_1u_AU","color-8":"_15xIC","color-9":"_3BKrn","color-10":"_2K28i","color-11":"_3Tgxk","color-12":"gDOn2","color-13":"_2VCPz","color-14":"_2__Sb","color-15":"O49s4","color-16":"_2SZye","color-17":"tL5Er","color-18":"_1mm81","color-19":"AeFZG","color-20":"MnTAw","bg-color-1":"_2BaLC","bg-color-2":"_2Ve0z","bg-color-3":"_1bQqQ","bg-color-4":"_1Lh7Q","bg-color-5":"H60Hl","bg-color-6":"_3tioC","bg-color-7":"cShFe","bg-color-8":"_3fxq4","bg-color-9":"_19X3F","bg-color-10":"_3REK_","bg-color-11":"_3oFfr","bg-color-12":"_2hJZn","bg-color-13":"_3pa1A","bg-color-14":"_3Zaqs","bg-color-15":"_1gRW0","bg-color-16":"_3evXa","bg-color-17":"_2lrX4","bg-color-18":"o6Q0S","bg-color-19":"_1cl3U","bg-color-20":"_1nB_J",metadataContainer:"_2S_XV",metadataIcon:"kjIPw",metadataText:"_1TSyH",metadataTitle:"_2xwAj",metadataSubtitle:"jBBQj",participantsTitle:"_2TH6-",participantsContainer:"H8YMs",participantWrapper:"_3Iv2R",participantImage:"_2rmd6",participantText:"_5AHJN"}},7609:function(e,t){t=e.exports={muted:"_1_kQM","color-1":"_37B0i","color-2":"_1ceuI","color-3":"_3vO3L","color-4":"_3r03A","color-5":"o2ABF","color-6":"_3vFE2","color-7":"_9fzkZ","color-8":"uZzFJ","color-9":"_2-_Q_","color-10":"_1ijkW","color-11":"_2-qpf","color-12":"_2Wwnh","color-13":"_3dp0a","color-14":"_32-mm","color-15":"_8b4z9","color-16":"_266v9","color-17":"_2fUpg","color-18":"_2od2u","color-19":"_3s2Sl","color-20":"_3EAAw","bg-color-1":"_3RSnd","bg-color-2":"_1oIa4","bg-color-3":"_3ocqO","bg-color-4":"_17zMB","bg-color-5":"jRxQt","bg-color-6":"_2PS8L","bg-color-7":"_1mcdP","bg-color-8":"_3OJNh","bg-color-9":"_2ZelJ","bg-color-10":"_3CMMm","bg-color-11":"_1D96Z","bg-color-12":"_1Qw0K","bg-color-13":"_1L0Db","bg-color-14":"_1Ncye","bg-color-15":"_26HkU","bg-color-16":"_1-tlI","bg-color-17":"_3GRxy","bg-color-18":"_2UTxY","bg-color-19":"_1N75x","bg-color-20":"_3MyC2",confirmationText:"koS3h"}},7610:function(e,t){t=e.exports={muted:"_33yrE","color-1":"_2bjj6","color-2":"_3HpfK","color-3":"_25yrY","color-4":"_1jXCt","color-5":"EWA7O","color-6":"_3G8wN","color-7":"Na-84","color-8":"_3OYVz","color-9":"_3_zND","color-10":"_37YDj","color-11":"_3l7q5","color-12":"Wi0cp","color-13":"TaCnn","color-14":"_34Kq6","color-15":"_3tYRk","color-16":"_3FsRb","color-17":"_3Y8kk","color-18":"_3XH54","color-19":"_3Y97Y","color-20":"_2J9rS","bg-color-1":"_2l0oa","bg-color-2":"_3okWt","bg-color-3":"_2OpSR","bg-color-4":"wRB_v","bg-color-5":"gJ7Oc","bg-color-6":"xrM2S","bg-color-7":"_3Kq5y","bg-color-8":"_1--mW","bg-color-9":"_2eVUN","bg-color-10":"_1t2e_","bg-color-11":"riRhs","bg-color-12":"_369nR","bg-color-13":"_1c4wb","bg-color-14":"mnpm4","bg-color-15":"_1kqR3","bg-color-16":"-UR0C","bg-color-17":"_10-PA","bg-color-18":"yUWtj","bg-color-19":"_3hEIJ","bg-color-20":"_282QA",title:"_2flas",titleIcon:"_250S3",spinner:"_3FSRn",list:"_2HDl5",footer:"Um7sh"}},7611:function(e,t){t=e.exports={muted:"_19R3W","color-1":"elgU1","color-2":"_2lGvi","color-3":"_11_Jn","color-4":"p9LSx","color-5":"_1-Pjk","color-6":"BrDdU","color-7":"_2MHra","color-8":"_3lkCk","color-9":"_3mU1Z","color-10":"CHMr9","color-11":"dmp5V","color-12":"_1IoGs","color-13":"_1vOFN","color-14":"hZnn-","color-15":"_1IzUq","color-16":"_2uNKf","color-17":"_26Sib","color-18":"_3YnkD","color-19":"_2tnM9","color-20":"_3d0sb","bg-color-1":"uObdS","bg-color-2":"FthxW","bg-color-3":"G9cWV","bg-color-4":"ck1xZ","bg-color-5":"_3qPBQ","bg-color-6":"_2m8Cp","bg-color-7":"tDmSU","bg-color-8":"_1rSEX","bg-color-9":"_1vA2A","bg-color-10":"_261ho","bg-color-11":"ULFAK","bg-color-12":"_26SdH","bg-color-13":"_1sFM4","bg-color-14":"_2txrA","bg-color-15":"TFP6_","bg-color-16":"a1iJI","bg-color-17":"_32oxg","bg-color-18":"_1W5Qr","bg-color-19":"G8pRA","bg-color-20":"EvVay",description:"_26BZr",chromeMediaIcon:"_1CvEJ",firefoxLockIcon:"_3gAUV",operaMediaIcon:"_3YTOO",guideContainer:"_38uPO",guideImage:"_30zap"}},7612:function(e,t){t=e.exports={muted:"_2jwc-","color-1":"_2D5ue","color-2":"_1quQ6","color-3":"_2becX","color-4":"U1fMB","color-5":"_3vUWl","color-6":"_3PFvn","color-7":"aI99M","color-8":"_isMs","color-9":"_3T3by","color-10":"_2quNP","color-11":"YGJPf","color-12":"TngkW","color-13":"_22M9N","color-14":"_310Xx","color-15":"_3ie3H","color-16":"_3TGO1","color-17":"_3SI_y","color-18":"_1hzLm","color-19":"_2A0el","color-20":"_22CEQ","bg-color-1":"_3hKGf","bg-color-2":"_16f6S","bg-color-3":"qlePk","bg-color-4":"_17A0t","bg-color-5":"_1RgPW","bg-color-6":"_1uCgH","bg-color-7":"_1iMs3","bg-color-8":"_3B-6K","bg-color-9":"_1Zvq7","bg-color-10":"_325O2","bg-color-11":"rRRiJ","bg-color-12":"FECO4","bg-color-13":"tJaUk","bg-color-14":"_3cHng","bg-color-15":"J_A9S","bg-color-16":"_2asVz","bg-color-17":"_2tN-R","bg-color-18":"_3pIUD","bg-color-19":"_2RXPY","bg-color-20":"_3EU3V",animation:"_1gzBr","play-ltr":"_1sfYd","play-rtl":"_1eCQY",version:"KuD7N",listItem:"_2ZnOp"}},7613:function(e,t){t=e.exports={muted:"_37SNT","color-1":"_1OP0c","color-2":"_1310_","color-3":"_1c_1N","color-4":"Klywn","color-5":"_1t12h","color-6":"_2Hc8J","color-7":"_1iflQ","color-8":"_2CKH5","color-9":"_2WkWU","color-10":"_22yXI","color-11":"xwbSb","color-12":"_2blqq","color-13":"_1gwaf","color-14":"_1_bij","color-15":"nsRHQ","color-16":"_2IF6l","color-17":"e3ipx","color-18":"_29pYN","color-19":"wCVLd","color-20":"_28zHu","bg-color-1":"_2KfQ1","bg-color-2":"_23H2o","bg-color-3":"_3odR3","bg-color-4":"_1_yMU","bg-color-5":"_3wQX8","bg-color-6":"_33vTa","bg-color-7":"_1UMmR","bg-color-8":"_1vIMN","bg-color-9":"_3Ruqu","bg-color-10":"cokzR","bg-color-11":"_1QCnS","bg-color-12":"_10BDu","bg-color-13":"_3fqT_","bg-color-14":"_16k0f","bg-color-15":"_25e5b","bg-color-16":"_36IU1","bg-color-17":"_1FSC8","bg-color-18":"FeKZT","bg-color-19":"Igefi","bg-color-20":"Pa48z",body:"P1enD",vcardWrapper:"_3afBu"}},7614:function(e,t){t=e.exports={muted:"cUxwI","color-1":"_3LgLr","color-2":"vkERd","color-3":"_1RpWq","color-4":"_2GCgY","color-5":"_2-ZhZ","color-6":"_1i7Um","color-7":"_8s0xy","color-8":"_3vDVy","color-9":"_2fWLK","color-10":"-y_Xv","color-11":"_3hc5K","color-12":"_1dlt0","color-13":"_3ZIf5","color-14":"_2McTd","color-15":"BZrFR","color-16":"SlR_q","color-17":"Ga5qX","color-18":"EeX0f","color-19":"_3GhE8","color-20":"_3tnyJ","bg-color-1":"_10LeQ","bg-color-2":"_1zqy7","bg-color-3":"_10PAy","bg-color-4":"_2fbSU","bg-color-5":"TGMvy","bg-color-6":"_3qOo0","bg-color-7":"_1hjUW","bg-color-8":"_1i5oJ","bg-color-9":"_2x9KZ","bg-color-10":"_2U4Fa","bg-color-11":"_1-4Fq","bg-color-12":"_2JybZ","bg-color-13":"_3sb-5","bg-color-14":"Pw6mI","bg-color-15":"_3_V4r","bg-color-16":"_2CnY3","bg-color-17":"_2Qxw6","bg-color-18":"_1LLoE","bg-color-19":"bfzbU","bg-color-20":"_1woF8",label:"_1M1iS",input:"_3DeDN"}},7615:function(e,t){t=e.exports={muted:"_3_Shg","color-1":"_218GN","color-2":"_6ZvSj","color-3":"JkWGO","color-4":"_2WDrS","color-5":"_3S75l","color-6":"aUv_1","color-7":"_2F7A_","color-8":"_1ueU8","color-9":"_3OB86","color-10":"_3Ie8x","color-11":"_1BOyt","color-12":"_10F5a","color-13":"_2xkDq","color-14":"_1ONEj","color-15":"_2xHtC","color-16":"_3hkB1","color-17":"_2RNc1","color-18":"_229br","color-19":"_3VJRX","color-20":"_1rYq9","bg-color-1":"_3AC_Y","bg-color-2":"_1ZATS","bg-color-3":"_26hBn","bg-color-4":"_13xrY","bg-color-5":"_1074i","bg-color-6":"_27YJI","bg-color-7":"kjZWA","bg-color-8":"_1KQAO","bg-color-9":"W1x0w","bg-color-10":"_3Y2rf","bg-color-11":"MomWV","bg-color-12":"_384Sn","bg-color-13":"_3GAAH","bg-color-14":"_1IG1G","bg-color-15":"LAwXb","bg-color-16":"_22Ymz","bg-color-17":"_3AE1W","bg-color-18":"_11UQx","bg-color-19":"_1raTx","bg-color-20":"_2Z4hM",nextButton:"_1ZJYc",section:"_2AafV"}},7616:function(e,t){t=e.exports={muted:"_1fI7q","color-1":"_3Q_zq","color-2":"_3k7H-","color-3":"Jti9J","color-4":"_3HPIA","color-5":"_2VoVC","color-6":"UooUB","color-7":"_1BO2G","color-8":"_2zF2z","color-9":"_2xvm7","color-10":"_2RBCT","color-11":"LMuNK","color-12":"_2bK0E","color-13":"_2rsA6","color-14":"XBQ29","color-15":"_112Ew","color-16":"_3M3lJ","color-17":"MoXX9","color-18":"_3_HdE","color-19":"OkAcD","color-20":"_9-BrN","bg-color-1":"_3kwVe","bg-color-2":"_2C8bH","bg-color-3":"_2Z8tz","bg-color-4":"_1eEoq","bg-color-5":"kkSbp","bg-color-6":"_2m73H","bg-color-7":"_2ymrx","bg-color-8":"_15cp0","bg-color-9":"_1ywOw","bg-color-10":"_3TegS","bg-color-11":"_2nFA3","bg-color-12":"_2QAWF","bg-color-13":"xfRN0","bg-color-14":"VrtsI","bg-color-15":"W1uB4","bg-color-16":"lx9ES","bg-color-17":"_1tsrZ","bg-color-18":"_2O8xu","bg-color-19":"_2fajI","bg-color-20":"ie_vZ",close:"_16yFM",profileThumb:"_2Q-Cb",profileContainer:"ao2gD",media:"_2L039",profileViewer:"P9iLC",profileViewerImg:"_1zH0g",container:"_1zcz2","media-viewer-animate":"_2rZ-T",headerContainer:"_2YdsD",headerContainerNative:"_2EEiy"}},7617:function(e,t){t=e.exports={muted:"_3erEF","color-1":"lhN8b","color-2":"_13A2x","color-3":"_2JWYn","color-4":"_1Sx54","color-5":"b1juM","color-6":"_3Hims","color-7":"_3ncpu","color-8":"_3NQpG","color-9":"eyEYN","color-10":"ciiE6","color-11":"_2idUV","color-12":"_13rPU","color-13":"_3-_J6","color-14":"ywHPj","color-15":"_1Ad-R","color-16":"_16KEi","color-17":"_1yE22","color-18":"_6WsC_","color-19":"-fXWC","color-20":"_2Yi9x","bg-color-1":"_3kU-I","bg-color-2":"_3aDRJ","bg-color-3":"ihMXa","bg-color-4":"_21sh6","bg-color-5":"_2voLC","bg-color-6":"M8wvr","bg-color-7":"_21OTE","bg-color-8":"NIsrX","bg-color-9":"_2iIQ5","bg-color-10":"_19aqS","bg-color-11":"_1FN_J","bg-color-12":"MaLN9","bg-color-13":"_1Y36b","bg-color-14":"_2d2aX","bg-color-15":"_1-X4z","bg-color-16":"_2snMQ","bg-color-17":"_3riiZ","bg-color-18":"_1THK6","bg-color-19":"_-11PI","bg-color-20":"_1_pLS",photoPickerWrapper:"_12fSF",scale:"XVXvJ",nameWrapper:"_idKB","well-animation":"_3Gjbg"}},7618:function(e,t){t=e.exports={muted:"_31HaC","color-1":"SARTG","color-2":"_3EpvC","color-3":"AgHSd","color-4":"_3b0qT","color-5":"eOBl-","color-6":"_7sYd2","color-7":"_3KvCe","color-8":"_13ACY","color-9":"_3vYyX","color-10":"_1mMda","color-11":"vHnyG","color-12":"_1bXBf","color-13":"_39Obu","color-14":"_3ZIsG","color-15":"_20trG","color-16":"_1xI5x","color-17":"_3eznM","color-18":"_3JWAl","color-19":"_1u6DC","color-20":"Zr9Fu","bg-color-1":"hiP_E","bg-color-2":"_3VVEx","bg-color-3":"_37Svz","bg-color-4":"_2cDOg","bg-color-5":"_3bij1","bg-color-6":"_31lU-","bg-color-7":"_2UdFw","bg-color-8":"_2lcCs","bg-color-9":"_16Iw4","bg-color-10":"_3O6gz","bg-color-11":"_3yj-p","bg-color-12":"_3fo1r","bg-color-13":"_16ift","bg-color-14":"_1JLpw","bg-color-15":"_1Moaa","bg-color-16":"cYbcV","bg-color-17":"_2D7Pi","bg-color-18":"_3cmfX","bg-color-19":"_1qEtj","bg-color-20":"_3kagb",screenshots:"_1XiZb",action:"_1BLxK",disabled:"_1cAbm",screenshotPreview:"_2WSfN",screenshotsImg:"_1QBse",btnDelete:"_2R1br"}},7619:function(e,t){t=e.exports={muted:"_1BYDA","color-1":"_2zO_A","color-2":"_2CMYu","color-3":"_4k6IF","color-4":"_24BuT","color-5":"_262KN","color-6":"_1zbzp","color-7":"_3SsHg","color-8":"_3acC7","color-9":"FqVJr","color-10":"_1iIv6","color-11":"oLF9B","color-12":"_2ilW4","color-13":"_2hM9L","color-14":"_2TCC3","color-15":"VbP93","color-16":"_3RLmh","color-17":"_12aCz","color-18":"_1vsR3","color-19":"_2gahP","color-20":"BtqJ_","bg-color-1":"_1Qcz7","bg-color-2":"_28aaX","bg-color-3":"_3oI2i","bg-color-4":"_29JlA","bg-color-5":"_137NA","bg-color-6":"_3vVJE","bg-color-7":"_3fFEs","bg-color-8":"_1-RCC","bg-color-9":"_3QrdQ","bg-color-10":"_3oSof","bg-color-11":"_16FkK","bg-color-12":"_13pV8","bg-color-13":"_2ihtW","bg-color-14":"_3mnIy","bg-color-15":"_2IclV","bg-color-16":"_3n8hf","bg-color-17":"_3V65O","bg-color-18":"_31yz1","bg-color-19":"_10Pm7","bg-color-20":"_1GWIg",more:"VWBaR",container:"_3_kNZ",hotKeyWraper:"ZwkQK"}},7620:function(e,t){t=e.exports={muted:"_2YIJc","color-1":"_1-Igv","color-2":"_3janr","color-3":"_15y83","color-4":"_2wxhl","color-5":"QPgxO","color-6":"_3rd5P","color-7":"_1NkIU","color-8":"_3hBQx","color-9":"_59iOa","color-10":"rhx_Z","color-11":"_1brZY","color-12":"_3T3s7","color-13":"CAGO5","color-14":"vQ_4O","color-15":"_2wTm7","color-16":"_2BZj2","color-17":"_3yf9k","color-18":"_30Pfc","color-19":"QRT8k","color-20":"_4sNZm","bg-color-1":"_2d3lh","bg-color-2":"_1QH5h","bg-color-3":"_3J5qL","bg-color-4":"_32SjW","bg-color-5":"_3s2TL","bg-color-6":"dI9ZX","bg-color-7":"_34WPE","bg-color-8":"_3F57V","bg-color-9":"_3X-gB","bg-color-10":"eOi5n","bg-color-11":"QLlr4","bg-color-12":"Lr2Zx","bg-color-13":"_1xT-C","bg-color-14":"_1u-o5","bg-color-15":"_1i9TP","bg-color-16":"_2cgH1","bg-color-17":"_1PH_l","bg-color-18":"_1ZJZk","bg-color-19":"_1AJU9","bg-color-20":"_2OerE",btnPosition:"_3h2Do",body:"_2bVIT",vcardWrapper:"_1VX5S",btnContainer:"_2mZ8F"}},7621:function(e,t){t=e.exports={muted:"NMgpK","color-1":"_17bbR","color-2":"_10qWY","color-3":"_3boH5","color-4":"_2ugOU","color-5":"_2YgcB","color-6":"_1f31x","color-7":"_3rCXW","color-8":"_2m087","color-9":"XLxmn","color-10":"_1eOW0","color-11":"_10Ufy","color-12":"O7zgK","color-13":"_3rTkC","color-14":"_3AeI1","color-15":"_2ULoO","color-16":"_1kYaA","color-17":"HT-wR","color-18":"_2V83E","color-19":"_3KXWy","color-20":"_21ypY","bg-color-1":"_3biVm","bg-color-2":"E8utK","bg-color-3":"_2NW2G","bg-color-4":"_4cM_r","bg-color-5":"_1c1cr","bg-color-6":"_1HwDG","bg-color-7":"_1NKah","bg-color-8":"_1pB9r","bg-color-9":"_2UBnj","bg-color-10":"_2j-AT","bg-color-11":"S2p16","bg-color-12":"_3Lwx2","bg-color-13":"_16H_K","bg-color-14":"_3rMRU","bg-color-15":"z9vYZ","bg-color-16":"_1cmVr","bg-color-17":"_1VAeQ","bg-color-18":"_1ezpT","bg-color-19":"OGBsa","bg-color-20":"_3ei2v",content:"_36ApL"}},7622:function(e,t){t=e.exports={muted:"XCod5","color-1":"_1VHQB","color-2":"_1yVRx","color-3":"_3uOY9","color-4":"_3h4Le","color-5":"_2D8SZ","color-6":"_1Q_e7","color-7":"q4nKu","color-8":"_3Twcj","color-9":"_2acdv","color-10":"_3WwD6","color-11":"_2KnGC","color-12":"_2M_tQ","color-13":"_2bM5x","color-14":"KGwmQ","color-15":"_1PNcX","color-16":"_3KPzO","color-17":"_18Qc8","color-18":"_2m8Lh","color-19":"_2ceLN","color-20":"_2Ij0r","bg-color-1":"_2MH2o","bg-color-2":"_2pkDG","bg-color-3":"_3rUvY","bg-color-4":"KgRML","bg-color-5":"_1MI6v","bg-color-6":"_1NyC7","bg-color-7":"_3_Fun","bg-color-8":"_1mmsP","bg-color-9":"_19LGK","bg-color-10":"_2MLPC","bg-color-11":"_2oIii","bg-color-12":"YozA2","bg-color-13":"_3K_2D","bg-color-14":"_3iQ60","bg-color-15":"_1nYhu","bg-color-16":"_2_5Qn","bg-color-17":"_3vWYw","bg-color-18":"_1bP5O","bg-color-19":"bVy9a","bg-color-20":"_24-Td",container:"_1eoPp"}},7623:function(e,t){t=e.exports={muted:"_24O--","color-1":"_2tEj8","color-2":"DtsKF","color-3":"Z7g9W","color-4":"_22gt-","color-5":"_3roHm","color-6":"Joq30","color-7":"_1kGWS","color-8":"_3y94a","color-9":"_1gI09","color-10":"E59pI","color-11":"_1D_du","color-12":"_1a5WE","color-13":"_3YsjX","color-14":"_3rhvm","color-15":"CP9W3","color-16":"_1oVn6","color-17":"_2Mg4P","color-18":"_2vJ4l","color-19":"_3KA51","color-20":"_2b7Sk","bg-color-1":"lwNN6","bg-color-2":"_3VHvc","bg-color-3":"_3nWMW","bg-color-4":"AyprV","bg-color-5":"_2tax-","bg-color-6":"_3PeGr","bg-color-7":"_3WGcy","bg-color-8":"_1_zZO","bg-color-9":"_3g__-","bg-color-10":"_3pwsS","bg-color-11":"ZM22R","bg-color-12":"_1e0th","bg-color-13":"_2o34b","bg-color-14":"GX8uo","bg-color-15":"_1t5k9","bg-color-16":"_1_S7V","bg-color-17":"_1X3GG","bg-color-18":"WVr6l","bg-color-19":"Xhl1j","bg-color-20":"CEbm-",wallpaperColorGrid:"tyVYE",wallpaperColorCanvas:"CDuBw",wallpaperDefaultTitle:"_22NjO",wallpaperColorEmpty:"N_TIP",canvasActive:"LzQzF",canvasHover:"_2DMPB"}},7624:function(e,t){t=e.exports={muted:"dL3Xv","color-1":"_1x_At","color-2":"dj7BD","color-3":"_3-nEB","color-4":"_1TyTG","color-5":"_3u1Yj","color-6":"_2t19v","color-7":"_1le6e","color-8":"La7b3","color-9":"_1596U","color-10":"ZdLeU","color-11":"_1n3g2","color-12":"_2uhDF","color-13":"jUQc9","color-14":"_1rJ-P","color-15":"_37TNc","color-16":"rZz2t","color-17":"_1Pjoy","color-18":"_2cHAP","color-19":"_2WpUv","color-20":"_3XQY4","bg-color-1":"_35R2_","bg-color-2":"_1lTqE","bg-color-3":"_38oip","bg-color-4":"_3cJ_Z","bg-color-5":"_1Dkpi","bg-color-6":"_2jIof","bg-color-7":"_11H0b","bg-color-8":"EVLNl","bg-color-9":"xIIig","bg-color-10":"_1wkis","bg-color-11":"_17G6n","bg-color-12":"MfDLI","bg-color-13":"fKQM2","bg-color-14":"_1X3e5","bg-color-15":"_2Y9W-","bg-color-16":"KMt83","bg-color-17":"_2Ufn9","bg-color-18":"Q1O95","bg-color-19":"Wg836","bg-color-20":"_3zdo9",ring:"_1JWMX",read:"_1yTHJ",unread:"_1tACm"}},7625:function(e,t){t=e.exports={muted:"_1vqPC","color-1":"_17XWe","color-2":"_14wYx","color-3":"_1fwfo","color-4":"_3bbnY","color-5":"_1XWLh","color-6":"_1HjyS","color-7":"_2B5Oc","color-8":"_2O5qR","color-9":"_2Wk32","color-10":"BufKt","color-11":"_2jhJ_","color-12":"JKLRo","color-13":"_3TgX5","color-14":"_3v_iK","color-15":"_3h3Oc","color-16":"_1Y3JX","color-17":"_2Hdpx","color-18":"_1jy0S","color-19":"_2tTtQ","color-20":"_1MEqX","bg-color-1":"kJrCi","bg-color-2":"_15lCd","bg-color-3":"_3w-kB","bg-color-4":"_1pE1L","bg-color-5":"_2Bim7","bg-color-6":"_3dhwo","bg-color-7":"_1z9VY","bg-color-8":"_1Q2RQ","bg-color-9":"_2VLLy","bg-color-10":"_1or_O","bg-color-11":"ME06E","bg-color-12":"yoXOG","bg-color-13":"fsGqj","bg-color-14":"_2H5nI","bg-color-15":"_30YaO","bg-color-16":"_3zWpI","bg-color-17":"_3cl61","bg-color-18":"WJ2xJ","bg-color-19":"KGfqa","bg-color-20":"_2U1FE",container:"_2Opss",wrapper:"_3LVDJ",mask:"_1oZua",bg:"_3wPo6",foreground:"_2dwaZ",filled:"_3Xb7q",empty:"_27Sip",active:"_1khRp"}}});